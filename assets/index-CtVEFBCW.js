const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser-CKC9vik6.js","./react-vendor-ByTr29QW.js","./ServicesSection-DGDj_Nap.js","./firebase-vendor-CAk-8R_y.js","./ProjectsSection-T4zhqq8x.js","./ContactSection-F2Wq3QDb.js"])))=>i.map(i=>d[i]);
import{r as Y,a as ff,u as df,c as Ke,g as Xm,b as Zm,d as eg,L as vi,B as tg,R as ng,e as Zn,N as pf}from"./react-vendor-ByTr29QW.js";import{L as rg,_ as ig,C as sg,r as nc,F as og,a as ag,g as lg,b as ug,c as cg,d as tn,e as hg,f as fg,h as Rt,S as dg,i as pg,j as mg,k as gg,l as yg,o as mf,s as vg,m as _g}from"./firebase-vendor-CAk-8R_y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var gf={exports:{}},Gs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg=Y,wg=Symbol.for("react.element"),Eg=Symbol.for("react.fragment"),xg=Object.prototype.hasOwnProperty,Tg=bg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ag={key:!0,ref:!0,__self:!0,__source:!0};function yf(r,e,t){var n,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)xg.call(e,n)&&!Ag.hasOwnProperty(n)&&(i[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:wg,type:r,key:s,ref:o,props:i,_owner:Tg.current}}Gs.Fragment=Eg;Gs.jsx=yf;Gs.jsxs=yf;gf.exports=Gs;var P=gf.exports,vf,rc=ff;vf=rc.createRoot,rc.hydrateRoot;var ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bn,_f;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function N(){}N.prototype=w.prototype,E.D=w.prototype,E.prototype=new N,E.prototype.constructor=E,E.C=function(T,x,I){for(var k=Array(arguments.length-2),j=2;j<arguments.length;j++)k[j-2]=arguments[j];return w.prototype[x].apply(T,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,w,N){N||(N=0);var T=Array(16);if(typeof w=="string")for(var x=0;16>x;++x)T[x]=w.charCodeAt(N++)|w.charCodeAt(N++)<<8|w.charCodeAt(N++)<<16|w.charCodeAt(N++)<<24;else for(x=0;16>x;++x)T[x]=w[N++]|w[N++]<<8|w[N++]<<16|w[N++]<<24;w=E.g[0],N=E.g[1],x=E.g[2];var I=E.g[3],k=w+(I^N&(x^I))+T[0]+3614090360&4294967295;w=N+(k<<7&4294967295|k>>>25),k=I+(x^w&(N^x))+T[1]+3905402710&4294967295,I=w+(k<<12&4294967295|k>>>20),k=x+(N^I&(w^N))+T[2]+606105819&4294967295,x=I+(k<<17&4294967295|k>>>15),k=N+(w^x&(I^w))+T[3]+3250441966&4294967295,N=x+(k<<22&4294967295|k>>>10),k=w+(I^N&(x^I))+T[4]+4118548399&4294967295,w=N+(k<<7&4294967295|k>>>25),k=I+(x^w&(N^x))+T[5]+1200080426&4294967295,I=w+(k<<12&4294967295|k>>>20),k=x+(N^I&(w^N))+T[6]+2821735955&4294967295,x=I+(k<<17&4294967295|k>>>15),k=N+(w^x&(I^w))+T[7]+4249261313&4294967295,N=x+(k<<22&4294967295|k>>>10),k=w+(I^N&(x^I))+T[8]+1770035416&4294967295,w=N+(k<<7&4294967295|k>>>25),k=I+(x^w&(N^x))+T[9]+2336552879&4294967295,I=w+(k<<12&4294967295|k>>>20),k=x+(N^I&(w^N))+T[10]+4294925233&4294967295,x=I+(k<<17&4294967295|k>>>15),k=N+(w^x&(I^w))+T[11]+2304563134&4294967295,N=x+(k<<22&4294967295|k>>>10),k=w+(I^N&(x^I))+T[12]+1804603682&4294967295,w=N+(k<<7&4294967295|k>>>25),k=I+(x^w&(N^x))+T[13]+4254626195&4294967295,I=w+(k<<12&4294967295|k>>>20),k=x+(N^I&(w^N))+T[14]+2792965006&4294967295,x=I+(k<<17&4294967295|k>>>15),k=N+(w^x&(I^w))+T[15]+1236535329&4294967295,N=x+(k<<22&4294967295|k>>>10),k=w+(x^I&(N^x))+T[1]+4129170786&4294967295,w=N+(k<<5&4294967295|k>>>27),k=I+(N^x&(w^N))+T[6]+3225465664&4294967295,I=w+(k<<9&4294967295|k>>>23),k=x+(w^N&(I^w))+T[11]+643717713&4294967295,x=I+(k<<14&4294967295|k>>>18),k=N+(I^w&(x^I))+T[0]+3921069994&4294967295,N=x+(k<<20&4294967295|k>>>12),k=w+(x^I&(N^x))+T[5]+3593408605&4294967295,w=N+(k<<5&4294967295|k>>>27),k=I+(N^x&(w^N))+T[10]+38016083&4294967295,I=w+(k<<9&4294967295|k>>>23),k=x+(w^N&(I^w))+T[15]+3634488961&4294967295,x=I+(k<<14&4294967295|k>>>18),k=N+(I^w&(x^I))+T[4]+3889429448&4294967295,N=x+(k<<20&4294967295|k>>>12),k=w+(x^I&(N^x))+T[9]+568446438&4294967295,w=N+(k<<5&4294967295|k>>>27),k=I+(N^x&(w^N))+T[14]+3275163606&4294967295,I=w+(k<<9&4294967295|k>>>23),k=x+(w^N&(I^w))+T[3]+4107603335&4294967295,x=I+(k<<14&4294967295|k>>>18),k=N+(I^w&(x^I))+T[8]+1163531501&4294967295,N=x+(k<<20&4294967295|k>>>12),k=w+(x^I&(N^x))+T[13]+2850285829&4294967295,w=N+(k<<5&4294967295|k>>>27),k=I+(N^x&(w^N))+T[2]+4243563512&4294967295,I=w+(k<<9&4294967295|k>>>23),k=x+(w^N&(I^w))+T[7]+1735328473&4294967295,x=I+(k<<14&4294967295|k>>>18),k=N+(I^w&(x^I))+T[12]+2368359562&4294967295,N=x+(k<<20&4294967295|k>>>12),k=w+(N^x^I)+T[5]+4294588738&4294967295,w=N+(k<<4&4294967295|k>>>28),k=I+(w^N^x)+T[8]+2272392833&4294967295,I=w+(k<<11&4294967295|k>>>21),k=x+(I^w^N)+T[11]+1839030562&4294967295,x=I+(k<<16&4294967295|k>>>16),k=N+(x^I^w)+T[14]+4259657740&4294967295,N=x+(k<<23&4294967295|k>>>9),k=w+(N^x^I)+T[1]+2763975236&4294967295,w=N+(k<<4&4294967295|k>>>28),k=I+(w^N^x)+T[4]+1272893353&4294967295,I=w+(k<<11&4294967295|k>>>21),k=x+(I^w^N)+T[7]+4139469664&4294967295,x=I+(k<<16&4294967295|k>>>16),k=N+(x^I^w)+T[10]+3200236656&4294967295,N=x+(k<<23&4294967295|k>>>9),k=w+(N^x^I)+T[13]+681279174&4294967295,w=N+(k<<4&4294967295|k>>>28),k=I+(w^N^x)+T[0]+3936430074&4294967295,I=w+(k<<11&4294967295|k>>>21),k=x+(I^w^N)+T[3]+3572445317&4294967295,x=I+(k<<16&4294967295|k>>>16),k=N+(x^I^w)+T[6]+76029189&4294967295,N=x+(k<<23&4294967295|k>>>9),k=w+(N^x^I)+T[9]+3654602809&4294967295,w=N+(k<<4&4294967295|k>>>28),k=I+(w^N^x)+T[12]+3873151461&4294967295,I=w+(k<<11&4294967295|k>>>21),k=x+(I^w^N)+T[15]+530742520&4294967295,x=I+(k<<16&4294967295|k>>>16),k=N+(x^I^w)+T[2]+3299628645&4294967295,N=x+(k<<23&4294967295|k>>>9),k=w+(x^(N|~I))+T[0]+4096336452&4294967295,w=N+(k<<6&4294967295|k>>>26),k=I+(N^(w|~x))+T[7]+1126891415&4294967295,I=w+(k<<10&4294967295|k>>>22),k=x+(w^(I|~N))+T[14]+2878612391&4294967295,x=I+(k<<15&4294967295|k>>>17),k=N+(I^(x|~w))+T[5]+4237533241&4294967295,N=x+(k<<21&4294967295|k>>>11),k=w+(x^(N|~I))+T[12]+1700485571&4294967295,w=N+(k<<6&4294967295|k>>>26),k=I+(N^(w|~x))+T[3]+2399980690&4294967295,I=w+(k<<10&4294967295|k>>>22),k=x+(w^(I|~N))+T[10]+4293915773&4294967295,x=I+(k<<15&4294967295|k>>>17),k=N+(I^(x|~w))+T[1]+2240044497&4294967295,N=x+(k<<21&4294967295|k>>>11),k=w+(x^(N|~I))+T[8]+1873313359&4294967295,w=N+(k<<6&4294967295|k>>>26),k=I+(N^(w|~x))+T[15]+4264355552&4294967295,I=w+(k<<10&4294967295|k>>>22),k=x+(w^(I|~N))+T[6]+2734768916&4294967295,x=I+(k<<15&4294967295|k>>>17),k=N+(I^(x|~w))+T[13]+1309151649&4294967295,N=x+(k<<21&4294967295|k>>>11),k=w+(x^(N|~I))+T[4]+4149444226&4294967295,w=N+(k<<6&4294967295|k>>>26),k=I+(N^(w|~x))+T[11]+3174756917&4294967295,I=w+(k<<10&4294967295|k>>>22),k=x+(w^(I|~N))+T[2]+718787259&4294967295,x=I+(k<<15&4294967295|k>>>17),k=N+(I^(x|~w))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(x+(k<<21&4294967295|k>>>11))&4294967295,E.g[2]=E.g[2]+x&4294967295,E.g[3]=E.g[3]+I&4294967295}n.prototype.u=function(E,w){w===void 0&&(w=E.length);for(var N=w-this.blockSize,T=this.B,x=this.h,I=0;I<w;){if(x==0)for(;I<=N;)i(this,E,I),I+=this.blockSize;if(typeof E=="string"){for(;I<w;)if(T[x++]=E.charCodeAt(I++),x==this.blockSize){i(this,T),x=0;break}}else for(;I<w;)if(T[x++]=E[I++],x==this.blockSize){i(this,T),x=0;break}}this.h=x,this.o+=w},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;var N=8*this.o;for(w=E.length-8;w<E.length;++w)E[w]=N&255,N/=256;for(this.u(E),E=Array(16),w=N=0;4>w;++w)for(var T=0;32>T;T+=8)E[N++]=this.g[w]>>>T&255;return E};function s(E,w){var N=a;return Object.prototype.hasOwnProperty.call(N,E)?N[E]:N[E]=w(E)}function o(E,w){this.h=w;for(var N=[],T=!0,x=E.length-1;0<=x;x--){var I=E[x]|0;T&&I==w||(N[x]=I,T=!1)}this.g=N}var a={};function l(E){return-128<=E&&128>E?s(E,function(w){return new o([w|0],0>w?-1:0)}):new o([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return y(c(-E));for(var w=[],N=1,T=0;E>=N;T++)w[T]=E/N|0,N*=4294967296;return new o(w,0)}function h(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return y(h(E.substring(1),w));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=c(Math.pow(w,8)),T=d,x=0;x<E.length;x+=8){var I=Math.min(8,E.length-x),k=parseInt(E.substring(x,x+I),w);8>I?(I=c(Math.pow(w,I)),T=T.j(I).add(c(k))):(T=T.j(N),T=T.add(c(k)))}return T}var d=l(0),f=l(1),p=l(16777216);r=o.prototype,r.m=function(){if(g(this))return-y(this).m();for(var E=0,w=1,N=0;N<this.g.length;N++){var T=this.i(N);E+=(0<=T?T:4294967296+T)*w,w*=4294967296}return E},r.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(_(this))return"0";if(g(this))return"-"+y(this).toString(E);for(var w=c(Math.pow(E,6)),N=this,T="";;){var x=v(N,w).g;N=m(N,x.j(w));var I=((0<N.g.length?N.g[0]:N.h)>>>0).toString(E);if(N=x,_(N))return I+T;for(;6>I.length;)I="0"+I;T=I+T}},r.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function _(E){if(E.h!=0)return!1;for(var w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function g(E){return E.h==-1}r.l=function(E){return E=m(this,E),g(E)?-1:_(E)?0:1};function y(E){for(var w=E.g.length,N=[],T=0;T<w;T++)N[T]=~E.g[T];return new o(N,~E.h).add(f)}r.abs=function(){return g(this)?y(this):this},r.add=function(E){for(var w=Math.max(this.g.length,E.g.length),N=[],T=0,x=0;x<=w;x++){var I=T+(this.i(x)&65535)+(E.i(x)&65535),k=(I>>>16)+(this.i(x)>>>16)+(E.i(x)>>>16);T=k>>>16,I&=65535,k&=65535,N[x]=k<<16|I}return new o(N,N[N.length-1]&-2147483648?-1:0)};function m(E,w){return E.add(y(w))}r.j=function(E){if(_(this)||_(E))return d;if(g(this))return g(E)?y(this).j(y(E)):y(y(this).j(E));if(g(E))return y(this.j(y(E)));if(0>this.l(p)&&0>E.l(p))return c(this.m()*E.m());for(var w=this.g.length+E.g.length,N=[],T=0;T<2*w;T++)N[T]=0;for(T=0;T<this.g.length;T++)for(var x=0;x<E.g.length;x++){var I=this.i(T)>>>16,k=this.i(T)&65535,j=E.i(x)>>>16,V=E.i(x)&65535;N[2*T+2*x]+=k*V,b(N,2*T+2*x),N[2*T+2*x+1]+=I*V,b(N,2*T+2*x+1),N[2*T+2*x+1]+=k*j,b(N,2*T+2*x+1),N[2*T+2*x+2]+=I*j,b(N,2*T+2*x+2)}for(T=0;T<w;T++)N[T]=N[2*T+1]<<16|N[2*T];for(T=w;T<2*w;T++)N[T]=0;return new o(N,0)};function b(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function S(E,w){this.g=E,this.h=w}function v(E,w){if(_(w))throw Error("division by zero");if(_(E))return new S(d,d);if(g(E))return w=v(y(E),w),new S(y(w.g),y(w.h));if(g(w))return w=v(E,y(w)),new S(y(w.g),w.h);if(30<E.g.length){if(g(E)||g(w))throw Error("slowDivide_ only works with positive integers.");for(var N=f,T=w;0>=T.l(E);)N=O(N),T=O(T);var x=R(N,1),I=R(T,1);for(T=R(T,2),N=R(N,2);!_(T);){var k=I.add(T);0>=k.l(E)&&(x=x.add(N),I=k),T=R(T,1),N=R(N,1)}return w=m(E,x.j(w)),new S(x,w)}for(x=d;0<=E.l(w);){for(N=Math.max(1,Math.floor(E.m()/w.m())),T=Math.ceil(Math.log(N)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),I=c(N),k=I.j(w);g(k)||0<k.l(E);)N-=T,I=c(N),k=I.j(w);_(I)&&(I=f),x=x.add(I),E=m(E,k)}return new S(x,E)}r.A=function(E){return v(this,E).h},r.and=function(E){for(var w=Math.max(this.g.length,E.g.length),N=[],T=0;T<w;T++)N[T]=this.i(T)&E.i(T);return new o(N,this.h&E.h)},r.or=function(E){for(var w=Math.max(this.g.length,E.g.length),N=[],T=0;T<w;T++)N[T]=this.i(T)|E.i(T);return new o(N,this.h|E.h)},r.xor=function(E){for(var w=Math.max(this.g.length,E.g.length),N=[],T=0;T<w;T++)N[T]=this.i(T)^E.i(T);return new o(N,this.h^E.h)};function O(E){for(var w=E.g.length+1,N=[],T=0;T<w;T++)N[T]=E.i(T)<<1|E.i(T-1)>>>31;return new o(N,E.h)}function R(E,w){var N=w>>5;w%=32;for(var T=E.g.length-N,x=[],I=0;I<T;I++)x[I]=0<w?E.i(I+N)>>>w|E.i(I+N+1)<<32-w:E.i(I+N);return new o(x,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,_f=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,bn=o}).apply(typeof ic<"u"?ic:typeof self<"u"?self:typeof window<"u"?window:{});var rs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bf,oi,wf,vs,ga,Ef,xf,Tf;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,A,C){return u==Array.prototype||u==Object.prototype||(u[A]=C.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof rs=="object"&&rs];for(var A=0;A<u.length;++A){var C=u[A];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=t(this);function i(u,A){if(A)e:{var C=n;u=u.split(".");for(var D=0;D<u.length-1;D++){var Q=u[D];if(!(Q in C))break e;C=C[Q]}u=u[u.length-1],D=C[u],A=A(D),A!=D&&A!=null&&e(C,u,{configurable:!0,writable:!0,value:A})}}function s(u,A){u instanceof String&&(u+="");var C=0,D=!1,Q={next:function(){if(!D&&C<u.length){var X=C++;return{value:A(X,u[X]),done:!1}}return D=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}i("Array.prototype.values",function(u){return u||function(){return s(this,function(A,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var A=typeof u;return A=A!="object"?A:u?Array.isArray(u)?"array":A:"null",A=="array"||A=="object"&&typeof u.length=="number"}function c(u){var A=typeof u;return A=="object"&&u!=null||A=="function"}function h(u,A,C){return u.call.apply(u.bind,arguments)}function d(u,A,C){if(!u)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,D),u.apply(A,Q)}}return function(){return u.apply(A,arguments)}}function f(u,A,C){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function p(u,A){var C=Array.prototype.slice.call(arguments,1);return function(){var D=C.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function _(u,A){function C(){}C.prototype=A.prototype,u.aa=A.prototype,u.prototype=new C,u.prototype.constructor=u,u.Qb=function(D,Q,X){for(var ae=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)ae[Fe-2]=arguments[Fe];return A.prototype[Q].apply(D,ae)}}function g(u){const A=u.length;if(0<A){const C=Array(A);for(let D=0;D<A;D++)C[D]=u[D];return C}return[]}function y(u,A){for(let C=1;C<arguments.length;C++){const D=arguments[C];if(l(D)){const Q=u.length||0,X=D.length||0;u.length=Q+X;for(let ae=0;ae<X;ae++)u[Q+ae]=D[ae]}else u.push(D)}}class m{constructor(A,C){this.i=A,this.j=C,this.h=0,this.g=null}get(){let A;return 0<this.h?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function b(u){return/^[\s\xa0]*$/.test(u)}function S(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function v(u){return v[" "](u),u}v[" "]=function(){};var O=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function R(u,A,C){for(const D in u)A.call(C,u[D],D,u)}function E(u,A){for(const C in u)A.call(void 0,u[C],C,u)}function w(u){const A={};for(const C in u)A[C]=u[C];return A}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(u,A){let C,D;for(let Q=1;Q<arguments.length;Q++){D=arguments[Q];for(C in D)u[C]=D[C];for(let X=0;X<N.length;X++)C=N[X],Object.prototype.hasOwnProperty.call(D,C)&&(u[C]=D[C])}}function x(u){var A=1;u=u.split(":");const C=[];for(;0<A&&u.length;)C.push(u.shift()),A--;return u.length&&C.push(u.join(":")),C}function I(u){a.setTimeout(()=>{throw u},0)}function k(){var u=K;let A=null;return u.g&&(A=u.g,u.g=u.g.next,u.g||(u.h=null),A.next=null),A}class j{constructor(){this.h=this.g=null}add(A,C){const D=V.get();D.set(A,C),this.h?this.h.next=D:this.g=D,this.h=D}}var V=new m(()=>new z,u=>u.reset());class z{constructor(){this.next=this.g=this.h=null}set(A,C){this.h=A,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let H,te=!1,K=new j,q=()=>{const u=a.Promise.resolve(void 0);H=()=>{u.then(L)}};var L=()=>{for(var u;u=k();){try{u.h.call(u.g)}catch(C){I(C)}var A=V;A.j(u),100>A.h&&(A.h++,u.next=A.g,A.g=u)}te=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(u,A){this.type=u,this.g=this.target=A,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,A=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const C=()=>{};a.addEventListener("test",C,A),a.removeEventListener("test",C,A)}catch{}return u}();function U(u,A){if(F.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var C=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=A,A=u.relatedTarget){if(O){e:{try{v(A.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(A=null)}}else C=="mouseover"?A=u.fromElement:C=="mouseout"&&(A=u.toElement);this.relatedTarget=A,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:M[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&U.aa.h.call(this)}}_(U,F);var M={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),G=0;function J(u,A,C,D,Q){this.listener=u,this.proxy=null,this.src=A,this.type=C,this.capture=!!D,this.ha=Q,this.key=++G,this.da=this.fa=!1}function re(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ue(u){this.src=u,this.g={},this.h=0}ue.prototype.add=function(u,A,C,D,Q){var X=u.toString();u=this.g[X],u||(u=this.g[X]=[],this.h++);var ae=ye(u,A,D,Q);return-1<ae?(A=u[ae],C||(A.fa=!1)):(A=new J(A,this.src,X,!!D,Q),A.fa=C,u.push(A)),A};function me(u,A){var C=A.type;if(C in u.g){var D=u.g[C],Q=Array.prototype.indexOf.call(D,A,void 0),X;(X=0<=Q)&&Array.prototype.splice.call(D,Q,1),X&&(re(A),u.g[C].length==0&&(delete u.g[C],u.h--))}}function ye(u,A,C,D){for(var Q=0;Q<u.length;++Q){var X=u[Q];if(!X.da&&X.listener==A&&X.capture==!!C&&X.ha==D)return Q}return-1}var Se="closure_lm_"+(1e6*Math.random()|0),Le={};function lt(u,A,C,D,Q){if(Array.isArray(A)){for(var X=0;X<A.length;X++)lt(u,A[X],C,D,Q);return null}return C=ke(C),u&&u[B]?u.K(A,C,c(D)?!!D.capture:!!D,Q):Ye(u,A,C,!1,D,Q)}function Ye(u,A,C,D,Q,X){if(!A)throw Error("Invalid event type");var ae=c(Q)?!!Q.capture:!!Q,Fe=we(u);if(Fe||(u[Se]=Fe=new ue(u)),C=Fe.add(A,C,D,ae,X),C.proxy)return C;if(D=Z(),C.proxy=D,D.src=u,D.listener=C,u.addEventListener)W||(Q=ae),Q===void 0&&(Q=!1),u.addEventListener(A.toString(),D,Q);else if(u.attachEvent)u.attachEvent(ce(A.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Z(){function u(C){return A.call(u.src,u.listener,C)}const A=se;return u}function ee(u,A,C,D,Q){if(Array.isArray(A))for(var X=0;X<A.length;X++)ee(u,A[X],C,D,Q);else D=c(D)?!!D.capture:!!D,C=ke(C),u&&u[B]?(u=u.i,A=String(A).toString(),A in u.g&&(X=u.g[A],C=ye(X,C,D,Q),-1<C&&(re(X[C]),Array.prototype.splice.call(X,C,1),X.length==0&&(delete u.g[A],u.h--)))):u&&(u=we(u))&&(A=u.g[A.toString()],u=-1,A&&(u=ye(A,C,D,Q)),(C=-1<u?A[u]:null)&&le(C))}function le(u){if(typeof u!="number"&&u&&!u.da){var A=u.src;if(A&&A[B])me(A.i,u);else{var C=u.type,D=u.proxy;A.removeEventListener?A.removeEventListener(C,D,u.capture):A.detachEvent?A.detachEvent(ce(C),D):A.addListener&&A.removeListener&&A.removeListener(D),(C=we(A))?(me(C,u),C.h==0&&(C.src=null,A[Se]=null)):re(u)}}}function ce(u){return u in Le?Le[u]:Le[u]="on"+u}function se(u,A){if(u.da)u=!0;else{A=new U(A,this);var C=u.listener,D=u.ha||u.src;u.fa&&le(u),u=C.call(D,A)}return u}function we(u){return u=u[Se],u instanceof ue?u:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function ke(u){return typeof u=="function"?u:(u[Ee]||(u[Ee]=function(A){return u.handleEvent(A)}),u[Ee])}function Ve(){$.call(this),this.i=new ue(this),this.M=this,this.F=null}_(Ve,$),Ve.prototype[B]=!0,Ve.prototype.removeEventListener=function(u,A,C,D){ee(this,u,A,C,D)};function Ue(u,A){var C,D=u.F;if(D)for(C=[];D;D=D.F)C.push(D);if(u=u.M,D=A.type||A,typeof A=="string")A=new F(A,u);else if(A instanceof F)A.target=A.target||u;else{var Q=A;A=new F(D,u),T(A,Q)}if(Q=!0,C)for(var X=C.length-1;0<=X;X--){var ae=A.g=C[X];Q=$e(ae,D,!0,A)&&Q}if(ae=A.g=u,Q=$e(ae,D,!0,A)&&Q,Q=$e(ae,D,!1,A)&&Q,C)for(X=0;X<C.length;X++)ae=A.g=C[X],Q=$e(ae,D,!1,A)&&Q}Ve.prototype.N=function(){if(Ve.aa.N.call(this),this.i){var u=this.i,A;for(A in u.g){for(var C=u.g[A],D=0;D<C.length;D++)re(C[D]);delete u.g[A],u.h--}}this.F=null},Ve.prototype.K=function(u,A,C,D){return this.i.add(String(u),A,!1,C,D)},Ve.prototype.L=function(u,A,C,D){return this.i.add(String(u),A,!0,C,D)};function $e(u,A,C,D){if(A=u.i.g[String(A)],!A)return!0;A=A.concat();for(var Q=!0,X=0;X<A.length;++X){var ae=A[X];if(ae&&!ae.da&&ae.capture==C){var Fe=ae.listener,ut=ae.ha||ae.src;ae.fa&&me(u.i,ae),Q=Fe.call(ut,D)!==!1&&Q}}return Q&&!D.defaultPrevented}function qi(u,A,C){if(typeof u=="function")C&&(u=f(u,C));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(A)?-1:a.setTimeout(u,A||0)}function Ge(u){u.g=qi(()=>{u.g=null,u.i&&(u.i=!1,Ge(u))},u.l);const A=u.h;u.h=null,u.m.apply(null,A)}class qt extends ${constructor(A,C){super(),this.m=A,this.l=C,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:Ge(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ur(u){$.call(this),this.h=u,this.g={}}_(Ur,$);var uu=[];function cu(u){R(u.g,function(A,C){this.g.hasOwnProperty(C)&&le(A)},u),u.g={}}Ur.prototype.N=function(){Ur.aa.N.call(this),cu(this)},Ur.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Io=a.JSON.stringify,Sm=a.JSON.parse,Im=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function No(){}No.prototype.h=null;function hu(u){return u.h||(u.h=u.i())}function fu(){}var Br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Oo(){F.call(this,"d")}_(Oo,F);function Po(){F.call(this,"c")}_(Po,F);var jn={},du=null;function Ui(){return du=du||new Ve}jn.La="serverreachability";function pu(u){F.call(this,jn.La,u)}_(pu,F);function zr(u){const A=Ui();Ue(A,new pu(A))}jn.STAT_EVENT="statevent";function mu(u,A){F.call(this,jn.STAT_EVENT,u),this.stat=A}_(mu,F);function bt(u){const A=Ui();Ue(A,new mu(A,u))}jn.Ma="timingevent";function gu(u,A){F.call(this,jn.Ma,u),this.size=A}_(gu,F);function Hr(u,A){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},A)}function Kr(){this.g=!0}Kr.prototype.xa=function(){this.g=!1};function Nm(u,A,C,D,Q,X){u.info(function(){if(u.g)if(X)for(var ae="",Fe=X.split("&"),ut=0;ut<Fe.length;ut++){var De=Fe[ut].split("=");if(1<De.length){var dt=De[0];De=De[1];var pt=dt.split("_");ae=2<=pt.length&&pt[1]=="type"?ae+(dt+"="+De+"&"):ae+(dt+"=redacted&")}}else ae=null;else ae=X;return"XMLHTTP REQ ("+D+") [attempt "+Q+"]: "+A+`
`+C+`
`+ae})}function Om(u,A,C,D,Q,X,ae){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Q+"]: "+A+`
`+C+`
`+X+" "+ae})}function Qn(u,A,C,D){u.info(function(){return"XMLHTTP TEXT ("+A+"): "+Cm(u,C)+(D?" "+D:"")})}function Pm(u,A){u.info(function(){return"TIMEOUT: "+A})}Kr.prototype.info=function(){};function Cm(u,A){if(!u.g)return A;if(!A)return null;try{var C=JSON.parse(A);if(C){for(u=0;u<C.length;u++)if(Array.isArray(C[u])){var D=C[u];if(!(2>D.length)){var Q=D[1];if(Array.isArray(Q)&&!(1>Q.length)){var X=Q[0];if(X!="noop"&&X!="stop"&&X!="close")for(var ae=1;ae<Q.length;ae++)Q[ae]=""}}}}return Io(C)}catch{return A}}var Bi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Co;function zi(){}_(zi,No),zi.prototype.g=function(){return new XMLHttpRequest},zi.prototype.i=function(){return{}},Co=new zi;function hn(u,A,C,D){this.j=u,this.i=A,this.l=C,this.R=D||1,this.U=new Ur(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vu}function vu(){this.i=null,this.g="",this.h=!1}var _u={},Ro={};function jo(u,A,C){u.L=1,u.v=Wi(Yt(A)),u.m=C,u.P=!0,bu(u,null)}function bu(u,A){u.F=Date.now(),Hi(u),u.A=Yt(u.v);var C=u.A,D=u.R;Array.isArray(D)||(D=[String(D)]),ju(C.i,"t",D),u.C=0,C=u.j.J,u.h=new vu,u.g=Xu(u.j,C?A:null,!u.m),0<u.O&&(u.M=new qt(f(u.Y,u,u.g),u.O)),A=u.U,C=u.g,D=u.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(uu[0]=Q.toString()),Q=uu);for(var X=0;X<Q.length;X++){var ae=lt(C,Q[X],D||A.handleEvent,!1,A.h||A);if(!ae)break;A.g[ae.key]=ae}A=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),A["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,A)):(u.u="GET",u.g.ea(u.A,u.u,null,A)),zr(),Nm(u.i,u.u,u.A,u.l,u.R,u.m)}hn.prototype.ca=function(u){u=u.target;const A=this.M;A&&Jt(u)==3?A.j():this.Y(u)},hn.prototype.Y=function(u){try{if(u==this.g)e:{const pt=Jt(this.g);var A=this.g.Ba();const Xn=this.g.Z();if(!(3>pt)&&(pt!=3||this.g&&(this.h.h||this.g.oa()||qu(this.g)))){this.J||pt!=4||A==7||(A==8||0>=Xn?zr(3):zr(2)),Lo(this);var C=this.g.Z();this.X=C;t:if(wu(this)){var D=qu(this.g);u="";var Q=D.length,X=Jt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ln(this),Gr(this);var ae="";break t}this.h.i=new a.TextDecoder}for(A=0;A<Q;A++)this.h.h=!0,u+=this.h.i.decode(D[A],{stream:!(X&&A==Q-1)});D.length=0,this.h.g+=u,this.C=0,ae=this.h.g}else ae=this.g.oa();if(this.o=C==200,Om(this.i,this.u,this.A,this.l,this.R,pt,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,ut=this.g;if((Fe=ut.g?ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Fe)){var De=Fe;break t}}De=null}if(C=De)Qn(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Do(this,C);else{this.o=!1,this.s=3,bt(12),Ln(this),Gr(this);break e}}if(this.P){C=!0;let Lt;for(;!this.J&&this.C<ae.length;)if(Lt=Rm(this,ae),Lt==Ro){pt==4&&(this.s=4,bt(14),C=!1),Qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==_u){this.s=4,bt(15),Qn(this.i,this.l,ae,"[Invalid Chunk]"),C=!1;break}else Qn(this.i,this.l,Lt,null),Do(this,Lt);if(wu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||ae.length!=0||this.h.h||(this.s=1,bt(16),C=!1),this.o=this.o&&C,!C)Qn(this.i,this.l,ae,"[Invalid Chunked Response]"),Ln(this),Gr(this);else if(0<ae.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Uo(dt),dt.M=!0,bt(11))}}else Qn(this.i,this.l,ae,null),Do(this,ae);pt==4&&Ln(this),this.o&&!this.J&&(pt==4?Wu(this.j,this):(this.o=!1,Hi(this)))}else Ym(this.g),C==400&&0<ae.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Ln(this),Gr(this)}}}catch{}finally{}};function wu(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Rm(u,A){var C=u.C,D=A.indexOf(`
`,C);return D==-1?Ro:(C=Number(A.substring(C,D)),isNaN(C)?_u:(D+=1,D+C>A.length?Ro:(A=A.slice(D,D+C),u.C=D+C,A)))}hn.prototype.cancel=function(){this.J=!0,Ln(this)};function Hi(u){u.S=Date.now()+u.I,Eu(u,u.I)}function Eu(u,A){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Hr(f(u.ba,u),A)}function Lo(u){u.B&&(a.clearTimeout(u.B),u.B=null)}hn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Pm(this.i,this.A),this.L!=2&&(zr(),bt(17)),Ln(this),this.s=2,Gr(this)):Eu(this,this.S-u)};function Gr(u){u.j.G==0||u.J||Wu(u.j,u)}function Ln(u){Lo(u);var A=u.M;A&&typeof A.ma=="function"&&A.ma(),u.M=null,cu(u.U),u.g&&(A=u.g,u.g=null,A.abort(),A.ma())}function Do(u,A){try{var C=u.j;if(C.G!=0&&(C.g==u||Mo(C.h,u))){if(!u.K&&Mo(C.h,u)&&C.G==3){try{var D=C.Da.g.parse(A)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Q=D;if(Q[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<u.F)es(C),Xi(C);else break e;qo(C),bt(18)}}else C.za=Q[1],0<C.za-C.T&&37500>Q[2]&&C.F&&C.v==0&&!C.C&&(C.C=Hr(f(C.Za,C),6e3));if(1>=Au(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Mn(C,11)}else if((u.K||C.g==u)&&es(C),!b(A))for(Q=C.Da.g.parse(A),A=0;A<Q.length;A++){let De=Q[A];if(C.T=De[0],De=De[1],C.G==2)if(De[0]=="c"){C.K=De[1],C.ia=De[2];const dt=De[3];dt!=null&&(C.la=dt,C.j.info("VER="+C.la));const pt=De[4];pt!=null&&(C.Aa=pt,C.j.info("SVER="+C.Aa));const Xn=De[5];Xn!=null&&typeof Xn=="number"&&0<Xn&&(D=1.5*Xn,C.L=D,C.j.info("backChannelRequestTimeoutMs_="+D)),D=C;const Lt=u.g;if(Lt){const ns=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ns){var X=D.h;X.g||ns.indexOf("spdy")==-1&&ns.indexOf("quic")==-1&&ns.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Vo(X,X.h),X.h=null))}if(D.D){const Bo=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;Bo&&(D.ya=Bo,Be(D.I,D.D,Bo))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-u.F,C.j.info("Handshake RTT: "+C.R+"ms")),D=C;var ae=u;if(D.qa=Ju(D,D.J?D.ia:null,D.W),ae.K){ku(D.h,ae);var Fe=ae,ut=D.L;ut&&(Fe.I=ut),Fe.B&&(Lo(Fe),Hi(Fe)),D.g=ae}else Ku(D);0<C.i.length&&Zi(C)}else De[0]!="stop"&&De[0]!="close"||Mn(C,7);else C.G==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?Mn(C,7):Fo(C):De[0]!="noop"&&C.l&&C.l.ta(De),C.v=0)}}zr(4)}catch{}}var jm=class{constructor(u,A){this.g=u,this.map=A}};function xu(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tu(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Au(u){return u.h?1:u.g?u.g.size:0}function Mo(u,A){return u.h?u.h==A:u.g?u.g.has(A):!1}function Vo(u,A){u.g?u.g.add(A):u.h=A}function ku(u,A){u.h&&u.h==A?u.h=null:u.g&&u.g.has(A)&&u.g.delete(A)}xu.prototype.cancel=function(){if(this.i=Su(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Su(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let A=u.i;for(const C of u.g.values())A=A.concat(C.D);return A}return g(u.i)}function Lm(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var A=[],C=u.length,D=0;D<C;D++)A.push(u[D]);return A}A=[],C=0;for(D in u)A[C++]=u[D];return A}function Dm(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var A=[];u=u.length;for(var C=0;C<u;C++)A.push(C);return A}A=[],C=0;for(const D in u)A[C++]=D;return A}}}function Iu(u,A){if(u.forEach&&typeof u.forEach=="function")u.forEach(A,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,A,void 0);else for(var C=Dm(u),D=Lm(u),Q=D.length,X=0;X<Q;X++)A.call(void 0,D[X],C&&C[X],u)}var Nu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Mm(u,A){if(u){u=u.split("&");for(var C=0;C<u.length;C++){var D=u[C].indexOf("="),Q=null;if(0<=D){var X=u[C].substring(0,D);Q=u[C].substring(D+1)}else X=u[C];A(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function Dn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Dn){this.h=u.h,Ki(this,u.j),this.o=u.o,this.g=u.g,Gi(this,u.s),this.l=u.l;var A=u.i,C=new Yr;C.i=A.i,A.g&&(C.g=new Map(A.g),C.h=A.h),Ou(this,C),this.m=u.m}else u&&(A=String(u).match(Nu))?(this.h=!1,Ki(this,A[1]||"",!0),this.o=Wr(A[2]||""),this.g=Wr(A[3]||"",!0),Gi(this,A[4]),this.l=Wr(A[5]||"",!0),Ou(this,A[6]||"",!0),this.m=Wr(A[7]||"")):(this.h=!1,this.i=new Yr(null,this.h))}Dn.prototype.toString=function(){var u=[],A=this.j;A&&u.push(Qr(A,Pu,!0),":");var C=this.g;return(C||A=="file")&&(u.push("//"),(A=this.o)&&u.push(Qr(A,Pu,!0),"@"),u.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&u.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&u.push("/"),u.push(Qr(C,C.charAt(0)=="/"?Fm:$m,!0))),(C=this.i.toString())&&u.push("?",C),(C=this.m)&&u.push("#",Qr(C,Um)),u.join("")};function Yt(u){return new Dn(u)}function Ki(u,A,C){u.j=C?Wr(A,!0):A,u.j&&(u.j=u.j.replace(/:$/,""))}function Gi(u,A){if(A){if(A=Number(A),isNaN(A)||0>A)throw Error("Bad port number "+A);u.s=A}else u.s=null}function Ou(u,A,C){A instanceof Yr?(u.i=A,Bm(u.i,u.h)):(C||(A=Qr(A,qm)),u.i=new Yr(A,u.h))}function Be(u,A,C){u.i.set(A,C)}function Wi(u){return Be(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Wr(u,A){return u?A?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Qr(u,A,C){return typeof u=="string"?(u=encodeURI(u).replace(A,Vm),C&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Vm(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Pu=/[#\/\?@]/g,$m=/[#\?:]/g,Fm=/[#\?]/g,qm=/[#\?@]/g,Um=/#/g;function Yr(u,A){this.h=this.g=null,this.i=u||null,this.j=!!A}function fn(u){u.g||(u.g=new Map,u.h=0,u.i&&Mm(u.i,function(A,C){u.add(decodeURIComponent(A.replace(/\+/g," ")),C)}))}r=Yr.prototype,r.add=function(u,A){fn(this),this.i=null,u=Yn(this,u);var C=this.g.get(u);return C||this.g.set(u,C=[]),C.push(A),this.h+=1,this};function Cu(u,A){fn(u),A=Yn(u,A),u.g.has(A)&&(u.i=null,u.h-=u.g.get(A).length,u.g.delete(A))}function Ru(u,A){return fn(u),A=Yn(u,A),u.g.has(A)}r.forEach=function(u,A){fn(this),this.g.forEach(function(C,D){C.forEach(function(Q){u.call(A,Q,D,this)},this)},this)},r.na=function(){fn(this);const u=Array.from(this.g.values()),A=Array.from(this.g.keys()),C=[];for(let D=0;D<A.length;D++){const Q=u[D];for(let X=0;X<Q.length;X++)C.push(A[D])}return C},r.V=function(u){fn(this);let A=[];if(typeof u=="string")Ru(this,u)&&(A=A.concat(this.g.get(Yn(this,u))));else{u=Array.from(this.g.values());for(let C=0;C<u.length;C++)A=A.concat(u[C])}return A},r.set=function(u,A){return fn(this),this.i=null,u=Yn(this,u),Ru(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[A]),this.h+=1,this},r.get=function(u,A){return u?(u=this.V(u),0<u.length?String(u[0]):A):A};function ju(u,A,C){Cu(u,A),0<C.length&&(u.i=null,u.g.set(Yn(u,A),g(C)),u.h+=C.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],A=Array.from(this.g.keys());for(var C=0;C<A.length;C++){var D=A[C];const X=encodeURIComponent(String(D)),ae=this.V(D);for(D=0;D<ae.length;D++){var Q=X;ae[D]!==""&&(Q+="="+encodeURIComponent(String(ae[D]))),u.push(Q)}}return this.i=u.join("&")};function Yn(u,A){return A=String(A),u.j&&(A=A.toLowerCase()),A}function Bm(u,A){A&&!u.j&&(fn(u),u.i=null,u.g.forEach(function(C,D){var Q=D.toLowerCase();D!=Q&&(Cu(this,D),ju(this,Q,C))},u)),u.j=A}function zm(u,A){const C=new Kr;if(a.Image){const D=new Image;D.onload=p(dn,C,"TestLoadImage: loaded",!0,A,D),D.onerror=p(dn,C,"TestLoadImage: error",!1,A,D),D.onabort=p(dn,C,"TestLoadImage: abort",!1,A,D),D.ontimeout=p(dn,C,"TestLoadImage: timeout",!1,A,D),a.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else A(!1)}function Hm(u,A){const C=new Kr,D=new AbortController,Q=setTimeout(()=>{D.abort(),dn(C,"TestPingServer: timeout",!1,A)},1e4);fetch(u,{signal:D.signal}).then(X=>{clearTimeout(Q),X.ok?dn(C,"TestPingServer: ok",!0,A):dn(C,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(Q),dn(C,"TestPingServer: error",!1,A)})}function dn(u,A,C,D,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),D(C)}catch{}}function Km(){this.g=new Im}function Gm(u,A,C){const D=C||"";try{Iu(u,function(Q,X){let ae=Q;c(Q)&&(ae=Io(Q)),A.push(D+X+"="+encodeURIComponent(ae))})}catch(Q){throw A.push(D+"type="+encodeURIComponent("_badmap")),Q}}function Qi(u){this.l=u.Ub||null,this.j=u.eb||!1}_(Qi,No),Qi.prototype.g=function(){return new Yi(this.l,this.j)},Qi.prototype.i=function(u){return function(){return u}}({});function Yi(u,A){Ve.call(this),this.D=u,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Yi,Ve),r=Yi.prototype,r.open=function(u,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=A,this.readyState=1,Xr(this)},r.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const A={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(A.body=u),(this.D||a).fetch(new Request(this.A,A)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=0},r.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Xr(this)),this.g&&(this.readyState=3,Xr(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lu(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lu(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}r.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var A=u.value?u.value:new Uint8Array(0);(A=this.v.decode(A,{stream:!u.done}))&&(this.response=this.responseText+=A)}u.done?Jr(this):Xr(this),this.readyState==3&&Lu(this)}},r.Ra=function(u){this.g&&(this.response=this.responseText=u,Jr(this))},r.Qa=function(u){this.g&&(this.response=u,Jr(this))},r.ga=function(){this.g&&Jr(this)};function Jr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Xr(u)}r.setRequestHeader=function(u,A){this.u.append(u,A)},r.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],A=this.h.entries();for(var C=A.next();!C.done;)C=C.value,u.push(C[0]+": "+C[1]),C=A.next();return u.join(`\r
`)};function Xr(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Du(u){let A="";return R(u,function(C,D){A+=D,A+=":",A+=C,A+=`\r
`}),A}function $o(u,A,C){e:{for(D in C){var D=!1;break e}D=!0}D||(C=Du(C),typeof u=="string"?C!=null&&encodeURIComponent(String(C)):Be(u,A,C))}function Qe(u){Ve.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Qe,Ve);var Wm=/^https?$/i,Qm=["POST","PUT"];r=Qe.prototype,r.Ha=function(u){this.J=u},r.ea=function(u,A,C,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);A=A?A.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Co.g(),this.v=this.o?hu(this.o):hu(Co),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(A,String(u),!0),this.B=!1}catch(X){Mu(this,X);return}if(u=C||"",C=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Q in D)C.set(Q,D[Q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const X of D.keys())C.set(X,D.get(X));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(C.keys()).find(X=>X.toLowerCase()=="content-type"),Q=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Qm,A,void 0))||D||Q||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ae]of C)this.g.setRequestHeader(X,ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fu(this),this.u=!0,this.g.send(u),this.u=!1}catch(X){Mu(this,X)}};function Mu(u,A){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=A,u.m=5,Vu(u),Ji(u)}function Vu(u){u.A||(u.A=!0,Ue(u,"complete"),Ue(u,"error"))}r.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ue(this,"complete"),Ue(this,"abort"),Ji(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ji(this,!0)),Qe.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?$u(this):this.bb())},r.bb=function(){$u(this)};function $u(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Jt(u)!=4||u.Z()!=2)){if(u.u&&Jt(u)==4)qi(u.Ea,0,u);else if(Ue(u,"readystatechange"),Jt(u)==4){u.h=!1;try{const ae=u.Z();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var C;if(!(C=A)){var D;if(D=ae===0){var Q=String(u.D).match(Nu)[1]||null;!Q&&a.self&&a.self.location&&(Q=a.self.location.protocol.slice(0,-1)),D=!Wm.test(Q?Q.toLowerCase():"")}C=D}if(C)Ue(u,"complete"),Ue(u,"success");else{u.m=6;try{var X=2<Jt(u)?u.g.statusText:""}catch{X=""}u.l=X+" ["+u.Z()+"]",Vu(u)}}finally{Ji(u)}}}}function Ji(u,A){if(u.g){Fu(u);const C=u.g,D=u.v[0]?()=>{}:null;u.g=null,u.v=null,A||Ue(u,"ready");try{C.onreadystatechange=D}catch{}}}function Fu(u){u.I&&(a.clearTimeout(u.I),u.I=null)}r.isActive=function(){return!!this.g};function Jt(u){return u.g?u.g.readyState:0}r.Z=function(){try{return 2<Jt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(u){if(this.g){var A=this.g.responseText;return u&&A.indexOf(u)==0&&(A=A.substring(u.length)),Sm(A)}};function qu(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ym(u){const A={};u=(u.g&&2<=Jt(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(b(u[D]))continue;var C=x(u[D]);const Q=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const X=A[Q]||[];A[Q]=X,X.push(C)}E(A,function(D){return D.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(u,A,C){return C&&C.internalChannelParams&&C.internalChannelParams[u]||A}function Uu(u){this.Aa=0,this.i=[],this.j=new Kr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zr("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zr("baseRetryDelayMs",5e3,u),this.cb=Zr("retryDelaySeedMs",1e4,u),this.Wa=Zr("forwardChannelMaxRetries",2,u),this.wa=Zr("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new xu(u&&u.concurrentRequestLimit),this.Da=new Km,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Uu.prototype,r.la=8,r.G=1,r.connect=function(u,A,C,D){bt(0),this.W=u,this.H=A||{},C&&D!==void 0&&(this.H.OSID=C,this.H.OAID=D),this.F=this.X,this.I=Ju(this,null,this.W),Zi(this)};function Fo(u){if(Bu(u),u.G==3){var A=u.U++,C=Yt(u.I);if(Be(C,"SID",u.K),Be(C,"RID",A),Be(C,"TYPE","terminate"),ei(u,C),A=new hn(u,u.j,A),A.L=2,A.v=Wi(Yt(C)),C=!1,a.navigator&&a.navigator.sendBeacon)try{C=a.navigator.sendBeacon(A.v.toString(),"")}catch{}!C&&a.Image&&(new Image().src=A.v,C=!0),C||(A.g=Xu(A.j,null),A.g.ea(A.v)),A.F=Date.now(),Hi(A)}Yu(u)}function Xi(u){u.g&&(Uo(u),u.g.cancel(),u.g=null)}function Bu(u){Xi(u),u.u&&(a.clearTimeout(u.u),u.u=null),es(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Zi(u){if(!Tu(u.h)&&!u.s){u.s=!0;var A=u.Ga;H||q(),te||(H(),te=!0),K.add(A,u),u.B=0}}function Jm(u,A){return Au(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=A.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Hr(f(u.Ga,u,A),Qu(u,u.B)),u.B++,!0)}r.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Q=new hn(this,this.j,u);let X=this.o;if(this.S&&(X?(X=w(X),T(X,this.S)):X=this.S),this.m!==null||this.O||(Q.H=X,X=null),this.P)e:{for(var A=0,C=0;C<this.i.length;C++){t:{var D=this.i[C];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(A+=D,4096<A){A=C;break e}if(A===4096||C===this.i.length-1){A=C+1;break e}}A=1e3}else A=1e3;A=Hu(this,Q,A),C=Yt(this.I),Be(C,"RID",u),Be(C,"CVER",22),this.D&&Be(C,"X-HTTP-Session-Id",this.D),ei(this,C),X&&(this.O?A="headers="+encodeURIComponent(String(Du(X)))+"&"+A:this.m&&$o(C,this.m,X)),Vo(this.h,Q),this.Ua&&Be(C,"TYPE","init"),this.P?(Be(C,"$req",A),Be(C,"SID","null"),Q.T=!0,jo(Q,C,null)):jo(Q,C,A),this.G=2}}else this.G==3&&(u?zu(this,u):this.i.length==0||Tu(this.h)||zu(this))};function zu(u,A){var C;A?C=A.l:C=u.U++;const D=Yt(u.I);Be(D,"SID",u.K),Be(D,"RID",C),Be(D,"AID",u.T),ei(u,D),u.m&&u.o&&$o(D,u.m,u.o),C=new hn(u,u.j,C,u.B+1),u.m===null&&(C.H=u.o),A&&(u.i=A.D.concat(u.i)),A=Hu(u,C,1e3),C.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Vo(u.h,C),jo(C,D,A)}function ei(u,A){u.H&&R(u.H,function(C,D){Be(A,D,C)}),u.l&&Iu({},function(C,D){Be(A,D,C)})}function Hu(u,A,C){C=Math.min(u.i.length,C);var D=u.l?f(u.l.Na,u.l,u):null;e:{var Q=u.i;let X=-1;for(;;){const ae=["count="+C];X==-1?0<C?(X=Q[0].g,ae.push("ofs="+X)):X=0:ae.push("ofs="+X);let Fe=!0;for(let ut=0;ut<C;ut++){let De=Q[ut].g;const dt=Q[ut].map;if(De-=X,0>De)X=Math.max(0,Q[ut].g-100),Fe=!1;else try{Gm(dt,ae,"req"+De+"_")}catch{D&&D(dt)}}if(Fe){D=ae.join("&");break e}}}return u=u.i.splice(0,C),A.D=u,D}function Ku(u){if(!u.g&&!u.u){u.Y=1;var A=u.Fa;H||q(),te||(H(),te=!0),K.add(A,u),u.v=0}}function qo(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Hr(f(u.Fa,u),Qu(u,u.v)),u.v++,!0)}r.Fa=function(){if(this.u=null,Gu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Hr(f(this.ab,this),u)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),Xi(this),Gu(this))};function Uo(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Gu(u){u.g=new hn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var A=Yt(u.qa);Be(A,"RID","rpc"),Be(A,"SID",u.K),Be(A,"AID",u.T),Be(A,"CI",u.F?"0":"1"),!u.F&&u.ja&&Be(A,"TO",u.ja),Be(A,"TYPE","xmlhttp"),ei(u,A),u.m&&u.o&&$o(A,u.m,u.o),u.L&&(u.g.I=u.L);var C=u.g;u=u.ia,C.L=1,C.v=Wi(Yt(A)),C.m=null,C.P=!0,bu(C,u)}r.Za=function(){this.C!=null&&(this.C=null,Xi(this),qo(this),bt(19))};function es(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Wu(u,A){var C=null;if(u.g==A){es(u),Uo(u),u.g=null;var D=2}else if(Mo(u.h,A))C=A.D,ku(u.h,A),D=1;else return;if(u.G!=0){if(A.o)if(D==1){C=A.m?A.m.length:0,A=Date.now()-A.F;var Q=u.B;D=Ui(),Ue(D,new gu(D,C)),Zi(u)}else Ku(u);else if(Q=A.s,Q==3||Q==0&&0<A.X||!(D==1&&Jm(u,A)||D==2&&qo(u)))switch(C&&0<C.length&&(A=u.h,A.i=A.i.concat(C)),Q){case 1:Mn(u,5);break;case 4:Mn(u,10);break;case 3:Mn(u,6);break;default:Mn(u,2)}}}function Qu(u,A){let C=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(C*=2),C*A}function Mn(u,A){if(u.j.info("Error code "+A),A==2){var C=f(u.fb,u),D=u.Xa;const Q=!D;D=new Dn(D||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ki(D,"https"),Wi(D),Q?zm(D.toString(),C):Hm(D.toString(),C)}else bt(2);u.G=0,u.l&&u.l.sa(A),Yu(u),Bu(u)}r.fb=function(u){u?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Yu(u){if(u.G=0,u.ka=[],u.l){const A=Su(u.h);(A.length!=0||u.i.length!=0)&&(y(u.ka,A),y(u.ka,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.ra()}}function Ju(u,A,C){var D=C instanceof Dn?Yt(C):new Dn(C);if(D.g!="")A&&(D.g=A+"."+D.g),Gi(D,D.s);else{var Q=a.location;D=Q.protocol,A=A?A+"."+Q.hostname:Q.hostname,Q=+Q.port;var X=new Dn(null);D&&Ki(X,D),A&&(X.g=A),Q&&Gi(X,Q),C&&(X.l=C),D=X}return C=u.D,A=u.ya,C&&A&&Be(D,C,A),Be(D,"VER",u.la),ei(u,D),D}function Xu(u,A,C){if(A&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return A=u.Ca&&!u.pa?new Qe(new Qi({eb:C})):new Qe(u.pa),A.Ha(u.J),A}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}r=Zu.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function ts(){}ts.prototype.g=function(u,A){return new It(u,A)};function It(u,A){Ve.call(this),this.g=new Uu(A),this.l=u,this.h=A&&A.messageUrlParams||null,u=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(u?u["X-WebChannel-Content-Type"]=A.messageContentType:u={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.va&&(u?u["X-WebChannel-Client-Profile"]=A.va:u={"X-WebChannel-Client-Profile":A.va}),this.g.S=u,(u=A&&A.Sb)&&!b(u)&&(this.g.m=u),this.v=A&&A.supportsCrossDomainXhr||!1,this.u=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!b(A)&&(this.g.D=A,u=this.h,u!==null&&A in u&&(u=this.h,A in u&&delete u[A])),this.j=new Jn(this)}_(It,Ve),It.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},It.prototype.close=function(){Fo(this.g)},It.prototype.o=function(u){var A=this.g;if(typeof u=="string"){var C={};C.__data__=u,u=C}else this.u&&(C={},C.__data__=Io(u),u=C);A.i.push(new jm(A.Ya++,u)),A.G==3&&Zi(A)},It.prototype.N=function(){this.g.l=null,delete this.j,Fo(this.g),delete this.g,It.aa.N.call(this)};function ec(u){Oo.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var A=u.__sm__;if(A){e:{for(const C in A){u=C;break e}u=void 0}(this.i=u)&&(u=this.i,A=A!==null&&u in A?A[u]:void 0),this.data=A}else this.data=u}_(ec,Oo);function tc(){Po.call(this),this.status=1}_(tc,Po);function Jn(u){this.g=u}_(Jn,Zu),Jn.prototype.ua=function(){Ue(this.g,"a")},Jn.prototype.ta=function(u){Ue(this.g,new ec(u))},Jn.prototype.sa=function(u){Ue(this.g,new tc)},Jn.prototype.ra=function(){Ue(this.g,"b")},ts.prototype.createWebChannel=ts.prototype.g,It.prototype.send=It.prototype.o,It.prototype.open=It.prototype.m,It.prototype.close=It.prototype.close,Tf=function(){return new ts},xf=function(){return Ui()},Ef=jn,ga={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bi.NO_ERROR=0,Bi.TIMEOUT=8,Bi.HTTP_ERROR=6,vs=Bi,yu.COMPLETE="complete",wf=yu,fu.EventType=Br,Br.OPEN="a",Br.CLOSE="b",Br.ERROR="c",Br.MESSAGE="d",Ve.prototype.listen=Ve.prototype.K,oi=fu,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,bf=Qe}).apply(typeof rs<"u"?rs:typeof self<"u"?self:typeof window<"u"?window:{});const sc="@firebase/firestore",oc="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};gt.UNAUTHENTICATED=new gt(null),gt.GOOGLE_CREDENTIALS=new gt("google-credentials-uid"),gt.FIRST_PARTY=new gt("first-party-uid"),gt.MOCK_USER=new gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ar="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new rg("@firebase/firestore");function or(){return zn.logLevel}function fe(r,...e){if(zn.logLevel<=tn.DEBUG){const t=e.map(tl);zn.debug(`Firestore (${Ar}): ${r}`,...t)}}function on(r,...e){if(zn.logLevel<=tn.ERROR){const t=e.map(tl);zn.error(`Firestore (${Ar}): ${r}`,...t)}}function pr(r,...e){if(zn.logLevel<=tn.WARN){const t=e.map(tl);zn.warn(`Firestore (${Ar}): ${r}`,...t)}}function tl(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(r="Unexpected state"){const e=`FIRESTORE (${Ar}) INTERNAL ASSERTION FAILED: `+r;throw on(e),new Error(e)}function Me(r,e){r||ge()}function _e(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends og{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class kg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gt.UNAUTHENTICATED))}shutdown(){}}class Sg{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Ig{constructor(e){this.t=e,this.currentUser=gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Me(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new rn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new rn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new rn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Me(typeof n.accessToken=="string"),new Af(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new gt(e)}}class Ng{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=gt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Og{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Ng(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ac{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Pg{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,ag(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Me(this.o===void 0);const n=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new ac(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Me(typeof t.token=="string"),this.R=t.token,new ac(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cg(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Cg(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function Ie(r,e){return r<e?-1:r>e?1:0}function ya(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return Ie(n,i);{const s=kf(),o=Rg(s.encode(lc(r,t)),s.encode(lc(e,t)));return o!==0?o:Ie(n,i)}}t+=n>65535?2:1}return Ie(r.length,e.length)}function lc(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function Rg(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return Ie(r[t],e[t]);return Ie(r.length,e.length)}function mr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=-62135596800,cc=1e6;class rt{static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*cc);return new rt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<uc)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cc}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-uc;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new rt(0,0))}static max(){return new ve(new rt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc="__name__";class zt{constructor(e,t,n){t===void 0?t=0:t>e.length&&ge(),n===void 0?n=e.length-t:n>e.length-t&&ge(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return zt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zt?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=zt.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Ie(e.length,t.length)}static compareSegments(e,t){const n=zt.isNumericId(e),i=zt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?zt.extractNumericId(e).compare(zt.extractNumericId(t)):ya(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bn.fromString(e.substring(4,e.length-2))}}class He extends zt{construct(e,t,n){return new He(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new he(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new He(t)}static emptyPath(){return new He([])}}const jg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ht extends zt{construct(e,t,n){return new ht(e,t,n)}static isValidIdentifier(e){return jg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ht.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hc}static keyField(){return new ht([hc])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new he(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new he(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new he(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ht(t)}static emptyPath(){return new ht([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(He.fromString(e))}static fromName(e){return new pe(He.fromString(e).popFirst(5))}static empty(){return new pe(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return He.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new He(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=-1;function Lg(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(n===1e9?new rt(t+1,0):new rt(t,n));return new En(i,pe.empty(),e)}function Dg(r){return new En(r.readTime,r.key,_i)}class En{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new En(ve.min(),pe.empty(),_i)}static max(){return new En(ve.max(),pe.empty(),_i)}}function Mg(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(r.documentKey,e.documentKey),t!==0?t:Ie(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $g{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kr(r){if(r.code!==ne.FAILED_PRECONDITION||r.message!==Vg)throw r;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(t){return ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.reject(t)}static resolve(e){return new ie((t,n)=>{t(e)})}static reject(e){return new ie((t,n)=>{n(e)})}static waitFor(e){return new ie((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>n(l))}),o=!0,s===i&&t()})}static or(e){let t=ie.resolve(!1);for(const n of e)t=t.next(i=>i?ie.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ie((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===s&&n(o)},h=>i(h))}})}static doWhile(e,t){return new ie((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function Fg(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Sr(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Ws.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=-1;function Qs(r){return r==null}function Ts(r){return r===0&&1/r==-1/0}function qg(r){return typeof r=="number"&&Number.isInteger(r)&&!Ts(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If="";function Ug(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=fc(e)),e=Bg(r.get(t),e);return fc(e)}function Bg(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case If:t+="";break;default:t+=s}}return t}function fc(r){return r+If+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function In(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Nf(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,t){this.comparator=e,this.root=t||ct.EMPTY}insert(e,t){return new We(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new is(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new is(this.root,e,this.comparator,!1)}getReverseIterator(){return new is(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new is(this.root,e,this.comparator,!0)}}class is{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??ct.RED,this.left=i??ct.EMPTY,this.right=s??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new ct(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ct.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1;ct.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,t,n,i,s){return this}insert(e,t,n){return new ct(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pc(this.data.getIterator())}getIteratorFrom(e){return new pc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof it)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new it(this.comparator);return t.data=e,t}}class pc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.fields=e,e.sort(ht.comparator)}static empty(){return new Ot([])}unionWith(e){let t=new it(ht.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ot(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Of("Invalid base64 string: "+s):s}}(e);return new ft(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ft(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ft.EMPTY_BYTE_STRING=new ft("");const zg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xn(r){if(Me(!!r),typeof r=="string"){let e=0;const t=zg.exec(r);if(Me(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Je(r.seconds),nanos:Je(r.nanos)}}function Je(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Tn(r){return typeof r=="string"?ft.fromBase64String(r):ft.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="server_timestamp",Cf="__type__",Rf="__previous_value__",jf="__local_write_time__";function rl(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Cf])===null||t===void 0?void 0:t.stringValue)===Pf}function Ys(r){const e=r.mapValue.fields[Rf];return rl(e)?Ys(e):e}function bi(r){const e=xn(r.mapValue.fields[jf].timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,t,n,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const As="(default)";class wi{constructor(e,t){this.projectId=e,this.database=t||As}static empty(){return new wi("","")}get isDefaultDatabase(){return this.database===As}isEqual(e){return e instanceof wi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="__type__",Df="__max__",ss={mapValue:{fields:{__type__:{stringValue:Df}}}},Mf="__vector__",ks="value";function An(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?rl(r)?4:Gg(r)?9007199254740991:Kg(r)?10:11:ge()}function Wt(r,e){if(r===e)return!0;const t=An(r);if(t!==An(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return bi(r).isEqual(bi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=xn(i.timestampValue),a=xn(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Tn(i.bytesValue).isEqual(Tn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Je(i.geoPointValue.latitude)===Je(s.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Je(i.integerValue)===Je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Je(i.doubleValue),a=Je(s.doubleValue);return o===a?Ts(o)===Ts(a):isNaN(o)&&isNaN(a)}return!1}(r,e);case 9:return mr(r.arrayValue.values||[],e.arrayValue.values||[],Wt);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(dc(o)!==dc(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Wt(o[l],a[l])))return!1;return!0}(r,e);default:return ge()}}function Ei(r,e){return(r.values||[]).find(t=>Wt(t,e))!==void 0}function gr(r,e){if(r===e)return 0;const t=An(r),n=An(e);if(t!==n)return Ie(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ie(r.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Je(s.integerValue||s.doubleValue),l=Je(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(r,e);case 3:return mc(r.timestampValue,e.timestampValue);case 4:return mc(bi(r),bi(e));case 5:return ya(r.stringValue,e.stringValue);case 6:return function(s,o){const a=Tn(s),l=Tn(o);return a.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=Ie(a[c],l[c]);if(h!==0)return h}return Ie(a.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ie(Je(s.latitude),Je(o.latitude));return a!==0?a:Ie(Je(s.longitude),Je(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return gc(r.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,h;const d=s.fields||{},f=o.fields||{},p=(a=d[ks])===null||a===void 0?void 0:a.arrayValue,_=(l=f[ks])===null||l===void 0?void 0:l.arrayValue,g=Ie(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return g!==0?g:gc(p,_)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===ss.mapValue&&o===ss.mapValue)return 0;if(s===ss.mapValue)return 1;if(o===ss.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=ya(l[d],h[d]);if(f!==0)return f;const p=gr(a[l[d]],c[h[d]]);if(p!==0)return p}return Ie(l.length,h.length)}(r.mapValue,e.mapValue);default:throw ge()}}function mc(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ie(r,e);const t=xn(r),n=xn(e),i=Ie(t.seconds,n.seconds);return i!==0?i:Ie(t.nanos,n.nanos)}function gc(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=gr(t[i],n[i]);if(s)return s}return Ie(t.length,n.length)}function yr(r){return va(r)}function va(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=xn(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Tn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return pe.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=va(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${va(t.fields[o])}`;return i+"}"}(r.mapValue):ge()}function _s(r){switch(An(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ys(r);return e?16+_s(e):16;case 5:return 2*r.stringValue.length;case 6:return Tn(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+_s(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return In(n.fields,(s,o)=>{i+=s.length+_s(o)}),i}(r.mapValue);default:throw ge()}}function yc(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function _a(r){return!!r&&"integerValue"in r}function il(r){return!!r&&"arrayValue"in r}function vc(r){return!!r&&"nullValue"in r}function _c(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function bs(r){return!!r&&"mapValue"in r}function Kg(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Lf])===null||t===void 0?void 0:t.stringValue)===Mf}function hi(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return In(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=hi(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hi(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Gg(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Df}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.value=e}static empty(){return new St({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!bs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hi(t)}setAll(e){let t=ht.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=hi(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());bs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];bs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){In(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new St(hi(this.value))}}function Vf(r){const e=[];return In(r.fields,(t,n)=>{const i=new ht([t]);if(bs(n)){const s=Vf(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ot(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,ve.min(),ve.min(),ve.min(),St.empty(),0)}static newFoundDocument(e,t,n,i){return new yt(e,1,t,ve.min(),n,i,0)}static newNoDocument(e,t){return new yt(e,2,t,ve.min(),ve.min(),St.empty(),0)}static newUnknownDocument(e,t){return new yt(e,3,t,ve.min(),ve.min(),St.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){this.position=e,this.inclusive=t}}function bc(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=pe.comparator(pe.fromName(o.referenceValue),t.key):n=gr(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function wc(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Wt(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,t="asc"){this.field=e,this.dir=t}}function Wg(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{}class tt extends $f{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Yg(e,t,n):t==="array-contains"?new Zg(e,n):t==="in"?new ey(e,n):t==="not-in"?new ty(e,n):t==="array-contains-any"?new ny(e,n):new tt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Jg(e,n):new Xg(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(gr(t,this.value)):t!==null&&An(this.value)===An(t)&&this.matchesComparison(gr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $t extends $f{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new $t(e,t)}matches(e){return Ff(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Ff(r){return r.op==="and"}function qf(r){return Qg(r)&&Ff(r)}function Qg(r){for(const e of r.filters)if(e instanceof $t)return!1;return!0}function ba(r){if(r instanceof tt)return r.field.canonicalString()+r.op.toString()+yr(r.value);if(qf(r))return r.filters.map(e=>ba(e)).join(",");{const e=r.filters.map(t=>ba(t)).join(",");return`${r.op}(${e})`}}function Uf(r,e){return r instanceof tt?function(n,i){return i instanceof tt&&n.op===i.op&&n.field.isEqual(i.field)&&Wt(n.value,i.value)}(r,e):r instanceof $t?function(n,i){return i instanceof $t&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,a)=>s&&Uf(o,i.filters[a]),!0):!1}(r,e):void ge()}function Bf(r){return r instanceof tt?function(t){return`${t.field.canonicalString()} ${t.op} ${yr(t.value)}`}(r):r instanceof $t?function(t){return t.op.toString()+" {"+t.getFilters().map(Bf).join(" ,")+"}"}(r):"Filter"}class Yg extends tt{constructor(e,t,n){super(e,t,n),this.key=pe.fromName(n.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Jg extends tt{constructor(e,t){super(e,"in",t),this.keys=zf("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Xg extends tt{constructor(e,t){super(e,"not-in",t),this.keys=zf("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function zf(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>pe.fromName(n.referenceValue))}class Zg extends tt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return il(t)&&Ei(t.arrayValue,this.value)}}class ey extends tt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ei(this.value.arrayValue,t)}}class ty extends tt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Ei(this.value.arrayValue,t)}}class ny extends tt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Ei(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.le=null}}function Ec(r,e=null,t=[],n=[],i=null,s=null,o=null){return new ry(r,e,t,n,i,s,o)}function sl(r){const e=_e(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>ba(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Qs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>yr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>yr(n)).join(",")),e.le=t}return e.le}function ol(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!Wg(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Uf(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!wc(r.startAt,e.startAt)&&wc(r.endAt,e.endAt)}function wa(r){return pe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function iy(r,e,t,n,i,s,o,a){return new Ir(r,e,t,n,i,s,o,a)}function Js(r){return new Ir(r)}function xc(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Hf(r){return r.collectionGroup!==null}function fi(r){const e=_e(r);if(e.he===null){e.he=[];const t=new Set;for(const s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new it(ht.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new xi(s,n))}),t.has(ht.keyField().canonicalString())||e.he.push(new xi(ht.keyField(),n))}return e.he}function Ht(r){const e=_e(r);return e.Pe||(e.Pe=sy(e,fi(r))),e.Pe}function sy(r,e){if(r.limitType==="F")return Ec(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new xi(i.field,s)});const t=r.endAt?new Ss(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Ss(r.startAt.position,r.startAt.inclusive):null;return Ec(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Ea(r,e){const t=r.filters.concat([e]);return new Ir(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function xa(r,e,t){return new Ir(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Xs(r,e){return ol(Ht(r),Ht(e))&&r.limitType===e.limitType}function Kf(r){return`${sl(Ht(r))}|lt:${r.limitType}`}function ar(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>Bf(i)).join(", ")}]`),Qs(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>yr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>yr(i)).join(",")),`Target(${n})`}(Ht(r))}; limitType=${r.limitType})`}function Zs(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):pe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of fi(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,a,l){const c=bc(o,a,l);return o.inclusive?c<=0:c<0}(n.startAt,fi(n),i)||n.endAt&&!function(o,a,l){const c=bc(o,a,l);return o.inclusive?c>=0:c>0}(n.endAt,fi(n),i))}(r,e)}function oy(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Gf(r){return(e,t)=>{let n=!1;for(const i of fi(r)){const s=ay(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function ay(r,e,t){const n=r.field.isKeyField()?pe.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?gr(l,c):ge()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){In(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Nf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=new We(pe.comparator);function an(){return ly}const Wf=new We(pe.comparator);function ai(...r){let e=Wf;for(const t of r)e=e.insert(t.key,t);return e}function Qf(r){let e=Wf;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Un(){return di()}function Yf(){return di()}function di(){return new Kn(r=>r.toString(),(r,e)=>r.isEqual(e))}const uy=new We(pe.comparator),cy=new it(pe.comparator);function Pe(...r){let e=cy;for(const t of r)e=e.add(t);return e}const hy=new it(Ie);function fy(){return hy}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ts(e)?"-0":e}}function Jf(r){return{integerValue:""+r}}function dy(r,e){return qg(e)?Jf(e):al(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){this._=void 0}}function py(r,e,t){return r instanceof Is?function(i,s){const o={fields:{[Cf]:{stringValue:Pf},[jf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rl(s)&&(s=Ys(s)),s&&(o.fields[Rf]=s),{mapValue:o}}(t,e):r instanceof Ti?Zf(r,e):r instanceof Ai?ed(r,e):function(i,s){const o=Xf(i,s),a=Tc(o)+Tc(i.Ie);return _a(o)&&_a(i.Ie)?Jf(a):al(i.serializer,a)}(r,e)}function my(r,e,t){return r instanceof Ti?Zf(r,e):r instanceof Ai?ed(r,e):t}function Xf(r,e){return r instanceof Ns?function(n){return _a(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Is extends eo{}class Ti extends eo{constructor(e){super(),this.elements=e}}function Zf(r,e){const t=td(e);for(const n of r.elements)t.some(i=>Wt(i,n))||t.push(n);return{arrayValue:{values:t}}}class Ai extends eo{constructor(e){super(),this.elements=e}}function ed(r,e){let t=td(e);for(const n of r.elements)t=t.filter(i=>!Wt(i,n));return{arrayValue:{values:t}}}class Ns extends eo{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Tc(r){return Je(r.integerValue||r.doubleValue)}function td(r){return il(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function gy(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ti&&i instanceof Ti||n instanceof Ai&&i instanceof Ai?mr(n.elements,i.elements,Wt):n instanceof Ns&&i instanceof Ns?Wt(n.Ie,i.Ie):n instanceof Is&&i instanceof Is}(r.transform,e.transform)}class yy{constructor(e,t){this.version=e,this.transformResults=t}}class Et{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Et}static exists(e){return new Et(void 0,e)}static updateTime(e){return new Et(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ws(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class to{}function nd(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new no(r.key,Et.none()):new Ii(r.key,r.data,Et.none());{const t=r.data,n=St.empty();let i=new it(ht.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Nn(r.key,n,new Ot(i.toArray()),Et.none())}}function vy(r,e,t){r instanceof Ii?function(i,s,o){const a=i.value.clone(),l=kc(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):r instanceof Nn?function(i,s,o){if(!ws(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=kc(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(rd(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pi(r,e,t,n){return r instanceof Ii?function(s,o,a,l){if(!ws(s.precondition,o))return a;const c=s.value.clone(),h=Sc(s.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof Nn?function(s,o,a,l){if(!ws(s.precondition,o))return a;const c=Sc(s.fieldTransforms,l,o),h=o.data;return h.setAll(rd(s)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(s,o,a){return ws(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(r,e,t)}function _y(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=Xf(n.transform,i||null);s!=null&&(t===null&&(t=St.empty()),t.set(n.field,s))}return t||null}function Ac(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&mr(n,i,(s,o)=>gy(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Ii extends to{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Nn extends to{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rd(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function kc(r,e,t){const n=new Map;Me(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,my(o,a,t[i]))}return n}function Sc(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,py(s,o,e))}return n}class no extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class by extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&vy(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Yf();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=nd(o,a);l!==null&&n.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ve.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Pe())}isEqual(e){return this.batchId===e.batchId&&mr(this.mutations,e.mutations,(t,n)=>Ac(t,n))&&mr(this.baseMutations,e.baseMutations,(t,n)=>Ac(t,n))}}class ll{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Me(e.mutations.length===n.length);let i=function(){return uy}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new ll(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,Re;function Ty(r){switch(r){case ne.OK:return ge();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return ge()}}function id(r){if(r===void 0)return on("GRPC error has no .code"),ne.UNKNOWN;switch(r){case et.OK:return ne.OK;case et.CANCELLED:return ne.CANCELLED;case et.UNKNOWN:return ne.UNKNOWN;case et.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case et.INTERNAL:return ne.INTERNAL;case et.UNAVAILABLE:return ne.UNAVAILABLE;case et.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case et.NOT_FOUND:return ne.NOT_FOUND;case et.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case et.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case et.ABORTED:return ne.ABORTED;case et.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case et.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case et.DATA_LOSS:return ne.DATA_LOSS;default:return ge()}}(Re=et||(et={}))[Re.OK=0]="OK",Re[Re.CANCELLED=1]="CANCELLED",Re[Re.UNKNOWN=2]="UNKNOWN",Re[Re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Re[Re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Re[Re.NOT_FOUND=5]="NOT_FOUND",Re[Re.ALREADY_EXISTS=6]="ALREADY_EXISTS",Re[Re.PERMISSION_DENIED=7]="PERMISSION_DENIED",Re[Re.UNAUTHENTICATED=16]="UNAUTHENTICATED",Re[Re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Re[Re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Re[Re.ABORTED=10]="ABORTED",Re[Re.OUT_OF_RANGE=11]="OUT_OF_RANGE",Re[Re.UNIMPLEMENTED=12]="UNIMPLEMENTED",Re[Re.INTERNAL=13]="INTERNAL",Re[Re.UNAVAILABLE=14]="UNAVAILABLE",Re[Re.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=new bn([4294967295,4294967295],0);function Ic(r){const e=kf().encode(r),t=new _f;return t.update(e),new Uint8Array(t.digest())}function Nc(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new bn([t,n],0),new bn([i,s],0)]}class ul{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new li(`Invalid padding: ${t}`);if(n<0)throw new li(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new li(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new li(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=bn.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(bn.fromNumber(n)));return i.compare(Ay)===1&&(i=new bn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=Ic(e),[n,i]=Nc(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);if(!this.Re(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ul(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=Ic(e),[n,i]=Nc(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class li extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Ni.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ro(ve.min(),i,new We(Ie),an(),Pe())}}class Ni{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ni(n,t,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}}class sd{constructor(e,t){this.targetId=e,this.ge=t}}class od{constructor(e,t,n=ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Oc{constructor(){this.pe=0,this.ye=Pc(),this.we=ft.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Pe(),t=Pe(),n=Pe();return this.ye.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ge()}}),new Ni(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Pc()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Me(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class ky{constructor(e){this.ke=e,this.qe=new Map,this.Qe=an(),this.$e=os(),this.Ue=os(),this.Ke=new We(Ie)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:ge()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){const s=i.target;if(wa(s))if(n===0){const o=new pe(s.path);this.ze(t,o,yt.newNoDocument(o,ve.min()))}else Me(n===1);else{const o=this.et(t);if(o!==n){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,c)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Tn(n).toUint8Array()}catch(l){if(l instanceof Of)return pr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ul(o,i,s)}catch(l){return pr(l instanceof li?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,s,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&wa(a.target)){const l=new pe(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,yt.newNoDocument(l,e))}s.ve&&(t.set(o,s.Fe()),s.Me())}});let n=Pe();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(e));const i=new ro(e,t,this.Ke,this.Qe,n);return this.Qe=an(),this.$e=os(),this.Ue=os(),this.Ke=new We(Ie),i}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Oc,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new it(Ie),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new it(Ie),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||fe("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Oc),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function os(){return new We(pe.comparator)}function Pc(){return new We(pe.comparator)}const Sy={asc:"ASCENDING",desc:"DESCENDING"},Iy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ny={and:"AND",or:"OR"};class Oy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ta(r,e){return r.useProto3Json||Qs(e)?e:{value:e}}function Os(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ad(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Py(r,e){return Os(r,e.toTimestamp())}function Kt(r){return Me(!!r),ve.fromTimestamp(function(t){const n=xn(t);return new rt(n.seconds,n.nanos)}(r))}function cl(r,e){return Aa(r,e).canonicalString()}function Aa(r,e){const t=function(i){return new He(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function ld(r){const e=He.fromString(r);return Me(dd(e)),e}function ka(r,e){return cl(r.databaseId,e.path)}function zo(r,e){const t=ld(e);if(t.get(1)!==r.databaseId.projectId)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new pe(cd(t))}function ud(r,e){return cl(r.databaseId,e)}function Cy(r){const e=ld(r);return e.length===4?He.emptyPath():cd(e)}function Sa(r){return new He(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function cd(r){return Me(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Cc(r,e,t){return{name:ka(r,e),fields:t.value.mapValue.fields}}function Ry(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,h){return c.useProto3Json?(Me(h===void 0||typeof h=="string"),ft.fromBase64String(h||"")):(Me(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ft.fromUint8Array(h||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?ne.UNKNOWN:id(c.code);return new he(h,c.message||"")}(o);t=new od(n,i,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=zo(r,n.document.name),s=Kt(n.document.updateTime),o=n.document.createTime?Kt(n.document.createTime):ve.min(),a=new St({mapValue:{fields:n.document.fields}}),l=yt.newFoundDocument(i,s,o,a),c=n.targetIds||[],h=n.removedTargetIds||[];t=new Es(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=zo(r,n.document),s=n.readTime?Kt(n.readTime):ve.min(),o=yt.newNoDocument(i,s),a=n.removedTargetIds||[];t=new Es([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=zo(r,n.document),s=n.removedTargetIds||[];t=new Es([],s,i,null)}else{if(!("filter"in e))return ge();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new xy(i,s),a=n.targetId;t=new sd(a,o)}}return t}function jy(r,e){let t;if(e instanceof Ii)t={update:Cc(r,e.key,e.value)};else if(e instanceof no)t={delete:ka(r,e.key)};else if(e instanceof Nn)t={update:Cc(r,e.key,e.data),updateMask:By(e.fieldMask)};else{if(!(e instanceof by))return ge();t={verify:ka(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof Is)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ti)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ns)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ge()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Py(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ge()}(r,e.precondition)),t}function Ly(r,e){return r&&r.length>0?(Me(e!==void 0),r.map(t=>function(i,s){let o=i.updateTime?Kt(i.updateTime):Kt(s);return o.isEqual(ve.min())&&(o=Kt(s)),new yy(o,i.transformResults||[])}(t,e))):[]}function Dy(r,e){return{documents:[ud(r,e.path)]}}function My(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=ud(r,i);const s=function(c){if(c.length!==0)return fd($t.create(c,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:lr(f.field),direction:Fy(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Ta(r,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ht:t,parent:i}}function Vy(r){let e=Cy(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){Me(n===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(d){const f=hd(d);return f instanceof $t&&qf(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(_){return new xi(ur(_.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Qs(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,p=d.values||[];return new Ss(p,f)}(t.startAt));let c=null;return t.endAt&&(c=function(d){const f=!d.before,p=d.values||[];return new Ss(p,f)}(t.endAt)),iy(e,i,o,s,a,"F",l,c)}function $y(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function hd(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ur(t.unaryFilter.field);return tt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ur(t.unaryFilter.field);return tt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ur(t.unaryFilter.field);return tt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ur(t.unaryFilter.field);return tt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(r):r.fieldFilter!==void 0?function(t){return tt.create(ur(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return $t.create(t.compositeFilter.filters.map(n=>hd(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ge()}}(t.compositeFilter.op))}(r):ge()}function Fy(r){return Sy[r]}function qy(r){return Iy[r]}function Uy(r){return Ny[r]}function lr(r){return{fieldPath:r.canonicalString()}}function ur(r){return ht.fromServerFormat(r.fieldPath)}function fd(r){return r instanceof tt?function(t){if(t.op==="=="){if(_c(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NAN"}};if(vc(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(_c(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NOT_NAN"}};if(vc(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lr(t.field),op:qy(t.op),value:t.value}}}(r):r instanceof $t?function(t){const n=t.getFilters().map(i=>fd(i));return n.length===1?n[0]:{compositeFilter:{op:Uy(t.op),filters:n}}}(r):ge()}function By(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function dd(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,n,i,s=ve.min(),o=ve.min(),a=ft.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new _n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e){this.Tt=e}}function Hy(r){const e=Vy({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?xa(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(){this.Tn=new Gy}addToCollectionParentIndex(e,t){return this.Tn.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(En.min())}updateCollectionGroup(e,t,n){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class Gy{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new it(He.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new it(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pd=41943040;class At{static withCacheSize(e){return new At(e,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */At.DEFAULT_COLLECTION_PERCENTILE=10,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,At.DEFAULT=new At(pd,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),At.DISABLED=new At(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new vr(0)}static Kn(){return new vr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc="LruGarbageCollector",Wy=1048576;function Lc([r,e],[t,n]){const i=Ie(r,t);return i===0?Ie(e,n):i}class Qy{constructor(e){this.Hn=e,this.buffer=new it(Lc),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Lc(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Yy{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){fe(jc,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sr(t)?fe(jc,"Ignoring IndexedDB error during garbage collection: ",t):await kr(t)}await this.er(3e5)})}}class Jy{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ie.resolve(Ws.ae);const n=new Qy(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(Rc)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rc):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,s,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(n=d,a=Date.now(),this.removeTargets(e,n,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(c=Date.now(),or()<=tn.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function Xy(r,e){return new Jy(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.changes=new Kn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ie.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&pi(n.mutation,i,Ot.empty(),rt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Pe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Pe()){const i=Un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=ai();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Un();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Pe()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=an();const o=di(),a=function(){return di()}();return t.forEach((l,c)=>{const h=n.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Nn)?s=s.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),pi(h.mutation,c,h.mutation.getFieldMask(),rt.now())):o.set(c.key,Ot.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var d;return a.set(c,new e0(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=di();let i=new We((o,a)=>o-a),s=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=n.get(l)||Ot.empty();h=a.applyToLocalView(c,h),n.set(l,h);const d=(i.get(a.batchId)||Pe()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=Yf();h.forEach(f=>{if(!s.has(f)){const p=nd(t.get(f),n.get(f));p!==null&&d.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return ie.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Hf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ie.resolve(Un());let a=_i,l=s;return o.next(c=>ie.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(h)?ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Pe())).next(h=>({batchId:a,changes:Qf(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next(n=>{let i=ai();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=ai();return this.indexManager.getCollectionParents(e,s).next(a=>ie.forEach(a,l=>{const c=function(d,f){return new Ir(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,yt.newInvalidDocument(h)))});let a=ai();return o.forEach((l,c)=>{const h=s.get(l);h!==void 0&&pi(h.mutation,c,Ot.empty(),rt.now()),Zs(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return ie.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Kt(i.createTime)}}(t)),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:Hy(i.bundledQuery),readTime:Kt(i.readTime)}}(t)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(){this.overlays=new We(pe.comparator),this.Rr=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Un();return ie.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.Et(e,t,s)}),ie.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),ie.resolve()}getOverlaysForCollection(e,t,n){const i=Un(),s=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new We((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>n){let h=s.get(c.largestBatchId);h===null&&(h=Un(),s=s.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=Un(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return ie.resolve(a)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Ey(t,n));let s=this.Rr.get(t);s===void 0&&(s=Pe(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.sessionToken=ft.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.Vr=new it(at.mr),this.gr=new it(at.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new at(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new at(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){const t=new pe(new He([])),n=new at(t,e),i=new at(t,e+1),s=[];return this.gr.forEachInRange([n,i],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new pe(new He([])),n=new at(t,e),i=new at(t,e+1);let s=Pe();return this.gr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new at(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class at{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return pe.comparator(e.key,t.key)||Ie(e.Cr,t.Cr)}static pr(e,t){return Ie(e.Cr,t.Cr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new it(at.mr)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new wy(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Mr=this.Mr.add(new at(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,t){return ie.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?nl:this.Fr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new at(t,0),i=new at(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,i],o=>{const a=this.Or(o.Cr);s.push(a)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new it(Ie);return t.forEach(i=>{const s=new at(i,0),o=new at(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],a=>{n=n.add(a.Cr)})}),ie.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;pe.isDocumentKey(s)||(s=s.child(""));const o=new at(new pe(s),0);let a=new it(Ie);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Cr)),!0)},o),ie.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Me(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return ie.forEach(t.mutations,i=>{const s=new at(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new at(t,0),i=this.Mr.firstAfterOrEqual(n);return ie.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e){this.kr=e,this.docs=function(){return new We(pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ie.resolve(n?n.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let n=an();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=an();const o=t.path,a=new pe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Mg(Dg(h),n)<=0||(i.has(h.key)||Zs(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,t,n,i){ge()}qr(e,t){return ie.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new a0(this)}getSize(e){return ie.resolve(this.size)}}class a0 extends Zy{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),ie.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e){this.persistence=e,this.Qr=new Kn(t=>sl(t),ol),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.$r=0,this.Ur=new hl,this.targetCount=0,this.Kr=vr.Un()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),ie.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new vr(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.zn(t),ie.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return ie.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),ie.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return ie.resolve(n)}containsKey(e,t){return ie.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Ws(0),this.zr=!1,this.zr=!0,this.jr=new i0,this.referenceDelegate=e(this),this.Hr=new l0(this),this.indexManager=new Ky,this.remoteDocumentCache=function(i){return new o0(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new zy(t),this.Yr=new n0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new r0,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new s0(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){fe("MemoryPersistence","Starting transaction:",e);const i=new u0(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return ie.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class u0 extends $g{constructor(e){super(),this.currentSequenceNumber=e}}class fl{constructor(e){this.persistence=e,this.ti=new hl,this.ni=null}static ri(e){return new fl(e)}get ii(){if(this.ni)return this.ni;throw ge()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),ie.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),ie.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.ii,n=>{const i=pe.fromPath(n);return this.si(e,i).next(s=>{s||t.removeEntry(i,ve.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return ie.or([()=>ie.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Ps{constructor(e,t){this.persistence=e,this.oi=new Kn(n=>Ug(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=Xy(this,t)}static ri(e,t){return new Ps(e,t)}Zr(){}Xr(e){return ie.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return ie.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(s=>s?ie.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,t).next(a=>{a||(n++,s.removeEntry(o,ve.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),ie.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ie.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),ie.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_s(e.data.value)),t}ar(e,t,n){return ie.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return ie.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=Pe(),i=Pe();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new dl(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return pg()?8:Fg(mg())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new c0;return this._s(e,t,o).next(a=>{if(s.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>s.result)}us(e,t,n,i){return n.documentReadCount<this.es?(or()<=tn.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",ar(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ie.resolve()):(or()<=tn.DEBUG&&fe("QueryEngine","Query:",ar(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(or()<=tn.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",ar(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ht(t))):ie.resolve())}rs(e,t){if(xc(t))return ie.resolve(null);let n=Ht(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=xa(t,null,"F"),n=Ht(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Pe(...s);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.cs(t,a);return this.ls(t,c,o,l.readTime)?this.rs(e,xa(t,null,"F")):this.hs(e,c,t,l)}))})))}ss(e,t,n,i){return xc(t)||i.isEqual(ve.min())?ie.resolve(null):this.ns.getDocuments(e,n).next(s=>{const o=this.cs(t,s);return this.ls(t,o,n,i)?ie.resolve(null):(or()<=tn.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ar(t)),this.hs(e,o,t,Lg(i,_i)).next(a=>a))})}cs(e,t){let n=new it(Gf(e));return t.forEach((i,s)=>{Zs(e,s)&&(n=n.add(s))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,n){return or()<=tn.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",ar(t)),this.ns.getDocumentsMatchingQuery(e,t,En.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="LocalStore",f0=3e8;class d0{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new We(Ie),this.Is=new Kn(s=>sl(s),ol),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new t0(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function p0(r,e,t,n){return new d0(r,e,t,n)}async function gd(r,e){const t=_e(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Pe();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of s){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(n,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function m0(r,e){const t=_e(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,f=d.keys();let p=ie.resolve();return f.forEach(_=>{p=p.next(()=>h.getEntry(l,_)).next(g=>{const y=c.docVersions.get(_);Me(y!==null),g.version.compareTo(y)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),h.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let l=Pe();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function yd(r){const e=_e(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function g0(r,e){const t=_e(r),n=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const a=[];e.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(t.Hr.removeMatchingKeys(s,h.removedDocuments,d).next(()=>t.Hr.addMatchingKeys(s,h.addedDocuments,d)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(ft.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,n)),i=i.insert(d,p),function(g,y,m){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=f0?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(f,p,h)&&a.push(t.Hr.updateTargetData(s,p))});let l=an(),c=Pe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(y0(s,o,e.documentUpdates).next(h=>{l=h.Vs,c=h.fs})),!n.isEqual(ve.min())){const h=t.Hr.getLastRemoteSnapshotVersion(s).next(d=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(h)}return ie.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(t.Ts=i,s))}function y0(r,e,t){let n=Pe(),i=Pe();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=an();return t.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ve.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):fe(pl,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:i}})}function v0(r,e){const t=_e(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=nl),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function _0(r,e){const t=_e(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(s=>s?(i=s,ie.resolve(i)):t.Hr.allocateTargetId(n).next(o=>(i=new _n(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function Ia(r,e,t){const n=_e(r),i=n.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Sr(o))throw o;fe(pl,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Dc(r,e,t){const n=_e(r);let i=ve.min(),s=Pe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=_e(l),f=d.Is.get(h);return f!==void 0?ie.resolve(d.Ts.get(f)):d.Hr.getTargetData(c,h)}(n,o,Ht(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Ps.getDocumentsMatchingQuery(o,e,t?i:ve.min(),t?s:Pe())).next(a=>(b0(n,oy(e),a),{documents:a,gs:s})))}function b0(r,e,t){let n=r.Es.get(e)||ve.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Es.set(e,n)}class Mc{constructor(){this.activeTargetIds=fy()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class w0{constructor(){this.ho=new Mc,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Mc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc="ConnectivityMonitor";class $c{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){fe(Vc,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){fe(Vc,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let as=null;function Na(){return as===null?as=function(){return 268435456+Math.round(2147483648*Math.random())}():as++,"0x"+as.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="RestConnection",x0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class T0{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===As?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,s){const o=Na(),a=this.bo(e,t.toUriEncodedString());fe(Ho,`Sending RPC '${e}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,i,s),this.vo(e,a,l,n).then(c=>(fe(Ho,`Received RPC '${e}' ${o}: `,c),c),c=>{throw pr(Ho,`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",n),c})}Co(e,t,n,i,s,o){return this.So(e,t,n,i,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ar}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}bo(e,t){const n=x0[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt="WebChannelConnection";class k0 extends T0{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const s=Na();return new Promise((o,a)=>{const l=new bf;l.setWithCredentials(!0),l.listenOnce(wf.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case vs.NO_ERROR:const h=l.getResponseJson();fe(mt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case vs.TIMEOUT:fe(mt,`RPC '${e}' ${s} timed out`),a(new he(ne.DEADLINE_EXCEEDED,"Request time out"));break;case vs.HTTP_ERROR:const d=l.getStatus();if(fe(mt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const _=function(y){const m=y.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(m)>=0?m:ne.UNKNOWN}(p.status);a(new he(_,p.message))}else a(new he(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new he(ne.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{fe(mt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);fe(mt,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",c,n,15)})}Wo(e,t,n){const i=Na(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tf(),a=xf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const h=s.join("");fe(mt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);let f=!1,p=!1;const _=new A0({Fo:y=>{p?fe(mt,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(f||(fe(mt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),f=!0),fe(mt,`RPC '${e}' stream ${i} sending:`,y),d.send(y))},Mo:()=>d.close()}),g=(y,m,b)=>{y.listen(m,S=>{try{b(S)}catch(v){setTimeout(()=>{throw v},0)}})};return g(d,oi.EventType.OPEN,()=>{p||(fe(mt,`RPC '${e}' stream ${i} transport opened.`),_.Qo())}),g(d,oi.EventType.CLOSE,()=>{p||(p=!0,fe(mt,`RPC '${e}' stream ${i} transport closed`),_.Uo())}),g(d,oi.EventType.ERROR,y=>{p||(p=!0,pr(mt,`RPC '${e}' stream ${i} transport errored:`,y),_.Uo(new he(ne.UNAVAILABLE,"The operation could not be completed")))}),g(d,oi.EventType.MESSAGE,y=>{var m;if(!p){const b=y.data[0];Me(!!b);const S=b,v=(S==null?void 0:S.error)||((m=S[0])===null||m===void 0?void 0:m.error);if(v){fe(mt,`RPC '${e}' stream ${i} received error:`,v);const O=v.status;let R=function(N){const T=et[N];if(T!==void 0)return id(T)}(O),E=v.message;R===void 0&&(R=ne.INTERNAL,E="Unknown error status: "+O+" with message "+v.message),p=!0,_.Uo(new he(R,E)),d.close()}else fe(mt,`RPC '${e}' stream ${i} received:`,b),_.Ko(b)}}),g(a,Ef.STAT_EVENT,y=>{y.stat===ga.PROXY?fe(mt,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===ga.NOPROXY&&fe(mt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.$o()},0),_}}function Ko(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(r){return new Oy(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc="PersistentStream";class _d{constructor(e,t,n,i,s,o,a,l){this.Ti=e,this.n_=n,this.r_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new vd(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?(on(t.toString()),on("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new he(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return fe(Fc,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(fe(Fc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class S0 extends _d{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=Ry(this.serializer,e),n=function(s){if(!("targetChange"in s))return ve.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Kt(o.readTime):ve.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Sa(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=wa(l)?{documents:Dy(s,l)}:{query:My(s,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ad(s,o.resumeToken);const c=Ta(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Os(s,o.snapshotVersion.toTimestamp());const c=Ta(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const n=$y(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Sa(this.serializer),t.removeTarget=e,this.I_(t)}}class I0 extends _d{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Me(!!e.streamToken),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=Ly(e.writeResults,e.commitTime),n=Kt(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Sa(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>jy(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{}class O0 extends N0{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,Aa(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new he(ne.UNKNOWN,s.toString())})}Co(e,t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,Aa(t,n),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new he(ne.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class P0{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(on(t),this.N_=!1):fe("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="RemoteStore";class C0{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{n.enqueueAndForget(async()=>{Gn(this)&&(fe(Hn,"Restarting streams for network reachability change."),await async function(l){const c=_e(l);c.W_.add(4),await Oi(c),c.j_.set("Unknown"),c.W_.delete(4),await so(c)}(this))})}),this.j_=new P0(n,i)}}async function so(r){if(Gn(r))for(const e of r.G_)await e(!0)}async function Oi(r){for(const e of r.G_)await e(!1)}function bd(r,e){const t=_e(r);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),vl(t)?yl(t):Nr(t).c_()&&gl(t,e))}function ml(r,e){const t=_e(r),n=Nr(t);t.K_.delete(e),n.c_()&&wd(t,e),t.K_.size===0&&(n.c_()?n.P_():Gn(t)&&t.j_.set("Unknown"))}function gl(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Nr(r).y_(e)}function wd(r,e){r.H_.Ne(e),Nr(r).w_(e)}function yl(r){r.H_=new ky({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.K_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),Nr(r).start(),r.j_.B_()}function vl(r){return Gn(r)&&!Nr(r).u_()&&r.K_.size>0}function Gn(r){return _e(r).W_.size===0}function Ed(r){r.H_=void 0}async function R0(r){r.j_.set("Online")}async function j0(r){r.K_.forEach((e,t)=>{gl(r,e)})}async function L0(r,e){Ed(r),vl(r)?(r.j_.q_(e),yl(r)):r.j_.set("Unknown")}async function D0(r,e,t){if(r.j_.set("Online"),e instanceof od&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.K_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.K_.delete(a),i.H_.removeTarget(a))}(r,e)}catch(n){fe(Hn,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Cs(r,n)}else if(e instanceof Es?r.H_.We(e):e instanceof sd?r.H_.Ze(e):r.H_.je(e),!t.isEqual(ve.min()))try{const n=await yd(r.localStore);t.compareTo(n)>=0&&await function(s,o){const a=s.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.K_.get(c);h&&s.K_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=s.K_.get(l);if(!h)return;s.K_.set(l,h.withResumeToken(ft.EMPTY_BYTE_STRING,h.snapshotVersion)),wd(s,l);const d=new _n(h.target,l,c,h.sequenceNumber);gl(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(r,t)}catch(n){fe(Hn,"Failed to raise snapshot:",n),await Cs(r,n)}}async function Cs(r,e,t){if(!Sr(e))throw e;r.W_.add(1),await Oi(r),r.j_.set("Offline"),t||(t=()=>yd(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{fe(Hn,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await so(r)})}function xd(r,e){return e().catch(t=>Cs(r,t,e))}async function oo(r){const e=_e(r),t=kn(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:nl;for(;M0(e);)try{const i=await v0(e.localStore,n);if(i===null){e.U_.length===0&&t.P_();break}n=i.batchId,V0(e,i)}catch(i){await Cs(e,i)}Td(e)&&Ad(e)}function M0(r){return Gn(r)&&r.U_.length<10}function V0(r,e){r.U_.push(e);const t=kn(r);t.c_()&&t.S_&&t.b_(e.mutations)}function Td(r){return Gn(r)&&!kn(r).u_()&&r.U_.length>0}function Ad(r){kn(r).start()}async function $0(r){kn(r).C_()}async function F0(r){const e=kn(r);for(const t of r.U_)e.b_(t.mutations)}async function q0(r,e,t){const n=r.U_.shift(),i=ll.from(n,e,t);await xd(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await oo(r)}async function U0(r,e){e&&kn(r).S_&&await async function(n,i){if(function(o){return Ty(o)&&o!==ne.ABORTED}(i.code)){const s=n.U_.shift();kn(n).h_(),await xd(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await oo(n)}}(r,e),Td(r)&&Ad(r)}async function qc(r,e){const t=_e(r);t.asyncQueue.verifyOperationInProgress(),fe(Hn,"RemoteStore received new credentials");const n=Gn(t);t.W_.add(3),await Oi(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await so(t)}async function B0(r,e){const t=_e(r);e?(t.W_.delete(2),await so(t)):e||(t.W_.add(2),await Oi(t),t.j_.set("Unknown"))}function Nr(r){return r.J_||(r.J_=function(t,n,i){const s=_e(t);return s.M_(),new S0(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:R0.bind(null,r),No:j0.bind(null,r),Lo:L0.bind(null,r),p_:D0.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),vl(r)?yl(r):r.j_.set("Unknown")):(await r.J_.stop(),Ed(r))})),r.J_}function kn(r){return r.Y_||(r.Y_=function(t,n,i){const s=_e(t);return s.M_(),new I0(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:$0.bind(null,r),Lo:U0.bind(null,r),D_:F0.bind(null,r),v_:q0.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await oo(r)):(await r.Y_.stop(),r.U_.length>0&&(fe(Hn,`Stopping write stream with ${r.U_.length} pending writes`),r.U_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new rn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new _l(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bl(r,e){if(on("AsyncQueue",`${e}: ${r}`),Sr(r))return new he(ne.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{static emptySet(e){return new hr(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||pe.comparator(t.key,n.key):(t,n)=>pe.comparator(t.key,n.key),this.keyedMap=ai(),this.sortedSet=new We(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new hr;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){this.Z_=new We(pe.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):ge():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class _r{constructor(e,t,n,i,s,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new _r(e,t,hr.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class H0{constructor(){this.queries=Bc(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=_e(t),s=i.queries;i.queries=Bc(),s.forEach((o,a)=>{for(const l of a.ta)l.onError(n)})})(this,new he(ne.ABORTED,"Firestore shutting down"))}}function Bc(){return new Kn(r=>Kf(r),Xs)}async function wl(r,e){const t=_e(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.na()&&e.ra()&&(n=2):(s=new z0,n=e.ra()?0:1);try{switch(n){case 0:s.ea=await t.onListen(i,!0);break;case 1:s.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=bl(o,`Initialization of query '${ar(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&xl(t)}async function El(r,e){const t=_e(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.ta.indexOf(e);o>=0&&(s.ta.splice(o,1),s.ta.length===0?i=e.ra()?0:1:!s.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function K0(r,e){const t=_e(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.ta)a.oa(i)&&(n=!0);o.ea=i}}n&&xl(t)}function G0(r,e,t){const n=_e(r),i=n.queries.get(e);if(i)for(const s of i.ta)s.onError(t);n.queries.delete(e)}function xl(r){r.ia.forEach(e=>{e.next()})}var Oa,zc;(zc=Oa||(Oa={}))._a="default",zc.Cache="cache";class Tl{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new _r(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=_r.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Oa.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e){this.key=e}}class Sd{constructor(e){this.key=e}}class W0{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Pe(),this.mutatedKeys=Pe(),this.ya=Gf(e),this.wa=new hr(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new Uc,i=t?t.wa:this.wa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,d)=>{const f=i.get(h),p=Zs(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;f&&p?f.data.isEqual(p.data)?_!==g&&(n.track({type:3,doc:p}),y=!0):this.va(f,p)||(n.track({type:2,doc:p}),y=!0,(l&&this.ya(p,l)>0||c&&this.ya(p,c)<0)&&(a=!0)):!f&&p?(n.track({type:0,doc:p}),y=!0):f&&!p&&(n.track({type:1,doc:f}),y=!0,(l||c)&&(a=!0)),y&&(p?(o=o.add(p),s=g?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),n.track({type:1,doc:h})}return{wa:o,Da:n,ls:a,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((h,d)=>function(p,_){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return g(p)-g(_)}(h.type,d.type)||this.ya(h.doc,d.doc)),this.Ca(n),i=i!=null&&i;const a=t&&!i?this.Fa():[],l=this.pa.size===0&&this.current&&!i?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new _r(this.query,e.wa,s,o,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Uc,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Pe(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new Sd(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new kd(n))}),t}Oa(e){this.fa=e.gs,this.pa=Pe();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return _r.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Al="SyncEngine";class Q0{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Y0{constructor(e){this.key=e,this.Ba=!1}}class J0{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Kn(a=>Kf(a),Xs),this.qa=new Map,this.Qa=new Set,this.$a=new We(pe.comparator),this.Ua=new Map,this.Ka=new hl,this.Wa={},this.Ga=new Map,this.za=vr.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function X0(r,e,t=!0){const n=Rd(r);let i;const s=n.ka.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Na()):i=await Id(n,e,t,!0),i}async function Z0(r,e){const t=Rd(r);await Id(t,e,!0,!1)}async function Id(r,e,t,n){const i=await _0(r.localStore,Ht(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let a;return n&&(a=await ev(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&bd(r.remoteStore,i),a}async function ev(r,e,t,n,i){r.Ha=(d,f,p)=>async function(g,y,m,b){let S=y.view.ba(m);S.ls&&(S=await Dc(g.localStore,y.query,!1).then(({documents:E})=>y.view.ba(E,S)));const v=b&&b.targetChanges.get(y.targetId),O=b&&b.targetMismatches.get(y.targetId)!=null,R=y.view.applyChanges(S,g.isPrimaryClient,v,O);return Kc(g,y.targetId,R.Ma),R.snapshot}(r,d,f,p);const s=await Dc(r.localStore,e,!0),o=new W0(e,s.gs),a=o.ba(s.documents),l=Ni.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),c=o.applyChanges(a,r.isPrimaryClient,l);Kc(r,t,c.Ma);const h=new Q0(e,t,o);return r.ka.set(e,h),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),c.snapshot}async function tv(r,e,t){const n=_e(r),i=n.ka.get(e),s=n.qa.get(i.targetId);if(s.length>1)return n.qa.set(i.targetId,s.filter(o=>!Xs(o,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ia(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&ml(n.remoteStore,i.targetId),Pa(n,i.targetId)}).catch(kr)):(Pa(n,i.targetId),await Ia(n.localStore,i.targetId,!0))}async function nv(r,e){const t=_e(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),ml(t.remoteStore,n.targetId))}async function rv(r,e,t){const n=cv(r);try{const i=await function(o,a){const l=_e(o),c=rt.now(),h=a.reduce((p,_)=>p.add(_.key),Pe());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let _=an(),g=Pe();return l.ds.getEntries(p,h).next(y=>{_=y,_.forEach((m,b)=>{b.isValidDocument()||(g=g.add(m))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,_)).next(y=>{d=y;const m=[];for(const b of a){const S=_y(b,d.get(b.key).overlayedDocument);S!=null&&m.push(new Nn(b.key,S,Vf(S.value.mapValue),Et.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,m,a)}).next(y=>{f=y;const m=y.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,y.batchId,m)})}).then(()=>({batchId:f.batchId,changes:Qf(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Wa[o.currentUser.toKey()];c||(c=new We(Ie)),c=c.insert(a,l),o.Wa[o.currentUser.toKey()]=c}(n,i.batchId,t),await Pi(n,i.changes),await oo(n.remoteStore)}catch(i){const s=bl(i,"Failed to persist write");t.reject(s)}}async function Nd(r,e){const t=_e(r);try{const n=await g0(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Ua.get(s);o&&(Me(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?Me(o.Ba):i.removedDocuments.size>0&&(Me(o.Ba),o.Ba=!1))}),await Pi(t,n,e)}catch(n){await kr(n)}}function Hc(r,e,t){const n=_e(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((s,o)=>{const a=o.view.sa(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=_e(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const f of d.ta)f.sa(a)&&(c=!0)}),c&&xl(l)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function iv(r,e,t){const n=_e(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Ua.get(e),s=i&&i.key;if(s){let o=new We(pe.comparator);o=o.insert(s,yt.newNoDocument(s,ve.min()));const a=Pe().add(s),l=new ro(ve.min(),new Map,new We(Ie),o,a);await Nd(n,l),n.$a=n.$a.remove(s),n.Ua.delete(e),kl(n)}else await Ia(n.localStore,e,!1).then(()=>Pa(n,e,t)).catch(kr)}async function sv(r,e){const t=_e(r),n=e.batch.batchId;try{const i=await m0(t.localStore,e);Pd(t,n,null),Od(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Pi(t,i)}catch(i){await kr(i)}}async function ov(r,e,t){const n=_e(r);try{const i=await function(o,a){const l=_e(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Me(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(n.localStore,e);Pd(n,e,t),Od(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Pi(n,i)}catch(i){await kr(i)}}function Od(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Pd(r,e,t){const n=_e(r);let i=n.Wa[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function Pa(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ka.br(e).forEach(n=>{r.Ka.containsKey(n)||Cd(r,n)})}function Cd(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(ml(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ua.delete(t),kl(r))}function Kc(r,e,t){for(const n of t)n instanceof kd?(r.Ka.addReference(n.key,e),av(r,n)):n instanceof Sd?(fe(Al,"Document no longer in limbo: "+n.key),r.Ka.removeReference(n.key,e),r.Ka.containsKey(n.key)||Cd(r,n.key)):ge()}function av(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(fe(Al,"New document in limbo: "+t),r.Qa.add(n),kl(r))}function kl(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new pe(He.fromString(e)),n=r.za.next();r.Ua.set(n,new Y0(t)),r.$a=r.$a.insert(t,n),bd(r.remoteStore,new _n(Ht(Js(t.path)),n,"TargetPurposeLimboResolution",Ws.ae))}}async function Pi(r,e,t){const n=_e(r),i=[],s=[],o=[];n.ka.isEmpty()||(n.ka.forEach((a,l)=>{o.push(n.Ha(l,e,t).then(c=>{var h;if((c||t)&&n.isPrimaryClient){const d=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){i.push(c);const d=dl.Yi(l.targetId,c);s.push(d)}}))}),await Promise.all(o),n.La.p_(i),await async function(l,c){const h=_e(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ie.forEach(c,f=>ie.forEach(f.Hi,p=>h.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>ie.forEach(f.Ji,p=>h.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!Sr(d))throw d;fe(pl,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const p=h.Ts.get(f),_=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(_);h.Ts=h.Ts.insert(f,g)}}}(n.localStore,s))}async function lv(r,e){const t=_e(r);if(!t.currentUser.isEqual(e)){fe(Al,"User change. New user:",e.toKey());const n=await gd(t.localStore,e);t.currentUser=e,function(s,o){s.Ga.forEach(a=>{a.forEach(l=>{l.reject(new he(ne.CANCELLED,o))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Pi(t,n.Rs)}}function uv(r,e){const t=_e(r),n=t.Ua.get(e);if(n&&n.Ba)return Pe().add(n.key);{let i=Pe();const s=t.qa.get(e);if(!s)return i;for(const o of s){const a=t.ka.get(o);i=i.unionWith(a.view.Sa)}return i}}function Rd(r){const e=_e(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=uv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iv.bind(null,e),e.La.p_=K0.bind(null,e.eventManager),e.La.Ja=G0.bind(null,e.eventManager),e}function cv(r){const e=_e(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ov.bind(null,e),e}class Rs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=io(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return p0(this.persistence,new h0,e.initialUser,this.serializer)}Xa(e){return new md(fl.ri,this.serializer)}Za(e){return new w0}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rs.provider={build:()=>new Rs};class hv extends Rs{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Me(this.persistence.referenceDelegate instanceof Ps);const n=this.persistence.referenceDelegate.garbageCollector;return new Yy(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?At.withCacheSize(this.cacheSizeBytes):At.DEFAULT;return new md(n=>Ps.ri(n,t),this.serializer)}}class Ca{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Hc(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=lv.bind(null,this.syncEngine),await B0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new H0}()}createDatastore(e){const t=io(e.databaseInfo.databaseId),n=function(s){return new k0(s)}(e.databaseInfo);return function(s,o,a,l){return new O0(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,a){return new C0(n,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Hc(this.syncEngine,t,0),function(){return $c.D()?new $c:new E0}())}createSyncEngine(e,t){return function(i,s,o,a,l,c,h){const d=new J0(i,s,o,a,l,c);return h&&(d.ja=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=_e(i);fe(Hn,"RemoteStore shutting down."),s.W_.add(5),await Oi(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ca.provider={build:()=>new Ca};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):on("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn="FirestoreClient";class fv{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=gt.UNAUTHENTICATED,this.clientId=Sf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{fe(Sn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(fe(Sn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bl(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Go(r,e){r.asyncQueue.verifyOperationInProgress(),fe(Sn,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await gd(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Gc(r,e){r.asyncQueue.verifyOperationInProgress();const t=await dv(r);fe(Sn,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>qc(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>qc(e.remoteStore,i)),r._onlineComponents=e}async function dv(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){fe(Sn,"Using user provided OfflineComponentProvider");try{await Go(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ne.FAILED_PRECONDITION||i.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;pr("Error using user provided cache. Falling back to memory cache: "+t),await Go(r,new Rs)}}else fe(Sn,"Using default OfflineComponentProvider"),await Go(r,new hv(void 0));return r._offlineComponents}async function jd(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(fe(Sn,"Using user provided OnlineComponentProvider"),await Gc(r,r._uninitializedComponentsProvider._online)):(fe(Sn,"Using default OnlineComponentProvider"),await Gc(r,new Ca))),r._onlineComponents}function pv(r){return jd(r).then(e=>e.syncEngine)}async function js(r){const e=await jd(r),t=e.eventManager;return t.onListen=X0.bind(null,e.syncEngine),t.onUnlisten=tv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Z0.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=nv.bind(null,e.syncEngine),t}function mv(r,e,t={}){const n=new rn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const h=new Sl({next:f=>{h.su(),o.enqueueAndForget(()=>El(s,d));const p=f.docs.has(a);!p&&f.fromCache?c.reject(new he(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?c.reject(new he(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new Tl(Js(a.path),h,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await js(r),r.asyncQueue,e,t,n)),n.promise}function gv(r,e,t={}){const n=new rn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const h=new Sl({next:f=>{h.su(),o.enqueueAndForget(()=>El(s,d)),f.fromCache&&l.source==="server"?c.reject(new he(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new Tl(a,h,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await js(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(r,e,t){if(!t)throw new he(ne.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function yv(r,e,t,n){if(e===!0&&n===!0)throw new he(ne.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Qc(r){if(!pe.isDocumentKey(r))throw new he(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Yc(r){if(pe.isDocumentKey(r))throw new he(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function ao(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":ge()}function xt(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new he(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ao(r);throw new he(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md="firestore.googleapis.com",Jc=!0;class Xc{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new he(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Md,this.ssl=Jc}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Jc;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pd;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Wy)throw new he(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ld((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lo{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xc({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xc(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new kg;switch(n.type){case"firstParty":return new Og(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new he(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Wc.get(t);n&&(fe("ComponentProvider","Removing Datastore"),Wc.delete(t),n.terminate())}(this),Promise.resolve()}}function vv(r,e,t,n={}){var i;const s=(r=xt(r,lo))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:r._getEmulatorOptions()}),a=`${e}:${t}`;s.host!==Md&&s.host!==a&&pr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},s),{host:a,ssl:!1,emulatorOptions:n});if(!hg(l,o)&&(r._setSettings(l),n.mockUserToken)){let c,h;if(typeof n.mockUserToken=="string")c=n.mockUserToken,h=gt.MOCK_USER;else{c=fg(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new he(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new gt(d)}r._authCredentials=new Sg(new Af(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new On(this.firestore,e,this._query)}}class _t{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class wn extends On{constructor(e,t,n){super(e,t,Js(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new pe(e))}withConverter(e){return new wn(this.firestore,e,this._path)}}function br(r,e,...t){if(r=Rt(r),Dd("collection","path",e),r instanceof lo){const n=He.fromString(e,...t);return Yc(n),new wn(r,null,n)}{if(!(r instanceof _t||r instanceof wn))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return Yc(n),new wn(r.firestore,null,n)}}function nt(r,e,...t){if(r=Rt(r),arguments.length===1&&(e=Sf.newId()),Dd("doc","path",e),r instanceof lo){const n=He.fromString(e,...t);return Qc(n),new _t(r,null,new pe(n))}{if(!(r instanceof _t||r instanceof wn))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return Qc(n),new _t(r.firestore,r instanceof wn?r.converter:null,new pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zc="AsyncQueue";class eh{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new vd(this,"async_queue_retry"),this.Su=()=>{const n=Ko();n&&fe(Zc,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const t=Ko();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Ko();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new rn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Sr(e))throw e;fe(Zc,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(n);throw on("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=_l.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&ge()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function th(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Qt extends lo{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new eh,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new eh(e),this._firestoreClient=void 0,await e}}}function _v(r,e){const t=typeof r=="object"?r:lg(),n=typeof r=="string"?r:As,i=ug(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=cg("firestore");s&&vv(i,...s)}return i}function Ci(r){if(r._terminated)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||bv(r),r._firestoreClient}function bv(r){var e,t,n;const i=r._freezeSettings(),s=function(a,l,c,h){return new Hg(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Ld(h.experimentalLongPollingOptions),h.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new fv(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wr(ft.fromBase64String(e))}catch(t){throw new he(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new wr(ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ht(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=/^__.*__$/;class Ev{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ii(e,this.data,t,this.fieldTransforms)}}class Vd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function $d(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class Pl{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Pl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Uu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Ls(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if($d(this.Lu)&&wv.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class xv{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||io(e)}ju(e,t,n,i=!1){return new Pl({Lu:e,methodName:t,zu:n,path:ht.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ji(r){const e=r._freezeSettings(),t=io(r._databaseId);return new xv(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Cl(r,e,t,n,i,s={}){const o=r.ju(s.merge||s.mergeFields?2:0,e,t,i);Rl("Data must be an object, but it was:",o,n);const a=Ud(n,o);let l,c;if(s.merge)l=new Ot(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const f=Ra(e,d,t);if(!o.contains(f))throw new he(ne.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);zd(h,f)||h.push(f)}l=new Ot(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new Ev(new St(a),l,c)}class Li extends Il{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Li}}function Fd(r,e,t,n){const i=r.ju(1,e,t);Rl("Data must be an object, but it was:",i,n);const s=[],o=St.empty();In(n,(l,c)=>{const h=jl(e,l,t);c=Rt(c);const d=i.Uu(h);if(c instanceof Li)s.push(h);else{const f=Di(c,d);f!=null&&(s.push(h),o.set(h,f))}});const a=new Ot(s);return new Vd(o,a,i.fieldTransforms)}function qd(r,e,t,n,i,s){const o=r.ju(1,e,t),a=[Ra(e,n,t)],l=[i];if(s.length%2!=0)throw new he(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Ra(e,s[f])),l.push(s[f+1]);const c=[],h=St.empty();for(let f=a.length-1;f>=0;--f)if(!zd(c,a[f])){const p=a[f];let _=l[f];_=Rt(_);const g=o.Uu(p);if(_ instanceof Li)c.push(p);else{const y=Di(_,g);y!=null&&(c.push(p),h.set(p,y))}}const d=new Ot(c);return new Vd(h,d,o.fieldTransforms)}function Tv(r,e,t,n=!1){return Di(t,r.ju(n?4:3,e))}function Di(r,e){if(Bd(r=Rt(r)))return Rl("Unsupported field value:",e,r),Ud(r,e);if(r instanceof Il)return function(n,i){if(!$d(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const a of n){let l=Di(a,i.Ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Rt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dy(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=rt.fromDate(n);return{timestampValue:Os(i.serializer,s)}}if(n instanceof rt){const s=new rt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Os(i.serializer,s)}}if(n instanceof Nl)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof wr)return{bytesValue:ad(i.serializer,n._byteString)};if(n instanceof _t){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:cl(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Ol)return function(o,a){return{mapValue:{fields:{[Lf]:{stringValue:Mf},[ks]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return al(a.serializer,c)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${ao(n)}`)}(r,e)}function Ud(r,e){const t={};return Nf(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):In(r,(n,i)=>{const s=Di(i,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function Bd(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof rt||r instanceof Nl||r instanceof wr||r instanceof _t||r instanceof Il||r instanceof Ol)}function Rl(r,e,t){if(!Bd(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=ao(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function Ra(r,e,t){if((e=Rt(e))instanceof Ri)return e._internalPath;if(typeof e=="string")return jl(r,e);throw Ls("Field path arguments must be of type string or ",r,!1,void 0,t)}const Av=new RegExp("[~\\*/\\[\\]]");function jl(r,e,t){if(e.search(Av)>=0)throw Ls(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Ri(...e.split("."))._internalPath}catch{throw Ls(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Ls(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${i}`),l+=")"),new he(ne.INVALID_ARGUMENT,a+r+l)}function zd(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ll("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class kv extends Hd{data(){return super.data()}}function Ll(r,e){return typeof e=="string"?jl(r,e):e instanceof Ri?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new he(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dl{}class Gd extends Dl{}function uo(r,e,...t){let n=[];e instanceof Dl&&n.push(e),n=n.concat(t),function(s){const o=s.filter(l=>l instanceof Vl).length,a=s.filter(l=>l instanceof Ml).length;if(o>1||o>0&&a>0)throw new he(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Ml extends Gd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ml(e,t,n)}_apply(e){const t=this._parse(e);return Wd(e._query,t),new On(e.firestore,e.converter,Ea(e._query,t))}_parse(e){const t=ji(e.firestore);return function(s,o,a,l,c,h,d){let f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new he(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){rh(d,h);const _=[];for(const g of d)_.push(nh(l,s,g));f={arrayValue:{values:_}}}else f=nh(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||rh(d,h),f=Tv(a,o,d,h==="in"||h==="not-in");return tt.create(c,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Vl extends Dl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vl(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:$t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Wd(o,l),o=Ea(o,l)}(e._query,t),new On(e.firestore,e.converter,Ea(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $l extends Gd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $l(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xi(s,o)}(e._query,this._field,this._direction);return new On(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function co(r,e="asc"){const t=e,n=Ll("orderBy",r);return $l._create(n,t)}function nh(r,e,t){if(typeof(t=Rt(t))=="string"){if(t==="")throw new he(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hf(e)&&t.indexOf("/")!==-1)throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(He.fromString(t));if(!pe.isDocumentKey(n))throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return yc(r,new pe(n))}if(t instanceof _t)return yc(r,t._key);throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ao(t)}.`)}function rh(r,e){if(!Array.isArray(r)||r.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Wd(r,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Sv{convertValue(e,t="none"){switch(An(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return In(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[ks].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Je(o.doubleValue));return new Ol(s)}convertGeoPoint(e){return new Nl(Je(e.latitude),Je(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ys(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(bi(e));default:return null}}convertTimestamp(e){const t=xn(e);return new rt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=He.fromString(e);Me(dd(n));const i=new wi(n.get(1),n.get(3)),s=new pe(n.popFirst(5));return i.isEqual(t)||on(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qd extends Hd{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ll("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class xs extends Qd{data(e={}){return super.data(e)}}class Yd{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ui(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new xs(this._firestore,this._userDataWriter,n.key,n,new ui(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new xs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ui(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new xs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ui(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Iv(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Iv(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(r){r=xt(r,_t);const e=xt(r.firestore,Qt);return mv(Ci(e),r._key).then(t=>Jd(e,r,t))}class ql extends Sv{constructor(e){super(),this.firestore=e}convertBytes(e){return new wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}function Mi(r){r=xt(r,On);const e=xt(r.firestore,Qt),t=Ci(e),n=new ql(e);return Kd(r._query),gv(t,r._query).then(i=>new Yd(e,n,r,i))}function ja(r,e,t){r=xt(r,_t);const n=xt(r.firestore,Qt),i=Fl(r.converter,e,t);return Vi(n,[Cl(ji(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Et.none())])}function Ds(r,e,t,...n){r=xt(r,_t);const i=xt(r.firestore,Qt),s=ji(i);let o;return o=typeof(e=Rt(e))=="string"||e instanceof Ri?qd(s,"updateDoc",r._key,e,t,n):Fd(s,"updateDoc",r._key,e),Vi(i,[o.toMutation(r._key,Et.exists(!0))])}function Ul(r){return Vi(xt(r.firestore,Qt),[new no(r._key,Et.none())])}function Bl(r,e){const t=xt(r.firestore,Qt),n=nt(r),i=Fl(r.converter,e);return Vi(t,[Cl(ji(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Et.exists(!1))]).then(()=>n)}function zl(r,...e){var t,n,i;r=Rt(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||th(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(th(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,c,h;if(r instanceof _t)c=xt(r.firestore,Qt),h=Js(r._key.path),l={next:d=>{e[o]&&e[o](Jd(c,r,d))},error:e[o+1],complete:e[o+2]};else{const d=xt(r,On);c=xt(d.firestore,Qt),h=d._query;const f=new ql(c);l={next:p=>{e[o]&&e[o](new Yd(c,f,d,p))},error:e[o+1],complete:e[o+2]},Kd(r._query)}return function(f,p,_,g){const y=new Sl(g),m=new Tl(p,y,_);return f.asyncQueue.enqueueAndForget(async()=>wl(await js(f),m)),()=>{y.su(),f.asyncQueue.enqueueAndForget(async()=>El(await js(f),m))}}(Ci(c),h,a,l)}function Vi(r,e){return function(n,i){const s=new rn;return n.asyncQueue.enqueueAndForget(async()=>rv(await pv(n),i,s)),s.promise}(Ci(r),e)}function Jd(r,e,t){const n=t.docs.get(e._key),i=new ql(r);return new Qd(r,i,e._key,n,new ui(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ji(e)}set(e,t,n){this._verifyNotCommitted();const i=Wo(e,this._firestore),s=Fl(i.converter,t,n),o=Cl(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,Et.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Wo(e,this._firestore);let o;return o=typeof(t=Rt(t))=="string"||t instanceof Ri?qd(this._dataReader,"WriteBatch.update",s._key,t,n,i):Fd(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Et.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Wo(e,this._firestore);return this._mutations=this._mutations.concat(new no(t._key,Et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Wo(r,e){if((r=Rt(r)).firestore!==e)throw new he(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(){return new Li("deleteField")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(r){return Ci(r=xt(r,Qt)),new Ov(r,e=>Vi(r,e))}(function(e,t=!0){(function(i){Ar=i})(dg),ig(new sg("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),a=new Qt(new Ig(n.getProvider("auth-internal")),new Pg(o,n.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new he(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wi(c.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),nc(sc,oc,e),nc(sc,oc,"esm2017")})();const Cv={apiKey:"AIzaSyAsGrtbRSjz77iShv4tB0vQ33A23ie9JM8",authDomain:"tiger3homs-f3a5f-d60da.firebaseapp.com",projectId:"tiger3homs-f3a5f-d60da",storageBucket:"tiger3homs-f3a5f-d60da.firebasestorage.app",messagingSenderId:"509990310606",appId:"1:509990310606:web:e36d91ea748c4cd64d369f",measurementId:"G-DDZTZ6MR6S"};let Qo=null,Mt=null,de=null;try{Qo=gg(Cv),Mt=yg(Qo),de=_v(Qo)}catch(r){throw console.error("Firebase initialization error:",r),new Error(`Firebase initialization failed: ${r instanceof Error?r.message:String(r)}`)}if(!de)throw new Error("Firestore failed to initialize and is null.");const Rv=r=>{const t=/[A-Z]/.test(r),n=/[a-z]/.test(r),i=/\d/.test(r),s=/[!@#$%^&*(),.?":{}|<>]/.test(r);return r.length>=8&&t&&n&&i&&s},jv=()=>{const[r,e]=Y.useState(""),[t,n]=Y.useState(""),[i,s]=Y.useState(""),[o,a]=Y.useState(!1),l=df();Y.useEffect(()=>{const h=setTimeout(()=>{Mt&&Mt.signOut()},18e5);return()=>clearTimeout(h)},[]),Y.useEffect(()=>{if(!Mt)return;const h=mf(Mt,d=>{d&&l("/admin/dashboard",{replace:!0})});return()=>h()},[l]);const c=async h=>{if(h.preventDefault(),s(""),a(!0),!r.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){s("Please enter a valid email address"),a(!1);return}if(!Rv(t)){s("Password must be at least 8 characters long and contain uppercase, lowercase, numbers, and special characters"),a(!1);return}if(!Mt){s("Authentication service is not available."),a(!1);return}try{await vg(Mt,r,t)}catch(d){let f="Failed to log in. Please check your credentials.";if(d.code)switch(d.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":f="Invalid email or password.";break;case"auth/invalid-email":f="Invalid email format.";break;case"auth/too-many-requests":f="Too many failed attempts. Please try again later.";break;default:console.error("Firebase Login error:",d)}s(f)}finally{a(!1)}};return P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:P.jsxs("div",{className:"p-8 bg-white rounded shadow-md w-full max-w-sm",children:[P.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Admin Login"}),P.jsxs("form",{onSubmit:c,children:[P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),P.jsx("input",{type:"email",id:"email",value:r,onChange:h=>e(h.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"password",children:"Password"}),P.jsx("input",{type:"password",id:"password",value:t,onChange:h=>n(h.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),i&&P.jsx("p",{className:"text-red-500 text-xs italic mb-4",children:i}),P.jsx("div",{className:"flex items-center justify-between",children:P.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full disabled:opacity-50",disabled:o,children:o?"Logging in...":"Login"})})]})]})})};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Dv=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),ih=r=>{const e=Dv(r);return e.charAt(0).toUpperCase()+e.slice(1)},Zd=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Mv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=Y.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>Y.createElement("svg",{ref:l,...Mv,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Zd("lucide",i),...a},[...o.map(([c,h])=>Y.createElement(c,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=(r,e)=>{const t=Y.forwardRef(({className:n,...i},s)=>Y.createElement(Vv,{ref:s,iconNode:e,className:Zd(`lucide-${Lv(ih(r))}`,`lucide-${r}`,n),...i}));return t.displayName=ih(r),t};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],La=je("arrow-down",$v);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Da=je("arrow-up",Fv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qv=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Uv=je("chevron-down",qv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Hl=je("circle-help",Bv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Hv=je("circle-plus",zv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Gv=je("circle-x",Kv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Qv=je("copy",Wv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Jv=je("eye",Yv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],ep=je("facebook",Xv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],e_=je("file-pen",Zv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],tp=je("file-text",t_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],np=je("github",n_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],i_=je("image",r_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],rp=je("instagram",s_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],a_=je("layout-dashboard",o_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],u_=je("link-2",l_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],ip=je("linkedin",c_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],f_=je("log-out",h_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],sp=je("mail",d_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],m_=je("maximize-2",p_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],sh=je("menu",g_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],v_=je("message-square",y_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],b_=je("minimize-2",__);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],op=je("palette",w_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],x_=je("refresh-cw",E_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ma=je("save",T_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],k_=je("settings",A_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Va=je("square-pen",S_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],N_=je("star",I_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ms=je("trash-2",O_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],ap=je("twitter",P_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],R_=je("type",C_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],L_=je("user",j_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],M_=je("wand-sparkles",D_),V_=({message:r,type:e})=>{if(!r||!e)return null;const t=e==="success"?"bg-green-500":"bg-red-500",n=e==="success"?P.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):P.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});return P.jsxs("div",{className:`fixed bottom-5 right-5 ${t} text-white px-4 py-2 rounded-md shadow-lg flex items-center z-[100] transition-opacity duration-300 animate-fade-in-out max-w-sm`,children:[n,P.jsx("span",{children:r})]})},$_=({isOpen:r,message:e,onConfirm:t,onCancel:n,confirmText:i="Confirm",cancelText:s="Cancel",title:o="Confirm Action"})=>r?P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:P.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full",children:[P.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:o}),P.jsx("p",{className:"text-sm text-gray-600 mb-6 whitespace-pre-wrap",children:e}),P.jsxs("div",{className:"flex justify-end space-x-3",children:[P.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm",children:s}),P.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:i})]})]})}):null,lp=Y.createContext(void 0),un=()=>{const r=Y.useContext(lp);if(!r)throw new Error("useNotifications must be used within a NotificationProvider");return r},up=({children:r})=>{const[e,t]=Y.useState(null),[n,i]=Y.useState(null),s=Y.useRef(null),[o,a]=Y.useState(null),[l,c]=Y.useState(!1),h=Y.useCallback((g,y="success",m=3e3)=>{s.current&&clearTimeout(s.current),t(g),i(y),s.current=setTimeout(()=>{t(null),i(null),s.current=null},m)},[]);Y.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]);const d=Y.useCallback(g=>{a(g),c(!0)},[]),f=()=>{o!=null&&o.onConfirm&&o.onConfirm(),c(!1),a(null)},p=()=>{c(!1),a(null)},_={showToast:h,requestConfirmation:d};return P.jsxs(lp.Provider,{value:_,children:[r,P.jsx(V_,{message:e,type:n}),o&&P.jsx($_,{isOpen:l,message:o.message,onConfirm:f,onCancel:p,confirmText:o.confirmText||"Confirm Delete",cancelText:o.cancelText,title:o.title})]})},Pt={en:{generalInfo:{title:"General Information",siteTitle:"Tiger3Homs",siteRole:"Website Developer & Tech Enthusiast",logoUrl:"https://raw.githubusercontent.com/tiger3homs/home/refs/heads/main/public/logo.png",footerText:"© 2025. Built and designed by Tiger3homs"},about:{title:"About Me",description:"I'm a passionate software developer with expertise in web development and system architecture. I love building efficient, scalable solutions and contributing to open-source projects. When I'm not coding, you can find me exploring new technologies and sharing knowledge with the developer community."},projects:{title:"Featured Projects",project1:{title:"OS Design v1",description:"The website offers a sleek, intuitive design with straightforward navigation and professional fonts. It highlights the company's services and expertise, making it easy for visitors to get in touch. Simple visuals and effective calls-to-action ensure a smooth and engaging experience. For more information, explore the site.",tags:["Modern","User-friendly","Professional"],link:""},project2:{title:"Project 2",description:"Coming soon.",tags:["Wait","For","It"],link:""},project3:{title:"New Project",description:"This is a new project description.",tags:["New","Exciting","Innovative"],link:""}},contact:{title:"Contact Me",nameLabel:"Name",namePlaceholder:"Enter your name",emailLabel:"Email",emailPlaceholder:"Enter your email",messageLabel:"Message",messagePlaceholder:"Enter your message",submitButton:"Send Message"},services:{title:"Services",list:[{title:"Web Development",description:"Building modern, responsive websites tailored to your needs."},{title:"UI/UX Design",description:"Crafting user-friendly and visually appealing designs."},{title:"SEO Optimization",description:"Improving your website's visibility on search engines."},{title:"Consulting",description:"Providing expert advice to help you achieve your goals."}]}}},F_={title:"New Project Title",description:"New project description.",tags:["Tag1","Tag2"],link:""},q_=(r,e,t)=>{if(!e||e.length===0)return r;const n=typeof structuredClone=="function"?structuredClone(r):JSON.parse(JSON.stringify(r));let i=n;for(let o=0;o<e.length-1;o++){const a=e[o];if(i[a]===void 0||i[a]===null){const l=typeof e[o+1]=="number";i[a]=l?[]:{}}if(Array.isArray(i)&&typeof a=="number")for(;i.length<=a;)i.push(void 0);else if(typeof i!="object"||i===null)return console.error("Cannot traverse into non-object:",i,"at path segment",a),r;i=i[a]}const s=e[e.length-1];if(typeof i!="object"||i===null)return console.error("Cannot set property on non-object/array:",i,"at path",e),r;if(Array.isArray(i)&&typeof s=="number")for(;i.length<=s;)i.push(void 0);return i[s]=t,n},Vs=r=>r?r.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()):"",ti="translations/en",U_={title:"New Service Title",description:"New service description."},B_=()=>{var _;const[r,e]=Y.useState(Pt),[t,n]=Y.useState(!0),[i,s]=Y.useState(""),{showToast:o}=un();Y.useEffect(()=>{if(!de){console.error("Firestore instance is not available."),s("Error: Firestore connection failed."),n(!1);return}const g=nt(de,ti);n(!0);const y=zl(g,m=>{if(m.exists()){const b=m.data();e(S=>({...S,en:b}))}else e(Pt),console.log("No translations document found in Firestore, using defaults.");n(!1)},m=>{console.error("Firestore snapshot error:",m),s("Error fetching data from Firestore."),n(!1)});return()=>y()},[]);const a=Y.useCallback((g,y)=>{e(m=>{const b="en";if(!g||g.length===0)return m;const S=q_(m[b],g,y);return{...m,[b]:S}}),s("")},[]),l=Y.useCallback(()=>{e(g=>{const y=`project_${Date.now()}`,m={...g.en};return(typeof m.projects!="object"||m.projects===null)&&(m.projects={title:Pt.en.projects.title}),m.projects[y]={...F_},{...g,en:m}}),s("New project added. Edit details and save.")},[]),c=Y.useCallback(()=>{e(g=>{var v;const y=(v=g.en)==null?void 0:v.services,b=[...Array.isArray(y==null?void 0:y.list)?y.list:[],{...U_}],S={...g.en,services:{...y||{title:Pt.en.services.title||"Services",list:[]},list:b}};return{...g,en:S}}),s("New service added. Edit details and save.")},[]),h=async g=>{const y=g||r.en;if(!de){s("Error: Firestore connection failed.");return}s("Saving...");try{const m=nt(de,ti);await ja(m,y,{merge:!0}),o("Content changes saved successfully!","success"),s("")}catch(m){console.error("Failed to save translations to Firestore:",m),o("Error saving content changes.","error"),s("")}finally{}},d=async g=>{if(!de){s("Error: Firestore connection failed.");return}s("Deleting item...");const y=nt(de,ti);try{await Ds(y,{[g]:Pv()}),o("Item deleted successfully!","success"),s("")}catch(m){console.error("Failed to delete item from Firestore:",m),o("Error deleting item.","error"),s("")}},f=Y.useCallback(async g=>{var y;if(!g||g.length<1){console.error("Invalid path for deletion:",g),s("Error: Invalid deletion path.");return}if(g[0]==="services"&&g[1]==="list"&&typeof g[2]=="number"){const m=g[2],b=(y=r.en.services)==null?void 0:y.list;if(!Array.isArray(b)){console.error("Cannot delete service item: services.list is not an array or is missing.",b),s("Error: Services data structure issue.");return}const S=b.filter((O,R)=>R!==m);if(!de){s("Error: Firestore connection failed.");return}s("Deleting service item...");const v=nt(de,ti);try{await Ds(v,{"services.list":S}),o("Service item deleted.","success"),s("")}catch(O){console.error("Failed to update services list in Firestore:",O),o("Error deleting service item.","error"),s("")}}else{const m=g.join(".");if(!m){console.error("Generated empty field path for deletion:",g),s("Error: Could not determine field to delete.");return}await d(m)}},[(_=r.en.services)==null?void 0:_.list]);return{translations:r,isLoading:t,saveStatus:i,setSaveStatus:s,setTranslations:e,handleInputChange:a,handleAddNewProject:l,handleAddNewService:c,saveChanges:h,handleDeleteItem:f,resetToDefaults:async()=>{if(!de){s("Error: Firestore connection failed.");return}if(window.confirm("Are you sure you want to reset the English text content (About, Contact, Services, General Info) to the default values? This cannot be undone and does not affect Projects, Styles, or Social Links.")){s("Resetting...");const g={...Pt.en,projects:r.en.projects};try{const y=nt(de,ti);await ja(y,g),o("Text content sections reset to defaults.","success"),s("")}catch(y){console.error("Failed to reset translations in Firestore:",y),o("Error resetting content.","error"),s("")}}}}},z_=({isMobile:r,isSidebarOpen:e,isDesktopSidebarCollapsed:t,onToggleMobileSidebar:n,onToggleDesktopSidebar:i,onLogout:s})=>{const[o,a]=Y.useState(!1);return P.jsx("nav",{className:"bg-white shadow-md fixed w-full z-10",children:P.jsxs("div",{className:"px-4 h-16 flex items-center justify-between",children:[P.jsxs("div",{className:"flex items-center space-x-4",children:[P.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 md:hidden","aria-label":"Toggle sidebar",children:P.jsx(sh,{size:24})}),P.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700 hidden md:block","aria-label":"Toggle sidebar",children:P.jsx(sh,{size:24})})]}),P.jsx("div",{className:"flex items-center space-x-4",children:P.jsxs("div",{className:"relative",children:[P.jsxs("button",{onClick:()=>a(!o),className:"flex items-center space-x-2 text-gray-700 hover:text-gray-900","aria-expanded":o,"aria-haspopup":"true",children:[P.jsx(L_,{size:20}),P.jsx("span",{children:"Admin"}),P.jsx(Uv,{size:16})]}),o&&P.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 border border-gray-200",children:P.jsxs("button",{onClick:()=>{s(),a(!1)},className:"w-full px-4 py-2 text-left text-red-600 hover:bg-gray-50 flex items-center space-x-2",children:[P.jsx(f_,{size:16}),P.jsx("span",{children:"Logout"})]})})]})})]})})},H_=({isMobile:r,isSidebarOpen:e,isDesktopSidebarCollapsed:t,activeTab:n,navItems:i,onTabClick:s,onCloseMobileSidebar:o})=>P.jsxs(P.Fragment,{children:[r&&e&&P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",onClick:o,"aria-hidden":"true"}),P.jsx("aside",{className:`fixed top-16 h-[calc(100vh-4rem)] bg-gray-800 text-white transition-transform duration-300 ease-in-out z-30 md:translate-x-0 md:transition-all md:duration-300
          ${r?e?"translate-x-0 w-64":"-translate-x-full w-64":t?"w-20":"w-64"}
        `,"aria-label":"Main Navigation",children:P.jsx("nav",{className:"p-4 overflow-y-auto h-full",children:i.map(a=>P.jsxs("button",{onClick:()=>s(a.tab),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${n===a.tab?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,"aria-current":n===a.tab?"page":void 0,children:[a.icon,P.jsx("span",{className:`${r&&e||!r&&!t?"inline":"hidden"}`,children:a.label})]},a.tab))})})]}),K_=({data:r,path:e,handleChange:t,editingPath:n,setEditingPath:i,handleAddProject:s,handleDelete:o,renderFields:a})=>{const{requestConfirmation:l}=un();return P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsxs("div",{className:"flex justify-between items-center mb-3",children:[P.jsx("h4",{className:"text-lg font-semibold capitalize",children:(r==null?void 0:r.title)||String(e[0]).replace(/([A-Z])/g," $1")}),P.jsx("button",{onClick:s,className:"bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded focus:outline-none focus:shadow-outline",children:"+ Add Project"})]}),(r==null?void 0:r.title)!==void 0&&typeof r.title=="string"&&a({title:r.title},e,t,n,i,void 0,void 0),Object.entries(r).map(([c,h])=>{if(c!=="title"&&typeof h=="object"&&h!==null&&!Array.isArray(h)){const d=[...e,c];return P.jsxs("div",{className:"mb-6 p-4 bg-white border border-gray-200 rounded-lg shadow-sm relative",children:[P.jsxs("div",{className:"flex justify-between items-start mb-3",children:[P.jsxs("h5",{className:"text-lg font-semibold text-gray-700 mr-4",children:["Project: ",P.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:c})]}),P.jsx("button",{onClick:()=>{l({message:`Are you sure you want to delete project "${c}"?
This action cannot be undone.`,onConfirm:()=>o(d),confirmText:"Delete Project",title:"Confirm Deletion"})},className:"bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete project ${c}`,children:"Delete Project"})]}),P.jsx("div",{className:"space-y-4",children:a(h,d,t,n,i,void 0,o)})]},d.join("."))}return null})]},e.join("."))},G_=({data:r,path:e,handleChange:t,editingPath:n,setEditingPath:i,handleDelete:s,handleAddService:o,renderFields:a})=>!r||typeof r!="object"?P.jsx("p",{children:"Error: Services data is missing or invalid."}):(Array.isArray(r.list)||console.warn("Services data is missing 'list' array."),P.jsxs(P.Fragment,{children:[P.jsx("button",{onClick:o,className:"mb-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-700 focus:ring-opacity-50","aria-label":"Add new service item",children:"Add New Service Item"}),a(r,e,t,n,i,void 0,s)]})),{min:W_,max:Q_}=Math,Bn=(r,e=0,t=1)=>W_(Q_(e,r),t),Kl=r=>{r._clipped=!1,r._unclipped=r.slice(0);for(let e=0;e<=3;e++)e<3?((r[e]<0||r[e]>255)&&(r._clipped=!0),r[e]=Bn(r[e],0,255)):e===3&&(r[e]=Bn(r[e],0,1));return r},cp={};for(let r of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])cp[`[object ${r}]`]=r.toLowerCase();function Ne(r){return cp[Object.prototype.toString.call(r)]||"object"}const xe=(r,e=null)=>r.length>=3?Array.prototype.slice.call(r):Ne(r[0])=="object"&&e?e.split("").filter(t=>r[0][t]!==void 0).map(t=>r[0][t]):r[0].slice(0),Or=r=>{if(r.length<2)return null;const e=r.length-1;return Ne(r[e])=="string"?r[e].toLowerCase():null},{PI:ho,min:hp,max:fp}=Math,Ct=r=>Math.round(r*100)/100,$a=r=>Math.round(r*100)/100,en=ho*2,Yo=ho/3,Y_=ho/180,J_=180/ho;function dp(r){return[...r.slice(0,3).reverse(),...r.slice(3)]}const be={format:{},autodetect:[]};class oe{constructor(...e){const t=this;if(Ne(e[0])==="object"&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];let n=Or(e),i=!1;if(!n){i=!0,be.sorted||(be.autodetect=be.autodetect.sort((s,o)=>o.p-s.p),be.sorted=!0);for(let s of be.autodetect)if(n=s.test(...e),n)break}if(be.format[n]){const s=be.format[n].apply(null,i?e:e.slice(0,-1));t._rgb=Kl(s)}else throw new Error("unknown format: "+e);t._rgb.length===3&&t._rgb.push(1)}toString(){return Ne(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const X_="3.1.2",Ae=(...r)=>new oe(...r);Ae.version=X_;const Er={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Z_=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,e1=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,pp=r=>{if(r.match(Z_)){(r.length===4||r.length===7)&&(r=r.substr(1)),r.length===3&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]);const e=parseInt(r,16),t=e>>16,n=e>>8&255,i=e&255;return[t,n,i,1]}if(r.match(e1)){(r.length===5||r.length===9)&&(r=r.substr(1)),r.length===4&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]);const e=parseInt(r,16),t=e>>24&255,n=e>>16&255,i=e>>8&255,s=Math.round((e&255)/255*100)/100;return[t,n,i,s]}throw new Error(`unknown hex color: ${r}`)},{round:ls}=Math,mp=(...r)=>{let[e,t,n,i]=xe(r,"rgba"),s=Or(r)||"auto";i===void 0&&(i=1),s==="auto"&&(s=i<1?"rgba":"rgb"),e=ls(e),t=ls(t),n=ls(n);let a="000000"+(e<<16|t<<8|n).toString(16);a=a.substr(a.length-6);let l="0"+ls(i*255).toString(16);switch(l=l.substr(l.length-2),s.toLowerCase()){case"rgba":return`#${a}${l}`;case"argb":return`#${l}${a}`;default:return`#${a}`}};oe.prototype.name=function(){const r=mp(this._rgb,"rgb");for(let e of Object.keys(Er))if(Er[e]===r)return e.toLowerCase();return r};be.format.named=r=>{if(r=r.toLowerCase(),Er[r])return pp(Er[r]);throw new Error("unknown color name: "+r)};be.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&Er[r.toLowerCase()])return"named"}});oe.prototype.alpha=function(r,e=!1){return r!==void 0&&Ne(r)==="number"?e?(this._rgb[3]=r,this):new oe([this._rgb[0],this._rgb[1],this._rgb[2],r],"rgb"):this._rgb[3]};oe.prototype.clipped=function(){return this._rgb._clipped||!1};const Gt={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},t1=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function nn(r){const e=t1.get(String(r).toLowerCase());if(!e)throw new Error("unknown Lab illuminant "+r);Gt.labWhitePoint=r,Gt.Xn=e[0],Gt.Zn=e[1]}function ki(){return Gt.labWhitePoint}const Gl=(...r)=>{r=xe(r,"lab");const[e,t,n]=r,[i,s,o]=n1(e,t,n),[a,l,c]=gp(i,s,o);return[a,l,c,r.length>3?r[3]:1]},n1=(r,e,t)=>{const{kE:n,kK:i,kKE:s,Xn:o,Yn:a,Zn:l}=Gt,c=(r+16)/116,h=.002*e+c,d=c-.005*t,f=h*h*h,p=d*d*d,_=f>n?f:(116*h-16)/i,g=r>s?Math.pow((r+16)/116,3):r/i,y=p>n?p:(116*d-16)/i,m=_*o,b=g*a,S=y*l;return[m,b,S]},Jo=r=>{const e=Math.sign(r);return r=Math.abs(r),(r<=.0031308?r*12.92:1.055*Math.pow(r,1/2.4)-.055)*e},gp=(r,e,t)=>{const{MtxAdaptMa:n,MtxAdaptMaI:i,MtxXYZ2RGB:s,RefWhiteRGB:o,Xn:a,Yn:l,Zn:c}=Gt,h=a*n.m00+l*n.m10+c*n.m20,d=a*n.m01+l*n.m11+c*n.m21,f=a*n.m02+l*n.m12+c*n.m22,p=o.X*n.m00+o.Y*n.m10+o.Z*n.m20,_=o.X*n.m01+o.Y*n.m11+o.Z*n.m21,g=o.X*n.m02+o.Y*n.m12+o.Z*n.m22,y=(r*n.m00+e*n.m10+t*n.m20)*(p/h),m=(r*n.m01+e*n.m11+t*n.m21)*(_/d),b=(r*n.m02+e*n.m12+t*n.m22)*(g/f),S=y*i.m00+m*i.m10+b*i.m20,v=y*i.m01+m*i.m11+b*i.m21,O=y*i.m02+m*i.m12+b*i.m22,R=Jo(S*s.m00+v*s.m10+O*s.m20),E=Jo(S*s.m01+v*s.m11+O*s.m21),w=Jo(S*s.m02+v*s.m12+O*s.m22);return[R*255,E*255,w*255]},Wl=(...r)=>{const[e,t,n,...i]=xe(r,"rgb"),[s,o,a]=yp(e,t,n),[l,c,h]=r1(s,o,a);return[l,c,h,...i.length>0&&i[0]<1?[i[0]]:[]]};function r1(r,e,t){const{Xn:n,Yn:i,Zn:s,kE:o,kK:a}=Gt,l=r/n,c=e/i,h=t/s,d=l>o?Math.pow(l,1/3):(a*l+16)/116,f=c>o?Math.pow(c,1/3):(a*c+16)/116,p=h>o?Math.pow(h,1/3):(a*h+16)/116;return[116*f-16,500*(d-f),200*(f-p)]}function Xo(r){const e=Math.sign(r);return r=Math.abs(r),(r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4))*e}const yp=(r,e,t)=>{r=Xo(r/255),e=Xo(e/255),t=Xo(t/255);const{MtxRGB2XYZ:n,MtxAdaptMa:i,MtxAdaptMaI:s,Xn:o,Yn:a,Zn:l,As:c,Bs:h,Cs:d}=Gt;let f=r*n.m00+e*n.m10+t*n.m20,p=r*n.m01+e*n.m11+t*n.m21,_=r*n.m02+e*n.m12+t*n.m22;const g=o*i.m00+a*i.m10+l*i.m20,y=o*i.m01+a*i.m11+l*i.m21,m=o*i.m02+a*i.m12+l*i.m22;let b=f*i.m00+p*i.m10+_*i.m20,S=f*i.m01+p*i.m11+_*i.m21,v=f*i.m02+p*i.m12+_*i.m22;return b*=g/c,S*=y/h,v*=m/d,f=b*s.m00+S*s.m10+v*s.m20,p=b*s.m01+S*s.m11+v*s.m21,_=b*s.m02+S*s.m12+v*s.m22,[f,p,_]};oe.prototype.lab=function(){return Wl(this._rgb)};const i1=(...r)=>new oe(...r,"lab");Object.assign(Ae,{lab:i1,getLabWhitePoint:ki,setLabWhitePoint:nn});be.format.lab=Gl;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"lab"),Ne(r)==="array"&&r.length===3)return"lab"}});oe.prototype.darken=function(r=1){const e=this,t=e.lab();return t[0]-=Gt.Kn*r,new oe(t,"lab").alpha(e.alpha(),!0)};oe.prototype.brighten=function(r=1){return this.darken(-r)};oe.prototype.darker=oe.prototype.darken;oe.prototype.brighter=oe.prototype.brighten;oe.prototype.get=function(r){const[e,t]=r.split("."),n=this[e]();if(t){const i=e.indexOf(t)-(e.substr(0,2)==="ok"?2:0);if(i>-1)return n[i];throw new Error(`unknown channel ${t} in mode ${e}`)}else return n};const{pow:s1}=Math,o1=1e-7,a1=20;oe.prototype.luminance=function(r,e="rgb"){if(r!==void 0&&Ne(r)==="number"){if(r===0)return new oe([0,0,0,this._rgb[3]],"rgb");if(r===1)return new oe([255,255,255,this._rgb[3]],"rgb");let t=this.luminance(),n=a1;const i=(o,a)=>{const l=o.interpolate(a,.5,e),c=l.luminance();return Math.abs(r-c)<o1||!n--?l:c>r?i(o,l):i(l,a)},s=(t>r?i(new oe([0,0,0]),this):i(this,new oe([255,255,255]))).rgb();return new oe([...s,this._rgb[3]])}return l1(...this._rgb.slice(0,3))};const l1=(r,e,t)=>(r=Zo(r),e=Zo(e),t=Zo(t),.2126*r+.7152*e+.0722*t),Zo=r=>(r/=255,r<=.03928?r/12.92:s1((r+.055)/1.055,2.4)),vt={},xr=(r,e,t=.5,...n)=>{let i=n[0]||"lrgb";if(!vt[i]&&!n.length&&(i=Object.keys(vt)[0]),!vt[i])throw new Error(`interpolation mode ${i} is not defined`);return Ne(r)!=="object"&&(r=new oe(r)),Ne(e)!=="object"&&(e=new oe(e)),vt[i](r,e,t).alpha(r.alpha()+t*(e.alpha()-r.alpha()))};oe.prototype.mix=oe.prototype.interpolate=function(r,e=.5,...t){return xr(this,r,e,...t)};oe.prototype.premultiply=function(r=!1){const e=this._rgb,t=e[3];return r?(this._rgb=[e[0]*t,e[1]*t,e[2]*t,t],this):new oe([e[0]*t,e[1]*t,e[2]*t,t],"rgb")};const{sin:u1,cos:c1}=Math,vp=(...r)=>{let[e,t,n]=xe(r,"lch");return isNaN(n)&&(n=0),n=n*Y_,[e,c1(n)*t,u1(n)*t]},Ql=(...r)=>{r=xe(r,"lch");const[e,t,n]=r,[i,s,o]=vp(e,t,n),[a,l,c]=Gl(i,s,o);return[a,l,c,r.length>3?r[3]:1]},h1=(...r)=>{const e=dp(xe(r,"hcl"));return Ql(...e)},{sqrt:f1,atan2:d1,round:p1}=Math,_p=(...r)=>{const[e,t,n]=xe(r,"lab"),i=f1(t*t+n*n);let s=(d1(n,t)*J_+360)%360;return p1(i*1e4)===0&&(s=Number.NaN),[e,i,s]},Yl=(...r)=>{const[e,t,n,...i]=xe(r,"rgb"),[s,o,a]=Wl(e,t,n),[l,c,h]=_p(s,o,a);return[l,c,h,...i.length>0&&i[0]<1?[i[0]]:[]]};oe.prototype.lch=function(){return Yl(this._rgb)};oe.prototype.hcl=function(){return dp(Yl(this._rgb))};const m1=(...r)=>new oe(...r,"lch"),g1=(...r)=>new oe(...r,"hcl");Object.assign(Ae,{lch:m1,hcl:g1});be.format.lch=Ql;be.format.hcl=h1;["lch","hcl"].forEach(r=>be.autodetect.push({p:2,test:(...e)=>{if(e=xe(e,r),Ne(e)==="array"&&e.length===3)return r}}));oe.prototype.saturate=function(r=1){const e=this,t=e.lch();return t[1]+=Gt.Kn*r,t[1]<0&&(t[1]=0),new oe(t,"lch").alpha(e.alpha(),!0)};oe.prototype.desaturate=function(r=1){return this.saturate(-r)};oe.prototype.set=function(r,e,t=!1){const[n,i]=r.split("."),s=this[n]();if(i){const o=n.indexOf(i)-(n.substr(0,2)==="ok"?2:0);if(o>-1){if(Ne(e)=="string")switch(e.charAt(0)){case"+":s[o]+=+e;break;case"-":s[o]+=+e;break;case"*":s[o]*=+e.substr(1);break;case"/":s[o]/=+e.substr(1);break;default:s[o]=+e}else if(Ne(e)==="number")s[o]=e;else throw new Error("unsupported value for Color.set");const a=new oe(s,n);return t?(this._rgb=a._rgb,this):a}throw new Error(`unknown channel ${i} in mode ${n}`)}else return s};oe.prototype.tint=function(r=.5,...e){return xr(this,"white",r,...e)};oe.prototype.shade=function(r=.5,...e){return xr(this,"black",r,...e)};const y1=(r,e,t)=>{const n=r._rgb,i=e._rgb;return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"rgb")};vt.rgb=y1;const{sqrt:ea,pow:er}=Math,v1=(r,e,t)=>{const[n,i,s]=r._rgb,[o,a,l]=e._rgb;return new oe(ea(er(n,2)*(1-t)+er(o,2)*t),ea(er(i,2)*(1-t)+er(a,2)*t),ea(er(s,2)*(1-t)+er(l,2)*t),"rgb")};vt.lrgb=v1;const _1=(r,e,t)=>{const n=r.lab(),i=e.lab();return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"lab")};vt.lab=_1;const Pr=(r,e,t,n)=>{let i,s;n==="hsl"?(i=r.hsl(),s=e.hsl()):n==="hsv"?(i=r.hsv(),s=e.hsv()):n==="hcg"?(i=r.hcg(),s=e.hcg()):n==="hsi"?(i=r.hsi(),s=e.hsi()):n==="lch"||n==="hcl"?(n="hcl",i=r.hcl(),s=e.hcl()):n==="oklch"&&(i=r.oklch().reverse(),s=e.oklch().reverse());let o,a,l,c,h,d;(n.substr(0,1)==="h"||n==="oklch")&&([o,l,h]=i,[a,c,d]=s);let f,p,_,g;return!isNaN(o)&&!isNaN(a)?(a>o&&a-o>180?g=a-(o+360):a<o&&o-a>180?g=a+360-o:g=a-o,p=o+t*g):isNaN(o)?isNaN(a)?p=Number.NaN:(p=a,(h==1||h==0)&&n!="hsv"&&(f=c)):(p=o,(d==1||d==0)&&n!="hsv"&&(f=l)),f===void 0&&(f=l+t*(c-l)),_=h+t*(d-h),n==="oklch"?new oe([_,f,p],n):new oe([p,f,_],n)},bp=(r,e,t)=>Pr(r,e,t,"lch");vt.lch=bp;vt.hcl=bp;const b1=r=>{if(Ne(r)=="number"&&r>=0&&r<=16777215){const e=r>>16,t=r>>8&255,n=r&255;return[e,t,n,1]}throw new Error("unknown num color: "+r)},w1=(...r)=>{const[e,t,n]=xe(r,"rgb");return(e<<16)+(t<<8)+n};oe.prototype.num=function(){return w1(this._rgb)};const E1=(...r)=>new oe(...r,"num");Object.assign(Ae,{num:E1});be.format.num=b1;be.autodetect.push({p:5,test:(...r)=>{if(r.length===1&&Ne(r[0])==="number"&&r[0]>=0&&r[0]<=16777215)return"num"}});const x1=(r,e,t)=>{const n=r.num(),i=e.num();return new oe(n+t*(i-n),"num")};vt.num=x1;const{floor:T1}=Math,A1=(...r)=>{r=xe(r,"hcg");let[e,t,n]=r,i,s,o;n=n*255;const a=t*255;if(t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const l=T1(e),c=e-l,h=n*(1-t),d=h+a*(1-c),f=h+a*c,p=h+a;switch(l){case 0:[i,s,o]=[p,f,h];break;case 1:[i,s,o]=[d,p,h];break;case 2:[i,s,o]=[h,p,f];break;case 3:[i,s,o]=[h,d,p];break;case 4:[i,s,o]=[f,h,p];break;case 5:[i,s,o]=[p,h,d];break}}return[i,s,o,r.length>3?r[3]:1]},k1=(...r)=>{const[e,t,n]=xe(r,"rgb"),i=hp(e,t,n),s=fp(e,t,n),o=s-i,a=o*100/255,l=i/(255-o)*100;let c;return o===0?c=Number.NaN:(e===s&&(c=(t-n)/o),t===s&&(c=2+(n-e)/o),n===s&&(c=4+(e-t)/o),c*=60,c<0&&(c+=360)),[c,a,l]};oe.prototype.hcg=function(){return k1(this._rgb)};const S1=(...r)=>new oe(...r,"hcg");Ae.hcg=S1;be.format.hcg=A1;be.autodetect.push({p:1,test:(...r)=>{if(r=xe(r,"hcg"),Ne(r)==="array"&&r.length===3)return"hcg"}});const I1=(r,e,t)=>Pr(r,e,t,"hcg");vt.hcg=I1;const{cos:tr}=Math,N1=(...r)=>{r=xe(r,"hsi");let[e,t,n]=r,i,s,o;return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e>360&&(e-=360),e<0&&(e+=360),e/=360,e<1/3?(o=(1-t)/3,i=(1+t*tr(en*e)/tr(Yo-en*e))/3,s=1-(o+i)):e<2/3?(e-=1/3,i=(1-t)/3,s=(1+t*tr(en*e)/tr(Yo-en*e))/3,o=1-(i+s)):(e-=2/3,s=(1-t)/3,o=(1+t*tr(en*e)/tr(Yo-en*e))/3,i=1-(s+o)),i=Bn(n*i*3),s=Bn(n*s*3),o=Bn(n*o*3),[i*255,s*255,o*255,r.length>3?r[3]:1]},{min:O1,sqrt:P1,acos:C1}=Math,R1=(...r)=>{let[e,t,n]=xe(r,"rgb");e/=255,t/=255,n/=255;let i;const s=O1(e,t,n),o=(e+t+n)/3,a=o>0?1-s/o:0;return a===0?i=NaN:(i=(e-t+(e-n))/2,i/=P1((e-t)*(e-t)+(e-n)*(t-n)),i=C1(i),n>t&&(i=en-i),i/=en),[i*360,a,o]};oe.prototype.hsi=function(){return R1(this._rgb)};const j1=(...r)=>new oe(...r,"hsi");Ae.hsi=j1;be.format.hsi=N1;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"hsi"),Ne(r)==="array"&&r.length===3)return"hsi"}});const L1=(r,e,t)=>Pr(r,e,t,"hsi");vt.hsi=L1;const Fa=(...r)=>{r=xe(r,"hsl");const[e,t,n]=r;let i,s,o;if(t===0)i=s=o=n*255;else{const a=[0,0,0],l=[0,0,0],c=n<.5?n*(1+t):n+t-n*t,h=2*n-c,d=e/360;a[0]=d+1/3,a[1]=d,a[2]=d-1/3;for(let f=0;f<3;f++)a[f]<0&&(a[f]+=1),a[f]>1&&(a[f]-=1),6*a[f]<1?l[f]=h+(c-h)*6*a[f]:2*a[f]<1?l[f]=c:3*a[f]<2?l[f]=h+(c-h)*(2/3-a[f])*6:l[f]=h;[i,s,o]=[l[0]*255,l[1]*255,l[2]*255]}return r.length>3?[i,s,o,r[3]]:[i,s,o,1]},wp=(...r)=>{r=xe(r,"rgba");let[e,t,n]=r;e/=255,t/=255,n/=255;const i=hp(e,t,n),s=fp(e,t,n),o=(s+i)/2;let a,l;return s===i?(a=0,l=Number.NaN):a=o<.5?(s-i)/(s+i):(s-i)/(2-s-i),e==s?l=(t-n)/(s-i):t==s?l=2+(n-e)/(s-i):n==s&&(l=4+(e-t)/(s-i)),l*=60,l<0&&(l+=360),r.length>3&&r[3]!==void 0?[l,a,o,r[3]]:[l,a,o]};oe.prototype.hsl=function(){return wp(this._rgb)};const D1=(...r)=>new oe(...r,"hsl");Ae.hsl=D1;be.format.hsl=Fa;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"hsl"),Ne(r)==="array"&&r.length===3)return"hsl"}});const M1=(r,e,t)=>Pr(r,e,t,"hsl");vt.hsl=M1;const{floor:V1}=Math,$1=(...r)=>{r=xe(r,"hsv");let[e,t,n]=r,i,s,o;if(n*=255,t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const a=V1(e),l=e-a,c=n*(1-t),h=n*(1-t*l),d=n*(1-t*(1-l));switch(a){case 0:[i,s,o]=[n,d,c];break;case 1:[i,s,o]=[h,n,c];break;case 2:[i,s,o]=[c,n,d];break;case 3:[i,s,o]=[c,h,n];break;case 4:[i,s,o]=[d,c,n];break;case 5:[i,s,o]=[n,c,h];break}}return[i,s,o,r.length>3?r[3]:1]},{min:F1,max:q1}=Math,U1=(...r)=>{r=xe(r,"rgb");let[e,t,n]=r;const i=F1(e,t,n),s=q1(e,t,n),o=s-i;let a,l,c;return c=s/255,s===0?(a=Number.NaN,l=0):(l=o/s,e===s&&(a=(t-n)/o),t===s&&(a=2+(n-e)/o),n===s&&(a=4+(e-t)/o),a*=60,a<0&&(a+=360)),[a,l,c]};oe.prototype.hsv=function(){return U1(this._rgb)};const B1=(...r)=>new oe(...r,"hsv");Ae.hsv=B1;be.format.hsv=$1;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"hsv"),Ne(r)==="array"&&r.length===3)return"hsv"}});const z1=(r,e,t)=>Pr(r,e,t,"hsv");vt.hsv=z1;function $s(r,e){let t=r.length;Array.isArray(r[0])||(r=[r]),Array.isArray(e[0])||(e=e.map(o=>[o]));let n=e[0].length,i=e[0].map((o,a)=>e.map(l=>l[a])),s=r.map(o=>i.map(a=>Array.isArray(o)?o.reduce((l,c,h)=>l+c*(a[h]||0),0):a.reduce((l,c)=>l+c*o,0)));return t===1&&(s=s[0]),n===1?s.map(o=>o[0]):s}const Jl=(...r)=>{r=xe(r,"lab");const[e,t,n,...i]=r,[s,o,a]=H1([e,t,n]),[l,c,h]=gp(s,o,a);return[l,c,h,...i.length>0&&i[0]<1?[i[0]]:[]]};function H1(r){var e=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],t=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],n=$s(t,r);return $s(e,n.map(i=>i**3))}const Xl=(...r)=>{const[e,t,n,...i]=xe(r,"rgb"),s=yp(e,t,n);return[...K1(s),...i.length>0&&i[0]<1?[i[0]]:[]]};function K1(r){const e=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],t=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],n=$s(e,r);return $s(t,n.map(i=>Math.cbrt(i)))}oe.prototype.oklab=function(){return Xl(this._rgb)};const G1=(...r)=>new oe(...r,"oklab");Object.assign(Ae,{oklab:G1});be.format.oklab=Jl;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"oklab"),Ne(r)==="array"&&r.length===3)return"oklab"}});const W1=(r,e,t)=>{const n=r.oklab(),i=e.oklab();return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"oklab")};vt.oklab=W1;const Q1=(r,e,t)=>Pr(r,e,t,"oklch");vt.oklch=Q1;const{pow:ta,sqrt:na,PI:ra,cos:oh,sin:ah,atan2:Y1}=Math,J1=(r,e="lrgb",t=null)=>{const n=r.length;t||(t=Array.from(new Array(n)).map(()=>1));const i=n/t.reduce(function(d,f){return d+f});if(t.forEach((d,f)=>{t[f]*=i}),r=r.map(d=>new oe(d)),e==="lrgb")return X1(r,t);const s=r.shift(),o=s.get(e),a=[];let l=0,c=0;for(let d=0;d<o.length;d++)if(o[d]=(o[d]||0)*t[0],a.push(isNaN(o[d])?0:t[0]),e.charAt(d)==="h"&&!isNaN(o[d])){const f=o[d]/180*ra;l+=oh(f)*t[0],c+=ah(f)*t[0]}let h=s.alpha()*t[0];r.forEach((d,f)=>{const p=d.get(e);h+=d.alpha()*t[f+1];for(let _=0;_<o.length;_++)if(!isNaN(p[_]))if(a[_]+=t[f+1],e.charAt(_)==="h"){const g=p[_]/180*ra;l+=oh(g)*t[f+1],c+=ah(g)*t[f+1]}else o[_]+=p[_]*t[f+1]});for(let d=0;d<o.length;d++)if(e.charAt(d)==="h"){let f=Y1(c/a[d],l/a[d])/ra*180;for(;f<0;)f+=360;for(;f>=360;)f-=360;o[d]=f}else o[d]=o[d]/a[d];return h/=n,new oe(o,e).alpha(h>.99999?1:h,!0)},X1=(r,e)=>{const t=r.length,n=[0,0,0,0];for(let i=0;i<r.length;i++){const s=r[i],o=e[i]/t,a=s._rgb;n[0]+=ta(a[0],2)*o,n[1]+=ta(a[1],2)*o,n[2]+=ta(a[2],2)*o,n[3]+=a[3]*o}return n[0]=na(n[0]),n[1]=na(n[1]),n[2]=na(n[2]),n[3]>.9999999&&(n[3]=1),new oe(Kl(n))},{pow:Z1}=Math;function Fs(r){let e="rgb",t=Ae("#ccc"),n=0,i=[0,1],s=[],o=[0,0],a=!1,l=[],c=!1,h=0,d=1,f=!1,p={},_=!0,g=1;const y=function(E){if(E=E||["#fff","#000"],E&&Ne(E)==="string"&&Ae.brewer&&Ae.brewer[E.toLowerCase()]&&(E=Ae.brewer[E.toLowerCase()]),Ne(E)==="array"){E.length===1&&(E=[E[0],E[0]]),E=E.slice(0);for(let w=0;w<E.length;w++)E[w]=Ae(E[w]);s.length=0;for(let w=0;w<E.length;w++)s.push(w/(E.length-1))}return O(),l=E},m=function(E){if(a!=null){const w=a.length-1;let N=0;for(;N<w&&E>=a[N];)N++;return N-1}return 0};let b=E=>E,S=E=>E;const v=function(E,w){let N,T;if(w==null&&(w=!1),isNaN(E)||E===null)return t;w?T=E:a&&a.length>2?T=m(E)/(a.length-2):d!==h?T=(E-h)/(d-h):T=1,T=S(T),w||(T=b(T)),g!==1&&(T=Z1(T,g)),T=o[0]+T*(1-o[0]-o[1]),T=Bn(T,0,1);const x=Math.floor(T*1e4);if(_&&p[x])N=p[x];else{if(Ne(l)==="array")for(let I=0;I<s.length;I++){const k=s[I];if(T<=k){N=l[I];break}if(T>=k&&I===s.length-1){N=l[I];break}if(T>k&&T<s[I+1]){T=(T-k)/(s[I+1]-k),N=Ae.interpolate(l[I],l[I+1],T,e);break}}else Ne(l)==="function"&&(N=l(T));_&&(p[x]=N)}return N};var O=()=>p={};y(r);const R=function(E){const w=Ae(v(E));return c&&w[c]?w[c]():w};return R.classes=function(E){if(E!=null){if(Ne(E)==="array")a=E,i=[E[0],E[E.length-1]];else{const w=Ae.analyze(i);E===0?a=[w.min,w.max]:a=Ae.limits(w,"e",E)}return R}return a},R.domain=function(E){if(!arguments.length)return i;h=E[0],d=E[E.length-1],s=[];const w=l.length;if(E.length===w&&h!==d)for(let N of Array.from(E))s.push((N-h)/(d-h));else{for(let N=0;N<w;N++)s.push(N/(w-1));if(E.length>2){const N=E.map((x,I)=>I/(E.length-1)),T=E.map(x=>(x-h)/(d-h));T.every((x,I)=>N[I]===x)||(S=x=>{if(x<=0||x>=1)return x;let I=0;for(;x>=T[I+1];)I++;const k=(x-T[I])/(T[I+1]-T[I]);return N[I]+k*(N[I+1]-N[I])})}}return i=[h,d],R},R.mode=function(E){return arguments.length?(e=E,O(),R):e},R.range=function(E,w){return y(E),R},R.out=function(E){return c=E,R},R.spread=function(E){return arguments.length?(n=E,R):n},R.correctLightness=function(E){return E==null&&(E=!0),f=E,O(),f?b=function(w){const N=v(0,!0).lab()[0],T=v(1,!0).lab()[0],x=N>T;let I=v(w,!0).lab()[0];const k=N+(T-N)*w;let j=I-k,V=0,z=1,H=20;for(;Math.abs(j)>.01&&H-- >0;)(function(){return x&&(j*=-1),j<0?(V=w,w+=(z-w)*.5):(z=w,w+=(V-w)*.5),I=v(w,!0).lab()[0],j=I-k})();return w}:b=w=>w,R},R.padding=function(E){return E!=null?(Ne(E)==="number"&&(E=[E,E]),o=E,R):o},R.colors=function(E,w){arguments.length<2&&(w="hex");let N=[];if(arguments.length===0)N=l.slice(0);else if(E===1)N=[R(.5)];else if(E>1){const T=i[0],x=i[1]-T;N=eb(0,E).map(I=>R(T+I/(E-1)*x))}else{r=[];let T=[];if(a&&a.length>2)for(let x=1,I=a.length,k=1<=I;k?x<I:x>I;k?x++:x--)T.push((a[x-1]+a[x])*.5);else T=i;N=T.map(x=>R(x))}return Ae[w]&&(N=N.map(T=>T[w]())),N},R.cache=function(E){return E!=null?(_=E,R):_},R.gamma=function(E){return E!=null?(g=E,R):g},R.nodata=function(E){return E!=null?(t=Ae(E),R):t},R}function eb(r,e,t){let n=[],i=r<e,s=e;for(let o=r;i?o<s:o>s;i?o++:o--)n.push(o);return n}const tb=function(r){let e=[1,1];for(let t=1;t<r;t++){let n=[1];for(let i=1;i<=e.length;i++)n[i]=(e[i]||0)+e[i-1];e=n}return e},nb=function(r){let e,t,n,i;if(r=r.map(s=>new oe(s)),r.length===2)[t,n]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>t[a]+s*(n[a]-t[a]));return new oe(o,"lab")};else if(r.length===3)[t,n,i]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>(1-s)*(1-s)*t[a]+2*(1-s)*s*n[a]+s*s*i[a]);return new oe(o,"lab")};else if(r.length===4){let s;[t,n,i,s]=r.map(o=>o.lab()),e=function(o){const a=[0,1,2].map(l=>(1-o)*(1-o)*(1-o)*t[l]+3*(1-o)*(1-o)*o*n[l]+3*(1-o)*o*o*i[l]+o*o*o*s[l]);return new oe(a,"lab")}}else if(r.length>=5){let s,o,a;s=r.map(l=>l.lab()),a=r.length-1,o=tb(a),e=function(l){const c=1-l,h=[0,1,2].map(d=>s.reduce((f,p,_)=>f+o[_]*c**(a-_)*l**_*p[d],0));return new oe(h,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return e},rb=r=>{const e=nb(r);return e.scale=()=>Fs(e),e},{round:Ep}=Math;oe.prototype.rgb=function(r=!0){return r===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Ep)};oe.prototype.rgba=function(r=!0){return this._rgb.slice(0,4).map((e,t)=>t<3?r===!1?e:Ep(e):e)};const ib=(...r)=>new oe(...r,"rgb");Object.assign(Ae,{rgb:ib});be.format.rgb=(...r)=>{const e=xe(r,"rgba");return e[3]===void 0&&(e[3]=1),e};be.autodetect.push({p:3,test:(...r)=>{if(r=xe(r,"rgba"),Ne(r)==="array"&&(r.length===3||r.length===4&&Ne(r[3])=="number"&&r[3]>=0&&r[3]<=1))return"rgb"}});const Ft=(r,e,t)=>{if(!Ft[t])throw new Error("unknown blend mode "+t);return Ft[t](r,e)},Pn=r=>(e,t)=>{const n=Ae(t).rgb(),i=Ae(e).rgb();return Ae.rgb(r(n,i))},Cn=r=>(e,t)=>{const n=[];return n[0]=r(e[0],t[0]),n[1]=r(e[1],t[1]),n[2]=r(e[2],t[2]),n},sb=r=>r,ob=(r,e)=>r*e/255,ab=(r,e)=>r>e?e:r,lb=(r,e)=>r>e?r:e,ub=(r,e)=>255*(1-(1-r/255)*(1-e/255)),cb=(r,e)=>e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255)),hb=(r,e)=>255*(1-(1-e/255)/(r/255)),fb=(r,e)=>r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r);Ft.normal=Pn(Cn(sb));Ft.multiply=Pn(Cn(ob));Ft.screen=Pn(Cn(ub));Ft.overlay=Pn(Cn(cb));Ft.darken=Pn(Cn(ab));Ft.lighten=Pn(Cn(lb));Ft.dodge=Pn(Cn(fb));Ft.burn=Pn(Cn(hb));const{pow:db,sin:pb,cos:mb}=Math;function gb(r=300,e=-1.5,t=1,n=1,i=[0,1]){let s=0,o;Ne(i)==="array"?o=i[1]-i[0]:(o=0,i=[i,i]);const a=function(l){const c=en*((r+120)/360+e*l),h=db(i[0]+o*l,n),f=(s!==0?t[0]+l*s:t)*h*(1-h)/2,p=mb(c),_=pb(c),g=h+f*(-.14861*p+1.78277*_),y=h+f*(-.29227*p-.90649*_),m=h+f*(1.97294*p);return Ae(Kl([g*255,y*255,m*255,1]))};return a.start=function(l){return l==null?r:(r=l,a)},a.rotations=function(l){return l==null?e:(e=l,a)},a.gamma=function(l){return l==null?n:(n=l,a)},a.hue=function(l){return l==null?t:(t=l,Ne(t)==="array"?(s=t[1]-t[0],s===0&&(t=t[1])):s=0,a)},a.lightness=function(l){return l==null?i:(Ne(l)==="array"?(i=l,o=l[1]-l[0]):(i=[l,l],o=0),a)},a.scale=()=>Ae.scale(a),a.hue(t),a}const yb="0123456789abcdef",{floor:vb,random:_b}=Math,bb=()=>{let r="#";for(let e=0;e<6;e++)r+=yb.charAt(vb(_b()*16));return new oe(r,"hex")},{log:lh,pow:wb,floor:Eb,abs:xb}=Math;function xp(r,e=null){const t={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Ne(r)==="object"&&(r=Object.values(r)),r.forEach(n=>{e&&Ne(n)==="object"&&(n=n[e]),n!=null&&!isNaN(n)&&(t.values.push(n),t.sum+=n,n<t.min&&(t.min=n),n>t.max&&(t.max=n),t.count+=1)}),t.domain=[t.min,t.max],t.limits=(n,i)=>Tp(t,n,i),t}function Tp(r,e="equal",t=7){Ne(r)=="array"&&(r=xp(r));const{min:n,max:i}=r,s=r.values.sort((a,l)=>a-l);if(t===1)return[n,i];const o=[];if(e.substr(0,1)==="c"&&(o.push(n),o.push(i)),e.substr(0,1)==="e"){o.push(n);for(let a=1;a<t;a++)o.push(n+a/t*(i-n));o.push(i)}else if(e.substr(0,1)==="l"){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");const a=Math.LOG10E*lh(n),l=Math.LOG10E*lh(i);o.push(n);for(let c=1;c<t;c++)o.push(wb(10,a+c/t*(l-a)));o.push(i)}else if(e.substr(0,1)==="q"){o.push(n);for(let a=1;a<t;a++){const l=(s.length-1)*a/t,c=Eb(l);if(c===l)o.push(s[c]);else{const h=l-c;o.push(s[c]*(1-h)+s[c+1]*h)}}o.push(i)}else if(e.substr(0,1)==="k"){let a;const l=s.length,c=new Array(l),h=new Array(t);let d=!0,f=0,p=null;p=[],p.push(n);for(let y=1;y<t;y++)p.push(n+y/t*(i-n));for(p.push(i);d;){for(let m=0;m<t;m++)h[m]=0;for(let m=0;m<l;m++){const b=s[m];let S=Number.MAX_VALUE,v;for(let O=0;O<t;O++){const R=xb(p[O]-b);R<S&&(S=R,v=O),h[v]++,c[m]=v}}const y=new Array(t);for(let m=0;m<t;m++)y[m]=null;for(let m=0;m<l;m++)a=c[m],y[a]===null?y[a]=s[m]:y[a]+=s[m];for(let m=0;m<t;m++)y[m]*=1/h[m];d=!1;for(let m=0;m<t;m++)if(y[m]!==p[m]){d=!0;break}p=y,f++,f>200&&(d=!1)}const _={};for(let y=0;y<t;y++)_[y]=[];for(let y=0;y<l;y++)a=c[y],_[a].push(s[y]);let g=[];for(let y=0;y<t;y++)g.push(_[y][0]),g.push(_[y][_[y].length-1]);g=g.sort((y,m)=>y-m),o.push(g[0]);for(let y=1;y<g.length;y+=2){const m=g[y];!isNaN(m)&&o.indexOf(m)===-1&&o.push(m)}}return o}const Tb=(r,e)=>{r=new oe(r),e=new oe(e);const t=r.luminance(),n=e.luminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const uh=.027,Ab=5e-4,kb=.1,ch=1.14,us=.022,hh=1.414,Sb=(r,e)=>{r=new oe(r),e=new oe(e),r.alpha()<1&&(r=xr(e,r,r.alpha(),"rgb"));const t=fh(...r.rgb()),n=fh(...e.rgb()),i=t>=us?t:t+Math.pow(us-t,hh),s=n>=us?n:n+Math.pow(us-n,hh),o=Math.pow(s,.56)-Math.pow(i,.57),a=Math.pow(s,.65)-Math.pow(i,.62),l=Math.abs(s-i)<Ab?0:i<s?o*ch:a*ch;return(Math.abs(l)<kb?0:l>0?l-uh:l+uh)*100};function fh(r,e,t){return .2126729*Math.pow(r/255,2.4)+.7151522*Math.pow(e/255,2.4)+.072175*Math.pow(t/255,2.4)}const{sqrt:Xt,pow:Xe,min:Ib,max:Nb,atan2:dh,abs:ph,cos:cs,sin:mh,exp:Ob,PI:gh}=Math;function Pb(r,e,t=1,n=1,i=1){var s=function(F){return 360*F/(2*gh)},o=function(F){return 2*gh*F/360};r=new oe(r),e=new oe(e);const[a,l,c]=Array.from(r.lab()),[h,d,f]=Array.from(e.lab()),p=(a+h)/2,_=Xt(Xe(l,2)+Xe(c,2)),g=Xt(Xe(d,2)+Xe(f,2)),y=(_+g)/2,m=.5*(1-Xt(Xe(y,7)/(Xe(y,7)+Xe(25,7)))),b=l*(1+m),S=d*(1+m),v=Xt(Xe(b,2)+Xe(c,2)),O=Xt(Xe(S,2)+Xe(f,2)),R=(v+O)/2,E=s(dh(c,b)),w=s(dh(f,S)),N=E>=0?E:E+360,T=w>=0?w:w+360,x=ph(N-T)>180?(N+T+360)/2:(N+T)/2,I=1-.17*cs(o(x-30))+.24*cs(o(2*x))+.32*cs(o(3*x+6))-.2*cs(o(4*x-63));let k=T-N;k=ph(k)<=180?k:T<=N?k+360:k-360,k=2*Xt(v*O)*mh(o(k)/2);const j=h-a,V=O-v,z=1+.015*Xe(p-50,2)/Xt(20+Xe(p-50,2)),H=1+.045*R,te=1+.015*R*I,K=30*Ob(-Xe((x-275)/25,2)),L=-(2*Xt(Xe(R,7)/(Xe(R,7)+Xe(25,7))))*mh(2*o(K)),$=Xt(Xe(j/(t*z),2)+Xe(V/(n*H),2)+Xe(k/(i*te),2)+L*(V/(n*H))*(k/(i*te)));return Nb(0,Ib(100,$))}function Cb(r,e,t="lab"){r=new oe(r),e=new oe(e);const n=r.get(t),i=e.get(t);let s=0;for(let o in n){const a=(n[o]||0)-(i[o]||0);s+=a*a}return Math.sqrt(s)}const Rb=(...r)=>{try{return new oe(...r),!0}catch{return!1}},jb={cool(){return Fs([Ae.hsl(180,1,.9),Ae.hsl(250,.7,.4)])},hot(){return Fs(["#000","#f00","#ff0","#fff"]).mode("rgb")}},qa={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Ap=Object.keys(qa),yh=new Map(Ap.map(r=>[r.toLowerCase(),r])),Lb=typeof Proxy=="function"?new Proxy(qa,{get(r,e){const t=e.toLowerCase();if(yh.has(t))return r[yh.get(t)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(Ap)}}):qa,Db=(...r)=>{r=xe(r,"cmyk");const[e,t,n,i]=r,s=r.length>4?r[4]:1;return i===1?[0,0,0,s]:[e>=1?0:255*(1-e)*(1-i),t>=1?0:255*(1-t)*(1-i),n>=1?0:255*(1-n)*(1-i),s]},{max:vh}=Math,Mb=(...r)=>{let[e,t,n]=xe(r,"rgb");e=e/255,t=t/255,n=n/255;const i=1-vh(e,vh(t,n)),s=i<1?1/(1-i):0,o=(1-e-i)*s,a=(1-t-i)*s,l=(1-n-i)*s;return[o,a,l,i]};oe.prototype.cmyk=function(){return Mb(this._rgb)};const Vb=(...r)=>new oe(...r,"cmyk");Object.assign(Ae,{cmyk:Vb});be.format.cmyk=Db;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"cmyk"),Ne(r)==="array"&&r.length===4)return"cmyk"}});const $b=(...r)=>{const e=xe(r,"hsla");let t=Or(r)||"lsa";return e[0]=Ct(e[0]||0)+"deg",e[1]=Ct(e[1]*100)+"%",e[2]=Ct(e[2]*100)+"%",t==="hsla"||e.length>3&&e[3]<1?(e[3]="/ "+(e.length>3?e[3]:1),t="hsla"):e.length=3,`${t.substr(0,3)}(${e.join(" ")})`},Fb=(...r)=>{const e=xe(r,"lab");let t=Or(r)||"lab";return e[0]=Ct(e[0])+"%",e[1]=Ct(e[1]),e[2]=Ct(e[2]),t==="laba"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lab(${e.join(" ")})`},qb=(...r)=>{const e=xe(r,"lch");let t=Or(r)||"lab";return e[0]=Ct(e[0])+"%",e[1]=Ct(e[1]),e[2]=isNaN(e[2])?"none":Ct(e[2])+"deg",t==="lcha"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lch(${e.join(" ")})`},Ub=(...r)=>{const e=xe(r,"lab");return e[0]=Ct(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=$a(e[2]),e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklab(${e.join(" ")})`},kp=(...r)=>{const[e,t,n,...i]=xe(r,"rgb"),[s,o,a]=Xl(e,t,n),[l,c,h]=_p(s,o,a);return[l,c,h,...i.length>0&&i[0]<1?[i[0]]:[]]},Bb=(...r)=>{const e=xe(r,"lch");return e[0]=Ct(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=isNaN(e[2])?"none":Ct(e[2])+"deg",e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklch(${e.join(" ")})`},{round:ia}=Math,zb=(...r)=>{const e=xe(r,"rgba");let t=Or(r)||"rgb";if(t.substr(0,3)==="hsl")return $b(wp(e),t);if(t.substr(0,3)==="lab"){const n=ki();nn("d50");const i=Fb(Wl(e),t);return nn(n),i}if(t.substr(0,3)==="lch"){const n=ki();nn("d50");const i=qb(Yl(e),t);return nn(n),i}return t.substr(0,5)==="oklab"?Ub(Xl(e)):t.substr(0,5)==="oklch"?Bb(kp(e)):(e[0]=ia(e[0]),e[1]=ia(e[1]),e[2]=ia(e[2]),(t==="rgba"||e.length>3&&e[3]<1)&&(e[3]="/ "+(e.length>3?e[3]:1),t="rgba"),`${t.substr(0,3)}(${e.slice(0,t==="rgb"?3:4).join(" ")})`)},Sp=(...r)=>{r=xe(r,"lch");const[e,t,n,...i]=r,[s,o,a]=vp(e,t,n),[l,c,h]=Jl(s,o,a);return[l,c,h,...i.length>0&&i[0]<1?[i[0]]:[]]},sn=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,Vt=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,qs=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,jt=/\s*/.source,Cr=/\s+/.source,Zl=/\s*,\s*/.source,fo=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,Rr=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,Ip=new RegExp("^rgba?\\("+jt+[sn,sn,sn].join(Cr)+Rr+"\\)$"),Np=new RegExp("^rgb\\("+jt+[sn,sn,sn].join(Zl)+jt+"\\)$"),Op=new RegExp("^rgba\\("+jt+[sn,sn,sn,Vt].join(Zl)+jt+"\\)$"),Pp=new RegExp("^hsla?\\("+jt+[fo,qs,qs].join(Cr)+Rr+"\\)$"),Cp=new RegExp("^hsl?\\("+jt+[fo,qs,qs].join(Zl)+jt+"\\)$"),Rp=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,jp=new RegExp("^lab\\("+jt+[Vt,Vt,Vt].join(Cr)+Rr+"\\)$"),Lp=new RegExp("^lch\\("+jt+[Vt,Vt,fo].join(Cr)+Rr+"\\)$"),Dp=new RegExp("^oklab\\("+jt+[Vt,Vt,Vt].join(Cr)+Rr+"\\)$"),Mp=new RegExp("^oklch\\("+jt+[Vt,Vt,fo].join(Cr)+Rr+"\\)$"),{round:Vp}=Math,nr=r=>r.map((e,t)=>t<=2?Bn(Vp(e),0,255):e),Ze=(r,e=0,t=100,n=!1)=>(typeof r=="string"&&r.endsWith("%")&&(r=parseFloat(r.substring(0,r.length-1))/100,n?r=e+(r+1)*.5*(t-e):r=e+r*(t-e)),+r),wt=(r,e)=>r==="none"?e:r,eu=r=>{if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];let e;if(be.format.named)try{return be.format.named(r)}catch{}if((e=r.match(Ip))||(e=r.match(Np))){let t=e.slice(1,4);for(let i=0;i<3;i++)t[i]=+Ze(wt(t[i],0),0,255);t=nr(t);const n=e[4]!==void 0?+Ze(e[4],0,1):1;return t[3]=n,t}if(e=r.match(Op)){const t=e.slice(1,5);for(let n=0;n<4;n++)t[n]=+Ze(t[n],0,255);return t}if((e=r.match(Pp))||(e=r.match(Cp))){const t=e.slice(1,4);t[0]=+wt(t[0].replace("deg",""),0),t[1]=+Ze(wt(t[1],0),0,100)*.01,t[2]=+Ze(wt(t[2],0),0,100)*.01;const n=nr(Fa(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}if(e=r.match(Rp)){const t=e.slice(1,4);t[1]*=.01,t[2]*=.01;const n=Fa(t);for(let i=0;i<3;i++)n[i]=Vp(n[i]);return n[3]=+e[4],n}if(e=r.match(jp)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,100),t[1]=Ze(wt(t[1],0),-125,125,!0),t[2]=Ze(wt(t[2],0),-125,125,!0);const n=ki();nn("d50");const i=nr(Gl(t));nn(n);const s=e[4]!==void 0?+Ze(e[4],0,1):1;return i[3]=s,i}if(e=r.match(Lp)){const t=e.slice(1,4);t[0]=Ze(t[0],0,100),t[1]=Ze(wt(t[1],0),0,150,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=ki();nn("d50");const i=nr(Ql(t));nn(n);const s=e[4]!==void 0?+Ze(e[4],0,1):1;return i[3]=s,i}if(e=r.match(Dp)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,1),t[1]=Ze(wt(t[1],0),-.4,.4,!0),t[2]=Ze(wt(t[2],0),-.4,.4,!0);const n=nr(Jl(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}if(e=r.match(Mp)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,1),t[1]=Ze(wt(t[1],0),0,.4,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=nr(Sp(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}};eu.test=r=>Ip.test(r)||Pp.test(r)||jp.test(r)||Lp.test(r)||Dp.test(r)||Mp.test(r)||Np.test(r)||Op.test(r)||Cp.test(r)||Rp.test(r)||r==="transparent";oe.prototype.css=function(r){return zb(this._rgb,r)};const Hb=(...r)=>new oe(...r,"css");Ae.css=Hb;be.format.css=eu;be.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&eu.test(r))return"css"}});be.format.gl=(...r)=>{const e=xe(r,"rgba");return e[0]*=255,e[1]*=255,e[2]*=255,e};const Kb=(...r)=>new oe(...r,"gl");Ae.gl=Kb;oe.prototype.gl=function(){const r=this._rgb;return[r[0]/255,r[1]/255,r[2]/255,r[3]]};oe.prototype.hex=function(r){return mp(this._rgb,r)};const Gb=(...r)=>new oe(...r,"hex");Ae.hex=Gb;be.format.hex=pp;be.autodetect.push({p:4,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&[3,4,5,6,7,8,9].indexOf(r.length)>=0)return"hex"}});const{log:hs}=Math,$p=r=>{const e=r/100;let t,n,i;return e<66?(t=255,n=e<6?0:-155.25485562709179-.44596950469579133*(n=e-2)+104.49216199393888*hs(n),i=e<20?0:-254.76935184120902+.8274096064007395*(i=e-10)+115.67994401066147*hs(i)):(t=351.97690566805693+.114206453784165*(t=e-55)-40.25366309332127*hs(t),n=325.4494125711974+.07943456536662342*(n=e-50)-28.0852963507957*hs(n),i=255),[t,n,i,1]},{round:Wb}=Math,Qb=(...r)=>{const e=xe(r,"rgb"),t=e[0],n=e[2];let i=1e3,s=4e4;const o=.4;let a;for(;s-i>o;){a=(s+i)*.5;const l=$p(a);l[2]/l[0]>=n/t?s=a:i=a}return Wb(a)};oe.prototype.temp=oe.prototype.kelvin=oe.prototype.temperature=function(){return Qb(this._rgb)};const sa=(...r)=>new oe(...r,"temp");Object.assign(Ae,{temp:sa,kelvin:sa,temperature:sa});be.format.temp=be.format.kelvin=be.format.temperature=$p;oe.prototype.oklch=function(){return kp(this._rgb)};const Yb=(...r)=>new oe(...r,"oklch");Object.assign(Ae,{oklch:Yb});be.format.oklch=Sp;be.autodetect.push({p:2,test:(...r)=>{if(r=xe(r,"oklch"),Ne(r)==="array"&&r.length===3)return"oklch"}});Object.assign(Ae,{analyze:xp,average:J1,bezier:rb,blend:Ft,brewer:Lb,Color:oe,colors:Er,contrast:Tb,contrastAPCA:Sb,cubehelix:gb,deltaE:Pb,distance:Cb,input:be,interpolate:xr,limits:Tp,mix:xr,random:bb,scale:Fs,scales:jb,valid:Rb});const Ce={primaryColor:"#377dc8",secondaryColor:"#0f3257",fontFamily:"'Noto Sans', sans-serif",titleColor:"#d7e3ee",h3TitleColor:"#d7e3ee",textColor:"#c6d3e2",backgroundFromColor:"#111827",backgroundToColor:"#1F2937",sectionBgColor:"#374151"},Jb=()=>{const[r,e]=Y.useState(Ce.primaryColor),[t,n]=Y.useState(Ce.secondaryColor),[i,s]=Y.useState(Ce.fontFamily),[o,a]=Y.useState(Ce.titleColor),[l,c]=Y.useState(Ce.h3TitleColor),[h,d]=Y.useState(Ce.textColor),[f,p]=Y.useState(Ce.backgroundFromColor),[_,g]=Y.useState(Ce.backgroundToColor),[y,m]=Y.useState(Ce.sectionBgColor),[b,S]=Y.useState(!0),[v,O]=Y.useState(!1),[R,E]=Y.useState(0),[w,N]=Y.useState([]),[T,x]=Y.useState(""),[I,k]=Y.useState(!0),{showToast:j,requestConfirmation:V}=un(),z=Y.useCallback(U=>{const M={};return Object.entries(U).forEach(([B,G])=>{const J=typeof G=="string"?G:"";M[B]=J.match(/^#[0-9A-F]{6}$/i)?J:Ce[B]||"#000000"}),M},[]),H=Y.useCallback(()=>{const U=document.documentElement,M=z({primaryColor:r,secondaryColor:t,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y});Object.entries(M).forEach(([B,G])=>{U.style.setProperty(`--${B.replace(/([A-Z])/g,"-$1").toLowerCase()}`,G)}),U.style.setProperty("--font-family",i)},[r,t,o,l,h,f,_,y,i,z]),te=Y.useCallback(async()=>{if(!de){console.error("Firestore not available"),j("Error: Firestore connection lost.","error"),S(!1),k(!1);return}S(!0),k(!0);try{const U=await Nv(nt(de,"settings","styles"));if(U.exists()){const G=U.data();e(G.primaryColor||Ce.primaryColor),n(G.secondaryColor||Ce.secondaryColor),s(G.fontFamily||Ce.fontFamily),a(G.titleColor||Ce.titleColor||"#ffffff"),c(G.h3TitleColor||Ce.h3TitleColor||"#d7e3ee"),d(G.textColor||Ce.textColor||"#c6d3e2"),p(G.backgroundFromColor||Ce.backgroundFromColor||"#111827"),g(G.backgroundToColor||Ce.backgroundToColor||"#1F2937"),m(G.sectionBgColor||Ce.sectionBgColor||"#374151")}else e(Ce.primaryColor),n(Ce.secondaryColor),s(Ce.fontFamily),a(Ce.titleColor??"#ffffff"),c(Ce.h3TitleColor??"#d7e3ee"),d(Ce.textColor??"#c6d3e2"),p(Ce.backgroundFromColor??"#111827"),g(Ce.backgroundToColor??"#1F2937"),m(Ce.sectionBgColor??"#374151");const B=(await Mi(br(de,"themes"))).docs.map(G=>({id:G.id,...G.data()}));N(B)}catch(U){console.error("Error loading data:",U),j("Failed to load styles or themes. Check console.","error")}finally{S(!1),k(!1)}},[j]),K=Y.useCallback(async()=>{if(!de){j("Error: Firestore connection lost.","error");return}O(!0);try{const U={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y};await ja(nt(de,"settings","styles"),U),j("Styles saved successfully!","success")}catch(U){console.error("Error saving styles:",U),j("Failed to save styles. Check console.","error")}finally{O(!1)}},[de,j,r,t,i,o,l,h,f,_,y]),q=Y.useCallback(async()=>{if(!de){j("Error: Firestore connection lost.","error");return}if(!T.trim()){j("Please enter a name for the theme.","error");return}O(!0);try{const U={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y},M={name:T.trim(),style:U},B=await Bl(br(de,"themes"),M);N(G=>[...G,{id:B.id,...M}]),x(""),j("Theme saved successfully!","success")}catch(U){console.error("Error saving theme:",U),j("Failed to save theme. Check console.","error")}finally{O(!1)}},[de,j,T,r,t,i,o,l,h,f,_,y]),L=Y.useCallback(async U=>{const M=w.find(B=>B.id===U);!de||!M||V({message:`Are you sure you want to delete the theme "${M.name}"?`,onConfirm:async()=>{if(!de){j("Error: Firestore connection lost.","error");return}try{await Ul(nt(de,"themes",U)),N(B=>B.filter(G=>G.id!==U)),j("Theme deleted successfully!","success")}catch(B){console.error("Error deleting theme:",B),j("Failed to delete theme. Check console.","error")}},confirmText:"Delete Theme",title:"Confirm Deletion"})},[de,V,j,w]),$=Y.useCallback(U=>{const{style:M}=U;e(M.primaryColor),n(M.secondaryColor),s(M.fontFamily),a(M.titleColor||Ce.titleColor||"#ffffff"),c(M.h3TitleColor||Ce.h3TitleColor||"#d7e3ee"),d(M.textColor||Ce.textColor||"#c6d3e2"),p(M.backgroundFromColor||Ce.backgroundFromColor||"#111827"),g(M.backgroundToColor||Ce.backgroundToColor||"#1F2937"),m(M.sectionBgColor||Ce.sectionBgColor||"#374151"),j(`Theme "${U.name}" applied!`,"success")},[j]),F=Y.useCallback(()=>{try{const U=Ae.valid(r)?Ae(r):Ae(Ce.primaryColor),M=R%3;let B;switch(M){case 1:B=U.set("hsl.h","+30").hex();break;case 2:B=U.set("hsl.h","+120").hex();break;default:B=U.set("hsl.h","+180").hex();break}n(B);const G=Ae.mix(f,_).luminance(),J=Ae.contrast(r,G>.5?"#000000":"#ffffff"),re=Ae.contrast(B,G>.5?"#000000":"#ffffff");a(J>4.5?r:G>.5?"#333333":"#eeeeee"),c(re>3?B:G>.5?"#555555":"#cccccc"),d(G>.5?"#666666":"#bbbbbb"),p(U.darken(2.2).desaturate(.5).hex()),g(U.darken(1.8).desaturate(.3).hex()),m(U.darken(1.5).desaturate(.4).hex()),E(ue=>ue+1),j(`AI colors generated (Mode ${M+1})!`,"success")}catch(U){console.error("Error generating AI colors:",U),j("Failed to generate colors. Check console.","error")}},[R,r,f,_,j]),W=Y.useCallback(U=>{e(U.primaryColor),n(U.secondaryColor),a(U.titleColor),c(U.h3TitleColor),d(U.textColor),p(U.backgroundFromColor),g(U.backgroundToColor),m(U.sectionBgColor)},[]);return Y.useEffect(()=>{te()},[te]),Y.useEffect(()=>{b||H()},[b,H]),{primaryColor:r,setPrimaryColor:e,secondaryColor:t,setSecondaryColor:n,fontFamily:i,setFontFamily:s,titleColor:o,setTitleColor:a,h3TitleColor:l,setH3TitleColor:c,textColor:h,setTextColor:d,backgroundFromColor:f,setBackgroundFromColor:p,backgroundToColor:_,setBackgroundToColor:g,sectionBgColor:y,setSectionBgColor:m,isLoading:b,isSaving:v,aiMode:R,savedThemes:w,newThemeName:T,setNewThemeName:x,isLoadingThemes:I,handleSaveStyles:K,handleSaveTheme:q,handleDeleteTheme:L,handleApplyTheme:$,handleGenerateAIColors:F,handleGlobalThemeSelect:W}},pn=({label:r,value:e,onChange:t,description:n})=>{const{showToast:i}=un(),s=l=>{const c=l.target.value;c.match(/^#?[0-9A-Fa-f]{0,6}$/)&&t(c.startsWith("#")?c:`#${c}`)},o=l=>{let c=l.target.value;c.startsWith("#")||(c=`#${c}`),c.length>1&&c.length<7&&(c=c.padEnd(7,c.substring(c.length-1).repeat(7-c.length))),c.match(/^#[0-9A-Fa-f]{6}$/i)?t(c):(t(e),i("Invalid hex color format. Reverted.","error"))},a=()=>{navigator.clipboard.writeText(e),i("Color code copied!","success")};return P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r}),P.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[P.jsx("input",{type:"color",value:e,onChange:l=>t(l.target.value),className:"h-10 w-10 p-1 border border-gray-300 rounded cursor-pointer self-start sm:self-center bg-white"}),P.jsx("input",{type:"text",value:e,onChange:s,onBlur:o,className:"w-full sm:flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",maxLength:7,placeholder:"#rrggbb"}),P.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 self-start sm:self-center",title:"Copy color code",type:"button",children:P.jsx(Qv,{size:20})})]}),n&&P.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n})]})},oa={light:{primaryColor:"#3b82f6",secondaryColor:"#6b7280",titleColor:"#1f2937",h3TitleColor:"#1f2937",textColor:"#1f2937",backgroundFromColor:"#ffffff",backgroundToColor:"#f3f4f6",sectionBgColor:"#f3f4f6"},dark:{primaryColor:"#60a5fa",secondaryColor:"#9ca3af",titleColor:"#f9fafb",h3TitleColor:"#f9fafb",textColor:"#f9fafb",backgroundFromColor:"#111827",backgroundToColor:"#1f2937",sectionBgColor:"#111827"},forest:{primaryColor:"#34d399",secondaryColor:"#6b7280",titleColor:"#064e3b",h3TitleColor:"#064e3b",textColor:"#064e3b",backgroundFromColor:"#d1fae5",backgroundToColor:"#ecfdf5",sectionBgColor:"#d1fae5"},ocean:{primaryColor:"#38bdf8",secondaryColor:"#94a3b8",titleColor:"#0c4a6e",h3TitleColor:"#0c4a6e",textColor:"#0c4a6e",backgroundFromColor:"#e0f2fe",backgroundToColor:"#f0f9ff",sectionBgColor:"#e0f2fe"},sunset:{primaryColor:"#fb7185",secondaryColor:"#f97316",titleColor:"#881337",h3TitleColor:"#881337",textColor:"#881337",backgroundFromColor:"#ffe4e6",backgroundToColor:"#fff1f2",sectionBgColor:"#ffe4e6"}},Xb=({onThemeSelect:r})=>{const e=[{name:"Light",value:"light",icon:"☀️"},{name:"Dark",value:"dark",icon:"🌙"},{name:"Forest",value:"forest",icon:"🌲"},{name:"Ocean",value:"ocean",icon:"🌊"},{name:"Sunset",value:"sunset",icon:"🌅"}],[t,n]=Y.useState(()=>{if(typeof window<"u"){const s=localStorage.getItem("theme");return s&&oa[s]?s:"light"}return"light"});Y.useEffect(()=>{if(typeof window<"u"){const s=Object.keys(oa);document.documentElement.classList.remove(...s),document.documentElement.classList.add(t),localStorage.setItem("theme",t)}},[t]);const i=s=>{const o=oa[s];o?(n(s),r(o)):console.warn(`Theme data not found for: ${s}`)};return P.jsx("div",{className:"theme-switcher",children:P.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2 p-1 sm:p-2 bg-[var(--color-background-secondary)] rounded-lg border border-gray-300 dark:border-gray-700",children:P.jsx("div",{className:"flex space-x-1",children:e.map(s=>P.jsx("button",{onClick:()=>i(s.value),className:`p-1 sm:p-2 rounded-md text-xs sm:text-sm transition-colors duration-150 ${t===s.value?"bg-[var(--color-primary)] text-white shadow-md":"bg-[var(--color-background-secondary)] text-[var(--color-text)] hover:bg-[var(--color-secondary)] hover:text-white"}`,title:s.name,children:P.jsx("span",{className:"flex items-center",children:P.jsx("span",{className:"mr-1",children:s.icon})})},s.value))})})})},Zb=[{id:"colors",label:"Colors",icon:P.jsx(op,{size:20})},{id:"typography",label:"Typography",icon:P.jsx(R_,{size:20})}],ew=()=>{const[r,e]=Y.useState("colors"),{primaryColor:t,setPrimaryColor:n,secondaryColor:i,setSecondaryColor:s,fontFamily:o,setFontFamily:a,titleColor:l,setTitleColor:c,h3TitleColor:h,setH3TitleColor:d,textColor:f,setTextColor:p,backgroundFromColor:_,setBackgroundFromColor:g,backgroundToColor:y,setBackgroundToColor:m,sectionBgColor:b,setSectionBgColor:S,isLoading:v,isSaving:O,aiMode:R,savedThemes:E,newThemeName:w,setNewThemeName:N,isLoadingThemes:T,handleSaveStyles:x,handleSaveTheme:I,handleDeleteTheme:k,handleApplyTheme:j,handleGenerateAIColors:V,handleGlobalThemeSelect:z}=Jb();return v?P.jsxs("div",{className:"flex items-center justify-center h-64 p-4 md:p-6",children:[P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),P.jsx("span",{className:"ml-3 text-gray-600",children:"Loading Styles..."})]}):P.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-4 md:p-6",children:[P.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[P.jsx("div",{className:"border-b border-gray-200 overflow-x-auto",children:P.jsx("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 whitespace-nowrap",children:Zb.map(H=>P.jsxs("button",{onClick:()=>e(H.id),className:`
                  flex items-center space-x-2 py-3 px-2 sm:py-4 sm:px-3 border-b-2 font-medium text-sm transition-colors duration-150 ease-in-out
                  ${r===H.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[H.icon,P.jsx("span",{className:"hidden sm:inline",children:H.label})]},H.id))})}),P.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[r==="colors"&&P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-4 sm:space-y-0",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Color Settings"}),P.jsxs("button",{onClick:V,className:"flex items-center justify-center sm:justify-start space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors w-full sm:w-auto text-sm",title:`Generate colors (Mode ${R%3+1})`,children:[P.jsx(M_,{size:16}),P.jsx("span",{children:"Generate AI Colors"})]})]}),P.jsx(pn,{label:"Primary Color",value:t,onChange:n,description:"Main brand color for buttons, links, etc."}),P.jsx(pn,{label:"Secondary Color",value:i,onChange:s,description:"Supporting color for accents, secondary actions."}),P.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[P.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Text Colors"}),P.jsx(pn,{label:"Title Color",value:l,onChange:c,description:"Color for main headings (h1, h2)."}),P.jsx(pn,{label:"Subtitle Color",value:h,onChange:d,description:"Color for subheadings (h3, h4)."}),P.jsx(pn,{label:"Body Text Color",value:f,onChange:p,description:"Default color for paragraphs and general text."})]}),P.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[P.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Background Colors"}),P.jsx(pn,{label:"Background Start",value:_,onChange:g,description:"Starting color for main background gradient."}),P.jsx(pn,{label:"Background End",value:y,onChange:m,description:"Ending color for main background gradient."}),P.jsx(pn,{label:"Section Background",value:b,onChange:S,description:"Background for content cards/sections."})]})]}),r==="typography"&&P.jsxs("div",{className:"space-y-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Typography Settings"}),P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{htmlFor:"fontFamilySelect",className:"block text-sm font-medium text-gray-700 mb-1",children:"Font Family"}),P.jsxs("select",{id:"fontFamilySelect",value:o,onChange:H=>a(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",children:[P.jsx("option",{value:"'Noto Sans', sans-serif",children:"Noto Sans"}),P.jsx("option",{value:"Arial, Helvetica, sans-serif",children:"Arial"})," ",P.jsx("option",{value:"Helvetica, Arial, sans-serif",children:"Helvetica"})," ",P.jsx("option",{value:"Georgia, serif",children:"Georgia"}),P.jsx("option",{value:"'Times New Roman', Times, serif",children:"Times New Roman"})]}),P.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select the primary font for the website."})]})]}),P.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:P.jsx("button",{onClick:x,disabled:O,className:`w-full flex items-center justify-center space-x-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${O?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:O?P.jsxs(P.Fragment,{children:[P.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),P.jsx("span",{children:"Saving..."})]}):P.jsxs(P.Fragment,{children:[P.jsx(Ma,{size:16}),P.jsx("span",{children:"Save Current Styles"})]})})})]})]}),P.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[P.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Saved Themes"}),T?P.jsxs("div",{className:"flex items-center justify-center h-20",children:[P.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),P.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading themes..."})]}):E.length>0?P.jsx("ul",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:E.map(H=>P.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors",children:[P.jsx("span",{className:"text-sm font-medium text-gray-800 truncate mr-2",title:H.name,children:H.name}),P.jsxs("div",{className:"flex space-x-2 flex-shrink-0",children:[P.jsx("button",{onClick:()=>j(H),className:"p-1 text-blue-600 hover:text-blue-800",title:"Apply Theme",children:P.jsx(x_,{size:16})}),P.jsx("button",{onClick:()=>k(H.id),className:"p-1 text-red-500 hover:text-red-700",title:"Delete Theme",children:P.jsx(Ms,{size:16})})]})]},H.id))}):P.jsx("p",{className:"text-sm text-gray-500",children:"No themes saved yet."}),P.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[P.jsx("label",{htmlFor:"newThemeName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Save Current as New Theme"}),P.jsxs("div",{className:"flex space-x-2",children:[P.jsx("input",{type:"text",id:"newThemeName",value:w,onChange:H=>N(H.target.value),placeholder:"Enter theme name",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 text-sm"}),P.jsx("button",{onClick:I,disabled:O||!w.trim(),className:`flex-shrink-0 px-3 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${O||!w.trim()?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,title:"Save current settings as a new theme",children:P.jsx(Ma,{size:16})})]})]})]}),P.jsx(Xb,{onThemeSelect:z})]})]})},_h=["Github","Facebook","Mail","Instagram","Linkedin","Twitter"],Fp={Github:np,Facebook:ep,Mail:sp,Instagram:rp,Linkedin:ip,Twitter:ap,HelpCircle:Hl},tw=({initialData:r,isEditing:e,onSubmit:t,onCancel:n})=>{const i={name:"",url:"",icon:_h[0]||"",order:0},[s,o]=Y.useState(r||i);Y.useEffect(()=>{o(r||i)},[r]);const a=h=>{const{name:d,value:f}=h.target;o(p=>({...p,[d]:d==="order"?parseInt(f,10)||0:f}))},l=h=>{if(h.preventDefault(),!s.name||!s.url||!s.icon){alert("Name, URL, and Icon are required.");return}t(s)},c=Fp[s.icon]||Hl;return P.jsxs("form",{onSubmit:l,className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg shadow-md",children:[P.jsx("h3",{className:"text-xl font-medium mb-4 text-gray-800",children:e?"Edit Link":"Add New Link"}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-name",className:"block text-sm font-medium text-gray-600 mb-1",children:"Name"}),P.jsx("input",{id:"link-name",type:"text",name:"name",placeholder:"Link Name (e.g., GitHub)",value:s.name,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-url",className:"block text-sm font-medium text-gray-600 mb-1",children:"URL"}),P.jsx("input",{id:"link-url",type:"url",name:"url",placeholder:"Full URL (e.g., https://github.com/user)",value:s.url,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-icon",className:"block text-sm font-medium text-gray-600 mb-1",children:"Icon"}),P.jsxs("div",{className:"flex items-center gap-2",children:[" ",P.jsxs("select",{id:"link-icon",name:"icon",value:s.icon,onChange:a,className:"flex-grow p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0,children:[P.jsx("option",{value:"",disabled:!0,children:"Select Icon"}),_h.map(h=>P.jsx("option",{value:h,children:h},h))]}),P.jsx(c,{size:24,className:"text-gray-500 flex-shrink-0"})]})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-order",className:"block text-sm font-medium text-gray-600 mb-1",children:"Order"}),P.jsx("input",{id:"link-order",type:"number",name:"order",placeholder:"Order (e.g., 1)",value:s.order,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0,min:"0"})]})]}),P.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[P.jsxs("button",{type:"submit",className:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[P.jsx(Ma,{size:18})," ",e?"Save Changes":"Add Link"]}),P.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md border border-gray-300",children:[P.jsx(Gv,{size:18})," Cancel"]})]})]})},nw=({link:r,index:e,isFirst:t,isLast:n,onEdit:i,onDelete:s,onMoveUp:o,onMoveDown:a})=>{const l=Fp[r.icon]||Hl;return P.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow p-4 md:grid md:grid-cols-12 md:gap-4 md:items-center md:bg-transparent md:hover:bg-gray-50 md:shadow-none md:rounded-none md:border-b md:border-gray-200 md:last:border-b-0 md:py-3 md:px-3 transition-colors duration-150",children:[P.jsxs("div",{className:"md:hidden space-y-3",children:[P.jsxs("div",{className:"flex justify-between items-start gap-2",children:[P.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[P.jsx(l,{size:20,className:"text-gray-500 flex-shrink-0"}),P.jsx("span",{className:"font-semibold text-lg text-gray-800 truncate",children:r.name})]}),P.jsxs("span",{className:"text-sm text-gray-500 flex-shrink-0",children:["(Order: ",r.order,")"]})]}),P.jsxs("div",{className:"text-sm break-words",children:[P.jsx("span",{className:"font-medium text-gray-500",children:"URL: "}),P.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r.url})]}),P.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200 mt-3",children:[P.jsx("button",{onClick:()=>o(e),disabled:t,className:`p-1 rounded ${t?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Up",children:P.jsx(Da,{size:18})}),P.jsx("button",{onClick:()=>a(e),disabled:n,className:`p-1 rounded ${n?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Down",children:P.jsx(La,{size:18})}),P.jsx("button",{onClick:()=>i(r),className:"text-yellow-500 hover:text-yellow-400 hover:bg-gray-100 p-1 rounded",title:"Edit",children:P.jsx(Va,{size:18})}),P.jsx("button",{onClick:()=>s(r.id),className:"text-red-600 hover:text-red-500 hover:bg-gray-100 p-1 rounded",title:"Delete",children:P.jsx(Ms,{size:18})})]})]}),P.jsxs("div",{className:"hidden md:contents",children:[" ",P.jsx("div",{className:"col-span-1 text-center text-gray-700",children:r.order}),P.jsx("div",{className:"col-span-1 flex items-center justify-center",children:P.jsx(l,{size:20,className:"text-gray-500"})}),P.jsx("div",{className:"col-span-3 truncate pr-2 text-gray-800",children:r.name}),P.jsx("div",{className:"col-span-4 truncate pr-2",children:P.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r.url})}),P.jsxs("div",{className:"col-span-3 flex items-center justify-end gap-1 pr-2",children:[" ",P.jsx("button",{onClick:()=>o(e),disabled:t,className:`p-1 rounded ${t?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Up",children:P.jsx(Da,{size:18})}),P.jsx("button",{onClick:()=>a(e),disabled:n,className:`p-1 rounded ${n?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Down",children:P.jsx(La,{size:18})}),P.jsx("button",{onClick:()=>i(r),className:"text-yellow-500 hover:text-yellow-400 hover:bg-gray-100 p-1 rounded",title:"Edit",children:P.jsx(Va,{size:18})}),P.jsx("button",{onClick:()=>s(r.id),className:"text-red-600 hover:text-red-500 hover:bg-gray-100 p-1 rounded",title:"Delete",children:P.jsx(Ms,{size:18})})]})]})]})},rw=()=>{const{showToast:r,requestConfirmation:e}=un(),[t,n]=Y.useState([]),[i,s]=Y.useState(!0),[o,a]=Y.useState(!1),[l,c]=Y.useState(null),[h,d]=Y.useState(null),f=Y.useMemo(()=>de?br(de,"socialLinks"):null,[]),p=Y.useCallback(async()=>{if(!de||!f){r("Error: Firestore is not initialized.","error"),s(!1);return}s(!0);try{const E=uo(f,co("order","asc")),N=(await Mi(E)).docs.map(T=>({...T.data(),id:T.id}));n(N)}catch(E){console.error("Error fetching social links:",E),r("Failed to load social links. Please try again.","error")}finally{s(!1)}},[f,r]);Y.useEffect(()=>{p()},[p]);const _=()=>{a(!1),c(null),d(null)},g=async E=>{if(!de||!f){r("Error: Firestore is not initialized.","error");return}try{const w=t.length>0?Math.max(...t.map(N=>N.order))+1:0;await Bl(f,{...E,order:w}),r("Link added successfully!","success"),_(),p()}catch(w){console.error("Error adding link:",w),r("Failed to add link. Please try again.","error")}},y=async E=>{if(!l||!de){r("Error: Cannot update link or Firestore is not initialized.","error");return}try{const w=nt(de,"socialLinks",l);await Ds(w,E),r("Link updated successfully!","success"),_(),p()}catch(w){console.error("Error updating link:",w),r("Failed to update link. Please try again.","error")}},m=async(E,w)=>{if(!de){r("Error: Firestore is not initialized.","error");return}const N=w==="up"?E-1:E+1;if(N<0||N>=t.length)return;const T=t[E],x=t[N],I=Xd(de),k=nt(de,"socialLinks",T.id),j=nt(de,"socialLinks",x.id);I.update(k,{order:x.order}),I.update(j,{order:T.order});try{await I.commit(),r(`Link moved ${w} successfully.`,"success"),p()}catch(V){console.error(`Error moving link ${w}:`,V),r("Failed to reorder link. Please try again.","error")}},b=E=>m(E,"up"),S=E=>m(E,"down"),v=async E=>{const w=t.find(N=>N.id===E);w&&e({message:`Are you sure you want to delete the link "${w.name}"?`,onConfirm:async()=>{if(!de){r("Error: Firestore is not initialized.","error");return}try{const N=nt(de,"socialLinks",E);await Ul(N),r("Link deleted successfully!","success"),p(),l===E&&_()}catch(N){console.error("Error deleting link:",N),r("Failed to delete link. Please try again.","error")}},confirmText:"Delete Link",title:"Confirm Deletion"})},O=E=>{c(E.id),d({name:E.name,url:E.url,icon:E.icon,order:E.order}),a(!1)},R=E=>{l?y(E):g(E)};return P.jsxs("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow-lg text-gray-800",children:[P.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-900",children:"Manage Social Links"}),i&&P.jsx("p",{className:"text-center text-gray-500",children:"Loading links..."}),(o||l)&&P.jsx(tw,{initialData:h,isEditing:!!l,onSubmit:R,onCancel:_},l||"add-form"),!o&&!l&&!i&&P.jsxs("button",{onClick:()=>{a(!0),c(null),d(null)},className:"mb-6 flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[P.jsx(Hv,{size:18})," Add New Link"]}),!i&&t.length>0&&P.jsxs("div",{className:"space-y-3",children:[P.jsxs("div",{className:"hidden md:grid md:grid-cols-12 gap-4 bg-gray-100 border-b border-gray-300 rounded-t-lg p-3 font-semibold text-gray-600 items-center sticky top-0 z-10",children:[P.jsx("div",{className:"col-span-1 text-center",children:"Order"}),P.jsx("div",{className:"col-span-1 text-center",children:"Icon"}),P.jsx("div",{className:"col-span-3",children:"Name"}),P.jsx("div",{className:"col-span-4",children:"URL"}),P.jsx("div",{className:"col-span-3 text-right pr-2",children:"Actions"})]}),t.map((E,w)=>P.jsx(nw,{link:E,index:w,isFirst:w===0,isLast:w===t.length-1,onEdit:O,onDelete:v,onMoveUp:b,onMoveDown:S},E.id))]}),!i&&t.length===0&&!o&&P.jsxs("div",{className:"text-center text-gray-500 mt-6 p-6 border border-dashed border-gray-300 rounded-lg bg-gray-50",children:[P.jsx("p",{className:"font-medium",children:"No social links found."}),P.jsx("p",{className:"text-sm mt-1",children:'Click "Add New Link" above to get started.'})]})]})},bh=({fieldKey:r,value:e,path:t,handleChange:n,editingPath:i,setEditingPath:s})=>{const o=t.join("."),a=i===o,l=r.replace(/([A-Z])/g," $1").replace(/^./,h=>h.toUpperCase()),c=/url|link/i.test(r);return P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:l}),a?c?P.jsx("input",{type:"url",id:o,name:o,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:h=>n(t,h.target.value),onBlur:()=>s(null),autoFocus:!0}):P.jsx("textarea",{id:o,name:o,rows:e.length>100?5:3,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:h=>n(t,h.target.value),onBlur:()=>s(null),autoFocus:!0}):P.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[40px] whitespace-pre-wrap text-gray-800 transition-colors duration-150 ease-in-out break-words",onClick:()=>s(o),children:e||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},o)},iw=({translations:r,handleInputChange:e,editingPath:t,setEditingPath:n,getStaticSectionName:i})=>{const s=r.en.generalInfo,o=r.en.about;return P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[P.jsxs("div",{className:"space-y-4",children:[" ",s?Object.entries(s).map(([a,l])=>typeof l=="string"?P.jsx(bh,{fieldKey:a,value:l,path:["generalInfo",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):P.jsx("p",{className:"text-gray-500 italic",children:"General Info data not available."})]}),P.jsxs("div",{className:"space-y-4",children:[" ",P.jsx("h3",{className:"text-xl font-semibold text-gray-800 capitalize border-b border-gray-300 pb-2 mb-4",children:i("about")}),o?Object.entries(o).map(([a,l])=>typeof l=="string"?P.jsx(bh,{fieldKey:a,value:l,path:["about",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):P.jsx("p",{className:"text-gray-500 italic",children:"About section data not available."})]})]})},sw=()=>{const{showToast:r,requestConfirmation:e}=un(),[t,n]=Y.useState([]),[i,s]=Y.useState(!1),[o,a]=Y.useState(null),l=Y.useMemo(()=>de?br(de,"pages"):null,[]),c=Y.useCallback(async()=>{if(!de||!l){r("Error: Firestore database is not initialized.","error"),s(!1);return}s(!0);try{const m=uo(l,co("order","asc")),S=(await Mi(m)).docs.map(v=>({id:v.id,...v.data()}));n(S)}catch(m){console.error("Error fetching pages:",m),r("Failed to load pages. Check console for details.","error")}finally{s(!1)}},[l,r]);Y.useEffect(()=>{c()},[c]);const h=Y.useCallback(()=>{a(null)},[]),d=Y.useCallback(async m=>{if(s(!0),!de){r("Error: Firestore database is not initialized.","error"),s(!1);return}try{let b;if(o){const v=t.find(O=>O.id===o);b=(v==null?void 0:v.order)??0}else b=t.length>0?Math.max(...t.map(v=>v.order))+1:0;const S={...m,order:b};if(o){const v=nt(de,"pages",o);await Ds(v,S),r("Page updated successfully!","success")}else{if(!l)throw new Error("Collection reference not available");await Bl(l,S),r("Page added successfully!","success")}h(),c()}catch(b){console.error("Error saving page:",b),r("Failed to save page. Check console for details.","error"),s(!1)}},[de,l,o,t,r,c,h]),f=Y.useCallback(m=>{var b;if(!m){r("Cannot delete page: Invalid ID.","error");return}e({message:`Are you sure you want to delete the page "${((b=t.find(S=>S.id===m))==null?void 0:b.title)||m}"?
This action cannot be undone.`,onConfirm:async()=>{if(!de){r("Error: Firestore database is not initialized.","error"),s(!1);return}s(!0);try{const S=nt(de,"pages",m);await Ul(S),r("Page deleted successfully!","success"),o===m&&h(),c()}catch(S){console.error("Error deleting page:",S),r("Failed to delete page. Check console for details.","error"),s(!1)}},confirmText:"Delete Page",title:"Confirm Deletion"})},[de,t,o,r,e,c,h]),p=Y.useCallback(m=>{if(!m.id){r("Cannot edit page: Invalid ID.","error");return}a(m.id)},[r]),_=Y.useCallback(async(m,b)=>{const S=b==="up"?m-1:m+1;if(S<0||S>=t.length)return;if(!de||!l){r("Error: Firestore database or collection ref is not initialized.","error");return}s(!0);const v=t[m],O=t[S],R=Xd(de),E=nt(l,v.id),w=nt(l,O.id);R.update(E,{order:O.order}),R.update(w,{order:v.order});try{await R.commit(),r(`Page moved ${b} successfully.`,"success"),c()}catch(N){console.error(`Error moving page ${b}:`,N),r("Failed to reorder page. Please try again.","error"),s(!1)}},[de,l,t,r,c]),g=Y.useCallback(m=>_(m,"up"),[_]),y=Y.useCallback(m=>_(m,"down"),[_]);return{pages:t,isLoading:i,isEditing:o,handleFormSubmit:d,handleDelete:f,startEditing:p,resetForm:h,handleMoveUp:g,handleMoveDown:y}};function ow(){this.__data__=[],this.size=0}var aw=ow;function lw(r,e){return r===e||r!==r&&e!==e}var qp=lw,uw=qp;function cw(r,e){for(var t=r.length;t--;)if(uw(r[t][0],e))return t;return-1}var po=cw,hw=po,fw=Array.prototype,dw=fw.splice;function pw(r){var e=this.__data__,t=hw(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():dw.call(e,t,1),--this.size,!0}var mw=pw,gw=po;function yw(r){var e=this.__data__,t=gw(e,r);return t<0?void 0:e[t][1]}var vw=yw,_w=po;function bw(r){return _w(this.__data__,r)>-1}var ww=bw,Ew=po;function xw(r,e){var t=this.__data__,n=Ew(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var Tw=xw,Aw=aw,kw=mw,Sw=vw,Iw=ww,Nw=Tw;function jr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}jr.prototype.clear=Aw;jr.prototype.delete=kw;jr.prototype.get=Sw;jr.prototype.has=Iw;jr.prototype.set=Nw;var mo=jr,Ow=mo;function Pw(){this.__data__=new Ow,this.size=0}var Cw=Pw;function Rw(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var jw=Rw;function Lw(r){return this.__data__.get(r)}var Dw=Lw;function Mw(r){return this.__data__.has(r)}var Vw=Mw,$w=typeof Ke=="object"&&Ke&&Ke.Object===Object&&Ke,Up=$w,Fw=Up,qw=typeof self=="object"&&self&&self.Object===Object&&self,Uw=Fw||qw||Function("return this")(),cn=Uw,Bw=cn,zw=Bw.Symbol,tu=zw,wh=tu,Bp=Object.prototype,Hw=Bp.hasOwnProperty,Kw=Bp.toString,ni=wh?wh.toStringTag:void 0;function Gw(r){var e=Hw.call(r,ni),t=r[ni];try{r[ni]=void 0;var n=!0}catch{}var i=Kw.call(r);return n&&(e?r[ni]=t:delete r[ni]),i}var Ww=Gw,Qw=Object.prototype,Yw=Qw.toString;function Jw(r){return Yw.call(r)}var Xw=Jw,Eh=tu,Zw=Ww,e2=Xw,t2="[object Null]",n2="[object Undefined]",xh=Eh?Eh.toStringTag:void 0;function r2(r){return r==null?r===void 0?n2:t2:xh&&xh in Object(r)?Zw(r):e2(r)}var go=r2;function i2(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var zp=i2,s2=go,o2=zp,a2="[object AsyncFunction]",l2="[object Function]",u2="[object GeneratorFunction]",c2="[object Proxy]";function h2(r){if(!o2(r))return!1;var e=s2(r);return e==l2||e==u2||e==a2||e==c2}var Hp=h2,f2=cn,d2=f2["__core-js_shared__"],p2=d2,aa=p2,Th=function(){var r=/[^.]+$/.exec(aa&&aa.keys&&aa.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function m2(r){return!!Th&&Th in r}var g2=m2,y2=Function.prototype,v2=y2.toString;function _2(r){if(r!=null){try{return v2.call(r)}catch{}try{return r+""}catch{}}return""}var Kp=_2,b2=Hp,w2=g2,E2=zp,x2=Kp,T2=/[\\^$.*+?()[\]{}|]/g,A2=/^\[object .+?Constructor\]$/,k2=Function.prototype,S2=Object.prototype,I2=k2.toString,N2=S2.hasOwnProperty,O2=RegExp("^"+I2.call(N2).replace(T2,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P2(r){if(!E2(r)||w2(r))return!1;var e=b2(r)?O2:A2;return e.test(x2(r))}var C2=P2;function R2(r,e){return r==null?void 0:r[e]}var j2=R2,L2=C2,D2=j2;function M2(r,e){var t=D2(r,e);return L2(t)?t:void 0}var Lr=M2,V2=Lr,$2=cn,F2=V2($2,"Map"),nu=F2,q2=Lr,U2=q2(Object,"create"),yo=U2,Ah=yo;function B2(){this.__data__=Ah?Ah(null):{},this.size=0}var z2=B2;function H2(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var K2=H2,G2=yo,W2="__lodash_hash_undefined__",Q2=Object.prototype,Y2=Q2.hasOwnProperty;function J2(r){var e=this.__data__;if(G2){var t=e[r];return t===W2?void 0:t}return Y2.call(e,r)?e[r]:void 0}var X2=J2,Z2=yo,eE=Object.prototype,tE=eE.hasOwnProperty;function nE(r){var e=this.__data__;return Z2?e[r]!==void 0:tE.call(e,r)}var rE=nE,iE=yo,sE="__lodash_hash_undefined__";function oE(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=iE&&e===void 0?sE:e,this}var aE=oE,lE=z2,uE=K2,cE=X2,hE=rE,fE=aE;function Dr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Dr.prototype.clear=lE;Dr.prototype.delete=uE;Dr.prototype.get=cE;Dr.prototype.has=hE;Dr.prototype.set=fE;var dE=Dr,kh=dE,pE=mo,mE=nu;function gE(){this.size=0,this.__data__={hash:new kh,map:new(mE||pE),string:new kh}}var yE=gE;function vE(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var _E=vE,bE=_E;function wE(r,e){var t=r.__data__;return bE(e)?t[typeof e=="string"?"string":"hash"]:t.map}var vo=wE,EE=vo;function xE(r){var e=EE(this,r).delete(r);return this.size-=e?1:0,e}var TE=xE,AE=vo;function kE(r){return AE(this,r).get(r)}var SE=kE,IE=vo;function NE(r){return IE(this,r).has(r)}var OE=NE,PE=vo;function CE(r,e){var t=PE(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var RE=CE,jE=yE,LE=TE,DE=SE,ME=OE,VE=RE;function Mr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Mr.prototype.clear=jE;Mr.prototype.delete=LE;Mr.prototype.get=DE;Mr.prototype.has=ME;Mr.prototype.set=VE;var Gp=Mr,$E=mo,FE=nu,qE=Gp,UE=200;function BE(r,e){var t=this.__data__;if(t instanceof $E){var n=t.__data__;if(!FE||n.length<UE-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new qE(n)}return t.set(r,e),this.size=t.size,this}var zE=BE,HE=mo,KE=Cw,GE=jw,WE=Dw,QE=Vw,YE=zE;function Vr(r){var e=this.__data__=new HE(r);this.size=e.size}Vr.prototype.clear=KE;Vr.prototype.delete=GE;Vr.prototype.get=WE;Vr.prototype.has=QE;Vr.prototype.set=YE;var JE=Vr,XE="__lodash_hash_undefined__";function ZE(r){return this.__data__.set(r,XE),this}var ex=ZE;function tx(r){return this.__data__.has(r)}var nx=tx,rx=Gp,ix=ex,sx=nx;function Us(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new rx;++e<t;)this.add(r[e])}Us.prototype.add=Us.prototype.push=ix;Us.prototype.has=sx;var ox=Us;function ax(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var lx=ax;function ux(r,e){return r.has(e)}var cx=ux,hx=ox,fx=lx,dx=cx,px=1,mx=2;function gx(r,e,t,n,i,s){var o=t&px,a=r.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(r),h=s.get(e);if(c&&h)return c==e&&h==r;var d=-1,f=!0,p=t&mx?new hx:void 0;for(s.set(r,e),s.set(e,r);++d<a;){var _=r[d],g=e[d];if(n)var y=o?n(g,_,d,e,r,s):n(_,g,d,r,e,s);if(y!==void 0){if(y)continue;f=!1;break}if(p){if(!fx(e,function(m,b){if(!dx(p,b)&&(_===m||i(_,m,t,n,s)))return p.push(b)})){f=!1;break}}else if(!(_===g||i(_,g,t,n,s))){f=!1;break}}return s.delete(r),s.delete(e),f}var Wp=gx,yx=cn,vx=yx.Uint8Array,_x=vx;function bx(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var wx=bx;function Ex(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var xx=Ex,Sh=tu,Ih=_x,Tx=qp,Ax=Wp,kx=wx,Sx=xx,Ix=1,Nx=2,Ox="[object Boolean]",Px="[object Date]",Cx="[object Error]",Rx="[object Map]",jx="[object Number]",Lx="[object RegExp]",Dx="[object Set]",Mx="[object String]",Vx="[object Symbol]",$x="[object ArrayBuffer]",Fx="[object DataView]",Nh=Sh?Sh.prototype:void 0,la=Nh?Nh.valueOf:void 0;function qx(r,e,t,n,i,s,o){switch(t){case Fx:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case $x:return!(r.byteLength!=e.byteLength||!s(new Ih(r),new Ih(e)));case Ox:case Px:case jx:return Tx(+r,+e);case Cx:return r.name==e.name&&r.message==e.message;case Lx:case Mx:return r==e+"";case Rx:var a=kx;case Dx:var l=n&Ix;if(a||(a=Sx),r.size!=e.size&&!l)return!1;var c=o.get(r);if(c)return c==e;n|=Nx,o.set(r,e);var h=Ax(a(r),a(e),n,i,s,o);return o.delete(r),h;case Vx:if(la)return la.call(r)==la.call(e)}return!1}var Ux=qx;function Bx(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var zx=Bx,Hx=Array.isArray,ru=Hx,Kx=zx,Gx=ru;function Wx(r,e,t){var n=e(r);return Gx(r)?n:Kx(n,t(r))}var Qx=Wx;function Yx(r,e){for(var t=-1,n=r==null?0:r.length,i=0,s=[];++t<n;){var o=r[t];e(o,t,r)&&(s[i++]=o)}return s}var Jx=Yx;function Xx(){return[]}var Zx=Xx,eT=Jx,tT=Zx,nT=Object.prototype,rT=nT.propertyIsEnumerable,Oh=Object.getOwnPropertySymbols,iT=Oh?function(r){return r==null?[]:(r=Object(r),eT(Oh(r),function(e){return rT.call(r,e)}))}:tT,sT=iT;function oT(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var aT=oT;function lT(r){return r!=null&&typeof r=="object"}var _o=lT,uT=go,cT=_o,hT="[object Arguments]";function fT(r){return cT(r)&&uT(r)==hT}var dT=fT,Ph=dT,pT=_o,Qp=Object.prototype,mT=Qp.hasOwnProperty,gT=Qp.propertyIsEnumerable,yT=Ph(function(){return arguments}())?Ph:function(r){return pT(r)&&mT.call(r,"callee")&&!gT.call(r,"callee")},vT=yT,Bs={exports:{}};function _T(){return!1}var bT=_T;Bs.exports;(function(r,e){var t=cn,n=bT,i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,a=o?t.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||n;r.exports=c})(Bs,Bs.exports);var Yp=Bs.exports,wT=9007199254740991,ET=/^(?:0|[1-9]\d*)$/;function xT(r,e){var t=typeof r;return e=e??wT,!!e&&(t=="number"||t!="symbol"&&ET.test(r))&&r>-1&&r%1==0&&r<e}var TT=xT,AT=9007199254740991;function kT(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=AT}var Jp=kT,ST=go,IT=Jp,NT=_o,OT="[object Arguments]",PT="[object Array]",CT="[object Boolean]",RT="[object Date]",jT="[object Error]",LT="[object Function]",DT="[object Map]",MT="[object Number]",VT="[object Object]",$T="[object RegExp]",FT="[object Set]",qT="[object String]",UT="[object WeakMap]",BT="[object ArrayBuffer]",zT="[object DataView]",HT="[object Float32Array]",KT="[object Float64Array]",GT="[object Int8Array]",WT="[object Int16Array]",QT="[object Int32Array]",YT="[object Uint8Array]",JT="[object Uint8ClampedArray]",XT="[object Uint16Array]",ZT="[object Uint32Array]",ze={};ze[HT]=ze[KT]=ze[GT]=ze[WT]=ze[QT]=ze[YT]=ze[JT]=ze[XT]=ze[ZT]=!0;ze[OT]=ze[PT]=ze[BT]=ze[CT]=ze[zT]=ze[RT]=ze[jT]=ze[LT]=ze[DT]=ze[MT]=ze[VT]=ze[$T]=ze[FT]=ze[qT]=ze[UT]=!1;function eA(r){return NT(r)&&IT(r.length)&&!!ze[ST(r)]}var tA=eA;function nA(r){return function(e){return r(e)}}var rA=nA,zs={exports:{}};zs.exports;(function(r,e){var t=Up,n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();r.exports=a})(zs,zs.exports);var iA=zs.exports,sA=tA,oA=rA,Ch=iA,Rh=Ch&&Ch.isTypedArray,aA=Rh?oA(Rh):sA,Xp=aA,lA=aT,uA=vT,cA=ru,hA=Yp,fA=TT,dA=Xp,pA=Object.prototype,mA=pA.hasOwnProperty;function gA(r,e){var t=cA(r),n=!t&&uA(r),i=!t&&!n&&hA(r),s=!t&&!n&&!i&&dA(r),o=t||n||i||s,a=o?lA(r.length,String):[],l=a.length;for(var c in r)(e||mA.call(r,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||fA(c,l)))&&a.push(c);return a}var yA=gA,vA=Object.prototype;function _A(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||vA;return r===t}var bA=_A;function wA(r,e){return function(t){return r(e(t))}}var EA=wA,xA=EA,TA=xA(Object.keys,Object),AA=TA,kA=bA,SA=AA,IA=Object.prototype,NA=IA.hasOwnProperty;function OA(r){if(!kA(r))return SA(r);var e=[];for(var t in Object(r))NA.call(r,t)&&t!="constructor"&&e.push(t);return e}var PA=OA,CA=Hp,RA=Jp;function jA(r){return r!=null&&RA(r.length)&&!CA(r)}var LA=jA,DA=yA,MA=PA,VA=LA;function $A(r){return VA(r)?DA(r):MA(r)}var FA=$A,qA=Qx,UA=sT,BA=FA;function zA(r){return qA(r,BA,UA)}var HA=zA,jh=HA,KA=1,GA=Object.prototype,WA=GA.hasOwnProperty;function QA(r,e,t,n,i,s){var o=t&KA,a=jh(r),l=a.length,c=jh(e),h=c.length;if(l!=h&&!o)return!1;for(var d=l;d--;){var f=a[d];if(!(o?f in e:WA.call(e,f)))return!1}var p=s.get(r),_=s.get(e);if(p&&_)return p==e&&_==r;var g=!0;s.set(r,e),s.set(e,r);for(var y=o;++d<l;){f=a[d];var m=r[f],b=e[f];if(n)var S=o?n(b,m,f,e,r,s):n(m,b,f,r,e,s);if(!(S===void 0?m===b||i(m,b,t,n,s):S)){g=!1;break}y||(y=f=="constructor")}if(g&&!y){var v=r.constructor,O=e.constructor;v!=O&&"constructor"in r&&"constructor"in e&&!(typeof v=="function"&&v instanceof v&&typeof O=="function"&&O instanceof O)&&(g=!1)}return s.delete(r),s.delete(e),g}var YA=QA,JA=Lr,XA=cn,ZA=JA(XA,"DataView"),ek=ZA,tk=Lr,nk=cn,rk=tk(nk,"Promise"),ik=rk,sk=Lr,ok=cn,ak=sk(ok,"Set"),lk=ak,uk=Lr,ck=cn,hk=uk(ck,"WeakMap"),fk=hk,Ua=ek,Ba=nu,za=ik,Ha=lk,Ka=fk,Zp=go,$r=Kp,Lh="[object Map]",dk="[object Object]",Dh="[object Promise]",Mh="[object Set]",Vh="[object WeakMap]",$h="[object DataView]",pk=$r(Ua),mk=$r(Ba),gk=$r(za),yk=$r(Ha),vk=$r(Ka),$n=Zp;(Ua&&$n(new Ua(new ArrayBuffer(1)))!=$h||Ba&&$n(new Ba)!=Lh||za&&$n(za.resolve())!=Dh||Ha&&$n(new Ha)!=Mh||Ka&&$n(new Ka)!=Vh)&&($n=function(r){var e=Zp(r),t=e==dk?r.constructor:void 0,n=t?$r(t):"";if(n)switch(n){case pk:return $h;case mk:return Lh;case gk:return Dh;case yk:return Mh;case vk:return Vh}return e});var _k=$n,ua=JE,bk=Wp,wk=Ux,Ek=YA,Fh=_k,qh=ru,Uh=Yp,xk=Xp,Tk=1,Bh="[object Arguments]",zh="[object Array]",fs="[object Object]",Ak=Object.prototype,Hh=Ak.hasOwnProperty;function kk(r,e,t,n,i,s){var o=qh(r),a=qh(e),l=o?zh:Fh(r),c=a?zh:Fh(e);l=l==Bh?fs:l,c=c==Bh?fs:c;var h=l==fs,d=c==fs,f=l==c;if(f&&Uh(r)){if(!Uh(e))return!1;o=!0,h=!1}if(f&&!h)return s||(s=new ua),o||xk(r)?bk(r,e,t,n,i,s):wk(r,e,l,t,n,i,s);if(!(t&Tk)){var p=h&&Hh.call(r,"__wrapped__"),_=d&&Hh.call(e,"__wrapped__");if(p||_){var g=p?r.value():r,y=_?e.value():e;return s||(s=new ua),i(g,y,t,n,s)}}return f?(s||(s=new ua),Ek(r,e,t,n,i,s)):!1}var Sk=kk,Ik=Sk,Kh=_o;function em(r,e,t,n,i){return r===e?!0:r==null||e==null||!Kh(r)&&!Kh(e)?r!==r&&e!==e:Ik(r,e,t,n,em,i)}var Nk=em,Ok=Nk;function Pk(r,e){return Ok(r,e)}var Ck=Pk,tm={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:Ke,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),a=i(19),l=i(45),c=i(46),h=i(47),d=i(48),f=i(49),p=i(12),_=i(32),g=i(33),y=i(31),m=i(1),b={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:s.default,Format:o.default,Leaf:a.default,Embed:d.default,Scroll:l.default,Block:h.default,Inline:c.default,Text:f.default,Attributor:{Attribute:p.default,Class:_.default,Style:g.default,Store:y.default}};n.default=b},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var S in b)b.hasOwnProperty(S)&&(m[S]=b[S])};return function(m,b){y(m,b);function S(){this.constructor=m}m.prototype=b===null?Object.create(b):(S.prototype=b.prototype,new S)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(y){s(m,y);function m(b){var S=this;return b="[Parchment] "+b,S=y.call(this,b)||this,S.message=b,S.name=S.constructor.name,S}return m}(Error);n.ParchmentError=o;var a={},l={},c={},h={};n.DATA_KEY="__blot";var d;(function(y){y[y.TYPE=3]="TYPE",y[y.LEVEL=12]="LEVEL",y[y.ATTRIBUTE=13]="ATTRIBUTE",y[y.BLOT=14]="BLOT",y[y.INLINE=7]="INLINE",y[y.BLOCK=11]="BLOCK",y[y.BLOCK_BLOT=10]="BLOCK_BLOT",y[y.INLINE_BLOT=6]="INLINE_BLOT",y[y.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",y[y.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",y[y.ANY=15]="ANY"})(d=n.Scope||(n.Scope={}));function f(y,m){var b=_(y);if(b==null)throw new o("Unable to create "+y+" blot");var S=b,v=y instanceof Node||y.nodeType===Node.TEXT_NODE?y:S.create(m);return new S(v,m)}n.create=f;function p(y,m){return m===void 0&&(m=!1),y==null?null:y[n.DATA_KEY]!=null?y[n.DATA_KEY].blot:m?p(y.parentNode,m):null}n.find=p;function _(y,m){m===void 0&&(m=d.ANY);var b;if(typeof y=="string")b=h[y]||a[y];else if(y instanceof Text||y.nodeType===Node.TEXT_NODE)b=h.text;else if(typeof y=="number")y&d.LEVEL&d.BLOCK?b=h.block:y&d.LEVEL&d.INLINE&&(b=h.inline);else if(y instanceof HTMLElement){var S=(y.getAttribute("class")||"").split(/\s+/);for(var v in S)if(b=l[S[v]],b)break;b=b||c[y.tagName]}return b==null?null:m&d.LEVEL&b.scope&&m&d.TYPE&b.scope?b:null}n.query=_;function g(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];if(y.length>1)return y.map(function(v){return g(v)});var b=y[0];if(typeof b.blotName!="string"&&typeof b.attrName!="string")throw new o("Invalid definition");if(b.blotName==="abstract")throw new o("Cannot register abstract class");if(h[b.blotName||b.attrName]=b,typeof b.keyName=="string")a[b.keyName]=b;else if(b.className!=null&&(l[b.className]=b),b.tagName!=null){Array.isArray(b.tagName)?b.tagName=b.tagName.map(function(v){return v.toUpperCase()}):b.tagName=b.tagName.toUpperCase();var S=Array.isArray(b.tagName)?b.tagName:[b.tagName];S.forEach(function(v){(c[v]==null||b.className==null)&&(c[v]=b)})}return b}n.register=g},function(t,n,i){var s=i(51),o=i(11),a=i(3),l=i(20),c="\0",h=function(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]};h.prototype.insert=function(d,f){var p={};return d.length===0?this:(p.insert=d,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p))},h.prototype.delete=function(d){return d<=0?this:this.push({delete:d})},h.prototype.retain=function(d,f){if(d<=0)return this;var p={retain:d};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p)},h.prototype.push=function(d){var f=this.ops.length,p=this.ops[f-1];if(d=a(!0,{},d),typeof p=="object"){if(typeof d.delete=="number"&&typeof p.delete=="number")return this.ops[f-1]={delete:p.delete+d.delete},this;if(typeof p.delete=="number"&&d.insert!=null&&(f-=1,p=this.ops[f-1],typeof p!="object"))return this.ops.unshift(d),this;if(o(d.attributes,p.attributes)){if(typeof d.insert=="string"&&typeof p.insert=="string")return this.ops[f-1]={insert:p.insert+d.insert},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof p.retain=="number")return this.ops[f-1]={retain:p.retain+d.retain},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this}}return f===this.ops.length?this.ops.push(d):this.ops.splice(f,0,d),this},h.prototype.chop=function(){var d=this.ops[this.ops.length-1];return d&&d.retain&&!d.attributes&&this.ops.pop(),this},h.prototype.filter=function(d){return this.ops.filter(d)},h.prototype.forEach=function(d){this.ops.forEach(d)},h.prototype.map=function(d){return this.ops.map(d)},h.prototype.partition=function(d){var f=[],p=[];return this.forEach(function(_){var g=d(_)?f:p;g.push(_)}),[f,p]},h.prototype.reduce=function(d,f){return this.ops.reduce(d,f)},h.prototype.changeLength=function(){return this.reduce(function(d,f){return f.insert?d+l.length(f):f.delete?d-f.delete:d},0)},h.prototype.length=function(){return this.reduce(function(d,f){return d+l.length(f)},0)},h.prototype.slice=function(d,f){d=d||0,typeof f!="number"&&(f=1/0);for(var p=[],_=l.iterator(this.ops),g=0;g<f&&_.hasNext();){var y;g<d?y=_.next(d-g):(y=_.next(f-g),p.push(y)),g+=l.length(y)}return new h(p)},h.prototype.compose=function(d){var f=l.iterator(this.ops),p=l.iterator(d.ops),_=[],g=p.peek();if(g!=null&&typeof g.retain=="number"&&g.attributes==null){for(var y=g.retain;f.peekType()==="insert"&&f.peekLength()<=y;)y-=f.peekLength(),_.push(f.next());g.retain-y>0&&p.next(g.retain-y)}for(var m=new h(_);f.hasNext()||p.hasNext();)if(p.peekType()==="insert")m.push(p.next());else if(f.peekType()==="delete")m.push(f.next());else{var b=Math.min(f.peekLength(),p.peekLength()),S=f.next(b),v=p.next(b);if(typeof v.retain=="number"){var O={};typeof S.retain=="number"?O.retain=b:O.insert=S.insert;var R=l.attributes.compose(S.attributes,v.attributes,typeof S.retain=="number");if(R&&(O.attributes=R),m.push(O),!p.hasNext()&&o(m.ops[m.ops.length-1],O)){var E=new h(f.rest());return m.concat(E).chop()}}else typeof v.delete=="number"&&typeof S.retain=="number"&&m.push(v)}return m.chop()},h.prototype.concat=function(d){var f=new h(this.ops.slice());return d.ops.length>0&&(f.push(d.ops[0]),f.ops=f.ops.concat(d.ops.slice(1))),f},h.prototype.diff=function(d,f){if(this.ops===d.ops)return new h;var p=[this,d].map(function(b){return b.map(function(S){if(S.insert!=null)return typeof S.insert=="string"?S.insert:c;var v=b===d?"on":"with";throw new Error("diff() called "+v+" non-document")}).join("")}),_=new h,g=s(p[0],p[1],f),y=l.iterator(this.ops),m=l.iterator(d.ops);return g.forEach(function(b){for(var S=b[1].length;S>0;){var v=0;switch(b[0]){case s.INSERT:v=Math.min(m.peekLength(),S),_.push(m.next(v));break;case s.DELETE:v=Math.min(S,y.peekLength()),y.next(v),_.delete(v);break;case s.EQUAL:v=Math.min(y.peekLength(),m.peekLength(),S);var O=y.next(v),R=m.next(v);o(O.insert,R.insert)?_.retain(v,l.attributes.diff(O.attributes,R.attributes)):_.push(R).delete(v);break}S-=v}}),_.chop()},h.prototype.eachLine=function(d,f){f=f||`
`;for(var p=l.iterator(this.ops),_=new h,g=0;p.hasNext();){if(p.peekType()!=="insert")return;var y=p.peek(),m=l.length(y)-p.peekLength(),b=typeof y.insert=="string"?y.insert.indexOf(f,m)-m:-1;if(b<0)_.push(p.next());else if(b>0)_.push(p.next(b));else{if(d(_,p.next(1).attributes||{},g)===!1)return;g+=1,_=new h}}_.length()>0&&d(_,{},g)},h.prototype.transform=function(d,f){if(f=!!f,typeof d=="number")return this.transformPosition(d,f);for(var p=l.iterator(this.ops),_=l.iterator(d.ops),g=new h;p.hasNext()||_.hasNext();)if(p.peekType()==="insert"&&(f||_.peekType()!=="insert"))g.retain(l.length(p.next()));else if(_.peekType()==="insert")g.push(_.next());else{var y=Math.min(p.peekLength(),_.peekLength()),m=p.next(y),b=_.next(y);if(m.delete)continue;b.delete?g.push(b):g.retain(y,l.attributes.transform(m.attributes,b.attributes,f))}return g.chop()},h.prototype.transformPosition=function(d,f){f=!!f;for(var p=l.iterator(this.ops),_=0;p.hasNext()&&_<=d;){var g=p.peekLength(),y=p.peekType();if(p.next(),y==="delete"){d-=Math.min(g,d-_);continue}else y==="insert"&&(_<d||!f)&&(d+=g);_+=g}return d},t.exports=h},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=function(p){return typeof Array.isArray=="function"?Array.isArray(p):s.call(p)==="[object Array]"},c=function(p){if(!p||s.call(p)!=="[object Object]")return!1;var _=i.call(p,"constructor"),g=p.constructor&&p.constructor.prototype&&i.call(p.constructor.prototype,"isPrototypeOf");if(p.constructor&&!_&&!g)return!1;var y;for(y in p);return typeof y>"u"||i.call(p,y)},h=function(p,_){o&&_.name==="__proto__"?o(p,_.name,{enumerable:!0,configurable:!0,value:_.newValue,writable:!0}):p[_.name]=_.newValue},d=function(p,_){if(_==="__proto__")if(i.call(p,_)){if(a)return a(p,_).value}else return;return p[_]};t.exports=function f(){var p,_,g,y,m,b,S=arguments[0],v=1,O=arguments.length,R=!1;for(typeof S=="boolean"&&(R=S,S=arguments[1]||{},v=2),(S==null||typeof S!="object"&&typeof S!="function")&&(S={});v<O;++v)if(p=arguments[v],p!=null)for(_ in p)g=d(S,_),y=d(p,_),S!==y&&(R&&y&&(c(y)||(m=l(y)))?(m?(m=!1,b=g&&l(g)?g:[]):b=g&&c(g)?g:{},h(S,{name:_,newValue:f(R,b,y)})):typeof y<"u"&&h(S,{name:_,newValue:y}));return S}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function x(I,k){for(var j=0;j<k.length;j++){var V=k[j];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(I,V.key,V)}}return function(I,k,j){return k&&x(I.prototype,k),j&&x(I,j),I}}(),o=function x(I,k,j){I===null&&(I=Function.prototype);var V=Object.getOwnPropertyDescriptor(I,k);if(V===void 0){var z=Object.getPrototypeOf(I);return z===null?void 0:x(z,k,j)}else{if("value"in V)return V.value;var H=V.get;return H===void 0?void 0:H.call(j)}},a=i(3),l=S(a),c=i(2),h=S(c),d=i(0),f=S(d),p=i(16),_=S(p),g=i(6),y=S(g),m=i(7),b=S(m);function S(x){return x&&x.__esModule?x:{default:x}}function v(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")}function O(x,I){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:x}function R(x,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);x.prototype=Object.create(I&&I.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(x,I):x.__proto__=I)}var E=1,w=function(x){R(I,x);function I(){return v(this,I),O(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return s(I,[{key:"attach",value:function(){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"attach",this).call(this),this.attributes=new f.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new h.default().insert(this.value(),(0,l.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(j,V){var z=f.default.query(j,f.default.Scope.BLOCK_ATTRIBUTE);z!=null&&this.attributes.attribute(z,V)}},{key:"formatAt",value:function(j,V,z,H){this.format(z,H)}},{key:"insertAt",value:function(j,V,z){if(typeof V=="string"&&V.endsWith(`
`)){var H=f.default.create(N.blotName);this.parent.insertBefore(H,j===0?this:this.next),H.insertAt(0,V.slice(0,-1))}else o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,j,V,z)}}]),I}(f.default.Embed);w.scope=f.default.Scope.BLOCK_BLOT;var N=function(x){R(I,x);function I(k){v(this,I);var j=O(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,k));return j.cache={},j}return s(I,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(f.default.Leaf).reduce(function(j,V){return V.length()===0?j:j.insert(V.value(),T(V))},new h.default).insert(`
`,T(this))),this.cache.delta}},{key:"deleteAt",value:function(j,V){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"deleteAt",this).call(this,j,V),this.cache={}}},{key:"formatAt",value:function(j,V,z,H){V<=0||(f.default.query(z,f.default.Scope.BLOCK)?j+V===this.length()&&this.format(z,H):o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"formatAt",this).call(this,j,Math.min(V,this.length()-j-1),z,H),this.cache={})}},{key:"insertAt",value:function(j,V,z){if(z!=null)return o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,j,V,z);if(V.length!==0){var H=V.split(`
`),te=H.shift();te.length>0&&(j<this.length()-1||this.children.tail==null?o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertAt",this).call(this,Math.min(j,this.length()-1),te):this.children.tail.insertAt(this.children.tail.length(),te),this.cache={});var K=this;H.reduce(function(q,L){return K=K.split(q,!0),K.insertAt(0,L),L.length},j+te.length)}}},{key:"insertBefore",value:function(j,V){var z=this.children.head;o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"insertBefore",this).call(this,j,V),z instanceof _.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"length",this).call(this)+E),this.cache.length}},{key:"moveChildren",value:function(j,V){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"moveChildren",this).call(this,j,V),this.cache={}}},{key:"optimize",value:function(j){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"optimize",this).call(this,j),this.cache={}}},{key:"path",value:function(j){return o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"path",this).call(this,j,!0)}},{key:"removeChild",value:function(j){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"removeChild",this).call(this,j),this.cache={}}},{key:"split",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(V&&(j===0||j>=this.length()-E)){var z=this.clone();return j===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var H=o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"split",this).call(this,j,V);return this.cache={},H}}}]),I}(f.default.Block);N.blotName="block",N.tagName="P",N.defaultChild="break",N.allowedChildren=[y.default,f.default.Embed,b.default];function T(x){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return x==null||(typeof x.formats=="function"&&(I=(0,l.default)(I,x.formats())),x.parent==null||x.parent.blotName=="scroll"||x.parent.statics.scope!==x.statics.scope)?I:T(x.parent,I)}n.bubbleFormats=T,n.BlockEmbed=w,n.default=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},o=function(){function K(q,L){var $=[],F=!0,W=!1,U=void 0;try{for(var M=q[Symbol.iterator](),B;!(F=(B=M.next()).done)&&($.push(B.value),!(L&&$.length===L));F=!0);}catch(G){W=!0,U=G}finally{try{!F&&M.return&&M.return()}finally{if(W)throw U}}return $}return function(q,L){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return K(q,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function K(q,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(q,F.key,F)}}return function(q,L,$){return L&&K(q.prototype,L),$&&K(q,$),q}}();i(50);var l=i(2),c=T(l),h=i(14),d=T(h),f=i(8),p=T(f),_=i(9),g=T(_),y=i(0),m=T(y),b=i(15),S=T(b),v=i(3),O=T(v),R=i(10),E=T(R),w=i(34),N=T(w);function T(K){return K&&K.__esModule?K:{default:K}}function x(K,q,L){return q in K?Object.defineProperty(K,q,{value:L,enumerable:!0,configurable:!0,writable:!0}):K[q]=L,K}function I(K,q){if(!(K instanceof q))throw new TypeError("Cannot call a class as a function")}var k=(0,E.default)("quill"),j=function(){a(K,null,[{key:"debug",value:function(L){L===!0&&(L="log"),E.default.level(L)}},{key:"find",value:function(L){return L.__quill||m.default.find(L)}},{key:"import",value:function(L){return this.imports[L]==null&&k.error("Cannot import "+L+". Are you sure it was registered?"),this.imports[L]}},{key:"register",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof L!="string"){var U=L.attrName||L.blotName;typeof U=="string"?this.register("formats/"+U,L,$):Object.keys(L).forEach(function(M){F.register(M,L[M],$)})}else this.imports[L]!=null&&!W&&k.warn("Overwriting "+L+" with",$),this.imports[L]=$,(L.startsWith("blots/")||L.startsWith("formats/"))&&$.blotName!=="abstract"?m.default.register($):L.startsWith("modules")&&typeof $.register=="function"&&$.register()}}]);function K(q){var L=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(I(this,K),this.options=V(q,$),this.container=this.options.container,this.container==null)return k.error("Invalid Quill container",q);this.options.debug&&K.debug(this.options.debug);var F=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new p.default,this.scroll=m.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new d.default(this.scroll),this.selection=new S.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(p.default.events.EDITOR_CHANGE,function(U){U===p.default.events.TEXT_CHANGE&&L.root.classList.toggle("ql-blank",L.editor.isBlank())}),this.emitter.on(p.default.events.SCROLL_UPDATE,function(U,M){var B=L.selection.lastRange,G=B&&B.length===0?B.index:void 0;z.call(L,function(){return L.editor.update(null,M,G)},U)});var W=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+F+"<p><br></p></div>");this.setContents(W),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return a(K,[{key:"addContainer",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof L=="string"){var F=L;L=document.createElement("div"),L.classList.add(F)}return this.container.insertBefore(L,$),L}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(L,$,F){var W=this,U=H(L,$,F),M=o(U,4);return L=M[0],$=M[1],F=M[3],z.call(this,function(){return W.editor.deleteText(L,$)},F,L,-1*$)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(L),this.container.classList.toggle("ql-disabled",!L)}},{key:"focus",value:function(){var L=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=L,this.scrollIntoView()}},{key:"format",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:p.default.sources.API;return z.call(this,function(){var U=F.getSelection(!0),M=new c.default;if(U==null)return M;if(m.default.query(L,m.default.Scope.BLOCK))M=F.editor.formatLine(U.index,U.length,x({},L,$));else{if(U.length===0)return F.selection.format(L,$),M;M=F.editor.formatText(U.index,U.length,x({},L,$))}return F.setSelection(U,p.default.sources.SILENT),M},W)}},{key:"formatLine",value:function(L,$,F,W,U){var M=this,B=void 0,G=H(L,$,F,W,U),J=o(G,4);return L=J[0],$=J[1],B=J[2],U=J[3],z.call(this,function(){return M.editor.formatLine(L,$,B)},U,L,0)}},{key:"formatText",value:function(L,$,F,W,U){var M=this,B=void 0,G=H(L,$,F,W,U),J=o(G,4);return L=J[0],$=J[1],B=J[2],U=J[3],z.call(this,function(){return M.editor.formatText(L,$,B)},U,L,0)}},{key:"getBounds",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=void 0;typeof L=="number"?F=this.selection.getBounds(L,$):F=this.selection.getBounds(L.index,L.length);var W=this.container.getBoundingClientRect();return{bottom:F.bottom-W.top,height:F.height,left:F.left-W.left,right:F.right-W.left,top:F.top-W.top,width:F.width}}},{key:"getContents",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-L,F=H(L,$),W=o(F,2);return L=W[0],$=W[1],this.editor.getContents(L,$)}},{key:"getFormat",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof L=="number"?this.editor.getFormat(L,$):this.editor.getFormat(L.index,L.length)}},{key:"getIndex",value:function(L){return L.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(L){return this.scroll.leaf(L)}},{key:"getLine",value:function(L){return this.scroll.line(L)}},{key:"getLines",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof L!="number"?this.scroll.lines(L.index,L.length):this.scroll.lines(L,$)}},{key:"getModule",value:function(L){return this.theme.modules[L]}},{key:"getSelection",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return L&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-L,F=H(L,$),W=o(F,2);return L=W[0],$=W[1],this.editor.getText(L,$)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(L,$,F){var W=this,U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:K.sources.API;return z.call(this,function(){return W.editor.insertEmbed(L,$,F)},U,L)}},{key:"insertText",value:function(L,$,F,W,U){var M=this,B=void 0,G=H(L,0,F,W,U),J=o(G,4);return L=J[0],B=J[2],U=J[3],z.call(this,function(){return M.editor.insertText(L,$,B)},U,L,$.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(L,$,F){this.clipboard.dangerouslyPasteHTML(L,$,F)}},{key:"removeFormat",value:function(L,$,F){var W=this,U=H(L,$,F),M=o(U,4);return L=M[0],$=M[1],F=M[3],z.call(this,function(){return W.editor.removeFormat(L,$)},F,L)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(L){var $=this,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return z.call(this,function(){L=new c.default(L);var W=$.getLength(),U=$.editor.deleteText(0,W),M=$.editor.applyDelta(L),B=M.ops[M.ops.length-1];B!=null&&typeof B.insert=="string"&&B.insert[B.insert.length-1]===`
`&&($.editor.deleteText($.getLength()-1,1),M.delete(1));var G=U.compose(M);return G},F)}},{key:"setSelection",value:function(L,$,F){if(L==null)this.selection.setRange(null,$||K.sources.API);else{var W=H(L,$,F),U=o(W,4);L=U[0],$=U[1],F=U[3],this.selection.setRange(new b.Range(L,$),F),F!==p.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API,F=new c.default().insert(L);return this.setContents(F,$)}},{key:"update",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p.default.sources.USER,$=this.scroll.update(L);return this.selection.update(L),$}},{key:"updateContents",value:function(L){var $=this,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return z.call(this,function(){return L=new c.default(L),$.editor.applyDelta(L,F)},F,!0)}}]),K}();j.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},j.events=p.default.events,j.sources=p.default.sources,j.version="1.3.7",j.imports={delta:c.default,parchment:m.default,"core/module":g.default,"core/theme":N.default};function V(K,q){if(q=(0,O.default)(!0,{container:K,modules:{clipboard:!0,keyboard:!0,history:!0}},q),!q.theme||q.theme===j.DEFAULTS.theme)q.theme=N.default;else if(q.theme=j.import("themes/"+q.theme),q.theme==null)throw new Error("Invalid theme "+q.theme+". Did you register it?");var L=(0,O.default)(!0,{},q.theme.DEFAULTS);[L,q].forEach(function(W){W.modules=W.modules||{},Object.keys(W.modules).forEach(function(U){W.modules[U]===!0&&(W.modules[U]={})})});var $=Object.keys(L.modules).concat(Object.keys(q.modules)),F=$.reduce(function(W,U){var M=j.import("modules/"+U);return M==null?k.error("Cannot load "+U+" module. Are you sure you registered it?"):W[U]=M.DEFAULTS||{},W},{});return q.modules!=null&&q.modules.toolbar&&q.modules.toolbar.constructor!==Object&&(q.modules.toolbar={container:q.modules.toolbar}),q=(0,O.default)(!0,{},j.DEFAULTS,{modules:F},L,q),["bounds","container","scrollingContainer"].forEach(function(W){typeof q[W]=="string"&&(q[W]=document.querySelector(q[W]))}),q.modules=Object.keys(q.modules).reduce(function(W,U){return q.modules[U]&&(W[U]=q.modules[U]),W},{}),q}function z(K,q,L,$){if(this.options.strict&&!this.isEnabled()&&q===p.default.sources.USER)return new c.default;var F=L==null?null:this.getSelection(),W=this.editor.delta,U=K();if(F!=null&&(L===!0&&(L=F.index),$==null?F=te(F,U,q):$!==0&&(F=te(F,L,$,q)),this.setSelection(F,p.default.sources.SILENT)),U.length()>0){var M,B=[p.default.events.TEXT_CHANGE,U,W,q];if((M=this.emitter).emit.apply(M,[p.default.events.EDITOR_CHANGE].concat(B)),q!==p.default.sources.SILENT){var G;(G=this.emitter).emit.apply(G,B)}}return U}function H(K,q,L,$,F){var W={};return typeof K.index=="number"&&typeof K.length=="number"?typeof q!="number"?(F=$,$=L,L=q,q=K.length,K=K.index):(q=K.length,K=K.index):typeof q!="number"&&(F=$,$=L,L=q,q=0),(typeof L>"u"?"undefined":s(L))==="object"?(W=L,F=$):typeof L=="string"&&($!=null?W[L]=$:F=L),F=F||p.default.sources.API,[K,q,W,F]}function te(K,q,L,$){if(K==null)return null;var F=void 0,W=void 0;if(q instanceof c.default){var U=[K.index,K.index+K.length].map(function(J){return q.transformPosition(J,$!==p.default.sources.USER)}),M=o(U,2);F=M[0],W=M[1]}else{var B=[K.index,K.index+K.length].map(function(J){return J<q||J===q&&$===p.default.sources.USER?J:L>=0?J+L:Math.max(q,J+L)}),G=o(B,2);F=G[0],W=G[1]}return new b.Range(F,W-F)}n.expandConfig=V,n.overload=H,n.default=j},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var S=0;S<b.length;S++){var v=b[S];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,S){return b&&y(m.prototype,b),S&&y(m,S),m}}(),o=function y(m,b,S){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,S)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(S)}},a=i(7),l=d(a),c=i(0),h=d(c);function d(y){return y&&y.__esModule?y:{default:y}}function f(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function p(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function _(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var g=function(y){_(m,y);function m(){return f(this,m),p(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"formatAt",value:function(S,v,O,R){if(m.compare(this.statics.blotName,O)<0&&h.default.query(O,h.default.Scope.BLOT)){var E=this.isolate(S,v);R&&E.wrap(O,R)}else o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"formatAt",this).call(this,S,v,O,R)}},{key:"optimize",value:function(S){if(o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,S),this.parent instanceof m&&m.compare(this.statics.blotName,this.parent.statics.blotName)>0){var v=this.parent.isolate(this.offset(),this.length());this.moveChildren(v),v.wrap(this)}}}],[{key:"compare",value:function(S,v){var O=m.order.indexOf(S),R=m.order.indexOf(v);return O>=0||R>=0?O-R:S===v?0:S<v?-1:1}}]),m}(h.default.Inline);g.allowedChildren=[g,h.default.Embed,l.default],g.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function c(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default.Text);n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(S,v){for(var O=0;O<v.length;O++){var R=v[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(S,R.key,R)}}return function(S,v,O){return v&&b(S.prototype,v),O&&b(S,O),S}}(),o=function b(S,v,O){S===null&&(S=Function.prototype);var R=Object.getOwnPropertyDescriptor(S,v);if(R===void 0){var E=Object.getPrototypeOf(S);return E===null?void 0:b(E,v,O)}else{if("value"in R)return R.value;var w=R.get;return w===void 0?void 0:w.call(O)}},a=i(54),l=d(a),c=i(10),h=d(c);function d(b){return b&&b.__esModule?b:{default:b}}function f(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}function p(b,S){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:b}function _(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);b.prototype=Object.create(S&&S.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(b,S):b.__proto__=S)}var g=(0,h.default)("quill:events"),y=["selectionchange","mousedown","mouseup","click"];y.forEach(function(b){document.addEventListener(b,function(){for(var S=arguments.length,v=Array(S),O=0;O<S;O++)v[O]=arguments[O];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(R){if(R.__quill&&R.__quill.emitter){var E;(E=R.__quill.emitter).handleDOM.apply(E,v)}})})});var m=function(b){_(S,b);function S(){f(this,S);var v=p(this,(S.__proto__||Object.getPrototypeOf(S)).call(this));return v.listeners={},v.on("error",g.error),v}return s(S,[{key:"emit",value:function(){g.log.apply(g,arguments),o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(O){for(var R=arguments.length,E=Array(R>1?R-1:0),w=1;w<R;w++)E[w-1]=arguments[w];(this.listeners[O.type]||[]).forEach(function(N){var T=N.node,x=N.handler;(O.target===T||T.contains(O.target))&&x.apply(void 0,[O].concat(E))})}},{key:"listenDOM",value:function(O,R,E){this.listeners[O]||(this.listeners[O]=[]),this.listeners[O].push({node:R,handler:E})}}]),S}(l.default);m.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},m.sources={API:"api",SILENT:"silent",USER:"user"},n.default=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}var o=function a(l){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,a),this.quill=l,this.options=c};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function a(c){if(s.indexOf(c)<=s.indexOf(o)){for(var h,d=arguments.length,f=Array(d>1?d-1:0),p=1;p<d;p++)f[p-1]=arguments[p];(h=console)[c].apply(h,f)}}function l(c){return s.reduce(function(h,d){return h[d]=a.bind(console,d,c),h},{})}a.level=l.level=function(c){o=c},n.default=l},function(t,n,i){var s=Array.prototype.slice,o=i(52),a=i(53),l=t.exports=function(f,p,_){return _||(_={}),f===p?!0:f instanceof Date&&p instanceof Date?f.getTime()===p.getTime():!f||!p||typeof f!="object"&&typeof p!="object"?_.strict?f===p:f==p:d(f,p,_)};function c(f){return f==null}function h(f){return!(!f||typeof f!="object"||typeof f.length!="number"||typeof f.copy!="function"||typeof f.slice!="function"||f.length>0&&typeof f[0]!="number")}function d(f,p,_){var g,y;if(c(f)||c(p)||f.prototype!==p.prototype)return!1;if(a(f))return a(p)?(f=s.call(f),p=s.call(p),l(f,p,_)):!1;if(h(f)){if(!h(p)||f.length!==p.length)return!1;for(g=0;g<f.length;g++)if(f[g]!==p[g])return!1;return!0}try{var m=o(f),b=o(p)}catch{return!1}if(m.length!=b.length)return!1;for(m.sort(),b.sort(),g=m.length-1;g>=0;g--)if(m[g]!=b[g])return!1;for(g=m.length-1;g>=0;g--)if(y=m[g],!l(f[y],p[y],_))return!1;return typeof f==typeof p}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l,c,h){h===void 0&&(h={}),this.attrName=l,this.keyName=c;var d=s.Scope.TYPE&s.Scope.ATTRIBUTE;h.scope!=null?this.scope=h.scope&s.Scope.LEVEL|d:this.scope=s.Scope.ATTRIBUTE,h.whitelist!=null&&(this.whitelist=h.whitelist)}return a.keys=function(l){return[].map.call(l.attributes,function(c){return c.name})},a.prototype.add=function(l,c){return this.canAdd(l,c)?(l.setAttribute(this.keyName,c),!0):!1},a.prototype.canAdd=function(l,c){var h=s.query(l,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return h==null?!1:this.whitelist==null?!0:typeof c=="string"?this.whitelist.indexOf(c.replace(/["']/g,""))>-1:this.whitelist.indexOf(c)>-1},a.prototype.remove=function(l){l.removeAttribute(this.keyName)},a.prototype.value=function(l){var c=l.getAttribute(this.keyName);return this.canAdd(l,c)&&c?c:""},a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function w(N,T){var x=[],I=!0,k=!1,j=void 0;try{for(var V=N[Symbol.iterator](),z;!(I=(z=V.next()).done)&&(x.push(z.value),!(T&&x.length===T));I=!0);}catch(H){k=!0,j=H}finally{try{!I&&V.return&&V.return()}finally{if(k)throw j}}return x}return function(N,T){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return w(N,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(N,T){for(var x=0;x<T.length;x++){var I=T[x];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(N,I.key,I)}}return function(N,T,x){return T&&w(N.prototype,T),x&&w(N,x),N}}(),a=function w(N,T,x){N===null&&(N=Function.prototype);var I=Object.getOwnPropertyDescriptor(N,T);if(I===void 0){var k=Object.getPrototypeOf(N);return k===null?void 0:w(k,T,x)}else{if("value"in I)return I.value;var j=I.get;return j===void 0?void 0:j.call(x)}},l=i(2),c=b(l),h=i(0),d=b(h),f=i(4),p=b(f),_=i(6),g=b(_),y=i(7),m=b(y);function b(w){return w&&w.__esModule?w:{default:w}}function S(w,N){if(!(w instanceof N))throw new TypeError("Cannot call a class as a function")}function v(w,N){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:w}function O(w,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);w.prototype=Object.create(N&&N.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(w,N):w.__proto__=N)}var R=function(w){O(N,w);function N(){return S(this,N),v(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return N}(g.default);R.blotName="code",R.tagName="CODE";var E=function(w){O(N,w);function N(){return S(this,N),v(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return o(N,[{key:"delta",value:function(){var x=this,I=this.domNode.textContent;return I.endsWith(`
`)&&(I=I.slice(0,-1)),I.split(`
`).reduce(function(k,j){return k.insert(j).insert(`
`,x.formats())},new c.default)}},{key:"format",value:function(x,I){if(!(x===this.statics.blotName&&I)){var k=this.descendant(m.default,this.length()-1),j=s(k,1),V=j[0];V!=null&&V.deleteAt(V.length()-1,1),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"format",this).call(this,x,I)}}},{key:"formatAt",value:function(x,I,k,j){if(I!==0&&!(d.default.query(k,d.default.Scope.BLOCK)==null||k===this.statics.blotName&&j===this.statics.formats(this.domNode))){var V=this.newlineIndex(x);if(!(V<0||V>=x+I)){var z=this.newlineIndex(x,!0)+1,H=V-z+1,te=this.isolate(z,H),K=te.next;te.format(k,j),K instanceof N&&K.formatAt(0,x-z+I-H,k,j)}}}},{key:"insertAt",value:function(x,I,k){if(k==null){var j=this.descendant(m.default,x),V=s(j,2),z=V[0],H=V[1];z.insertAt(H,I)}}},{key:"length",value:function(){var x=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?x:x+1}},{key:"newlineIndex",value:function(x){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(I)return this.domNode.textContent.slice(0,x).lastIndexOf(`
`);var k=this.domNode.textContent.slice(x).indexOf(`
`);return k>-1?x+k:-1}},{key:"optimize",value:function(x){this.domNode.textContent.endsWith(`
`)||this.appendChild(d.default.create("text",`
`)),a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"optimize",this).call(this,x);var I=this.next;I!=null&&I.prev===this&&I.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===I.statics.formats(I.domNode)&&(I.optimize(x),I.moveChildren(this),I.remove())}},{key:"replace",value:function(x){a(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"replace",this).call(this,x),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(I){var k=d.default.find(I);k==null?I.parentNode.removeChild(I):k instanceof d.default.Embed?k.remove():k.unwrap()})}}],[{key:"create",value:function(x){var I=a(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this,x);return I.setAttribute("spellcheck",!1),I}},{key:"formats",value:function(){return!0}}]),N}(p.default);E.blotName="code-block",E.tagName="PRE",E.TAB="  ",n.Code=R,n.default=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},o=function(){function K(q,L){var $=[],F=!0,W=!1,U=void 0;try{for(var M=q[Symbol.iterator](),B;!(F=(B=M.next()).done)&&($.push(B.value),!(L&&$.length===L));F=!0);}catch(G){W=!0,U=G}finally{try{!F&&M.return&&M.return()}finally{if(W)throw U}}return $}return function(q,L){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return K(q,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function K(q,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(q,F.key,F)}}return function(q,L,$){return L&&K(q.prototype,L),$&&K(q,$),q}}(),l=i(2),c=I(l),h=i(20),d=I(h),f=i(0),p=I(f),_=i(13),g=I(_),y=i(24),m=I(y),b=i(4),S=I(b),v=i(16),O=I(v),R=i(21),E=I(R),w=i(11),N=I(w),T=i(3),x=I(T);function I(K){return K&&K.__esModule?K:{default:K}}function k(K,q,L){return q in K?Object.defineProperty(K,q,{value:L,enumerable:!0,configurable:!0,writable:!0}):K[q]=L,K}function j(K,q){if(!(K instanceof q))throw new TypeError("Cannot call a class as a function")}var V=/^[ -~]*$/,z=function(){function K(q){j(this,K),this.scroll=q,this.delta=this.getDelta()}return a(K,[{key:"applyDelta",value:function(L){var $=this,F=!1;this.scroll.update();var W=this.scroll.length();return this.scroll.batchStart(),L=te(L),L.reduce(function(U,M){var B=M.retain||M.delete||M.insert.length||1,G=M.attributes||{};if(M.insert!=null){if(typeof M.insert=="string"){var J=M.insert;J.endsWith(`
`)&&F&&(F=!1,J=J.slice(0,-1)),U>=W&&!J.endsWith(`
`)&&(F=!0),$.scroll.insertAt(U,J);var re=$.scroll.line(U),ue=o(re,2),me=ue[0],ye=ue[1],Se=(0,x.default)({},(0,b.bubbleFormats)(me));if(me instanceof S.default){var Le=me.descendant(p.default.Leaf,ye),lt=o(Le,1),Ye=lt[0];Se=(0,x.default)(Se,(0,b.bubbleFormats)(Ye))}G=d.default.attributes.diff(Se,G)||{}}else if(s(M.insert)==="object"){var Z=Object.keys(M.insert)[0];if(Z==null)return U;$.scroll.insertAt(U,Z,M.insert[Z])}W+=B}return Object.keys(G).forEach(function(ee){$.scroll.formatAt(U,B,ee,G[ee])}),U+B},0),L.reduce(function(U,M){return typeof M.delete=="number"?($.scroll.deleteAt(U,M.delete),U):U+(M.retain||M.insert.length||1)},0),this.scroll.batchEnd(),this.update(L)}},{key:"deleteText",value:function(L,$){return this.scroll.deleteAt(L,$),this.update(new c.default().retain(L).delete($))}},{key:"formatLine",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(W).forEach(function(U){if(!(F.scroll.whitelist!=null&&!F.scroll.whitelist[U])){var M=F.scroll.lines(L,Math.max($,1)),B=$;M.forEach(function(G){var J=G.length();if(!(G instanceof g.default))G.format(U,W[U]);else{var re=L-G.offset(F.scroll),ue=G.newlineIndex(re+B)-re+1;G.formatAt(re,ue,U,W[U])}B-=J})}}),this.scroll.optimize(),this.update(new c.default().retain(L).retain($,(0,E.default)(W)))}},{key:"formatText",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(W).forEach(function(U){F.scroll.formatAt(L,$,U,W[U])}),this.update(new c.default().retain(L).retain($,(0,E.default)(W)))}},{key:"getContents",value:function(L,$){return this.delta.slice(L,L+$)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(L,$){return L.concat($.delta())},new c.default)}},{key:"getFormat",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=[],W=[];$===0?this.scroll.path(L).forEach(function(M){var B=o(M,1),G=B[0];G instanceof S.default?F.push(G):G instanceof p.default.Leaf&&W.push(G)}):(F=this.scroll.lines(L,$),W=this.scroll.descendants(p.default.Leaf,L,$));var U=[F,W].map(function(M){if(M.length===0)return{};for(var B=(0,b.bubbleFormats)(M.shift());Object.keys(B).length>0;){var G=M.shift();if(G==null)return B;B=H((0,b.bubbleFormats)(G),B)}return B});return x.default.apply(x.default,U)}},{key:"getText",value:function(L,$){return this.getContents(L,$).filter(function(F){return typeof F.insert=="string"}).map(function(F){return F.insert}).join("")}},{key:"insertEmbed",value:function(L,$,F){return this.scroll.insertAt(L,$,F),this.update(new c.default().retain(L).insert(k({},$,F)))}},{key:"insertText",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return $=$.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(L,$),Object.keys(W).forEach(function(U){F.scroll.formatAt(L,$.length,U,W[U])}),this.update(new c.default().retain(L).insert($,(0,E.default)(W)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var L=this.scroll.children.head;return L.statics.blotName!==S.default.blotName||L.children.length>1?!1:L.children.head instanceof O.default}},{key:"removeFormat",value:function(L,$){var F=this.getText(L,$),W=this.scroll.line(L+$),U=o(W,2),M=U[0],B=U[1],G=0,J=new c.default;M!=null&&(M instanceof g.default?G=M.newlineIndex(B)-B+1:G=M.length()-B,J=M.delta().slice(B,B+G-1).insert(`
`));var re=this.getContents(L,$+G),ue=re.diff(new c.default().insert(F).concat(J)),me=new c.default().retain(L).concat(ue);return this.applyDelta(me)}},{key:"update",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,W=this.delta;if($.length===1&&$[0].type==="characterData"&&$[0].target.data.match(V)&&p.default.find($[0].target)){var U=p.default.find($[0].target),M=(0,b.bubbleFormats)(U),B=U.offset(this.scroll),G=$[0].oldValue.replace(m.default.CONTENTS,""),J=new c.default().insert(G),re=new c.default().insert(U.value()),ue=new c.default().retain(B).concat(J.diff(re,F));L=ue.reduce(function(me,ye){return ye.insert?me.insert(ye.insert,M):me.push(ye)},new c.default),this.delta=W.compose(L)}else this.delta=this.getDelta(),(!L||!(0,N.default)(W.compose(L),this.delta))&&(L=W.diff(this.delta,F));return L}}]),K}();function H(K,q){return Object.keys(q).reduce(function(L,$){return K[$]==null||(q[$]===K[$]?L[$]=q[$]:Array.isArray(q[$])?q[$].indexOf(K[$])<0&&(L[$]=q[$].concat([K[$]])):L[$]=[q[$],K[$]]),L},{})}function te(K){return K.reduce(function(q,L){if(L.insert===1){var $=(0,E.default)(L.attributes);return delete $.image,q.insert({image:L.attributes.image},$)}if(L.attributes!=null&&(L.attributes.list===!0||L.attributes.bullet===!0)&&(L=(0,E.default)(L),L.attributes.list?L.attributes.list="ordered":(L.attributes.list="bullet",delete L.attributes.bullet)),typeof L.insert=="string"){var F=L.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return q.insert(F,L.attributes)}return q.push(L)},new c.default)}n.default=z},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function w(N,T){var x=[],I=!0,k=!1,j=void 0;try{for(var V=N[Symbol.iterator](),z;!(I=(z=V.next()).done)&&(x.push(z.value),!(T&&x.length===T));I=!0);}catch(H){k=!0,j=H}finally{try{!I&&V.return&&V.return()}finally{if(k)throw j}}return x}return function(N,T){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return w(N,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(N,T){for(var x=0;x<T.length;x++){var I=T[x];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(N,I.key,I)}}return function(N,T,x){return T&&w(N.prototype,T),x&&w(N,x),N}}(),a=i(0),l=m(a),c=i(21),h=m(c),d=i(11),f=m(d),p=i(8),_=m(p),g=i(10),y=m(g);function m(w){return w&&w.__esModule?w:{default:w}}function b(w){if(Array.isArray(w)){for(var N=0,T=Array(w.length);N<w.length;N++)T[N]=w[N];return T}else return Array.from(w)}function S(w,N){if(!(w instanceof N))throw new TypeError("Cannot call a class as a function")}var v=(0,y.default)("quill:selection"),O=function w(N){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;S(this,w),this.index=N,this.length=T},R=function(){function w(N,T){var x=this;S(this,w),this.emitter=T,this.scroll=N,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=l.default.create("cursor",this),this.lastRange=this.savedRange=new O(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){x.mouseDown||setTimeout(x.update.bind(x,_.default.sources.USER),1)}),this.emitter.on(_.default.events.EDITOR_CHANGE,function(I,k){I===_.default.events.TEXT_CHANGE&&k.length()>0&&x.update(_.default.sources.SILENT)}),this.emitter.on(_.default.events.SCROLL_BEFORE_UPDATE,function(){if(x.hasFocus()){var I=x.getNativeRange();I!=null&&I.start.node!==x.cursor.textNode&&x.emitter.once(_.default.events.SCROLL_UPDATE,function(){try{x.setNativeRange(I.start.node,I.start.offset,I.end.node,I.end.offset)}catch{}})}}),this.emitter.on(_.default.events.SCROLL_OPTIMIZE,function(I,k){if(k.range){var j=k.range,V=j.startNode,z=j.startOffset,H=j.endNode,te=j.endOffset;x.setNativeRange(V,z,H,te)}}),this.update(_.default.sources.SILENT)}return o(w,[{key:"handleComposition",value:function(){var T=this;this.root.addEventListener("compositionstart",function(){T.composing=!0}),this.root.addEventListener("compositionend",function(){if(T.composing=!1,T.cursor.parent){var x=T.cursor.restore();if(!x)return;setTimeout(function(){T.setNativeRange(x.startNode,x.startOffset,x.endNode,x.endOffset)},1)}})}},{key:"handleDragging",value:function(){var T=this;this.emitter.listenDOM("mousedown",document.body,function(){T.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){T.mouseDown=!1,T.update(_.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(T,x){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[T])){this.scroll.update();var I=this.getNativeRange();if(!(I==null||!I.native.collapsed||l.default.query(T,l.default.Scope.BLOCK))){if(I.start.node!==this.cursor.textNode){var k=l.default.find(I.start.node,!1);if(k==null)return;if(k instanceof l.default.Leaf){var j=k.split(I.start.offset);k.parent.insertBefore(this.cursor,j)}else k.insertBefore(this.cursor,I.start.node);this.cursor.attach()}this.cursor.format(T,x),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(T){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,I=this.scroll.length();T=Math.min(T,I-1),x=Math.min(T+x,I-1)-T;var k=void 0,j=this.scroll.leaf(T),V=s(j,2),z=V[0],H=V[1];if(z==null)return null;var te=z.position(H,!0),K=s(te,2);k=K[0],H=K[1];var q=document.createRange();if(x>0){q.setStart(k,H);var L=this.scroll.leaf(T+x),$=s(L,2);if(z=$[0],H=$[1],z==null)return null;var F=z.position(H,!0),W=s(F,2);return k=W[0],H=W[1],q.setEnd(k,H),q.getBoundingClientRect()}else{var U="left",M=void 0;return k instanceof Text?(H<k.data.length?(q.setStart(k,H),q.setEnd(k,H+1)):(q.setStart(k,H-1),q.setEnd(k,H),U="right"),M=q.getBoundingClientRect()):(M=z.domNode.getBoundingClientRect(),H>0&&(U="right")),{bottom:M.top+M.height,height:M.height,left:M[U],right:M[U],top:M.top,width:0}}}},{key:"getNativeRange",value:function(){var T=document.getSelection();if(T==null||T.rangeCount<=0)return null;var x=T.getRangeAt(0);if(x==null)return null;var I=this.normalizeNative(x);return v.info("getNativeRange",I),I}},{key:"getRange",value:function(){var T=this.getNativeRange();if(T==null)return[null,null];var x=this.normalizedToRange(T);return[x,T]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(T){var x=this,I=[[T.start.node,T.start.offset]];T.native.collapsed||I.push([T.end.node,T.end.offset]);var k=I.map(function(z){var H=s(z,2),te=H[0],K=H[1],q=l.default.find(te,!0),L=q.offset(x.scroll);return K===0?L:q instanceof l.default.Container?L+q.length():L+q.index(te,K)}),j=Math.min(Math.max.apply(Math,b(k)),this.scroll.length()-1),V=Math.min.apply(Math,[j].concat(b(k)));return new O(V,j-V)}},{key:"normalizeNative",value:function(T){if(!E(this.root,T.startContainer)||!T.collapsed&&!E(this.root,T.endContainer))return null;var x={start:{node:T.startContainer,offset:T.startOffset},end:{node:T.endContainer,offset:T.endOffset},native:T};return[x.start,x.end].forEach(function(I){for(var k=I.node,j=I.offset;!(k instanceof Text)&&k.childNodes.length>0;)if(k.childNodes.length>j)k=k.childNodes[j],j=0;else if(k.childNodes.length===j)k=k.lastChild,j=k instanceof Text?k.data.length:k.childNodes.length+1;else break;I.node=k,I.offset=j}),x}},{key:"rangeToNative",value:function(T){var x=this,I=T.collapsed?[T.index]:[T.index,T.index+T.length],k=[],j=this.scroll.length();return I.forEach(function(V,z){V=Math.min(j-1,V);var H=void 0,te=x.scroll.leaf(V),K=s(te,2),q=K[0],L=K[1],$=q.position(L,z!==0),F=s($,2);H=F[0],L=F[1],k.push(H,L)}),k.length<2&&(k=k.concat(k)),k}},{key:"scrollIntoView",value:function(T){var x=this.lastRange;if(x!=null){var I=this.getBounds(x.index,x.length);if(I!=null){var k=this.scroll.length()-1,j=this.scroll.line(Math.min(x.index,k)),V=s(j,1),z=V[0],H=z;if(x.length>0){var te=this.scroll.line(Math.min(x.index+x.length,k)),K=s(te,1);H=K[0]}if(!(z==null||H==null)){var q=T.getBoundingClientRect();I.top<q.top?T.scrollTop-=q.top-I.top:I.bottom>q.bottom&&(T.scrollTop+=I.bottom-q.bottom)}}}}},{key:"setNativeRange",value:function(T,x){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:x,j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(v.info("setNativeRange",T,x,I,k),!(T!=null&&(this.root.parentNode==null||T.parentNode==null||I.parentNode==null))){var V=document.getSelection();if(V!=null)if(T!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||j||T!==z.startContainer||x!==z.startOffset||I!==z.endContainer||k!==z.endOffset){T.tagName=="BR"&&(x=[].indexOf.call(T.parentNode.childNodes,T),T=T.parentNode),I.tagName=="BR"&&(k=[].indexOf.call(I.parentNode.childNodes,I),I=I.parentNode);var H=document.createRange();H.setStart(T,x),H.setEnd(I,k),V.removeAllRanges(),V.addRange(H)}}else V.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(T){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;if(typeof x=="string"&&(I=x,x=!1),v.info("setRange",T),T!=null){var k=this.rangeToNative(T);this.setNativeRange.apply(this,b(k).concat([x]))}else this.setNativeRange(null);this.update(I)}},{key:"update",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,x=this.lastRange,I=this.getRange(),k=s(I,2),j=k[0],V=k[1];if(this.lastRange=j,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,f.default)(x,this.lastRange)){var z;!this.composing&&V!=null&&V.native.collapsed&&V.start.node!==this.cursor.textNode&&this.cursor.restore();var H=[_.default.events.SELECTION_CHANGE,(0,h.default)(this.lastRange),(0,h.default)(x),T];if((z=this.emitter).emit.apply(z,[_.default.events.EDITOR_CHANGE].concat(H)),T!==_.default.sources.SILENT){var te;(te=this.emitter).emit.apply(te,H)}}}}]),w}();function E(w,N){try{N.parentNode}catch{return!1}return N instanceof Text&&(N=N.parentNode),w.contains(N)}n.Range=O,n.default=R},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var S=Object.getPrototypeOf(g);return S===null?void 0:_(S,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(0),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"insertInto",value:function(m,b){m.children.length===0?o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"insertInto",this).call(this,m,b):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),g}(l.default.Embed);p.blotName="break",p.tagName="BR",n.default=p},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),a=i(30),l=i(1),c=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.build(),_}return f.prototype.appendChild=function(p){this.insertBefore(p)},f.prototype.attach=function(){d.prototype.attach.call(this),this.children.forEach(function(p){p.attach()})},f.prototype.build=function(){var p=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(_){try{var g=h(_);p.insertBefore(g,p.children.head||void 0)}catch(y){if(y instanceof l.ParchmentError)return;throw y}})},f.prototype.deleteAt=function(p,_){if(p===0&&_===this.length())return this.remove();this.children.forEachAt(p,_,function(g,y,m){g.deleteAt(y,m)})},f.prototype.descendant=function(p,_){var g=this.children.find(_),y=g[0],m=g[1];return p.blotName==null&&p(y)||p.blotName!=null&&y instanceof p?[y,m]:y instanceof f?y.descendant(p,m):[null,-1]},f.prototype.descendants=function(p,_,g){_===void 0&&(_=0),g===void 0&&(g=Number.MAX_VALUE);var y=[],m=g;return this.children.forEachAt(_,g,function(b,S,v){(p.blotName==null&&p(b)||p.blotName!=null&&b instanceof p)&&y.push(b),b instanceof f&&(y=y.concat(b.descendants(p,S,m))),m-=v}),y},f.prototype.detach=function(){this.children.forEach(function(p){p.detach()}),d.prototype.detach.call(this)},f.prototype.formatAt=function(p,_,g,y){this.children.forEachAt(p,_,function(m,b,S){m.formatAt(b,S,g,y)})},f.prototype.insertAt=function(p,_,g){var y=this.children.find(p),m=y[0],b=y[1];if(m)m.insertAt(b,_,g);else{var S=g==null?l.create("text",_):l.create(_,g);this.appendChild(S)}},f.prototype.insertBefore=function(p,_){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(g){return p instanceof g}))throw new l.ParchmentError("Cannot insert "+p.statics.blotName+" into "+this.statics.blotName);p.insertInto(this,_)},f.prototype.length=function(){return this.children.reduce(function(p,_){return p+_.length()},0)},f.prototype.moveChildren=function(p,_){this.children.forEach(function(g){p.insertBefore(g,_)})},f.prototype.optimize=function(p){if(d.prototype.optimize.call(this,p),this.children.length===0)if(this.statics.defaultChild!=null){var _=l.create(this.statics.defaultChild);this.appendChild(_),_.optimize(p)}else this.remove()},f.prototype.path=function(p,_){_===void 0&&(_=!1);var g=this.children.find(p,_),y=g[0],m=g[1],b=[[this,p]];return y instanceof f?b.concat(y.path(m,_)):(y!=null&&b.push([y,m]),b)},f.prototype.removeChild=function(p){this.children.remove(p)},f.prototype.replace=function(p){p instanceof f&&p.moveChildren(this),d.prototype.replace.call(this,p)},f.prototype.split=function(p,_){if(_===void 0&&(_=!1),!_){if(p===0)return this;if(p===this.length())return this.next}var g=this.clone();return this.parent.insertBefore(g,this.next),this.children.forEachAt(p,this.length(),function(y,m,b){y=y.split(m,_),g.appendChild(y)}),g},f.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},f.prototype.update=function(p,_){var g=this,y=[],m=[];p.forEach(function(b){b.target===g.domNode&&b.type==="childList"&&(y.push.apply(y,b.addedNodes),m.push.apply(m,b.removedNodes))}),m.forEach(function(b){if(!(b.parentNode!=null&&b.tagName!=="IFRAME"&&document.body.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var S=l.find(b);S!=null&&(S.domNode.parentNode==null||S.domNode.parentNode===g.domNode)&&S.detach()}}),y.filter(function(b){return b.parentNode==g.domNode}).sort(function(b,S){return b===S?0:b.compareDocumentPosition(S)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(b){var S=null;b.nextSibling!=null&&(S=l.find(b.nextSibling));var v=h(b);(v.next!=S||v.next==null)&&(v.parent!=null&&v.parent.removeChild(g),g.insertBefore(v,S||void 0))})},f}(a.default);function h(d){var f=l.find(d);if(f==null)try{f=l.create(d)}catch{f=l.create(l.Scope.INLINE),[].slice.call(d.childNodes).forEach(function(_){f.domNode.appendChild(_)}),d.parentNode&&d.parentNode.replaceChild(f.domNode,d),f.attach()}return f}n.default=c},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),a=i(31),l=i(17),c=i(1),h=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.attributes=new a.default(_.domNode),_}return f.formats=function(p){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return p.tagName.toLowerCase()},f.prototype.format=function(p,_){var g=c.query(p);g instanceof o.default?this.attributes.attribute(g,_):_&&g!=null&&(p!==this.statics.blotName||this.formats()[p]!==_)&&this.replaceWith(p,_)},f.prototype.formats=function(){var p=this.attributes.values(),_=this.statics.formats(this.domNode);return _!=null&&(p[this.statics.blotName]=_),p},f.prototype.replaceWith=function(p,_){var g=d.prototype.replaceWith.call(this,p,_);return this.attributes.copy(g),g},f.prototype.update=function(p,_){var g=this;d.prototype.update.call(this,p,_),p.some(function(y){return y.target===g.domNode&&y.type==="attributes"})&&this.attributes.build()},f.prototype.wrap=function(p,_){var g=d.prototype.wrap.call(this,p,_);return g instanceof f&&g.statics.scope===this.statics.scope&&this.attributes.move(g),g},f}(l.default);n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){c(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),a=i(1),l=function(c){s(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.value=function(d){return!0},h.prototype.index=function(d,f){return this.domNode===d||this.domNode.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(f,1):-1},h.prototype.position=function(d,f){var p=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return d>0&&(p+=1),[this.parent.domNode,p]},h.prototype.value=function(){var d;return d={},d[this.statics.blotName]=this.statics.value(this.domNode)||!0,d},h.scope=a.Scope.INLINE_BLOT,h}(o.default);n.default=l},function(t,n,i){var s=i(11),o=i(3),a={attributes:{compose:function(c,h,d){typeof c!="object"&&(c={}),typeof h!="object"&&(h={});var f=o(!0,{},h);d||(f=Object.keys(f).reduce(function(_,g){return f[g]!=null&&(_[g]=f[g]),_},{}));for(var p in c)c[p]!==void 0&&h[p]===void 0&&(f[p]=c[p]);return Object.keys(f).length>0?f:void 0},diff:function(c,h){typeof c!="object"&&(c={}),typeof h!="object"&&(h={});var d=Object.keys(c).concat(Object.keys(h)).reduce(function(f,p){return s(c[p],h[p])||(f[p]=h[p]===void 0?null:h[p]),f},{});return Object.keys(d).length>0?d:void 0},transform:function(c,h,d){if(typeof c!="object")return h;if(typeof h=="object"){if(!d)return h;var f=Object.keys(h).reduce(function(p,_){return c[_]===void 0&&(p[_]=h[_]),p},{});return Object.keys(f).length>0?f:void 0}}},iterator:function(c){return new l(c)},length:function(c){return typeof c.delete=="number"?c.delete:typeof c.retain=="number"?c.retain:typeof c.insert=="string"?c.insert.length:1}};function l(c){this.ops=c,this.index=0,this.offset=0}l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(c){c||(c=1/0);var h=this.ops[this.index];if(h){var d=this.offset,f=a.length(h);if(c>=f-d?(c=f-d,this.index+=1,this.offset=0):this.offset+=c,typeof h.delete=="number")return{delete:c};var p={};return h.attributes&&(p.attributes=h.attributes),typeof h.retain=="number"?p.retain=c:typeof h.insert=="string"?p.insert=h.insert.substr(d,c):p.insert=h.insert,p}else return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var c=this.offset,h=this.index,d=this.next(),f=this.ops.slice(this.index);return this.offset=c,this.index=h,[d].concat(f)}else return[]},t.exports=a},function(t,n){var i=function(){function s(g,y){return y!=null&&g instanceof y}var o;try{o=Map}catch{o=function(){}}var a;try{a=Set}catch{a=function(){}}var l;try{l=Promise}catch{l=function(){}}function c(g,y,m,b,S){typeof y=="object"&&(m=y.depth,b=y.prototype,S=y.includeNonEnumerable,y=y.circular);var v=[],O=[],R=typeof Buffer<"u";typeof y>"u"&&(y=!0),typeof m>"u"&&(m=1/0);function E(w,N){if(w===null)return null;if(N===0)return w;var T,x;if(typeof w!="object")return w;if(s(w,o))T=new o;else if(s(w,a))T=new a;else if(s(w,l))T=new l(function(q,L){w.then(function($){q(E($,N-1))},function($){L(E($,N-1))})});else if(c.__isArray(w))T=[];else if(c.__isRegExp(w))T=new RegExp(w.source,_(w)),w.lastIndex&&(T.lastIndex=w.lastIndex);else if(c.__isDate(w))T=new Date(w.getTime());else{if(R&&Buffer.isBuffer(w))return Buffer.allocUnsafe?T=Buffer.allocUnsafe(w.length):T=new Buffer(w.length),w.copy(T),T;s(w,Error)?T=Object.create(w):typeof b>"u"?(x=Object.getPrototypeOf(w),T=Object.create(x)):(T=Object.create(b),x=b)}if(y){var I=v.indexOf(w);if(I!=-1)return O[I];v.push(w),O.push(T)}s(w,o)&&w.forEach(function(q,L){var $=E(L,N-1),F=E(q,N-1);T.set($,F)}),s(w,a)&&w.forEach(function(q){var L=E(q,N-1);T.add(L)});for(var k in w){var j;x&&(j=Object.getOwnPropertyDescriptor(x,k)),!(j&&j.set==null)&&(T[k]=E(w[k],N-1))}if(Object.getOwnPropertySymbols)for(var V=Object.getOwnPropertySymbols(w),k=0;k<V.length;k++){var z=V[k],H=Object.getOwnPropertyDescriptor(w,z);H&&!H.enumerable&&!S||(T[z]=E(w[z],N-1),H.enumerable||Object.defineProperty(T,z,{enumerable:!1}))}if(S)for(var te=Object.getOwnPropertyNames(w),k=0;k<te.length;k++){var K=te[k],H=Object.getOwnPropertyDescriptor(w,K);H&&H.enumerable||(T[K]=E(w[K],N-1),Object.defineProperty(T,K,{enumerable:!1}))}return T}return E(g,m)}c.clonePrototype=function(y){if(y===null)return null;var m=function(){};return m.prototype=y,new m};function h(g){return Object.prototype.toString.call(g)}c.__objToStr=h;function d(g){return typeof g=="object"&&h(g)==="[object Date]"}c.__isDate=d;function f(g){return typeof g=="object"&&h(g)==="[object Array]"}c.__isArray=f;function p(g){return typeof g=="object"&&h(g)==="[object RegExp]"}c.__isRegExp=p;function _(g){var y="";return g.global&&(y+="g"),g.ignoreCase&&(y+="i"),g.multiline&&(y+="m"),y}return c.__getRegExpFlags=_,c}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(x,I){var k=[],j=!0,V=!1,z=void 0;try{for(var H=x[Symbol.iterator](),te;!(j=(te=H.next()).done)&&(k.push(te.value),!(I&&k.length===I));j=!0);}catch(K){V=!0,z=K}finally{try{!j&&H.return&&H.return()}finally{if(V)throw z}}return k}return function(x,I){if(Array.isArray(x))return x;if(Symbol.iterator in Object(x))return T(x,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(x,I){for(var k=0;k<I.length;k++){var j=I[k];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(x,j.key,j)}}return function(x,I,k){return I&&T(x.prototype,I),k&&T(x,k),x}}(),a=function T(x,I,k){x===null&&(x=Function.prototype);var j=Object.getOwnPropertyDescriptor(x,I);if(j===void 0){var V=Object.getPrototypeOf(x);return V===null?void 0:T(V,I,k)}else{if("value"in j)return j.value;var z=j.get;return z===void 0?void 0:z.call(k)}},l=i(0),c=v(l),h=i(8),d=v(h),f=i(4),p=v(f),_=i(16),g=v(_),y=i(13),m=v(y),b=i(25),S=v(b);function v(T){return T&&T.__esModule?T:{default:T}}function O(T,x){if(!(T instanceof x))throw new TypeError("Cannot call a class as a function")}function R(T,x){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:T}function E(T,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);T.prototype=Object.create(x&&x.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(T,x):T.__proto__=x)}function w(T){return T instanceof p.default||T instanceof f.BlockEmbed}var N=function(T){E(x,T);function x(I,k){O(this,x);var j=R(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I));return j.emitter=k.emitter,Array.isArray(k.whitelist)&&(j.whitelist=k.whitelist.reduce(function(V,z){return V[z]=!0,V},{})),j.domNode.addEventListener("DOMNodeInserted",function(){}),j.optimize(),j.enable(),j}return o(x,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(k,j){var V=this.line(k),z=s(V,2),H=z[0],te=z[1],K=this.line(k+j),q=s(K,1),L=q[0];if(a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"deleteAt",this).call(this,k,j),L!=null&&H!==L&&te>0){if(H instanceof f.BlockEmbed||L instanceof f.BlockEmbed){this.optimize();return}if(H instanceof m.default){var $=H.newlineIndex(H.length(),!0);if($>-1&&(H=H.split($+1),H===L)){this.optimize();return}}else if(L instanceof m.default){var F=L.newlineIndex(0);F>-1&&L.split(F+1)}var W=L.children.head instanceof g.default?null:L.children.head;H.moveChildren(L,W),H.remove()}this.optimize()}},{key:"enable",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",k)}},{key:"formatAt",value:function(k,j,V,z){this.whitelist!=null&&!this.whitelist[V]||(a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"formatAt",this).call(this,k,j,V,z),this.optimize())}},{key:"insertAt",value:function(k,j,V){if(!(V!=null&&this.whitelist!=null&&!this.whitelist[j])){if(k>=this.length())if(V==null||c.default.query(j,c.default.Scope.BLOCK)==null){var z=c.default.create(this.statics.defaultChild);this.appendChild(z),V==null&&j.endsWith(`
`)&&(j=j.slice(0,-1)),z.insertAt(0,j,V)}else{var H=c.default.create(j,V);this.appendChild(H)}else a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertAt",this).call(this,k,j,V);this.optimize()}}},{key:"insertBefore",value:function(k,j){if(k.statics.scope===c.default.Scope.INLINE_BLOT){var V=c.default.create(this.statics.defaultChild);V.appendChild(k),k=V}a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertBefore",this).call(this,k,j)}},{key:"leaf",value:function(k){return this.path(k).pop()||[null,-1]}},{key:"line",value:function(k){return k===this.length()?this.line(k-1):this.descendant(w,k)}},{key:"lines",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,V=function z(H,te,K){var q=[],L=K;return H.children.forEachAt(te,K,function($,F,W){w($)?q.push($):$ instanceof c.default.Container&&(q=q.concat(z($,F,L))),L-=W}),q};return V(this,k,j)}},{key:"optimize",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,k,j),k.length>0&&this.emitter.emit(d.default.events.SCROLL_OPTIMIZE,k,j))}},{key:"path",value:function(k){return a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"path",this).call(this,k).slice(1)}},{key:"update",value:function(k){if(this.batch!==!0){var j=d.default.sources.USER;typeof k=="string"&&(j=k),Array.isArray(k)||(k=this.observer.takeRecords()),k.length>0&&this.emitter.emit(d.default.events.SCROLL_BEFORE_UPDATE,j,k),a(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"update",this).call(this,k.concat([])),k.length>0&&this.emitter.emit(d.default.events.SCROLL_UPDATE,j,k)}}}]),x}(c.default.Scroll);N.blotName="scroll",N.className="ql-editor",N.tagName="DIV",N.defaultChild="block",N.allowedChildren=[p.default,f.BlockEmbed,S.default],n.default=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o=function(){function M(B,G){var J=[],re=!0,ue=!1,me=void 0;try{for(var ye=B[Symbol.iterator](),Se;!(re=(Se=ye.next()).done)&&(J.push(Se.value),!(G&&J.length===G));re=!0);}catch(Le){ue=!0,me=Le}finally{try{!re&&ye.return&&ye.return()}finally{if(ue)throw me}}return J}return function(B,G){if(Array.isArray(B))return B;if(Symbol.iterator in Object(B))return M(B,G);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function M(B,G){for(var J=0;J<G.length;J++){var re=G[J];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(B,re.key,re)}}return function(B,G,J){return G&&M(B.prototype,G),J&&M(B,J),B}}(),l=i(21),c=T(l),h=i(11),d=T(h),f=i(3),p=T(f),_=i(2),g=T(_),y=i(20),m=T(y),b=i(0),S=T(b),v=i(5),O=T(v),R=i(10),E=T(R),w=i(9),N=T(w);function T(M){return M&&M.__esModule?M:{default:M}}function x(M,B,G){return B in M?Object.defineProperty(M,B,{value:G,enumerable:!0,configurable:!0,writable:!0}):M[B]=G,M}function I(M,B){if(!(M instanceof B))throw new TypeError("Cannot call a class as a function")}function k(M,B){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:M}function j(M,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);M.prototype=Object.create(B&&B.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(M,B):M.__proto__=B)}var V=(0,E.default)("quill:keyboard"),z=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",H=function(M){j(B,M),a(B,null,[{key:"match",value:function(J,re){return re=U(re),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ue){return!!re[ue]!==J[ue]&&re[ue]!==null})?!1:re.key===(J.which||J.keyCode)}}]);function B(G,J){I(this,B);var re=k(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,G,J));return re.bindings={},Object.keys(re.options.bindings).forEach(function(ue){ue==="list autofill"&&G.scroll.whitelist!=null&&!G.scroll.whitelist.list||re.options.bindings[ue]&&re.addBinding(re.options.bindings[ue])}),re.addBinding({key:B.keys.ENTER,shiftKey:null},$),re.addBinding({key:B.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(re.addBinding({key:B.keys.BACKSPACE},{collapsed:!0},K),re.addBinding({key:B.keys.DELETE},{collapsed:!0},q)):(re.addBinding({key:B.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},K),re.addBinding({key:B.keys.DELETE},{collapsed:!0,suffix:/^.?$/},q)),re.addBinding({key:B.keys.BACKSPACE},{collapsed:!1},L),re.addBinding({key:B.keys.DELETE},{collapsed:!1},L),re.addBinding({key:B.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},K),re.listen(),re}return a(B,[{key:"addBinding",value:function(J){var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},me=U(J);if(me==null||me.key==null)return V.warn("Attempted to add invalid keyboard binding",me);typeof re=="function"&&(re={handler:re}),typeof ue=="function"&&(ue={handler:ue}),me=(0,p.default)(me,re,ue),this.bindings[me.key]=this.bindings[me.key]||[],this.bindings[me.key].push(me)}},{key:"listen",value:function(){var J=this;this.quill.root.addEventListener("keydown",function(re){if(!re.defaultPrevented){var ue=re.which||re.keyCode,me=(J.bindings[ue]||[]).filter(function(Ge){return B.match(re,Ge)});if(me.length!==0){var ye=J.quill.getSelection();if(!(ye==null||!J.quill.hasFocus())){var Se=J.quill.getLine(ye.index),Le=o(Se,2),lt=Le[0],Ye=Le[1],Z=J.quill.getLeaf(ye.index),ee=o(Z,2),le=ee[0],ce=ee[1],se=ye.length===0?[le,ce]:J.quill.getLeaf(ye.index+ye.length),we=o(se,2),Ee=we[0],ke=we[1],Ve=le instanceof S.default.Text?le.value().slice(0,ce):"",Ue=Ee instanceof S.default.Text?Ee.value().slice(ke):"",$e={collapsed:ye.length===0,empty:ye.length===0&&lt.length()<=1,format:J.quill.getFormat(ye),offset:Ye,prefix:Ve,suffix:Ue},qi=me.some(function(Ge){if(Ge.collapsed!=null&&Ge.collapsed!==$e.collapsed||Ge.empty!=null&&Ge.empty!==$e.empty||Ge.offset!=null&&Ge.offset!==$e.offset)return!1;if(Array.isArray(Ge.format)){if(Ge.format.every(function(qt){return $e.format[qt]==null}))return!1}else if(s(Ge.format)==="object"&&!Object.keys(Ge.format).every(function(qt){return Ge.format[qt]===!0?$e.format[qt]!=null:Ge.format[qt]===!1?$e.format[qt]==null:(0,d.default)(Ge.format[qt],$e.format[qt])}))return!1;return Ge.prefix!=null&&!Ge.prefix.test($e.prefix)||Ge.suffix!=null&&!Ge.suffix.test($e.suffix)?!1:Ge.handler.call(J,ye,$e)!==!0});qi&&re.preventDefault()}}}})}}]),B}(N.default);H.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},H.DEFAULTS={bindings:{bold:W("bold"),italic:W("italic"),underline:W("underline"),indent:{key:H.keys.TAB,format:["blockquote","indent","list"],handler:function(B,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","+1",O.default.sources.USER)}},outdent:{key:H.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(B,G){if(G.collapsed&&G.offset!==0)return!0;this.quill.format("indent","-1",O.default.sources.USER)}},"outdent backspace":{key:H.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(B,G){G.format.indent!=null?this.quill.format("indent","-1",O.default.sources.USER):G.format.list!=null&&this.quill.format("list",!1,O.default.sources.USER)}},"indent code-block":F(!0),"outdent code-block":F(!1),"remove tab":{key:H.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(B){this.quill.deleteText(B.index-1,1,O.default.sources.USER)}},tab:{key:H.keys.TAB,handler:function(B){this.quill.history.cutoff();var G=new g.default().retain(B.index).delete(B.length).insert("	");this.quill.updateContents(G,O.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(B.index+1,O.default.sources.SILENT)}},"list empty enter":{key:H.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(B,G){this.quill.format("list",!1,O.default.sources.USER),G.format.indent&&this.quill.format("indent",!1,O.default.sources.USER)}},"checklist enter":{key:H.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(B){var G=this.quill.getLine(B.index),J=o(G,2),re=J[0],ue=J[1],me=(0,p.default)({},re.formats(),{list:"checked"}),ye=new g.default().retain(B.index).insert(`
`,me).retain(re.length()-ue-1).retain(1,{list:"unchecked"});this.quill.updateContents(ye,O.default.sources.USER),this.quill.setSelection(B.index+1,O.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:H.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(B,G){var J=this.quill.getLine(B.index),re=o(J,2),ue=re[0],me=re[1],ye=new g.default().retain(B.index).insert(`
`,G.format).retain(ue.length()-me-1).retain(1,{header:null});this.quill.updateContents(ye,O.default.sources.USER),this.quill.setSelection(B.index+1,O.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(B,G){var J=G.prefix.length,re=this.quill.getLine(B.index),ue=o(re,2),me=ue[0],ye=ue[1];if(ye>J)return!0;var Se=void 0;switch(G.prefix.trim()){case"[]":case"[ ]":Se="unchecked";break;case"[x]":Se="checked";break;case"-":case"*":Se="bullet";break;default:Se="ordered"}this.quill.insertText(B.index," ",O.default.sources.USER),this.quill.history.cutoff();var Le=new g.default().retain(B.index-ye).delete(J+1).retain(me.length()-2-ye).retain(1,{list:Se});this.quill.updateContents(Le,O.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(B.index-J,O.default.sources.SILENT)}},"code exit":{key:H.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(B){var G=this.quill.getLine(B.index),J=o(G,2),re=J[0],ue=J[1],me=new g.default().retain(B.index+re.length()-ue-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(me,O.default.sources.USER)}},"embed left":te(H.keys.LEFT,!1),"embed left shift":te(H.keys.LEFT,!0),"embed right":te(H.keys.RIGHT,!1),"embed right shift":te(H.keys.RIGHT,!0)}};function te(M,B){var G,J=M===H.keys.LEFT?"prefix":"suffix";return G={key:M,shiftKey:B,altKey:null},x(G,J,/^$/),x(G,"handler",function(ue){var me=ue.index;M===H.keys.RIGHT&&(me+=ue.length+1);var ye=this.quill.getLeaf(me),Se=o(ye,1),Le=Se[0];return Le instanceof S.default.Embed?(M===H.keys.LEFT?B?this.quill.setSelection(ue.index-1,ue.length+1,O.default.sources.USER):this.quill.setSelection(ue.index-1,O.default.sources.USER):B?this.quill.setSelection(ue.index,ue.length+1,O.default.sources.USER):this.quill.setSelection(ue.index+ue.length+1,O.default.sources.USER),!1):!0}),G}function K(M,B){if(!(M.index===0||this.quill.getLength()<=1)){var G=this.quill.getLine(M.index),J=o(G,1),re=J[0],ue={};if(B.offset===0){var me=this.quill.getLine(M.index-1),ye=o(me,1),Se=ye[0];if(Se!=null&&Se.length()>1){var Le=re.formats(),lt=this.quill.getFormat(M.index-1,1);ue=m.default.attributes.diff(Le,lt)||{}}}var Ye=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(B.prefix)?2:1;this.quill.deleteText(M.index-Ye,Ye,O.default.sources.USER),Object.keys(ue).length>0&&this.quill.formatLine(M.index-Ye,Ye,ue,O.default.sources.USER),this.quill.focus()}}function q(M,B){var G=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(B.suffix)?2:1;if(!(M.index>=this.quill.getLength()-G)){var J={},re=0,ue=this.quill.getLine(M.index),me=o(ue,1),ye=me[0];if(B.offset>=ye.length()-1){var Se=this.quill.getLine(M.index+1),Le=o(Se,1),lt=Le[0];if(lt){var Ye=ye.formats(),Z=this.quill.getFormat(M.index,1);J=m.default.attributes.diff(Ye,Z)||{},re=lt.length()}}this.quill.deleteText(M.index,G,O.default.sources.USER),Object.keys(J).length>0&&this.quill.formatLine(M.index+re-1,G,J,O.default.sources.USER)}}function L(M){var B=this.quill.getLines(M),G={};if(B.length>1){var J=B[0].formats(),re=B[B.length-1].formats();G=m.default.attributes.diff(re,J)||{}}this.quill.deleteText(M,O.default.sources.USER),Object.keys(G).length>0&&this.quill.formatLine(M.index,1,G,O.default.sources.USER),this.quill.setSelection(M.index,O.default.sources.SILENT),this.quill.focus()}function $(M,B){var G=this;M.length>0&&this.quill.scroll.deleteAt(M.index,M.length);var J=Object.keys(B.format).reduce(function(re,ue){return S.default.query(ue,S.default.Scope.BLOCK)&&!Array.isArray(B.format[ue])&&(re[ue]=B.format[ue]),re},{});this.quill.insertText(M.index,`
`,J,O.default.sources.USER),this.quill.setSelection(M.index+1,O.default.sources.SILENT),this.quill.focus(),Object.keys(B.format).forEach(function(re){J[re]==null&&(Array.isArray(B.format[re])||re!=="link"&&G.quill.format(re,B.format[re],O.default.sources.USER))})}function F(M){return{key:H.keys.TAB,shiftKey:!M,format:{"code-block":!0},handler:function(G){var J=S.default.query("code-block"),re=G.index,ue=G.length,me=this.quill.scroll.descendant(J,re),ye=o(me,2),Se=ye[0],Le=ye[1];if(Se!=null){var lt=this.quill.getIndex(Se),Ye=Se.newlineIndex(Le,!0)+1,Z=Se.newlineIndex(lt+Le+ue),ee=Se.domNode.textContent.slice(Ye,Z).split(`
`);Le=0,ee.forEach(function(le,ce){M?(Se.insertAt(Ye+Le,J.TAB),Le+=J.TAB.length,ce===0?re+=J.TAB.length:ue+=J.TAB.length):le.startsWith(J.TAB)&&(Se.deleteAt(Ye+Le,J.TAB.length),Le-=J.TAB.length,ce===0?re-=J.TAB.length:ue-=J.TAB.length),Le+=le.length+1}),this.quill.update(O.default.sources.USER),this.quill.setSelection(re,ue,O.default.sources.SILENT)}}}}function W(M){return{key:M[0].toUpperCase(),shortKey:!0,handler:function(G,J){this.quill.format(M,!J.format[M],O.default.sources.USER)}}}function U(M){if(typeof M=="string"||typeof M=="number")return U({key:M});if((typeof M>"u"?"undefined":s(M))==="object"&&(M=(0,c.default)(M,!1)),typeof M.key=="string")if(H.keys[M.key.toUpperCase()]!=null)M.key=H.keys[M.key.toUpperCase()];else if(M.key.length===1)M.key=M.key.toUpperCase().charCodeAt(0);else return null;return M.shortKey&&(M[z]=M.shortKey,delete M.shortKey),M}n.default=H,n.SHORTKEY=z},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,S){var v=[],O=!0,R=!1,E=void 0;try{for(var w=b[Symbol.iterator](),N;!(O=(N=w.next()).done)&&(v.push(N.value),!(S&&v.length===S));O=!0);}catch(T){R=!0,E=T}finally{try{!O&&w.return&&w.return()}finally{if(R)throw E}}return v}return function(b,S){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return m(b,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function m(b,S,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,S);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,S,v)}else{if("value"in O)return O.value;var E=O.get;return E===void 0?void 0:E.call(v)}},a=function(){function m(b,S){for(var v=0;v<S.length;v++){var O=S[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,S,v){return S&&m(b.prototype,S),v&&m(b,v),b}}(),l=i(0),c=f(l),h=i(7),d=f(h);function f(m){return m&&m.__esModule?m:{default:m}}function p(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function _(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function g(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var y=function(m){g(b,m),a(b,null,[{key:"value",value:function(){}}]);function b(S,v){p(this,b);var O=_(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,S));return O.selection=v,O.textNode=document.createTextNode(b.CONTENTS),O.domNode.appendChild(O.textNode),O._length=0,O}return a(b,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(v,O){if(this._length!==0)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,v,O);for(var R=this,E=0;R!=null&&R.statics.scope!==c.default.Scope.BLOCK_BLOT;)E+=R.offset(R.parent),R=R.parent;R!=null&&(this._length=b.CONTENTS.length,R.optimize(),R.formatAt(E,b.CONTENTS.length,v,O),this._length=0)}},{key:"index",value:function(v,O){return v===this.textNode?0:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,O)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var v=this.textNode,O=this.selection.getNativeRange(),R=void 0,E=void 0,w=void 0;if(O!=null&&O.start.node===v&&O.end.node===v){var N=[v,O.start.offset,O.end.offset];R=N[0],E=N[1],w=N[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==b.CONTENTS){var T=this.textNode.data.split(b.CONTENTS).join("");this.next instanceof d.default?(R=this.next.domNode,this.next.insertAt(0,T),this.textNode.data=b.CONTENTS):(this.textNode.data=T,this.parent.insertBefore(c.default.create(this.textNode),this),this.textNode=document.createTextNode(b.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),E!=null){var x=[E,w].map(function(k){return Math.max(0,Math.min(R.data.length,k-1))}),I=s(x,2);return E=I[0],w=I[1],{startNode:R,startOffset:E,endNode:R,endOffset:w}}}}},{key:"update",value:function(v,O){var R=this;if(v.some(function(w){return w.type==="characterData"&&w.target===R.textNode})){var E=this.restore();E&&(O.range=E)}}},{key:"value",value:function(){return""}}]),b}(c.default.Embed);y.blotName="cursor",y.className="ql-cursor",y.tagName="span",y.CONTENTS="\uFEFF",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=c(s),a=i(4),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default.Container);p.allowedChildren=[l.default,a.BlockEmbed,p],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function y(m,b){for(var S=0;S<b.length;S++){var v=b[S];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,S){return b&&y(m.prototype,b),S&&y(m,S),m}}(),o=function y(m,b,S){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,S)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(S)}},a=i(0),l=c(a);function c(y){return y&&y.__esModule?y:{default:y}}function h(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function d(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function f(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var p=function(y){f(m,y);function m(){return h(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"value",value:function(S){var v=o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,S);return v.startsWith("rgb(")?(v=v.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+v.split(",").map(function(O){return("00"+parseInt(O).toString(16)).slice(-2)}).join("")):v}}]),m}(l.default.Attributor.Style),_=new l.default.Attributor.Class("color","ql-color",{scope:l.default.Scope.INLINE}),g=new p("color","color",{scope:l.default.Scope.INLINE});n.ColorAttributor=p,n.ColorClass=_,n.ColorStyle=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function g(y,m){for(var b=0;b<m.length;b++){var S=m[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}return function(y,m,b){return m&&g(y.prototype,m),b&&g(y,b),y}}(),o=function g(y,m,b){y===null&&(y=Function.prototype);var S=Object.getOwnPropertyDescriptor(y,m);if(S===void 0){var v=Object.getPrototypeOf(y);return v===null?void 0:g(v,m,b)}else{if("value"in S)return S.value;var O=S.get;return O===void 0?void 0:O.call(b)}},a=i(6),l=c(a);function c(g){return g&&g.__esModule?g:{default:g}}function h(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function d(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var p=function(g){f(y,g);function y(){return h(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"format",value:function(b,S){if(b!==this.statics.blotName||!S)return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,b,S);S=this.constructor.sanitize(S),this.domNode.setAttribute("href",S)}}],[{key:"create",value:function(b){var S=o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,b);return b=this.sanitize(b),S.setAttribute("href",b),S.setAttribute("rel","noopener noreferrer"),S.setAttribute("target","_blank"),S}},{key:"formats",value:function(b){return b.getAttribute("href")}},{key:"sanitize",value:function(b){return _(b,this.PROTOCOL_WHITELIST)?b:this.SANITIZED_URL}}]),y}(l.default);p.blotName="link",p.tagName="A",p.SANITIZED_URL="about:blank",p.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function _(g,y){var m=document.createElement("a");m.href=g;var b=m.href.slice(0,m.href.indexOf(":"));return y.indexOf(b)>-1}n.default=p,n.sanitize=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},o=function(){function y(m,b){for(var S=0;S<b.length;S++){var v=b[S];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,S){return b&&y(m.prototype,b),S&&y(m,S),m}}(),a=i(23),l=d(a),c=i(107),h=d(c);function d(y){return y&&y.__esModule?y:{default:y}}function f(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}var p=0;function _(y,m){y.setAttribute(m,y.getAttribute(m)!=="true")}var g=function(){function y(m){var b=this;f(this,y),this.select=m,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){b.togglePicker()}),this.label.addEventListener("keydown",function(S){switch(S.keyCode){case l.default.keys.ENTER:b.togglePicker();break;case l.default.keys.ESCAPE:b.escape(),S.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(y,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),_(this.label,"aria-expanded"),_(this.options,"aria-hidden")}},{key:"buildItem",value:function(b){var S=this,v=document.createElement("span");return v.tabIndex="0",v.setAttribute("role","button"),v.classList.add("ql-picker-item"),b.hasAttribute("value")&&v.setAttribute("data-value",b.getAttribute("value")),b.textContent&&v.setAttribute("data-label",b.textContent),v.addEventListener("click",function(){S.selectItem(v,!0)}),v.addEventListener("keydown",function(O){switch(O.keyCode){case l.default.keys.ENTER:S.selectItem(v,!0),O.preventDefault();break;case l.default.keys.ESCAPE:S.escape(),O.preventDefault();break}}),v}},{key:"buildLabel",value:function(){var b=document.createElement("span");return b.classList.add("ql-picker-label"),b.innerHTML=h.default,b.tabIndex="0",b.setAttribute("role","button"),b.setAttribute("aria-expanded","false"),this.container.appendChild(b),b}},{key:"buildOptions",value:function(){var b=this,S=document.createElement("span");S.classList.add("ql-picker-options"),S.setAttribute("aria-hidden","true"),S.tabIndex="-1",S.id="ql-picker-options-"+p,p+=1,this.label.setAttribute("aria-controls",S.id),this.options=S,[].slice.call(this.select.options).forEach(function(v){var O=b.buildItem(v);S.appendChild(O),v.selected===!0&&b.selectItem(O)}),this.container.appendChild(S)}},{key:"buildPicker",value:function(){var b=this;[].slice.call(this.select.attributes).forEach(function(S){b.container.setAttribute(S.name,S.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var b=this;this.close(),setTimeout(function(){return b.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(b){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=this.container.querySelector(".ql-selected");if(b!==v&&(v!=null&&v.classList.remove("ql-selected"),b!=null&&(b.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(b.parentNode.children,b),b.hasAttribute("data-value")?this.label.setAttribute("data-value",b.getAttribute("data-value")):this.label.removeAttribute("data-value"),b.hasAttribute("data-label")?this.label.setAttribute("data-label",b.getAttribute("data-label")):this.label.removeAttribute("data-label"),S))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var O=document.createEvent("Event");O.initEvent("change",!0,!0),this.select.dispatchEvent(O)}this.close()}}},{key:"update",value:function(){var b=void 0;if(this.select.selectedIndex>-1){var S=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];b=this.select.options[this.select.selectedIndex],this.selectItem(S)}else this.selectItem(null);var v=b!=null&&b!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",v)}}]),y}();n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=V(s),a=i(5),l=V(a),c=i(4),h=V(c),d=i(16),f=V(d),p=i(25),_=V(p),g=i(24),y=V(g),m=i(35),b=V(m),S=i(6),v=V(S),O=i(22),R=V(O),E=i(7),w=V(E),N=i(55),T=V(N),x=i(42),I=V(x),k=i(23),j=V(k);function V(z){return z&&z.__esModule?z:{default:z}}l.default.register({"blots/block":h.default,"blots/block/embed":c.BlockEmbed,"blots/break":f.default,"blots/container":_.default,"blots/cursor":y.default,"blots/embed":b.default,"blots/inline":v.default,"blots/scroll":R.default,"blots/text":w.default,"modules/clipboard":T.default,"modules/history":I.default,"modules/keyboard":j.default}),o.default.register(h.default,f.default,y.default,v.default,R.default,w.default),n.default=l.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l){this.domNode=l,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(a.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),a.create=function(l){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var c;return Array.isArray(this.tagName)?(typeof l=="string"&&(l=l.toUpperCase(),parseInt(l).toString()===l&&(l=parseInt(l))),typeof l=="number"?c=document.createElement(this.tagName[l-1]):this.tagName.indexOf(l)>-1?c=document.createElement(l):c=document.createElement(this.tagName[0])):c=document.createElement(this.tagName),this.className&&c.classList.add(this.className),c},a.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},a.prototype.clone=function(){var l=this.domNode.cloneNode(!1);return s.create(l)},a.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},a.prototype.deleteAt=function(l,c){var h=this.isolate(l,c);h.remove()},a.prototype.formatAt=function(l,c,h,d){var f=this.isolate(l,c);if(s.query(h,s.Scope.BLOT)!=null&&d)f.wrap(h,d);else if(s.query(h,s.Scope.ATTRIBUTE)!=null){var p=s.create(this.statics.scope);f.wrap(p),p.format(h,d)}},a.prototype.insertAt=function(l,c,h){var d=h==null?s.create("text",c):s.create(c,h),f=this.split(l);this.parent.insertBefore(d,f)},a.prototype.insertInto=function(l,c){c===void 0&&(c=null),this.parent!=null&&this.parent.children.remove(this);var h=null;l.children.insertBefore(this,c),c!=null&&(h=c.domNode),(this.domNode.parentNode!=l.domNode||this.domNode.nextSibling!=h)&&l.domNode.insertBefore(this.domNode,h),this.parent=l,this.attach()},a.prototype.isolate=function(l,c){var h=this.split(l);return h.split(c),h},a.prototype.length=function(){return 1},a.prototype.offset=function(l){return l===void 0&&(l=this.parent),this.parent==null||this==l?0:this.parent.children.offset(this)+this.parent.offset(l)},a.prototype.optimize=function(l){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},a.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},a.prototype.replace=function(l){l.parent!=null&&(l.parent.insertBefore(this,l.next),l.remove())},a.prototype.replaceWith=function(l,c){var h=typeof l=="string"?s.create(l,c):l;return h.replace(this),h},a.prototype.split=function(l,c){return l===0?this:this.next},a.prototype.update=function(l,c){},a.prototype.wrap=function(l,c){var h=typeof l=="string"?s.create(l,c):l;return this.parent!=null&&this.parent.insertBefore(h,this.next),h.appendChild(this),h},a.blotName="abstract",a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),a=i(33),l=i(1),c=function(){function h(d){this.attributes={},this.domNode=d,this.build()}return h.prototype.attribute=function(d,f){f?d.add(this.domNode,f)&&(d.value(this.domNode)!=null?this.attributes[d.attrName]=d:delete this.attributes[d.attrName]):(d.remove(this.domNode),delete this.attributes[d.attrName])},h.prototype.build=function(){var d=this;this.attributes={};var f=s.default.keys(this.domNode),p=o.default.keys(this.domNode),_=a.default.keys(this.domNode);f.concat(p).concat(_).forEach(function(g){var y=l.query(g,l.Scope.ATTRIBUTE);y instanceof s.default&&(d.attributes[y.attrName]=y)})},h.prototype.copy=function(d){var f=this;Object.keys(this.attributes).forEach(function(p){var _=f.attributes[p].value(f.domNode);d.format(p,_)})},h.prototype.move=function(d){var f=this;this.copy(d),Object.keys(this.attributes).forEach(function(p){f.attributes[p].remove(f.domNode)}),this.attributes={}},h.prototype.values=function(){var d=this;return Object.keys(this.attributes).reduce(function(f,p){return f[p]=d.attributes[p].value(d.domNode),f},{})},h}();n.default=c},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){c(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(c,h){var d=c.getAttribute("class")||"";return d.split(/\s+/).filter(function(f){return f.indexOf(h+"-")===0})}var l=function(c){s(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.keys=function(d){return(d.getAttribute("class")||"").split(/\s+/).map(function(f){return f.split("-").slice(0,-1).join("-")})},h.prototype.add=function(d,f){return this.canAdd(d,f)?(this.remove(d),d.classList.add(this.keyName+"-"+f),!0):!1},h.prototype.remove=function(d){var f=a(d,this.keyName);f.forEach(function(p){d.classList.remove(p)}),d.classList.length===0&&d.removeAttribute("class")},h.prototype.value=function(d){var f=a(d,this.keyName)[0]||"",p=f.slice(this.keyName.length+1);return this.canAdd(d,p)?p:""},h}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){c(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(c){var h=c.split("-"),d=h.slice(1).map(function(f){return f[0].toUpperCase()+f.slice(1)}).join("");return h[0]+d}var l=function(c){s(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.keys=function(d){return(d.getAttribute("style")||"").split(";").map(function(f){var p=f.split(":");return p[0].trim()})},h.prototype.add=function(d,f){return this.canAdd(d,f)?(d.style[a(this.keyName)]=f,!0):!1},h.prototype.remove=function(d){d.style[a(this.keyName)]="",d.getAttribute("style")||d.removeAttribute("style")},h.prototype.value=function(d){var f=d.style[a(this.keyName)];return this.canAdd(d,f)?f:""},h}(o.default);n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(c,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}}return function(c,h,d){return h&&l(c.prototype,h),d&&l(c,d),c}}();function o(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(c,h){o(this,l),this.quill=c,this.options=h,this.modules={}}return s(l,[{key:"init",value:function(){var h=this;Object.keys(this.options.modules).forEach(function(d){h.modules[d]==null&&h.addModule(d)})}},{key:"addModule",value:function(h){var d=this.quill.constructor.import("modules/"+h);return this.modules[h]=new d(this.quill,this.options.modules[h]||{}),this.modules[h]}}]),l}();a.DEFAULTS={modules:{}},a.themes={default:a},n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,S){for(var v=0;v<S.length;v++){var O=S[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,S,v){return S&&m(b.prototype,S),v&&m(b,v),b}}(),o=function m(b,S,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,S);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,S,v)}else{if("value"in O)return O.value;var E=O.get;return E===void 0?void 0:E.call(v)}},a=i(0),l=d(a),c=i(7),h=d(c);function d(m){return m&&m.__esModule?m:{default:m}}function f(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function p(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function _(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var g="\uFEFF",y=function(m){_(b,m);function b(S){f(this,b);var v=p(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,S));return v.contentNode=document.createElement("span"),v.contentNode.setAttribute("contenteditable",!1),[].slice.call(v.domNode.childNodes).forEach(function(O){v.contentNode.appendChild(O)}),v.leftGuard=document.createTextNode(g),v.rightGuard=document.createTextNode(g),v.domNode.appendChild(v.leftGuard),v.domNode.appendChild(v.contentNode),v.domNode.appendChild(v.rightGuard),v}return s(b,[{key:"index",value:function(v,O){return v===this.leftGuard?0:v===this.rightGuard?1:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,O)}},{key:"restore",value:function(v){var O=void 0,R=void 0,E=v.data.split(g).join("");if(v===this.leftGuard)if(this.prev instanceof h.default){var w=this.prev.length();this.prev.insertAt(w,E),O={startNode:this.prev.domNode,startOffset:w+E.length}}else R=document.createTextNode(E),this.parent.insertBefore(l.default.create(R),this),O={startNode:R,startOffset:E.length};else v===this.rightGuard&&(this.next instanceof h.default?(this.next.insertAt(0,E),O={startNode:this.next.domNode,startOffset:E.length}):(R=document.createTextNode(E),this.parent.insertBefore(l.default.create(R),this.next),O={startNode:R,startOffset:E.length}));return v.data=g,O}},{key:"update",value:function(v,O){var R=this;v.forEach(function(E){if(E.type==="characterData"&&(E.target===R.leftGuard||E.target===R.rightGuard)){var w=R.restore(E.target);w&&(O.range=w)}})}}]),b}(l.default.Embed);n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},c=new o.default.Attributor.Attribute("align","align",l),h=new o.default.Attributor.Class("align","ql-align",l),d=new o.default.Attributor.Style("align","text-align",l);n.AlignAttribute=c,n.AlignClass=h,n.AlignStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=l(s),a=i(26);function l(d){return d&&d.__esModule?d:{default:d}}var c=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),h=new a.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=c,n.BackgroundStyle=h},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},c=new o.default.Attributor.Attribute("direction","dir",l),h=new o.default.Attributor.Class("direction","ql-direction",l),d=new o.default.Attributor.Style("direction","direction",l);n.DirectionAttribute=c,n.DirectionClass=h,n.DirectionStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function m(b,S){for(var v=0;v<S.length;v++){var O=S[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,S,v){return S&&m(b.prototype,S),v&&m(b,v),b}}(),o=function m(b,S,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,S);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,S,v)}else{if("value"in O)return O.value;var E=O.get;return E===void 0?void 0:E.call(v)}},a=i(0),l=c(a);function c(m){return m&&m.__esModule?m:{default:m}}function h(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function d(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function f(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var p={scope:l.default.Scope.INLINE,whitelist:["serif","monospace"]},_=new l.default.Attributor.Class("font","ql-font",p),g=function(m){f(b,m);function b(){return h(this,b),d(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"value",value:function(v){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,v).replace(/["']/g,"")}}]),b}(l.default.Attributor.Style),y=new g("font","font-family",p);n.FontStyle=y,n.FontClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=a(s);function a(h){return h&&h.__esModule?h:{default:h}}var l=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),c=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=l,n.SizeStyle=c},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function S(v,O){for(var R=0;R<O.length;R++){var E=O[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(v,E.key,E)}}return function(v,O,R){return O&&S(v.prototype,O),R&&S(v,R),v}}(),o=i(0),a=f(o),l=i(5),c=f(l),h=i(9),d=f(h);function f(S){return S&&S.__esModule?S:{default:S}}function p(S,v){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}function _(S,v){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:S}function g(S,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);S.prototype=Object.create(v&&v.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(S,v):S.__proto__=v)}var y=function(S){g(v,S);function v(O,R){p(this,v);var E=_(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,O,R));return E.lastRecorded=0,E.ignoreChange=!1,E.clear(),E.quill.on(c.default.events.EDITOR_CHANGE,function(w,N,T,x){w!==c.default.events.TEXT_CHANGE||E.ignoreChange||(!E.options.userOnly||x===c.default.sources.USER?E.record(N,T):E.transform(N))}),E.quill.keyboard.addBinding({key:"Z",shortKey:!0},E.undo.bind(E)),E.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},E.redo.bind(E)),/Win/i.test(navigator.platform)&&E.quill.keyboard.addBinding({key:"Y",shortKey:!0},E.redo.bind(E)),E}return s(v,[{key:"change",value:function(R,E){if(this.stack[R].length!==0){var w=this.stack[R].pop();this.stack[E].push(w),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(w[R],c.default.sources.USER),this.ignoreChange=!1;var N=b(w[R]);this.quill.setSelection(N)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(R,E){if(R.ops.length!==0){this.stack.redo=[];var w=this.quill.getContents().diff(E),N=Date.now();if(this.lastRecorded+this.options.delay>N&&this.stack.undo.length>0){var T=this.stack.undo.pop();w=w.compose(T.undo),R=T.redo.compose(R)}else this.lastRecorded=N;this.stack.undo.push({redo:R,undo:w}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(R){this.stack.undo.forEach(function(E){E.undo=R.transform(E.undo,!0),E.redo=R.transform(E.redo,!0)}),this.stack.redo.forEach(function(E){E.undo=R.transform(E.undo,!0),E.redo=R.transform(E.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),v}(d.default);y.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function m(S){var v=S.ops[S.ops.length-1];return v==null?!1:v.insert!=null?typeof v.insert=="string"&&v.insert.endsWith(`
`):v.attributes!=null?Object.keys(v.attributes).some(function(O){return a.default.query(O,a.default.Scope.BLOCK)!=null}):!1}function b(S){var v=S.reduce(function(R,E){return R+=E.delete||0,R},0),O=S.length()-v;return m(S)&&(O-=1),O}n.default=y,n.getLastChangeIndex=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function $(F,W){for(var U=0;U<W.length;U++){var M=W[U];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,W,U){return W&&$(F.prototype,W),U&&$(F,U),F}}(),o=function $(F,W,U){F===null&&(F=Function.prototype);var M=Object.getOwnPropertyDescriptor(F,W);if(M===void 0){var B=Object.getPrototypeOf(F);return B===null?void 0:$(B,W,U)}else{if("value"in M)return M.value;var G=M.get;return G===void 0?void 0:G.call(U)}},a=i(3),l=N(a),c=i(2),h=N(c),d=i(8),f=N(d),p=i(23),_=N(p),g=i(34),y=N(g),m=i(59),b=N(m),S=i(60),v=N(S),O=i(28),R=N(O),E=i(61),w=N(E);function N($){return $&&$.__esModule?$:{default:$}}function T($,F){if(!($ instanceof F))throw new TypeError("Cannot call a class as a function")}function x($,F){if(!$)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:$}function I($,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);$.prototype=Object.create(F&&F.prototype,{constructor:{value:$,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf($,F):$.__proto__=F)}var k=[!1,"center","right","justify"],j=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],V=[!1,"serif","monospace"],z=["1","2","3",!1],H=["small",!1,"large","huge"],te=function($){I(F,$);function F(W,U){T(this,F);var M=x(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,W,U)),B=function G(J){if(!document.body.contains(W.root))return document.body.removeEventListener("click",G);M.tooltip!=null&&!M.tooltip.root.contains(J.target)&&document.activeElement!==M.tooltip.textbox&&!M.quill.hasFocus()&&M.tooltip.hide(),M.pickers!=null&&M.pickers.forEach(function(re){re.container.contains(J.target)||re.close()})};return W.emitter.listenDOM("click",document.body,B),M}return s(F,[{key:"addModule",value:function(U){var M=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"addModule",this).call(this,U);return U==="toolbar"&&this.extendToolbar(M),M}},{key:"buildButtons",value:function(U,M){U.forEach(function(B){var G=B.getAttribute("class")||"";G.split(/\s+/).forEach(function(J){if(J.startsWith("ql-")&&(J=J.slice(3),M[J]!=null))if(J==="direction")B.innerHTML=M[J][""]+M[J].rtl;else if(typeof M[J]=="string")B.innerHTML=M[J];else{var re=B.value||"";re!=null&&M[J][re]&&(B.innerHTML=M[J][re])}})})}},{key:"buildPickers",value:function(U,M){var B=this;this.pickers=U.map(function(J){if(J.classList.contains("ql-align"))return J.querySelector("option")==null&&L(J,k),new v.default(J,M.align);if(J.classList.contains("ql-background")||J.classList.contains("ql-color")){var re=J.classList.contains("ql-background")?"background":"color";return J.querySelector("option")==null&&L(J,j,re==="background"?"#ffffff":"#000000"),new b.default(J,M[re])}else return J.querySelector("option")==null&&(J.classList.contains("ql-font")?L(J,V):J.classList.contains("ql-header")?L(J,z):J.classList.contains("ql-size")&&L(J,H)),new R.default(J)});var G=function(){B.pickers.forEach(function(re){re.update()})};this.quill.on(f.default.events.EDITOR_CHANGE,G)}}]),F}(y.default);te.DEFAULTS=(0,l.default)(!0,{},y.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var F=this,W=this.container.querySelector("input.ql-image[type=file]");W==null&&(W=document.createElement("input"),W.setAttribute("type","file"),W.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),W.classList.add("ql-image"),W.addEventListener("change",function(){if(W.files!=null&&W.files[0]!=null){var U=new FileReader;U.onload=function(M){var B=F.quill.getSelection(!0);F.quill.updateContents(new h.default().retain(B.index).delete(B.length).insert({image:M.target.result}),f.default.sources.USER),F.quill.setSelection(B.index+1,f.default.sources.SILENT),W.value=""},U.readAsDataURL(W.files[0])}}),this.container.appendChild(W)),W.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var K=function($){I(F,$);function F(W,U){T(this,F);var M=x(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,W,U));return M.textbox=M.root.querySelector('input[type="text"]'),M.listen(),M}return s(F,[{key:"listen",value:function(){var U=this;this.textbox.addEventListener("keydown",function(M){_.default.match(M,"enter")?(U.save(),M.preventDefault()):_.default.match(M,"escape")&&(U.cancel(),M.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),M!=null?this.textbox.value=M:U!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+U)||""),this.root.setAttribute("data-mode",U)}},{key:"restoreFocus",value:function(){var U=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=U}},{key:"save",value:function(){var U=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var M=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",U,f.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",U,f.default.sources.USER)),this.quill.root.scrollTop=M;break}case"video":U=q(U);case"formula":{if(!U)break;var B=this.quill.getSelection(!0);if(B!=null){var G=B.index+B.length;this.quill.insertEmbed(G,this.root.getAttribute("data-mode"),U,f.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(G+1," ",f.default.sources.USER),this.quill.setSelection(G+2,f.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),F}(w.default);function q($){var F=$.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||$.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return F?(F[1]||"https")+"://www.youtube.com/embed/"+F[2]+"?showinfo=0":(F=$.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(F[1]||"https")+"://player.vimeo.com/video/"+F[2]+"/":$}function L($,F){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;F.forEach(function(U){var M=document.createElement("option");U===W?M.setAttribute("selected","selected"):M.setAttribute("value",U),$.appendChild(M)})}n.BaseTooltip=K,n.default=te},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];this.insertBefore(a[0],null),a.length>1&&this.append.apply(this,a.slice(1))},o.prototype.contains=function(a){for(var l,c=this.iterator();l=c();)if(l===a)return!0;return!1},o.prototype.insertBefore=function(a,l){a&&(a.next=l,l!=null?(a.prev=l.prev,l.prev!=null&&(l.prev.next=a),l.prev=a,l===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)},o.prototype.offset=function(a){for(var l=0,c=this.head;c!=null;){if(c===a)return l;l+=c.length(),c=c.next}return-1},o.prototype.remove=function(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)},o.prototype.iterator=function(a){return a===void 0&&(a=this.head),function(){var l=a;return a!=null&&(a=a.next),l}},o.prototype.find=function(a,l){l===void 0&&(l=!1);for(var c,h=this.iterator();c=h();){var d=c.length();if(a<d||l&&a===d&&(c.next==null||c.next.length()!==0))return[c,a];a-=d}return[null,0]},o.prototype.forEach=function(a){for(var l,c=this.iterator();l=c();)a(l)},o.prototype.forEachAt=function(a,l,c){if(!(l<=0))for(var h=this.find(a),d=h[0],f=h[1],p,_=a-f,g=this.iterator(d);(p=g())&&_<a+l;){var y=p.length();a>_?c(p,a-_,Math.min(l,_+y-a)):c(p,0,Math.min(y,a+l-_)),_+=y}},o.prototype.map=function(a){return this.reduce(function(l,c){return l.push(a(c)),l},[])},o.prototype.reduce=function(a,l){for(var c,h=this.iterator();c=h();)l=a(l,c);return l},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),a=i(1),l={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},c=100,h=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.scroll=_,_.observer=new MutationObserver(function(g){_.update(g)}),_.observer.observe(_.domNode,l),_.attach(),_}return f.prototype.detach=function(){d.prototype.detach.call(this),this.observer.disconnect()},f.prototype.deleteAt=function(p,_){this.update(),p===0&&_===this.length()?this.children.forEach(function(g){g.remove()}):d.prototype.deleteAt.call(this,p,_)},f.prototype.formatAt=function(p,_,g,y){this.update(),d.prototype.formatAt.call(this,p,_,g,y)},f.prototype.insertAt=function(p,_,g){this.update(),d.prototype.insertAt.call(this,p,_,g)},f.prototype.optimize=function(p,_){var g=this;p===void 0&&(p=[]),_===void 0&&(_={}),d.prototype.optimize.call(this,_);for(var y=[].slice.call(this.observer.takeRecords());y.length>0;)p.push(y.pop());for(var m=function(O,R){R===void 0&&(R=!0),!(O==null||O===g)&&O.domNode.parentNode!=null&&(O.domNode[a.DATA_KEY].mutations==null&&(O.domNode[a.DATA_KEY].mutations=[]),R&&m(O.parent))},b=function(O){O.domNode[a.DATA_KEY]==null||O.domNode[a.DATA_KEY].mutations==null||(O instanceof o.default&&O.children.forEach(b),O.optimize(_))},S=p,v=0;S.length>0;v+=1){if(v>=c)throw new Error("[Parchment] Maximum optimize iterations reached");for(S.forEach(function(O){var R=a.find(O.target,!0);R!=null&&(R.domNode===O.target&&(O.type==="childList"?(m(a.find(O.previousSibling,!1)),[].forEach.call(O.addedNodes,function(E){var w=a.find(E,!1);m(w,!1),w instanceof o.default&&w.children.forEach(function(N){m(N,!1)})})):O.type==="attributes"&&m(R.prev)),m(R))}),this.children.forEach(b),S=[].slice.call(this.observer.takeRecords()),y=S.slice();y.length>0;)p.push(y.pop())}},f.prototype.update=function(p,_){var g=this;_===void 0&&(_={}),p=p||this.observer.takeRecords(),p.map(function(y){var m=a.find(y.target,!0);return m==null?null:m.domNode[a.DATA_KEY].mutations==null?(m.domNode[a.DATA_KEY].mutations=[y],m):(m.domNode[a.DATA_KEY].mutations.push(y),null)}).forEach(function(y){y==null||y===g||y.domNode[a.DATA_KEY]==null||y.update(y.domNode[a.DATA_KEY].mutations||[],_)}),this.domNode[a.DATA_KEY].mutations!=null&&d.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,_),this.optimize(p,_)},f.blotName="scroll",f.defaultChild="block",f.scope=a.Scope.BLOCK_BLOT,f.tagName="DIV",f}(o.default);n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var p in f)f.hasOwnProperty(p)&&(d[p]=f[p])};return function(d,f){h(d,f);function p(){this.constructor=d}d.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1);function l(h,d){if(Object.keys(h).length!==Object.keys(d).length)return!1;for(var f in h)if(h[f]!==d[f])return!1;return!0}var c=function(h){s(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.formats=function(f){if(f.tagName!==d.tagName)return h.formats.call(this,f)},d.prototype.format=function(f,p){var _=this;f===this.statics.blotName&&!p?(this.children.forEach(function(g){g instanceof o.default||(g=g.wrap(d.blotName,!0)),_.attributes.copy(g)}),this.unwrap()):h.prototype.format.call(this,f,p)},d.prototype.formatAt=function(f,p,_,g){if(this.formats()[_]!=null||a.query(_,a.Scope.ATTRIBUTE)){var y=this.isolate(f,p);y.format(_,g)}else h.prototype.formatAt.call(this,f,p,_,g)},d.prototype.optimize=function(f){h.prototype.optimize.call(this,f);var p=this.formats();if(Object.keys(p).length===0)return this.unwrap();var _=this.next;_ instanceof d&&_.prev===this&&l(p,_.formats())&&(_.moveChildren(this),_.remove())},d.blotName="inline",d.scope=a.Scope.INLINE_BLOT,d.tagName="SPAN",d}(o.default);n.default=c},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){c(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1),l=function(c){s(h,c);function h(){return c!==null&&c.apply(this,arguments)||this}return h.formats=function(d){var f=a.query(h.blotName).tagName;if(d.tagName!==f)return c.formats.call(this,d)},h.prototype.format=function(d,f){a.query(d,a.Scope.BLOCK)!=null&&(d===this.statics.blotName&&!f?this.replaceWith(h.blotName):c.prototype.format.call(this,d,f))},h.prototype.formatAt=function(d,f,p,_){a.query(p,a.Scope.BLOCK)!=null?this.format(p,_):c.prototype.formatAt.call(this,d,f,p,_)},h.prototype.insertAt=function(d,f,p){if(p==null||a.query(f,a.Scope.INLINE)!=null)c.prototype.insertAt.call(this,d,f,p);else{var _=this.split(d),g=a.create(f,p);_.parent.insertBefore(g,_)}},h.prototype.update=function(d,f){navigator.userAgent.match(/Trident/)?this.build():c.prototype.update.call(this,d,f)},h.blotName="block",h.scope=a.Scope.BLOCK_BLOT,h.tagName="P",h}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,h){c.__proto__=h}||function(c,h){for(var d in h)h.hasOwnProperty(d)&&(c[d]=h[d])};return function(c,h){l(c,h);function d(){this.constructor=c}c.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=function(l){s(c,l);function c(){return l!==null&&l.apply(this,arguments)||this}return c.formats=function(h){},c.prototype.format=function(h,d){l.prototype.formatAt.call(this,0,this.length(),h,d)},c.prototype.formatAt=function(h,d,f,p){h===0&&d===this.length()?this.format(f,p):l.prototype.formatAt.call(this,h,d,f,p)},c.prototype.formats=function(){return this.statics.formats(this.domNode)},c}(o.default);n.default=a},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){c(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=i(1),l=function(c){s(h,c);function h(d){var f=c.call(this,d)||this;return f.text=f.statics.value(f.domNode),f}return h.create=function(d){return document.createTextNode(d)},h.value=function(d){var f=d.data;return f.normalize&&(f=f.normalize()),f},h.prototype.deleteAt=function(d,f){this.domNode.data=this.text=this.text.slice(0,d)+this.text.slice(d+f)},h.prototype.index=function(d,f){return this.domNode===d?f:-1},h.prototype.insertAt=function(d,f,p){p==null?(this.text=this.text.slice(0,d)+f+this.text.slice(d),this.domNode.data=this.text):c.prototype.insertAt.call(this,d,f,p)},h.prototype.length=function(){return this.text.length},h.prototype.optimize=function(d){c.prototype.optimize.call(this,d),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof h&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},h.prototype.position=function(d,f){return[this.domNode,d]},h.prototype.split=function(d,f){if(f===void 0&&(f=!1),!f){if(d===0)return this;if(d===this.length())return this.next}var p=a.create(this.domNode.splitText(d));return this.parent.insertBefore(p,this.next),this.text=this.statics.value(this.domNode),p},h.prototype.update=function(d,f){var p=this;d.some(function(_){return _.type==="characterData"&&_.target===p.domNode})&&(this.text=this.statics.value(this.domNode))},h.prototype.value=function(){return this.text},h.blotName="text",h.scope=a.Scope.INLINE_BLOT,h}(o.default);n.default=l},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,l){return arguments.length>1&&!this.contains(a)==!l?l:o.call(this,a)}}String.prototype.startsWith||(String.prototype.startsWith=function(a,l){return l=l||0,this.substr(l,a.length)===a}),String.prototype.endsWith||(String.prototype.endsWith=function(a,l){var c=this.toString();(typeof l!="number"||!isFinite(l)||Math.floor(l)!==l||l>c.length)&&(l=c.length),l-=a.length;var h=c.indexOf(a,l);return h!==-1&&h===l}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("predicate must be a function");for(var c=Object(this),h=c.length>>>0,d=arguments[1],f,p=0;p<h;p++)if(f=c[p],l.call(d,f,p,c))return f}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function a(v,O,R){if(v==O)return v?[[o,v]]:[];(R<0||v.length<R)&&(R=null);var E=d(v,O),w=v.substring(0,E);v=v.substring(E),O=O.substring(E),E=f(v,O);var N=v.substring(v.length-E);v=v.substring(0,v.length-E),O=O.substring(0,O.length-E);var T=l(v,O);return w&&T.unshift([o,w]),N&&T.push([o,N]),_(T),R!=null&&(T=m(T,R)),T=b(T),T}function l(v,O){var R;if(!v)return[[s,O]];if(!O)return[[i,v]];var E=v.length>O.length?v:O,w=v.length>O.length?O:v,N=E.indexOf(w);if(N!=-1)return R=[[s,E.substring(0,N)],[o,w],[s,E.substring(N+w.length)]],v.length>O.length&&(R[0][0]=R[2][0]=i),R;if(w.length==1)return[[i,v],[s,O]];var T=p(v,O);if(T){var x=T[0],I=T[1],k=T[2],j=T[3],V=T[4],z=a(x,k),H=a(I,j);return z.concat([[o,V]],H)}return c(v,O)}function c(v,O){for(var R=v.length,E=O.length,w=Math.ceil((R+E)/2),N=w,T=2*w,x=new Array(T),I=new Array(T),k=0;k<T;k++)x[k]=-1,I[k]=-1;x[N+1]=0,I[N+1]=0;for(var j=R-E,V=j%2!=0,z=0,H=0,te=0,K=0,q=0;q<w;q++){for(var L=-q+z;L<=q-H;L+=2){var $=N+L,F;L==-q||L!=q&&x[$-1]<x[$+1]?F=x[$+1]:F=x[$-1]+1;for(var W=F-L;F<R&&W<E&&v.charAt(F)==O.charAt(W);)F++,W++;if(x[$]=F,F>R)H+=2;else if(W>E)z+=2;else if(V){var U=N+j-L;if(U>=0&&U<T&&I[U]!=-1){var M=R-I[U];if(F>=M)return h(v,O,F,W)}}}for(var B=-q+te;B<=q-K;B+=2){var U=N+B,M;B==-q||B!=q&&I[U-1]<I[U+1]?M=I[U+1]:M=I[U-1]+1;for(var G=M-B;M<R&&G<E&&v.charAt(R-M-1)==O.charAt(E-G-1);)M++,G++;if(I[U]=M,M>R)K+=2;else if(G>E)te+=2;else if(!V){var $=N+j-B;if($>=0&&$<T&&x[$]!=-1){var F=x[$],W=N+F-$;if(M=R-M,F>=M)return h(v,O,F,W)}}}}return[[i,v],[s,O]]}function h(v,O,R,E){var w=v.substring(0,R),N=O.substring(0,E),T=v.substring(R),x=O.substring(E),I=a(w,N),k=a(T,x);return I.concat(k)}function d(v,O){if(!v||!O||v.charAt(0)!=O.charAt(0))return 0;for(var R=0,E=Math.min(v.length,O.length),w=E,N=0;R<w;)v.substring(N,w)==O.substring(N,w)?(R=w,N=R):E=w,w=Math.floor((E-R)/2+R);return w}function f(v,O){if(!v||!O||v.charAt(v.length-1)!=O.charAt(O.length-1))return 0;for(var R=0,E=Math.min(v.length,O.length),w=E,N=0;R<w;)v.substring(v.length-w,v.length-N)==O.substring(O.length-w,O.length-N)?(R=w,N=R):E=w,w=Math.floor((E-R)/2+R);return w}function p(v,O){var R=v.length>O.length?v:O,E=v.length>O.length?O:v;if(R.length<4||E.length*2<R.length)return null;function w(H,te,K){for(var q=H.substring(K,K+Math.floor(H.length/4)),L=-1,$="",F,W,U,M;(L=te.indexOf(q,L+1))!=-1;){var B=d(H.substring(K),te.substring(L)),G=f(H.substring(0,K),te.substring(0,L));$.length<G+B&&($=te.substring(L-G,L)+te.substring(L,L+B),F=H.substring(0,K-G),W=H.substring(K+B),U=te.substring(0,L-G),M=te.substring(L+B))}return $.length*2>=H.length?[F,W,U,M,$]:null}var N=w(R,E,Math.ceil(R.length/4)),T=w(R,E,Math.ceil(R.length/2)),x;if(!N&&!T)return null;T?N?x=N[4].length>T[4].length?N:T:x=T:x=N;var I,k,j,V;v.length>O.length?(I=x[0],k=x[1],j=x[2],V=x[3]):(j=x[0],V=x[1],I=x[2],k=x[3]);var z=x[4];return[I,k,j,V,z]}function _(v){v.push([o,""]);for(var O=0,R=0,E=0,w="",N="",T;O<v.length;)switch(v[O][0]){case s:E++,N+=v[O][1],O++;break;case i:R++,w+=v[O][1],O++;break;case o:R+E>1?(R!==0&&E!==0&&(T=d(N,w),T!==0&&(O-R-E>0&&v[O-R-E-1][0]==o?v[O-R-E-1][1]+=N.substring(0,T):(v.splice(0,0,[o,N.substring(0,T)]),O++),N=N.substring(T),w=w.substring(T)),T=f(N,w),T!==0&&(v[O][1]=N.substring(N.length-T)+v[O][1],N=N.substring(0,N.length-T),w=w.substring(0,w.length-T))),R===0?v.splice(O-E,R+E,[s,N]):E===0?v.splice(O-R,R+E,[i,w]):v.splice(O-R-E,R+E,[i,w],[s,N]),O=O-R-E+(R?1:0)+(E?1:0)+1):O!==0&&v[O-1][0]==o?(v[O-1][1]+=v[O][1],v.splice(O,1)):O++,E=0,R=0,w="",N="";break}v[v.length-1][1]===""&&v.pop();var x=!1;for(O=1;O<v.length-1;)v[O-1][0]==o&&v[O+1][0]==o&&(v[O][1].substring(v[O][1].length-v[O-1][1].length)==v[O-1][1]?(v[O][1]=v[O-1][1]+v[O][1].substring(0,v[O][1].length-v[O-1][1].length),v[O+1][1]=v[O-1][1]+v[O+1][1],v.splice(O-1,1),x=!0):v[O][1].substring(0,v[O+1][1].length)==v[O+1][1]&&(v[O-1][1]+=v[O+1][1],v[O][1]=v[O][1].substring(v[O+1][1].length)+v[O+1][1],v.splice(O+1,1),x=!0)),O++;x&&_(v)}var g=a;g.INSERT=s,g.DELETE=i,g.EQUAL=o,t.exports=g;function y(v,O){if(O===0)return[o,v];for(var R=0,E=0;E<v.length;E++){var w=v[E];if(w[0]===i||w[0]===o){var N=R+w[1].length;if(O===N)return[E+1,v];if(O<N){v=v.slice();var T=O-R,x=[w[0],w[1].slice(0,T)],I=[w[0],w[1].slice(T)];return v.splice(E,1,x,I),[E+1,v]}else R=N}}throw new Error("cursor_pos is out of bounds!")}function m(v,O){var R=y(v,O),E=R[1],w=R[0],N=E[w],T=E[w+1];if(N==null)return v;if(N[0]!==o)return v;if(T!=null&&N[1]+T[1]===T[1]+N[1])return E.splice(w,2,T,N),S(E,w,2);if(T!=null&&T[1].indexOf(N[1])===0){E.splice(w,2,[T[0],N[1]],[0,N[1]]);var x=T[1].slice(N[1].length);return x.length>0&&E.splice(w+2,0,[T[0],x]),S(E,w,3)}else return v}function b(v){for(var O=!1,R=function(T){return T.charCodeAt(0)>=56320&&T.charCodeAt(0)<=57343},E=function(T){return T.charCodeAt(T.length-1)>=55296&&T.charCodeAt(T.length-1)<=56319},w=2;w<v.length;w+=1)v[w-2][0]===o&&E(v[w-2][1])&&v[w-1][0]===i&&R(v[w-1][1])&&v[w][0]===s&&R(v[w][1])&&(O=!0,v[w-1][1]=v[w-2][1].slice(-1)+v[w-1][1],v[w][1]=v[w-2][1].slice(-1)+v[w][1],v[w-2][1]=v[w-2][1].slice(0,-1));if(!O)return v;for(var N=[],w=0;w<v.length;w+=1)v[w][1].length>0&&N.push(v[w]);return N}function S(v,O,R){for(var E=O+R-1;E>=0&&E>=O-1;E--)if(E+1<v.length){var w=v[E],N=v[E+1];w[0]===N[1]&&v.splice(E,2,[w[0],w[1]+N[1]])}return v}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var a in s)o.push(a);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(a){return Object.prototype.toString.call(a)=="[object Arguments]"}n.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function a(c,h,d){this.fn=c,this.context=h,this.once=d||!1}function l(){this._events=new o,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],d,f;if(this._eventsCount===0)return h;for(f in d=this._events)i.call(d,f)&&h.push(s?f.slice(1):f);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},l.prototype.listeners=function(h,d){var f=s?s+h:h,p=this._events[f];if(d)return!!p;if(!p)return[];if(p.fn)return[p.fn];for(var _=0,g=p.length,y=new Array(g);_<g;_++)y[_]=p[_].fn;return y},l.prototype.emit=function(h,d,f,p,_,g){var y=s?s+h:h;if(!this._events[y])return!1;var m=this._events[y],b=arguments.length,S,v;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),b){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,f),!0;case 4:return m.fn.call(m.context,d,f,p),!0;case 5:return m.fn.call(m.context,d,f,p,_),!0;case 6:return m.fn.call(m.context,d,f,p,_,g),!0}for(v=1,S=new Array(b-1);v<b;v++)S[v-1]=arguments[v];m.fn.apply(m.context,S)}else{var O=m.length,R;for(v=0;v<O;v++)switch(m[v].once&&this.removeListener(h,m[v].fn,void 0,!0),b){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,d);break;case 3:m[v].fn.call(m[v].context,d,f);break;case 4:m[v].fn.call(m[v].context,d,f,p);break;default:if(!S)for(R=1,S=new Array(b-1);R<b;R++)S[R-1]=arguments[R];m[v].fn.apply(m[v].context,S)}}return!0},l.prototype.on=function(h,d,f){var p=new a(d,f||this),_=s?s+h:h;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.once=function(h,d,f){var p=new a(d,f||this,!0),_=s?s+h:h;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.removeListener=function(h,d,f,p){var _=s?s+h:h;if(!this._events[_])return this;if(!d)return--this._eventsCount===0?this._events=new o:delete this._events[_],this;var g=this._events[_];if(g.fn)g.fn===d&&(!p||g.once)&&(!f||g.context===f)&&(--this._eventsCount===0?this._events=new o:delete this._events[_]);else{for(var y=0,m=[],b=g.length;y<b;y++)(g[y].fn!==d||p&&!g[y].once||f&&g[y].context!==f)&&m.push(g[y]);m.length?this._events[_]=m.length===1?m[0]:m:--this._eventsCount===0?this._events=new o:delete this._events[_]}return this},l.prototype.removeAllListeners=function(h){var d;return h?(d=s?s+h:h,this._events[d]&&(--this._eventsCount===0?this._events=new o:delete this._events[d])):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prototype.setMaxListeners=function(){return this},l.prefixed=s,l.EventEmitter=l,typeof t<"u"&&(t.exports=l)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z},o=function(){function Z(ee,le){var ce=[],se=!0,we=!1,Ee=void 0;try{for(var ke=ee[Symbol.iterator](),Ve;!(se=(Ve=ke.next()).done)&&(ce.push(Ve.value),!(le&&ce.length===le));se=!0);}catch(Ue){we=!0,Ee=Ue}finally{try{!se&&ke.return&&ke.return()}finally{if(we)throw Ee}}return ce}return function(ee,le){if(Array.isArray(ee))return ee;if(Symbol.iterator in Object(ee))return Z(ee,le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Z(ee,le){for(var ce=0;ce<le.length;ce++){var se=le[ce];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(ee,se.key,se)}}return function(ee,le,ce){return le&&Z(ee.prototype,le),ce&&Z(ee,ce),ee}}(),l=i(3),c=I(l),h=i(2),d=I(h),f=i(0),p=I(f),_=i(5),g=I(_),y=i(10),m=I(y),b=i(9),S=I(b),v=i(36),O=i(37),R=i(13),E=I(R),w=i(26),N=i(38),T=i(39),x=i(40);function I(Z){return Z&&Z.__esModule?Z:{default:Z}}function k(Z,ee,le){return ee in Z?Object.defineProperty(Z,ee,{value:le,enumerable:!0,configurable:!0,writable:!0}):Z[ee]=le,Z}function j(Z,ee){if(!(Z instanceof ee))throw new TypeError("Cannot call a class as a function")}function V(Z,ee){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee&&(typeof ee=="object"||typeof ee=="function")?ee:Z}function z(Z,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ee);Z.prototype=Object.create(ee&&ee.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),ee&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,ee):Z.__proto__=ee)}var H=(0,m.default)("quill:clipboard"),te="__ql-matcher",K=[[Node.TEXT_NODE,Ye],[Node.TEXT_NODE,Se],["br",ue],[Node.ELEMENT_NODE,Se],[Node.ELEMENT_NODE,re],[Node.ELEMENT_NODE,Le],[Node.ELEMENT_NODE,J],[Node.ELEMENT_NODE,lt],["li",ye],["b",G.bind(G,"bold")],["i",G.bind(G,"italic")],["style",me]],q=[v.AlignAttribute,N.DirectionAttribute].reduce(function(Z,ee){return Z[ee.keyName]=ee,Z},{}),L=[v.AlignStyle,O.BackgroundStyle,w.ColorStyle,N.DirectionStyle,T.FontStyle,x.SizeStyle].reduce(function(Z,ee){return Z[ee.keyName]=ee,Z},{}),$=function(Z){z(ee,Z);function ee(le,ce){j(this,ee);var se=V(this,(ee.__proto__||Object.getPrototypeOf(ee)).call(this,le,ce));return se.quill.root.addEventListener("paste",se.onPaste.bind(se)),se.container=se.quill.addContainer("ql-clipboard"),se.container.setAttribute("contenteditable",!0),se.container.setAttribute("tabindex",-1),se.matchers=[],K.concat(se.options.matchers).forEach(function(we){var Ee=o(we,2),ke=Ee[0],Ve=Ee[1];!ce.matchVisual&&Ve===Le||se.addMatcher(ke,Ve)}),se}return a(ee,[{key:"addMatcher",value:function(ce,se){this.matchers.push([ce,se])}},{key:"convert",value:function(ce){if(typeof ce=="string")return this.container.innerHTML=ce.replace(/\>\r?\n +\</g,"><"),this.convert();var se=this.quill.getFormat(this.quill.selection.savedRange.index);if(se[E.default.blotName]){var we=this.container.innerText;return this.container.innerHTML="",new d.default().insert(we,k({},E.default.blotName,se[E.default.blotName]))}var Ee=this.prepareMatching(),ke=o(Ee,2),Ve=ke[0],Ue=ke[1],$e=B(this.container,Ve,Ue);return U($e,`
`)&&$e.ops[$e.ops.length-1].attributes==null&&($e=$e.compose(new d.default().retain($e.length()-1).delete(1))),H.log("convert",this.container.innerHTML,$e),this.container.innerHTML="",$e}},{key:"dangerouslyPasteHTML",value:function(ce,se){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;if(typeof ce=="string")this.quill.setContents(this.convert(ce),se),this.quill.setSelection(0,g.default.sources.SILENT);else{var Ee=this.convert(se);this.quill.updateContents(new d.default().retain(ce).concat(Ee),we),this.quill.setSelection(ce+Ee.length(),g.default.sources.SILENT)}}},{key:"onPaste",value:function(ce){var se=this;if(!(ce.defaultPrevented||!this.quill.isEnabled())){var we=this.quill.getSelection(),Ee=new d.default().retain(we.index),ke=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(g.default.sources.SILENT),setTimeout(function(){Ee=Ee.concat(se.convert()).delete(we.length),se.quill.updateContents(Ee,g.default.sources.USER),se.quill.setSelection(Ee.length()-we.length,g.default.sources.SILENT),se.quill.scrollingContainer.scrollTop=ke,se.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ce=this,se=[],we=[];return this.matchers.forEach(function(Ee){var ke=o(Ee,2),Ve=ke[0],Ue=ke[1];switch(Ve){case Node.TEXT_NODE:we.push(Ue);break;case Node.ELEMENT_NODE:se.push(Ue);break;default:[].forEach.call(ce.container.querySelectorAll(Ve),function($e){$e[te]=$e[te]||[],$e[te].push(Ue)});break}}),[se,we]}}]),ee}(S.default);$.DEFAULTS={matchers:[],matchVisual:!0};function F(Z,ee,le){return(typeof ee>"u"?"undefined":s(ee))==="object"?Object.keys(ee).reduce(function(ce,se){return F(ce,se,ee[se])},Z):Z.reduce(function(ce,se){return se.attributes&&se.attributes[ee]?ce.push(se):ce.insert(se.insert,(0,c.default)({},k({},ee,le),se.attributes))},new d.default)}function W(Z){if(Z.nodeType!==Node.ELEMENT_NODE)return{};var ee="__ql-computed-style";return Z[ee]||(Z[ee]=window.getComputedStyle(Z))}function U(Z,ee){for(var le="",ce=Z.ops.length-1;ce>=0&&le.length<ee.length;--ce){var se=Z.ops[ce];if(typeof se.insert!="string")break;le=se.insert+le}return le.slice(-1*ee.length)===ee}function M(Z){if(Z.childNodes.length===0)return!1;var ee=W(Z);return["block","list-item"].indexOf(ee.display)>-1}function B(Z,ee,le){return Z.nodeType===Z.TEXT_NODE?le.reduce(function(ce,se){return se(Z,ce)},new d.default):Z.nodeType===Z.ELEMENT_NODE?[].reduce.call(Z.childNodes||[],function(ce,se){var we=B(se,ee,le);return se.nodeType===Z.ELEMENT_NODE&&(we=ee.reduce(function(Ee,ke){return ke(se,Ee)},we),we=(se[te]||[]).reduce(function(Ee,ke){return ke(se,Ee)},we)),ce.concat(we)},new d.default):new d.default}function G(Z,ee,le){return F(le,Z,!0)}function J(Z,ee){var le=p.default.Attributor.Attribute.keys(Z),ce=p.default.Attributor.Class.keys(Z),se=p.default.Attributor.Style.keys(Z),we={};return le.concat(ce).concat(se).forEach(function(Ee){var ke=p.default.query(Ee,p.default.Scope.ATTRIBUTE);ke!=null&&(we[ke.attrName]=ke.value(Z),we[ke.attrName])||(ke=q[Ee],ke!=null&&(ke.attrName===Ee||ke.keyName===Ee)&&(we[ke.attrName]=ke.value(Z)||void 0),ke=L[Ee],ke!=null&&(ke.attrName===Ee||ke.keyName===Ee)&&(ke=L[Ee],we[ke.attrName]=ke.value(Z)||void 0))}),Object.keys(we).length>0&&(ee=F(ee,we)),ee}function re(Z,ee){var le=p.default.query(Z);if(le==null)return ee;if(le.prototype instanceof p.default.Embed){var ce={},se=le.value(Z);se!=null&&(ce[le.blotName]=se,ee=new d.default().insert(ce,le.formats(Z)))}else typeof le.formats=="function"&&(ee=F(ee,le.blotName,le.formats(Z)));return ee}function ue(Z,ee){return U(ee,`
`)||ee.insert(`
`),ee}function me(){return new d.default}function ye(Z,ee){var le=p.default.query(Z);if(le==null||le.blotName!=="list-item"||!U(ee,`
`))return ee;for(var ce=-1,se=Z.parentNode;!se.classList.contains("ql-clipboard");)(p.default.query(se)||{}).blotName==="list"&&(ce+=1),se=se.parentNode;return ce<=0?ee:ee.compose(new d.default().retain(ee.length()-1).retain(1,{indent:ce}))}function Se(Z,ee){return U(ee,`
`)||(M(Z)||ee.length()>0&&Z.nextSibling&&M(Z.nextSibling))&&ee.insert(`
`),ee}function Le(Z,ee){if(M(Z)&&Z.nextElementSibling!=null&&!U(ee,`

`)){var le=Z.offsetHeight+parseFloat(W(Z).marginTop)+parseFloat(W(Z).marginBottom);Z.nextElementSibling.offsetTop>Z.offsetTop+le*1.5&&ee.insert(`
`)}return ee}function lt(Z,ee){var le={},ce=Z.style||{};return ce.fontStyle&&W(Z).fontStyle==="italic"&&(le.italic=!0),ce.fontWeight&&(W(Z).fontWeight.startsWith("bold")||parseInt(W(Z).fontWeight)>=700)&&(le.bold=!0),Object.keys(le).length>0&&(ee=F(ee,le)),parseFloat(ce.textIndent||0)>0&&(ee=new d.default().insert("	").concat(ee)),ee}function Ye(Z,ee){var le=Z.data;if(Z.parentNode.tagName==="O:P")return ee.insert(le.trim());if(le.trim().length===0&&Z.parentNode.classList.contains("ql-clipboard"))return ee;if(!W(Z.parentNode).whiteSpace.startsWith("pre")){var ce=function(we,Ee){return Ee=Ee.replace(/[^\u00a0]/g,""),Ee.length<1&&we?" ":Ee};le=le.replace(/\r\n/g," ").replace(/\n/g," "),le=le.replace(/\s\s+/g,ce.bind(ce,!0)),(Z.previousSibling==null&&M(Z.parentNode)||Z.previousSibling!=null&&M(Z.previousSibling))&&(le=le.replace(/^\s+/,ce.bind(ce,!1))),(Z.nextSibling==null&&M(Z.parentNode)||Z.nextSibling!=null&&M(Z.nextSibling))&&(le=le.replace(/\s+$/,ce.bind(ce,!1)))}return ee.insert(le)}n.default=$,n.matchAttributor=J,n.matchBlot=re,n.matchNewline=Se,n.matchSpacing=Le,n.matchText=Ye},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var S=Object.getPrototypeOf(g);return S===null?void 0:_(S,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"optimize",value:function(m){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"optimize",this).call(this,m),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),g}(l.default);p.blotName="bold",p.tagName=["STRONG","B"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function x(I,k){var j=[],V=!0,z=!1,H=void 0;try{for(var te=I[Symbol.iterator](),K;!(V=(K=te.next()).done)&&(j.push(K.value),!(k&&j.length===k));V=!0);}catch(q){z=!0,H=q}finally{try{!V&&te.return&&te.return()}finally{if(z)throw H}}return j}return function(I,k){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return x(I,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function x(I,k){for(var j=0;j<k.length;j++){var V=k[j];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(I,V.key,V)}}return function(I,k,j){return k&&x(I.prototype,k),j&&x(I,j),I}}(),a=i(2),l=m(a),c=i(0),h=m(c),d=i(5),f=m(d),p=i(10),_=m(p),g=i(9),y=m(g);function m(x){return x&&x.__esModule?x:{default:x}}function b(x,I,k){return I in x?Object.defineProperty(x,I,{value:k,enumerable:!0,configurable:!0,writable:!0}):x[I]=k,x}function S(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")}function v(x,I){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:x}function O(x,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);x.prototype=Object.create(I&&I.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(x,I):x.__proto__=I)}var R=(0,_.default)("quill:toolbar"),E=function(x){O(I,x);function I(k,j){S(this,I);var V=v(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,k,j));if(Array.isArray(V.options.container)){var z=document.createElement("div");N(z,V.options.container),k.container.parentNode.insertBefore(z,k.container),V.container=z}else typeof V.options.container=="string"?V.container=document.querySelector(V.options.container):V.container=V.options.container;if(!(V.container instanceof HTMLElement)){var H;return H=R.error("Container required for toolbar",V.options),v(V,H)}return V.container.classList.add("ql-toolbar"),V.controls=[],V.handlers={},Object.keys(V.options.handlers).forEach(function(te){V.addHandler(te,V.options.handlers[te])}),[].forEach.call(V.container.querySelectorAll("button, select"),function(te){V.attach(te)}),V.quill.on(f.default.events.EDITOR_CHANGE,function(te,K){te===f.default.events.SELECTION_CHANGE&&V.update(K)}),V.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){var te=V.quill.selection.getRange(),K=s(te,1),q=K[0];V.update(q)}),V}return o(I,[{key:"addHandler",value:function(j,V){this.handlers[j]=V}},{key:"attach",value:function(j){var V=this,z=[].find.call(j.classList,function(te){return te.indexOf("ql-")===0});if(z){if(z=z.slice(3),j.tagName==="BUTTON"&&j.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){R.warn("ignoring attaching to disabled format",z,j);return}if(h.default.query(z)==null){R.warn("ignoring attaching to nonexistent format",z,j);return}}var H=j.tagName==="SELECT"?"change":"click";j.addEventListener(H,function(te){var K=void 0;if(j.tagName==="SELECT"){if(j.selectedIndex<0)return;var q=j.options[j.selectedIndex];q.hasAttribute("selected")?K=!1:K=q.value||!1}else j.classList.contains("ql-active")?K=!1:K=j.value||!j.hasAttribute("value"),te.preventDefault();V.quill.focus();var L=V.quill.selection.getRange(),$=s(L,1),F=$[0];if(V.handlers[z]!=null)V.handlers[z].call(V,K);else if(h.default.query(z).prototype instanceof h.default.Embed){if(K=prompt("Enter "+z),!K)return;V.quill.updateContents(new l.default().retain(F.index).delete(F.length).insert(b({},z,K)),f.default.sources.USER)}else V.quill.format(z,K,f.default.sources.USER);V.update(F)}),this.controls.push([z,j])}}},{key:"update",value:function(j){var V=j==null?{}:this.quill.getFormat(j);this.controls.forEach(function(z){var H=s(z,2),te=H[0],K=H[1];if(K.tagName==="SELECT"){var q=void 0;if(j==null)q=null;else if(V[te]==null)q=K.querySelector("option[selected]");else if(!Array.isArray(V[te])){var L=V[te];typeof L=="string"&&(L=L.replace(/\"/g,'\\"')),q=K.querySelector('option[value="'+L+'"]')}q==null?(K.value="",K.selectedIndex=-1):q.selected=!0}else if(j==null)K.classList.remove("ql-active");else if(K.hasAttribute("value")){var $=V[te]===K.getAttribute("value")||V[te]!=null&&V[te].toString()===K.getAttribute("value")||V[te]==null&&!K.getAttribute("value");K.classList.toggle("ql-active",$)}else K.classList.toggle("ql-active",V[te]!=null)})}}]),I}(y.default);E.DEFAULTS={};function w(x,I,k){var j=document.createElement("button");j.setAttribute("type","button"),j.classList.add("ql-"+I),k!=null&&(j.value=k),x.appendChild(j)}function N(x,I){Array.isArray(I[0])||(I=[I]),I.forEach(function(k){var j=document.createElement("span");j.classList.add("ql-formats"),k.forEach(function(V){if(typeof V=="string")w(j,V);else{var z=Object.keys(V)[0],H=V[z];Array.isArray(H)?T(j,z,H):w(j,z,H)}}),x.appendChild(j)})}function T(x,I,k){var j=document.createElement("select");j.classList.add("ql-"+I),k.forEach(function(V){var z=document.createElement("option");V!==!1?z.setAttribute("value",V):z.setAttribute("selected","selected"),j.appendChild(z)}),x.appendChild(j)}E.DEFAULTS={container:null,handlers:{clean:function(){var I=this,k=this.quill.getSelection();if(k!=null)if(k.length==0){var j=this.quill.getFormat();Object.keys(j).forEach(function(V){h.default.query(V,h.default.Scope.INLINE)!=null&&I.quill.format(V,!1)})}else this.quill.removeFormat(k,f.default.sources.USER)},direction:function(I){var k=this.quill.getFormat().align;I==="rtl"&&k==null?this.quill.format("align","right",f.default.sources.USER):!I&&k==="right"&&this.quill.format("align",!1,f.default.sources.USER),this.quill.format("direction",I,f.default.sources.USER)},indent:function(I){var k=this.quill.getSelection(),j=this.quill.getFormat(k),V=parseInt(j.indent||0);if(I==="+1"||I==="-1"){var z=I==="+1"?1:-1;j.direction==="rtl"&&(z*=-1),this.quill.format("indent",V+z,f.default.sources.USER)}},link:function(I){I===!0&&(I=prompt("Enter link URL:")),this.quill.format("link",I,f.default.sources.USER)},list:function(I){var k=this.quill.getSelection(),j=this.quill.getFormat(k);I==="check"?j.list==="checked"||j.list==="unchecked"?this.quill.format("list",!1,f.default.sources.USER):this.quill.format("list","unchecked",f.default.sources.USER):this.quill.format("list",I,f.default.sources.USER)}}},n.default=E,n.addControls=N},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var S=Object.getPrototypeOf(g);return S===null?void 0:_(S,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(y,m){h(this,g);var b=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return b.label.innerHTML=m,b.container.classList.add("ql-color-picker"),[].slice.call(b.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(S){S.classList.add("ql-primary")}),b}return s(g,[{key:"buildItem",value:function(m){var b=o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"buildItem",this).call(this,m);return b.style.backgroundColor=m.getAttribute("value")||"",b}},{key:"selectItem",value:function(m,b){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,m,b);var S=this.label.querySelector(".ql-color-label"),v=m&&m.getAttribute("data-value")||"";S&&(S.tagName==="line"?S.style.stroke=v:S.style.fill=v)}}]),g}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var S=Object.getPrototypeOf(g);return S===null?void 0:_(S,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(y,m){h(this,g);var b=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return b.container.classList.add("ql-icon-picker"),[].forEach.call(b.container.querySelectorAll(".ql-picker-item"),function(S){S.innerHTML=m[S.getAttribute("data-value")||""]}),b.defaultItem=b.container.querySelector(".ql-selected"),b.selectItem(b.defaultItem),b}return s(g,[{key:"selectItem",value:function(m,b){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,m,b),m=m||this.defaultItem,this.label.innerHTML=m.innerHTML}}]),g}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(c,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(c,f.key,f)}}return function(c,h,d){return h&&l(c.prototype,h),d&&l(c,d),c}}();function o(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(c,h){var d=this;o(this,l),this.quill=c,this.boundsContainer=h||document.body,this.root=c.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){d.root.style.marginTop=-1*d.quill.root.scrollTop+"px"}),this.hide()}return s(l,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(h){var d=h.left+h.width/2-this.root.offsetWidth/2,f=h.bottom+this.quill.root.scrollTop;this.root.style.left=d+"px",this.root.style.top=f+"px",this.root.classList.remove("ql-flip");var p=this.boundsContainer.getBoundingClientRect(),_=this.root.getBoundingClientRect(),g=0;if(_.right>p.right&&(g=p.right-_.right,this.root.style.left=d+g+"px"),_.left<p.left&&(g=p.left-_.left,this.root.style.left=d+g+"px"),_.bottom>p.bottom){var y=_.bottom-_.top,m=h.bottom-h.top+y;this.root.style.top=f-m+"px",this.root.classList.add("ql-flip")}return g}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),l}();n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(x,I){var k=[],j=!0,V=!1,z=void 0;try{for(var H=x[Symbol.iterator](),te;!(j=(te=H.next()).done)&&(k.push(te.value),!(I&&k.length===I));j=!0);}catch(K){V=!0,z=K}finally{try{!j&&H.return&&H.return()}finally{if(V)throw z}}return k}return function(x,I){if(Array.isArray(x))return x;if(Symbol.iterator in Object(x))return T(x,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function T(x,I,k){x===null&&(x=Function.prototype);var j=Object.getOwnPropertyDescriptor(x,I);if(j===void 0){var V=Object.getPrototypeOf(x);return V===null?void 0:T(V,I,k)}else{if("value"in j)return j.value;var z=j.get;return z===void 0?void 0:z.call(k)}},a=function(){function T(x,I){for(var k=0;k<I.length;k++){var j=I[k];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(x,j.key,j)}}return function(x,I,k){return I&&T(x.prototype,I),k&&T(x,k),x}}(),l=i(3),c=S(l),h=i(8),d=S(h),f=i(43),p=S(f),_=i(27),g=S(_),y=i(15),m=i(41),b=S(m);function S(T){return T&&T.__esModule?T:{default:T}}function v(T,x){if(!(T instanceof x))throw new TypeError("Cannot call a class as a function")}function O(T,x){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:T}function R(T,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);T.prototype=Object.create(x&&x.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(T,x):T.__proto__=x)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],w=function(T){R(x,T);function x(I,k){v(this,x),k.modules.toolbar!=null&&k.modules.toolbar.container==null&&(k.modules.toolbar.container=E);var j=O(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I,k));return j.quill.container.classList.add("ql-snow"),j}return a(x,[{key:"extendToolbar",value:function(k){k.container.classList.add("ql-snow"),this.buildButtons([].slice.call(k.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(k.container.querySelectorAll("select")),b.default),this.tooltip=new N(this.quill,this.options.bounds),k.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(j,V){k.handlers.link.call(k,!V.format.link)})}}]),x}(p.default);w.DEFAULTS=(0,c.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(x){if(x){var I=this.quill.getSelection();if(I==null||I.length==0)return;var k=this.quill.getText(I);/^\S+@\S+\.\S+$/.test(k)&&k.indexOf("mailto:")!==0&&(k="mailto:"+k);var j=this.quill.theme.tooltip;j.edit("link",k)}else this.quill.format("link",!1)}}}}});var N=function(T){R(x,T);function x(I,k){v(this,x);var j=O(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,I,k));return j.preview=j.root.querySelector("a.ql-preview"),j}return a(x,[{key:"listen",value:function(){var k=this;o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(j){k.root.classList.contains("ql-editing")?k.save():k.edit("link",k.preview.textContent),j.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(j){if(k.linkRange!=null){var V=k.linkRange;k.restoreFocus(),k.quill.formatText(V,"link",!1,d.default.sources.USER),delete k.linkRange}j.preventDefault(),k.hide()}),this.quill.on(d.default.events.SELECTION_CHANGE,function(j,V,z){if(j!=null){if(j.length===0&&z===d.default.sources.USER){var H=k.quill.scroll.descendant(g.default,j.index),te=s(H,2),K=te[0],q=te[1];if(K!=null){k.linkRange=new y.Range(j.index-q,K.length());var L=g.default.formats(K.domNode);k.preview.textContent=L,k.preview.setAttribute("href",L),k.show(),k.position(k.quill.getBounds(k.linkRange));return}}else delete k.linkRange;k.hide()}})}},{key:"show",value:function(){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),x}(f.BaseTooltip);N.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=w},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=se(s),a=i(36),l=i(38),c=i(64),h=i(65),d=se(h),f=i(66),p=se(f),_=i(67),g=se(_),y=i(37),m=i(26),b=i(39),S=i(40),v=i(56),O=se(v),R=i(68),E=se(R),w=i(27),N=se(w),T=i(69),x=se(T),I=i(70),k=se(I),j=i(71),V=se(j),z=i(72),H=se(z),te=i(73),K=se(te),q=i(13),L=se(q),$=i(74),F=se($),W=i(75),U=se(W),M=i(57),B=se(M),G=i(41),J=se(G),re=i(28),ue=se(re),me=i(59),ye=se(me),Se=i(60),Le=se(Se),lt=i(61),Ye=se(lt),Z=i(108),ee=se(Z),le=i(62),ce=se(le);function se(we){return we&&we.__esModule?we:{default:we}}o.default.register({"attributors/attribute/direction":l.DirectionAttribute,"attributors/class/align":a.AlignClass,"attributors/class/background":y.BackgroundClass,"attributors/class/color":m.ColorClass,"attributors/class/direction":l.DirectionClass,"attributors/class/font":b.FontClass,"attributors/class/size":S.SizeClass,"attributors/style/align":a.AlignStyle,"attributors/style/background":y.BackgroundStyle,"attributors/style/color":m.ColorStyle,"attributors/style/direction":l.DirectionStyle,"attributors/style/font":b.FontStyle,"attributors/style/size":S.SizeStyle},!0),o.default.register({"formats/align":a.AlignClass,"formats/direction":l.DirectionClass,"formats/indent":c.IndentClass,"formats/background":y.BackgroundStyle,"formats/color":m.ColorStyle,"formats/font":b.FontClass,"formats/size":S.SizeClass,"formats/blockquote":d.default,"formats/code-block":L.default,"formats/header":p.default,"formats/list":g.default,"formats/bold":O.default,"formats/code":q.Code,"formats/italic":E.default,"formats/link":N.default,"formats/script":x.default,"formats/strike":k.default,"formats/underline":V.default,"formats/image":H.default,"formats/video":K.default,"formats/list/item":_.ListItem,"modules/formula":F.default,"modules/syntax":U.default,"modules/toolbar":B.default,"themes/bubble":ee.default,"themes/snow":ce.default,"ui/icons":J.default,"ui/picker":ue.default,"ui/icon-picker":Le.default,"ui/color-picker":ye.default,"ui/tooltip":Ye.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function g(y,m){for(var b=0;b<m.length;b++){var S=m[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}return function(y,m,b){return m&&g(y.prototype,m),b&&g(y,b),y}}(),o=function g(y,m,b){y===null&&(y=Function.prototype);var S=Object.getOwnPropertyDescriptor(y,m);if(S===void 0){var v=Object.getPrototypeOf(y);return v===null?void 0:g(v,m,b)}else{if("value"in S)return S.value;var O=S.get;return O===void 0?void 0:O.call(b)}},a=i(0),l=c(a);function c(g){return g&&g.__esModule?g:{default:g}}function h(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function d(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var p=function(g){f(y,g);function y(){return h(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"add",value:function(b,S){if(S==="+1"||S==="-1"){var v=this.value(b)||0;S=S==="+1"?v+1:v-1}return S===0?(this.remove(b),!0):o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"add",this).call(this,b,S)}},{key:"canAdd",value:function(b,S){return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,b,S)||o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,b,parseInt(S))}},{key:"value",value:function(b){return parseInt(o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"value",this).call(this,b))||void 0}}]),y}(l.default.Attributor.Class),_=new p("indent","ql-indent",{scope:l.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function c(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="blockquote",d.tagName="blockquote",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function p(_,g){for(var y=0;y<g.length;y++){var m=g[y];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(_,m.key,m)}}return function(_,g,y){return g&&p(_.prototype,g),y&&p(_,y),_}}(),o=i(4),a=l(o);function l(p){return p&&p.__esModule?p:{default:p}}function c(p,_){if(!(p instanceof _))throw new TypeError("Cannot call a class as a function")}function h(p,_){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:p}function d(p,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);p.prototype=Object.create(_&&_.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(p,_):p.__proto__=_)}var f=function(p){d(_,p);function _(){return c(this,_),h(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,null,[{key:"formats",value:function(y){return this.tagName.indexOf(y.tagName)+1}}]),_}(a.default);f.blotName="header",f.tagName=["H1","H2","H3","H4","H5","H6"],n.default=f},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function v(O,R){for(var E=0;E<R.length;E++){var w=R[E];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(O,w.key,w)}}return function(O,R,E){return R&&v(O.prototype,R),E&&v(O,E),O}}(),o=function v(O,R,E){O===null&&(O=Function.prototype);var w=Object.getOwnPropertyDescriptor(O,R);if(w===void 0){var N=Object.getPrototypeOf(O);return N===null?void 0:v(N,R,E)}else{if("value"in w)return w.value;var T=w.get;return T===void 0?void 0:T.call(E)}},a=i(0),l=p(a),c=i(4),h=p(c),d=i(25),f=p(d);function p(v){return v&&v.__esModule?v:{default:v}}function _(v,O,R){return O in v?Object.defineProperty(v,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):v[O]=R,v}function g(v,O){if(!(v instanceof O))throw new TypeError("Cannot call a class as a function")}function y(v,O){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:v}function m(v,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);v.prototype=Object.create(O&&O.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(v,O):v.__proto__=O)}var b=function(v){m(O,v);function O(){return g(this,O),y(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return s(O,[{key:"format",value:function(E,w){E===S.blotName&&!w?this.replaceWith(l.default.create(this.statics.scope)):o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"format",this).call(this,E,w)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,w){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,w),this):(this.parent.unwrap(),o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replaceWith",this).call(this,E,w))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(O.__proto__||Object.getPrototypeOf(O),"formats",this).call(this,E)}}]),O}(h.default);b.blotName="list-item",b.tagName="LI";var S=function(v){m(O,v),s(O,null,[{key:"create",value:function(E){var w=E==="ordered"?"OL":"UL",N=o(O.__proto__||Object.getPrototypeOf(O),"create",this).call(this,w);return(E==="checked"||E==="unchecked")&&N.setAttribute("data-checked",E==="checked"),N}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function O(R){g(this,O);var E=y(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,R)),w=function(T){if(T.target.parentNode===R){var x=E.statics.formats(R),I=l.default.find(T.target);x==="checked"?I.format("list","unchecked"):x==="unchecked"&&I.format("list","checked")}};return R.addEventListener("touchstart",w),R.addEventListener("mousedown",w),E}return s(O,[{key:"format",value:function(E,w){this.children.length>0&&this.children.tail.format(E,w)}},{key:"formats",value:function(){return _({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,w){if(E instanceof b)o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertBefore",this).call(this,E,w);else{var N=w==null?this.length():w.offset(this),T=this.split(N);T.parent.insertBefore(E,T)}}},{key:"optimize",value:function(E){o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,E);var w=this.next;w!=null&&w.prev===this&&w.statics.blotName===this.statics.blotName&&w.domNode.tagName===this.domNode.tagName&&w.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(w.moveChildren(this),w.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var w=l.default.create(this.statics.defaultChild);E.moveChildren(w),this.appendChild(w)}o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replace",this).call(this,E)}}]),O}(f.default);S.blotName="list",S.scope=l.default.Scope.BLOCK_BLOT,S.tagName=["OL","UL"],S.defaultChild="list-item",S.allowedChildren=[b],n.ListItem=b,n.default=S},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function c(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="italic",d.tagName=["EM","I"],n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var S=Object.getPrototypeOf(g);return S===null?void 0:_(S,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=c(a);function c(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,null,[{key:"create",value:function(m){return m==="super"?document.createElement("sup"):m==="sub"?document.createElement("sub"):o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,m)}},{key:"formats",value:function(m){if(m.tagName==="SUB")return"sub";if(m.tagName==="SUP")return"super"}}]),g}(l.default);p.blotName="script",p.tagName=["SUB","SUP"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function c(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="strike",d.tagName="S",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function c(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),c(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="underline",d.tagName="U",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var S=0;S<b.length;S++){var v=b[S];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,S){return b&&y(m.prototype,b),S&&y(m,S),m}}(),o=function y(m,b,S){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,S)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(S)}},a=i(0),l=h(a),c=i(27);function h(y){return y&&y.__esModule?y:{default:y}}function d(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function f(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function p(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var _=["alt","height","width"],g=function(y){p(m,y);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(S,v){_.indexOf(S)>-1?v?this.domNode.setAttribute(S,v):this.domNode.removeAttribute(S):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,S,v)}}],[{key:"create",value:function(S){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,S);return typeof S=="string"&&v.setAttribute("src",this.sanitize(S)),v}},{key:"formats",value:function(S){return _.reduce(function(v,O){return S.hasAttribute(O)&&(v[O]=S.getAttribute(O)),v},{})}},{key:"match",value:function(S){return/\.(jpe?g|gif|png)$/.test(S)||/^data:image\/.+;base64/.test(S)}},{key:"sanitize",value:function(S){return(0,c.sanitize)(S,["http","https","data"])?S:"//:0"}},{key:"value",value:function(S){return S.getAttribute("src")}}]),m}(l.default.Embed);g.blotName="image",g.tagName="IMG",n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var S=0;S<b.length;S++){var v=b[S];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,S){return b&&y(m.prototype,b),S&&y(m,S),m}}(),o=function y(m,b,S){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,S)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(S)}},a=i(4),l=i(27),c=h(l);function h(y){return y&&y.__esModule?y:{default:y}}function d(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function f(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function p(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var _=["height","width"],g=function(y){p(m,y);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(S,v){_.indexOf(S)>-1?v?this.domNode.setAttribute(S,v):this.domNode.removeAttribute(S):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,S,v)}}],[{key:"create",value:function(S){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,S);return v.setAttribute("frameborder","0"),v.setAttribute("allowfullscreen",!0),v.setAttribute("src",this.sanitize(S)),v}},{key:"formats",value:function(S){return _.reduce(function(v,O){return S.hasAttribute(O)&&(v[O]=S.getAttribute(O)),v},{})}},{key:"sanitize",value:function(S){return c.default.sanitize(S)}},{key:"value",value:function(S){return S.getAttribute("src")}}]),m}(a.BlockEmbed);g.blotName="video",g.className="ql-video",g.tagName="IFRAME",n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function S(v,O){for(var R=0;R<O.length;R++){var E=O[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(v,E.key,E)}}return function(v,O,R){return O&&S(v.prototype,O),R&&S(v,R),v}}(),o=function S(v,O,R){v===null&&(v=Function.prototype);var E=Object.getOwnPropertyDescriptor(v,O);if(E===void 0){var w=Object.getPrototypeOf(v);return w===null?void 0:S(w,O,R)}else{if("value"in E)return E.value;var N=E.get;return N===void 0?void 0:N.call(R)}},a=i(35),l=p(a),c=i(5),h=p(c),d=i(9),f=p(d);function p(S){return S&&S.__esModule?S:{default:S}}function _(S,v){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}function g(S,v){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:S}function y(S,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);S.prototype=Object.create(v&&v.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(S,v):S.__proto__=v)}var m=function(S){y(v,S);function v(){return _(this,v),g(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,null,[{key:"create",value:function(R){var E=o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,R);return typeof R=="string"&&(window.katex.render(R,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",R)),E}},{key:"value",value:function(R){return R.getAttribute("data-value")}}]),v}(l.default);m.blotName="formula",m.className="ql-formula",m.tagName="SPAN";var b=function(S){y(v,S),s(v,null,[{key:"register",value:function(){h.default.register(m,!0)}}]);function v(){_(this,v);var O=g(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return O}return v}(f.default);n.FormulaBlot=m,n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function R(E,w){for(var N=0;N<w.length;N++){var T=w[N];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(E,T.key,T)}}return function(E,w,N){return w&&R(E.prototype,w),N&&R(E,N),E}}(),o=function R(E,w,N){E===null&&(E=Function.prototype);var T=Object.getOwnPropertyDescriptor(E,w);if(T===void 0){var x=Object.getPrototypeOf(E);return x===null?void 0:R(x,w,N)}else{if("value"in T)return T.value;var I=T.get;return I===void 0?void 0:I.call(N)}},a=i(0),l=g(a),c=i(5),h=g(c),d=i(9),f=g(d),p=i(13),_=g(p);function g(R){return R&&R.__esModule?R:{default:R}}function y(R,E){if(!(R instanceof E))throw new TypeError("Cannot call a class as a function")}function m(R,E){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:R}function b(R,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);R.prototype=Object.create(E&&E.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(R,E):R.__proto__=E)}var S=function(R){b(E,R);function E(){return y(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,[{key:"replaceWith",value:function(N){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,N)}},{key:"highlight",value:function(N){var T=this.domNode.textContent;this.cachedText!==T&&((T.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=N(T),this.domNode.normalize(),this.attach()),this.cachedText=T)}}]),E}(_.default);S.className="ql-syntax";var v=new l.default.Attributor.Class("token","hljs",{scope:l.default.Scope.INLINE}),O=function(R){b(E,R),s(E,null,[{key:"register",value:function(){h.default.register(v,!0),h.default.register(S,!0)}}]);function E(w,N){y(this,E);var T=m(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,w,N));if(typeof T.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var x=null;return T.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(x),x=setTimeout(function(){T.highlight(),x=null},T.options.interval)}),T.highlight(),T}return s(E,[{key:"highlight",value:function(){var N=this;if(!this.quill.selection.composing){this.quill.update(h.default.sources.USER);var T=this.quill.getSelection();this.quill.scroll.descendants(S).forEach(function(x){x.highlight(N.options.highlight)}),this.quill.update(h.default.sources.SILENT),T!=null&&this.quill.setSelection(T,h.default.sources.SILENT)}}}]),E}(f.default);O.DEFAULTS={highlight:function(){return window.hljs==null?null:function(R){var E=window.hljs.highlightAuto(R);return E.value}}(),interval:1e3},n.CodeBlock=S,n.CodeToken=v,n.default=O},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function E(w,N,T){w===null&&(w=Function.prototype);var x=Object.getOwnPropertyDescriptor(w,N);if(x===void 0){var I=Object.getPrototypeOf(w);return I===null?void 0:E(I,N,T)}else{if("value"in x)return x.value;var k=x.get;return k===void 0?void 0:k.call(T)}},o=function(){function E(w,N){for(var T=0;T<N.length;T++){var x=N[T];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(w,x.key,x)}}return function(w,N,T){return N&&E(w.prototype,N),T&&E(w,T),w}}(),a=i(3),l=y(a),c=i(8),h=y(c),d=i(43),f=y(d),p=i(15),_=i(41),g=y(_);function y(E){return E&&E.__esModule?E:{default:E}}function m(E,w){if(!(E instanceof w))throw new TypeError("Cannot call a class as a function")}function b(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:E}function S(E,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);E.prototype=Object.create(w&&w.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(E,w):E.__proto__=w)}var v=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],O=function(E){S(w,E);function w(N,T){m(this,w),T.modules.toolbar!=null&&T.modules.toolbar.container==null&&(T.modules.toolbar.container=v);var x=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,N,T));return x.quill.container.classList.add("ql-bubble"),x}return o(w,[{key:"extendToolbar",value:function(T){this.tooltip=new R(this.quill,this.options.bounds),this.tooltip.root.appendChild(T.container),this.buildButtons([].slice.call(T.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(T.container.querySelectorAll("select")),g.default)}}]),w}(f.default);O.DEFAULTS=(0,l.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(w){w?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var R=function(E){S(w,E);function w(N,T){m(this,w);var x=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,N,T));return x.quill.on(h.default.events.EDITOR_CHANGE,function(I,k,j,V){if(I===h.default.events.SELECTION_CHANGE)if(k!=null&&k.length>0&&V===h.default.sources.USER){x.show(),x.root.style.left="0px",x.root.style.width="",x.root.style.width=x.root.offsetWidth+"px";var z=x.quill.getLines(k.index,k.length);if(z.length===1)x.position(x.quill.getBounds(k));else{var H=z[z.length-1],te=x.quill.getIndex(H),K=Math.min(H.length()-1,k.index+k.length-te),q=x.quill.getBounds(new p.Range(te,K));x.position(q)}}else document.activeElement!==x.textbox&&x.quill.hasFocus()&&x.hide()}),x}return o(w,[{key:"listen",value:function(){var T=this;s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){T.root.classList.remove("ql-editing")}),this.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!T.root.classList.contains("ql-hidden")){var x=T.quill.getSelection();x!=null&&T.position(T.quill.getBounds(x))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(T){var x=s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"position",this).call(this,T),I=this.root.querySelector(".ql-tooltip-arrow");if(I.style.marginLeft="",x===0)return x;I.style.marginLeft=-1*x-I.offsetWidth/2+"px"}}]),w}(d.BaseTooltip);R.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=R,n.default=O},function(t,n,i){t.exports=i(63)}]).default})})(tm);var Rk=tm.exports,jk=Ke&&Ke.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hs=Ke&&Ke.__assign||function(){return Hs=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Hs.apply(this,arguments)},Lk=Ke&&Ke.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},bo=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},Ut=bo(Y),Dk=bo(ff),ri=bo(Ck),Gh=bo(Rk),Mk=function(r){jk(e,r);function e(t){var n=r.call(this,t)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(s,o,a,l){var c,h,d,f;s==="text-change"?(h=(c=n).onEditorChangeText)===null||h===void 0||h.call(c,n.editor.root.innerHTML,o,l,n.unprivilegedEditor):s==="selection-change"&&((f=(d=n).onEditorChangeSelection)===null||f===void 0||f.call(d,o,l,n.unprivilegedEditor))};var i=n.isControlled()?t.value:t.defaultValue;return n.value=i??"",n}return e.prototype.validateProps=function(t){var n;if(Ut.default.Children.count(t.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ut.default.Children.count(t.children)){var i=Ut.default.Children.only(t.children);if(((n=i)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&t.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},e.prototype.shouldComponentUpdate=function(t,n){var i=this,s;if(this.validateProps(t),!this.editor||this.state.generation!==n.generation)return!0;if("value"in t){var o=this.getEditorContents(),a=(s=t.value,s??"");this.isEqualValue(a,o)||this.setEditorContents(this.editor,a)}return t.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,t.readOnly),Lk(this.cleanProps,this.dirtyProps).some(function(l){return!ri.default(t[l],i.props[l])})},e.prototype.shouldComponentRegenerate=function(t){var n=this;return this.dirtyProps.some(function(i){return!ri.default(t[i],n.props[i])})},e.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},e.prototype.componentWillUnmount=function(){this.destroyEditor()},e.prototype.componentDidUpdate=function(t,n){var i=this;if(this.editor&&this.shouldComponentRegenerate(t)){var s=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:s,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var a=this.regenerationSnapshot,s=a.delta,l=a.selection;delete this.regenerationSnapshot,this.instantiateEditor();var c=this.editor;c.setContents(s),Wh(function(){return i.setEditorSelection(c,l)})}},e.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},e.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},e.prototype.isControlled=function(){return"value"in this.props},e.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},e.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},e.prototype.createEditor=function(t,n){var i=new Gh.default(t,n);return n.tabIndex!=null&&this.setEditorTabIndex(i,n.tabIndex),this.hookEditor(i),i},e.prototype.hookEditor=function(t){this.unprivilegedEditor=this.makeUnprivilegedEditor(t),t.on("editor-change",this.onEditorChange)},e.prototype.unhookEditor=function(t){t.off("editor-change",this.onEditorChange)},e.prototype.getEditorContents=function(){return this.value},e.prototype.getEditorSelection=function(){return this.selection},e.prototype.isDelta=function(t){return t&&t.ops},e.prototype.isEqualValue=function(t,n){return this.isDelta(t)&&this.isDelta(n)?ri.default(t.ops,n.ops):ri.default(t,n)},e.prototype.setEditorContents=function(t,n){var i=this;this.value=n;var s=this.getEditorSelection();typeof n=="string"?t.setContents(t.clipboard.convert(n)):t.setContents(n),Wh(function(){return i.setEditorSelection(t,s)})},e.prototype.setEditorSelection=function(t,n){if(this.selection=n,n){var i=t.getLength();n.index=Math.max(0,Math.min(n.index,i-1)),n.length=Math.max(0,Math.min(n.length,i-1-n.index)),t.setSelection(n)}},e.prototype.setEditorTabIndex=function(t,n){var i,s;!((s=(i=t)===null||i===void 0?void 0:i.scroll)===null||s===void 0)&&s.domNode&&(t.scroll.domNode.tabIndex=n)},e.prototype.setEditorReadOnly=function(t,n){n?t.disable():t.enable()},e.prototype.makeUnprivilegedEditor=function(t){var n=t;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},e.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var t=Dk.default.findDOMNode(this.editingArea);if(!t)throw new Error("Cannot find element for editing area");if(t.nodeType===3)throw new Error("Editing area cannot be a text node");return t},e.prototype.renderEditingArea=function(){var t=this,n=this.props,i=n.children,s=n.preserveWhitespace,o=this.state.generation,a={key:o,ref:function(l){t.editingArea=l}};return Ut.default.Children.count(i)?Ut.default.cloneElement(Ut.default.Children.only(i),a):s?Ut.default.createElement("pre",Hs({},a)):Ut.default.createElement("div",Hs({},a))},e.prototype.render=function(){var t;return Ut.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(t=this.props.className,t??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},e.prototype.onEditorChangeText=function(t,n,i,s){var o,a;if(this.editor){var l=this.isDelta(this.value)?s.getContents():s.getHTML();l!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=l,(a=(o=this.props).onChange)===null||a===void 0||a.call(o,t,n,i,s))}},e.prototype.onEditorChangeSelection=function(t,n,i){var s,o,a,l,c,h;if(this.editor){var d=this.getEditorSelection(),f=!d&&t,p=d&&!t;ri.default(t,d)||(this.selection=t,(o=(s=this.props).onChangeSelection)===null||o===void 0||o.call(s,t,n,i),f?(l=(a=this.props).onFocus)===null||l===void 0||l.call(a,t,n,i):p&&((h=(c=this.props).onBlur)===null||h===void 0||h.call(c,d,n,i)))}},e.prototype.focus=function(){this.editor&&this.editor.focus()},e.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},e.displayName="React Quill",e.Quill=Gh.default,e.defaultProps={theme:"snow",modules:{},readOnly:!1},e}(Ut.default.Component);function Wh(r){Promise.resolve().then(r)}var Vk=Mk;const $k=Xm(Vk),Fk=100,qk=800,Uk=200,Bk=({value:r,onChange:e,placeholder:t="Enter content here...",style:n={},className:i="mt-1"})=>{const s=Y.useRef(null),[o,a]=Y.useState(Uk);Y.useEffect(()=>{var g,y;const h=(g=s.current)==null?void 0:g.getEditor(),d=(y=h==null?void 0:h.getModule("toolbar"))==null?void 0:y.container;if(!d)return;let f=0;const p=m=>{m.target.closest(".ql-picker")&&(f=window.scrollY)},_=m=>{m.target.closest(".ql-picker")&&setTimeout(()=>{window.scrollY!==f&&window.scrollTo(window.scrollX,f)},0)};return d.addEventListener("mousedown",p),d.addEventListener("mouseup",_),()=>{d.removeEventListener("mousedown",p),d.removeEventListener("mouseup",_)}},[]);const l=Y.useMemo(()=>({toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{align:[]}],[{color:[]},{background:[]}],["link","image","video"],["clean"]],handlers:{image:function(){var S;const h=(S=s.current)==null?void 0:S.getEditor();if(!h){console.error("Quill editor instance not found.");return}const d=h.getSelection(!0);if(!d)return;const f=h.theme.tooltip,p=f.save,_=f.action;f.edit();const g=f.textbox;if(!g){console.error("Tooltip input element not found."),f.hide();return}g.value="",g.setAttribute("placeholder","Enter image URL"),g.setAttribute("data-mode","image");const y=()=>{var O;const v=g.value;v&&h.insertEmbed(d.index,"image",v,"user"),f.hide(),f.save=p,f.action=_,g.removeEventListener("keydown",m),(O=f.root.querySelector("a.ql-action"))==null||O.removeEventListener("click",y)},m=v=>{var O;v.key==="Enter"?(v.preventDefault(),y()):v.key==="Escape"&&(v.preventDefault(),f.hide(),f.save=p,f.action=_,g.removeEventListener("keydown",m),(O=f.root.querySelector("a.ql-action"))==null||O.removeEventListener("click",y))};f.save=y,g.removeEventListener("keydown",m),g.addEventListener("keydown",m);const b=f.root.querySelector("a.ql-action");b?(b.removeEventListener("click",y),b.addEventListener("click",y)):console.warn("Tooltip save button (a.ql-action) not found."),g.focus()}}}}),[]),c=Y.useMemo(()=>["header","font","size","bold","italic","underline","strike","blockquote","code-block","list","bullet","script","indent","direction","align","color","background","link","image","video"],[]);return P.jsxs("div",{className:`quill-editor-container ${i}`,children:[P.jsx("div",{className:"quill-editor-wrapper border border-gray-300 rounded-md overflow-hidden",style:{...n,height:`${o}px`,display:"flex",flexDirection:"column"},children:P.jsx($k,{theme:"snow",value:r,onChange:e,ref:s,modules:l,formats:c,className:"bg-white flex-grow",placeholder:t,style:{height:"calc(100% - 42px)"}})}),P.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-gray-600",children:[P.jsx(b_,{size:16}),P.jsx("input",{type:"range",min:Fk,max:qk,value:o,onChange:h=>a(Number(h.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700","aria-label":"Adjust editor height"}),P.jsx(m_,{size:16}),P.jsxs("span",{className:"text-xs w-12 text-right",children:[o,"px"]})]})]})},zk=({initialData:r,onSubmit:e,onCancel:t,isLoading:n})=>{const[i,s]=Y.useState((r==null?void 0:r.title)||""),[o,a]=Y.useState((r==null?void 0:r.slug)||""),[l,c]=Y.useState((r==null?void 0:r.content)||""),{showToast:h}=un();Y.useEffect(()=>{s((r==null?void 0:r.title)||""),a((r==null?void 0:r.slug)||""),c((r==null?void 0:r.content)||"")},[r]);const d=p=>{a(p.target.value.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""))},f=p=>{if(p.preventDefault(),!i||!o||!l){h("Title, Slug, and Content are required.","error");return}e({title:i,slug:o,content:l})};return P.jsxs("form",{onSubmit:f,className:"p-4 border rounded shadow-sm bg-white space-y-4",children:[P.jsx("h3",{className:"text-lg font-medium",children:r!=null&&r.id?"Edit Page":"Add New Page"}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"pageTitle",className:"block text-sm font-medium text-gray-700",children:"Title"}),P.jsx("input",{type:"text",id:"pageTitle",value:i,onChange:p=>s(p.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"pageSlug",className:"block text-sm font-medium text-gray-700",children:"Slug (URL Path, e.g., 'about-us')"}),P.jsx("input",{type:"text",id:"pageSlug",value:o,onChange:d,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",pattern:"^[a-z0-9-]+$",title:"Slug can only contain lowercase letters, numbers, and hyphens."})]}),P.jsxs("div",{className:"relative quill-editor-wrapper",children:[P.jsx("label",{htmlFor:"pageContent",className:"block text-sm font-medium text-gray-700",children:"Content"}),P.jsx(Bk,{value:l,onChange:c,placeholder:"Enter page content here..."})]}),P.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[(r==null?void 0:r.id)&&t&&P.jsx("button",{type:"button",onClick:t,disabled:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Cancel Edit"}),P.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:n?"Saving...":r!=null&&r.id?"Update Page":"Add Page"})]})]})},Hk=({page:r,index:e,pageCount:t,isLoading:n,onEdit:i,onDelete:s,onMoveUp:o,onMoveDown:a})=>P.jsxs("li",{className:"p-4 flex justify-between items-center hover:bg-gray-50",children:[P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("span",{className:"text-xs font-mono text-gray-400 w-6 text-right",children:r.order}),P.jsxs("div",{children:[P.jsx("p",{className:"font-medium text-gray-900",children:r.title}),P.jsxs("p",{className:"text-sm text-gray-500",children:["/",r.slug]})]})]}),P.jsxs("div",{className:"flex items-center space-x-1",children:[P.jsx("button",{onClick:()=>o(e),disabled:n||e===0,className:`p-1 rounded ${n||e===0?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Up",children:P.jsx(Da,{size:18})}),P.jsx("button",{onClick:()=>a(e),disabled:n||e===t-1,className:`p-1 rounded ${n||e===t-1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Down",children:P.jsx(La,{size:18})}),P.jsx("button",{onClick:()=>i(r),disabled:n,className:"p-1 rounded text-gray-500 hover:text-indigo-600 hover:bg-indigo-100 disabled:opacity-50",title:"Edit",children:P.jsx(Va,{size:18})}),r.id&&P.jsx("button",{onClick:()=>s(r.id),disabled:n,className:"p-1 rounded text-gray-500 hover:text-red-600 hover:bg-red-100 disabled:opacity-50",title:"Delete",children:P.jsx(Ms,{size:18})})]})]},r.id),Kk=()=>{const{pages:r,isLoading:e,isEditing:t,handleFormSubmit:n,handleDelete:i,startEditing:s,resetForm:o,handleMoveUp:a,handleMoveDown:l}=sw();return P.jsxs("div",{className:"space-y-6",children:[P.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Manage Pages"}),P.jsx(zk,{initialData:t?r.find(c=>c.id===t):void 0,onSubmit:n,onCancel:o,isLoading:e},t||"add"),P.jsxs("div",{className:"mt-6 border rounded shadow-sm bg-white",children:[P.jsx("h3",{className:"text-lg font-medium p-4 border-b",children:"Existing Pages"}),e&&!r.length?P.jsx("p",{className:"p-4 text-gray-500",children:"Loading pages..."}):r.length===0?P.jsx("p",{className:"p-4 text-gray-500",children:"No pages found."}):P.jsx("ul",{className:"divide-y divide-gray-200",children:r.map((c,h)=>P.jsx(Hk,{page:c,index:h,pageCount:r.length,isLoading:e,onEdit:s,onDelete:i,onMoveUp:a,onMoveDown:l},c.id))})]})]})},Gk="modulepreload",Wk=function(r,e){return new URL(r,e).href},Qh={},ln=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=Wk(c,n),c in Qh)return;Qh[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(!!n)for(let _=o.length-1;_>=0;_--){const g=o[_];if(g.href===c&&(!h||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":Gk,h||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),h)return new Promise((_,g)=>{p.addEventListener("load",_),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},Qk=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ln(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class iu extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class Yk extends iu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Jk extends iu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Xk extends iu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ga;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Ga||(Ga={}));var Zk=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class eS{constructor(e,{headers:t={},customFetch:n,region:i=Ga.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Qk(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return Zk(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const h=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:c}).catch(_=>{throw new Yk(_)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Jk(h);if(!h.ok)throw new Xk(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var kt={},su={},wo={},$i={},Eo={},xo={},tS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Tr=tS();const nS=Tr.fetch,nm=Tr.fetch.bind(Tr),rm=Tr.Headers,rS=Tr.Request,iS=Tr.Response,Fr=Object.freeze(Object.defineProperty({__proto__:null,Headers:rm,Request:rS,Response:iS,default:nm,fetch:nS},Symbol.toStringTag,{value:"Module"})),sS=Zm(Fr);var To={};Object.defineProperty(To,"__esModule",{value:!0});let oS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};To.default=oS;var im=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xo,"__esModule",{value:!0});const aS=im(sS),lS=im(To);let uS=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=aS.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let c=null,h=null,d=null,f=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=m:h=JSON.parse(m))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(c={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,f=406,p="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const g=await s.text();try{c=JSON.parse(g),Array.isArray(c)&&s.status===404&&(h=[],c=null,f=200,p="OK")}catch{s.status===404&&g===""?(f=204,p="No Content"):c={message:g}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,f=200,p="OK"),c&&this.shouldThrowOnError)throw new lS.default(c)}return{error:c,data:h,count:d,status:f,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};xo.default=uS;var cS=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Eo,"__esModule",{value:!0});const hS=cS(xo);let fS=class extends hS.default{select(e){let t=!1;const n=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Eo.default=fS;var dS=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($i,"__esModule",{value:!0});const pS=dS(Eo);let mS=class extends pS.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};$i.default=mS;var gS=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wo,"__esModule",{value:!0});const ii=gS($i);let yS=class{constructor(e,{headers:t={},schema:n,fetch:i}){this.url=e,this.headers=t,this.schema=n,this.fetch=i}select(e,{head:t=!1,count:n}={}){const i=t?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new ii.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new ii.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new ii.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new ii.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ii.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};wo.default=yS;var Ao={},ko={};Object.defineProperty(ko,"__esModule",{value:!0});ko.version=void 0;ko.version="0.0.0-automated";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.DEFAULT_HEADERS=void 0;const vS=ko;Ao.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${vS.version}`};var sm=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(su,"__esModule",{value:!0});const _S=sm(wo),bS=sm($i),wS=Ao;let ES=class om{constructor(e,{headers:t={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},wS.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new _S.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new om(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:i=!1,count:s}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;n||i?(o=n?"HEAD":"GET",Object.entries(t).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{a.searchParams.append(h,d)})):(o="POST",l=t);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new bS.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};su.default=ES;var qr=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(kt,"__esModule",{value:!0});kt.PostgrestError=kt.PostgrestBuilder=kt.PostgrestTransformBuilder=kt.PostgrestFilterBuilder=kt.PostgrestQueryBuilder=kt.PostgrestClient=void 0;const am=qr(su);kt.PostgrestClient=am.default;const lm=qr(wo);kt.PostgrestQueryBuilder=lm.default;const um=qr($i);kt.PostgrestFilterBuilder=um.default;const cm=qr(Eo);kt.PostgrestTransformBuilder=cm.default;const hm=qr(xo);kt.PostgrestBuilder=hm.default;const fm=qr(To);kt.PostgrestError=fm.default;var xS=kt.default={PostgrestClient:am.default,PostgrestQueryBuilder:lm.default,PostgrestFilterBuilder:um.default,PostgrestTransformBuilder:cm.default,PostgrestBuilder:hm.default,PostgrestError:fm.default};const{PostgrestClient:TS,PostgrestQueryBuilder:KN,PostgrestFilterBuilder:GN,PostgrestTransformBuilder:WN,PostgrestBuilder:QN,PostgrestError:YN}=xS,AS="2.11.2",kS={"X-Client-Info":`realtime-js/${AS}`},SS="1.0.0",dm=1e4,IS=1e3;var fr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(fr||(fr={}));var Nt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Nt||(Nt={}));var Dt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Dt||(Dt={}));var Wa;(function(r){r.websocket="websocket"})(Wa||(Wa={}));var qn;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(qn||(qn={}));class NS{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const i=t.getUint8(1),s=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+i));o=o+i;const l=n.decode(e.slice(o,o+s));o=o+s;const c=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class pm{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var qe;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(qe||(qe={}));const Yh=(r,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,o)=>(s[o]=OS(o,r,e,i),s),{})},OS=(r,e,t,n)=>{const i=e.find(a=>a.name===r),s=i==null?void 0:i.type,o=t[r];return s&&!n.includes(s)?mm(s,o):Qa(o)},mm=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return jS(e,t)}switch(r){case qe.bool:return PS(e);case qe.float4:case qe.float8:case qe.int2:case qe.int4:case qe.int8:case qe.numeric:case qe.oid:return CS(e);case qe.json:case qe.jsonb:return RS(e);case qe.timestamp:return LS(e);case qe.abstime:case qe.date:case qe.daterange:case qe.int4range:case qe.int8range:case qe.money:case qe.reltime:case qe.text:case qe.time:case qe.timestamptz:case qe.timetz:case qe.tsrange:case qe.tstzrange:return Qa(e);default:return Qa(e)}},Qa=r=>r,PS=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},CS=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},RS=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},jS=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let s;const o=r.slice(1,t);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>mm(e,a))}return r},LS=r=>typeof r=="string"?r.replace(" ","T"):r,gm=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ca{constructor(e,t,n={},i=dm){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Jh;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Jh||(Jh={}));class mi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mi.syncState(this.state,i,s,o),this.pendingDiffs.forEach(l=>{this.state=mi.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=mi.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const s=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(s,(c,h)=>{o[c]||(l[c]=h)}),this.map(o,(c,h)=>{const d=s[c];if(d){const f=h.map(y=>y.presence_ref),p=d.map(y=>y.presence_ref),_=h.filter(y=>p.indexOf(y.presence_ref)<0),g=d.filter(y=>f.indexOf(y.presence_ref)<0);_.length>0&&(a[c]=_),g.length>0&&(l[c]=g)}else a[c]=h}),this.syncDiff(s,{joins:a,leaves:l},n,i)}static syncDiff(e,t,n,i){const{joins:s,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(a,l)=>{var c;const h=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),h.length>0){const d=e[a].map(p=>p.presence_ref),f=h.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...f)}n(a,h,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const h=l.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Xh||(Xh={}));var Zh;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Zh||(Zh={}));var Zt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Zt||(Zt={}));class ou{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ca(this,Dt.join,this.params,this.timeout),this.rejoinTimer=new pm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Dt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new mi(this),this.broadcastEndpointURL=gm(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:a}}=this.params;this._onError(h=>e==null?void 0:e(Zt.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(Zt.CLOSED));const l={},c={broadcast:s,presence:o,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var d;if(this.socket.setAuth(),h===void 0){e==null||e(Zt.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,_=[];for(let g=0;g<p;g++){const y=f[g],{filter:{event:m,schema:b,table:S,filter:v}}=y,O=h&&h[g];if(O&&O.event===m&&O.schema===b&&O.table===S&&O.filter===v)_.push(Object.assign(Object.assign({},y),{id:O.id}));else{this.unsubscribe(),e==null||e(Zt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(Zt.SUBSCRIBED);return}}).receive("error",h=>{e==null||e(Zt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Zt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Nt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Dt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new ca(this,Dt.leave,{},e);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ca(this,e,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:h}=Dt;if(n&&[a,l,c,h].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var _,g,y;return((_=p.filter)===null||_===void 0?void 0:_.event)==="*"||((y=(g=p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(s=this.bindings[o])===null||s===void 0||s.filter(p=>{var _,g,y,m,b,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const v=p.id,O=(_=p.filter)===null||_===void 0?void 0:_.event;return v&&((g=t.ids)===null||g===void 0?void 0:g.includes(v))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const v=(b=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return v==="*"||v===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const _=f.data,{schema:g,table:y,commit_timestamp:m,type:b,errors:S}=_;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:m,eventType:b,new:{},old:{},errors:S}),this._getPayloadRecords(_))}p.callback(f,n)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ou.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Dt.close,{},e)}_onError(e){this._on(Dt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Yh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Yh(e.columns,e.old_record)),t}}const DS=()=>{},MS=typeof WebSocket<"u",VS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $S{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=kS,this.params={},this.timeout=dm,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=DS,this.conn=null,this.sendBuffer=[],this.serializer=new NS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>ln(async()=>{const{default:l}=await Promise.resolve().then(()=>Fr);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Wa.websocket}`,this.httpEndpoint=gm(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,o)=>o(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new pm(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(MS){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new FS(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ln(async()=>{const{default:e}=await import("./browser-CKC9vik6.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1]),import.meta.url).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:SS}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case fr.connecting:return qn.Connecting;case fr.open:return qn.Open;case fr.closing:return qn.Closing;default:return qn.Closed}}isConnected(){return this.connectionState()===qn.Open}channel(e,t={config:{}}){const n=new ou(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(Dt.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(IS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:i,payload:s,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${o&&"("+o+")"||""}`,s),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Dt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([VS],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class FS{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=fr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class au extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ot(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class qS extends au{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ya extends au{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var US=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const ym=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ln(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},BS=()=>US(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ln(()=>Promise.resolve().then(()=>Fr),void 0,import.meta.url)).Response:Response}),Ja=r=>{if(Array.isArray(r))return r.map(t=>Ja(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ja(n)}),e};var Wn=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const ha=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),zS=(r,e,t)=>Wn(void 0,void 0,void 0,function*(){const n=yield BS();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{e(new qS(ha(i),r.status||500))}).catch(i=>{e(new Ya(ha(i),i))}):e(new Ya(ha(r),r))}),HS=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function Fi(r,e,t,n,i,s){return Wn(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,HS(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>zS(l,a,n))})})}function Ks(r,e,t,n){return Wn(this,void 0,void 0,function*(){return Fi(r,"GET",e,t,n)})}function yn(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"POST",e,n,i,t)})}function KS(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"PUT",e,n,i,t)})}function GS(r,e,t,n){return Wn(this,void 0,void 0,function*(){return Fi(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function vm(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"DELETE",e,n,i,t)})}var Tt=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const WS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ef={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class QS{constructor(e,t={},n,i){this.url=e,this.headers=t,this.bucketId=n,this.fetch=ym(i)}uploadOrUpdate(e,t,n,i){return Tt(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},ef),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(t),h=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(ot(s))return{data:null,error:s};throw s}})}upload(e,t,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return Tt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:ef.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:h}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(ot(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Tt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=yield yn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new au("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}update(e,t,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Tt(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}copy(e,t,n){return Tt(this,void 0,void 0,function*(){try{return{data:{path:(yield yn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return Tt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield yn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return Tt(this,void 0,void 0,function*(){try{const i=yield yn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}download(e,t){return Tt(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ks(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ot(a))return{data:null,error:a};throw a}})}info(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Ks(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ja(n),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}exists(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield GS(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ot(n)&&n instanceof Ya){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return Tt(this,void 0,void 0,function*(){try{return{data:yield vm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}list(e,t,n){return Tt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},WS),t),{prefix:e||""});return{data:yield yn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const YS="2.7.1",JS={"X-Client-Info":`storage-js/${YS}`};var rr=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class XS{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},JS),t),this.fetch=ym(n)}listBuckets(){return rr(this,void 0,void 0,function*(){try{return{data:yield Ks(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}})}getBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Ks(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return rr(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return rr(this,void 0,void 0,function*(){try{return{data:yield KS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}emptyBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield vm(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}}class ZS extends XS{constructor(e,t={},n){super(e,t,n)}from(e){return new QS(this.url,this.headers,e,this.fetch)}}const eI="2.49.4";let ci="";typeof Deno<"u"?ci="deno":typeof document<"u"?ci="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ci="react-native":ci="node";const tI={"X-Client-Info":`supabase-js-${ci}/${eI}`},nI={headers:tI},rI={schema:"public"},iI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sI={};var oI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const aI=r=>{let e;return r?e=r:typeof fetch>"u"?e=nm:e=fetch,(...t)=>e(...t)},lI=()=>typeof Headers>"u"?rm:Headers,uI=(r,e,t)=>{const n=aI(t),i=lI();return(s,o)=>oI(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let c=new i(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},o),{headers:c}))})};var cI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};function hI(r){return r.replace(/\/$/,"")}function fI(r,e){const{db:t,auth:n,realtime:i,global:s}=r,{db:o,auth:a,realtime:l,global:c}=e,h={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),s),accessToken:()=>cI(this,void 0,void 0,function*(){return""})};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}const _m="2.69.1",cr=30*1e3,Xa=3,fa=Xa*cr,dI="http://localhost:9999",pI="supabase.auth.token",mI={"X-Client-Info":`gotrue-js/${_m}`},Za="X-Supabase-Api-Version",bm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yI=6e5;class lu extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Te(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class vI extends lu{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function _I(r){return Te(r)&&r.name==="AuthApiError"}class wm extends lu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Rn extends lu{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class mn extends Rn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bI(r){return Te(r)&&r.name==="AuthSessionMissingError"}class da extends Rn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ds extends Rn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ps extends Rn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wI(r){return Te(r)&&r.name==="AuthImplicitGrantRedirectError"}class tf extends Rn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class el extends Rn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function pa(r){return Te(r)&&r.name==="AuthRetryableFetchError"}class nf extends Rn{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class gi extends Rn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const rf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sf=` 	
\r=`.split(""),EI=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<sf.length;e+=1)r[sf[e].charCodeAt(0)]=-2;for(let e=0;e<rf.length;e+=1)r[rf[e].charCodeAt(0)]=e;return r})();function Em(r,e,t){const n=EI[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function of(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{AI(o,n,t)};for(let o=0;o<r.length;o+=1)Em(r.charCodeAt(o),i,s);return e.join("")}function xI(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function TI(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}xI(n,e)}}function AI(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function kI(r){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)Em(r.charCodeAt(i),t,n);return new Uint8Array(e)}function SI(r){const e=[];return TI(r,t=>e.push(t)),new Uint8Array(e)}function II(r){return Math.round(Date.now()/1e3)+r}function NI(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Bt=()=>typeof window<"u"&&typeof document<"u",Vn={tested:!1,writable:!1},yi=()=>{if(!Bt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vn.tested)return Vn.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Vn.tested=!0,Vn.writable=!0}catch{Vn.tested=!0,Vn.writable=!1}return Vn.writable};function OI(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const xm=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ln(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},PI=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Tm=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ms=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},gs=async(r,e)=>{await r.removeItem(e)};class So{constructor(){this.promise=new So.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}So.promiseConstructor=Promise;function ma(r){const e=r.split(".");if(e.length!==3)throw new gi("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!gI.test(e[n]))throw new gi("JWT not in base64url format");return{header:JSON.parse(of(e[0])),payload:JSON.parse(of(e[1])),signature:kI(e[2]),raw:{header:e[0],payload:e[1]}}}async function CI(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function RI(r,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await r(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function jI(r){return("0"+r.toString(16)).substr(-2)}function LI(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,jI).join("")}async function DI(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function MI(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await DI(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ir(r,e,t=!1){const n=LI();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await Tm(r,`${e}-code-verifier`,i);const s=await MI(n);return[s,n===s?"plain":"s256"]}const VI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $I(r){const e=r.headers.get(Za);if(!e||!e.match(VI))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function FI(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function qI(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var UI=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Fn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),BI=[502,503,504];async function af(r){var e;if(!PI(r))throw new el(Fn(r),0);if(BI.includes(r.status))throw new el(Fn(r),r.status);let t;try{t=await r.json()}catch(s){throw new wm(Fn(s),s)}let n;const i=$I(r);if(i&&i.getTime()>=bm["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new nf(Fn(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new mn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new nf(Fn(t),r.status,t.weak_password.reasons);throw new vI(Fn(t),r.status||500,n)}const zI=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function Oe(r,e,t,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Za]||(s[Za]=bm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await HI(r,e,t+a,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function HI(r,e,t,n,i,s){const o=zI(e,n,i,s);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new el(Fn(l),0)}if(a.ok||await af(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await af(l)}}function gn(r){var e;let t=null;QI(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=II(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function lf(r){const e=gn(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function vn(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function KI(r){return{data:r,error:null}}function GI(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s}=r,o=UI(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function WI(r){return r}function QI(r){return r.access_token&&r.refresh_token&&r.expires_in}var YI=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class JI{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=xm(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await Oe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=YI(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:GI,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Te(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Oe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:vn})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,s,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},h=await Oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:WI});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(_=>{const g=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(_.split(";")[1].split("=")[1]);c[`${y}Page`]=g}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Te(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await Oe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:vn})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Oe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await Oe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}}const XI={getItem:r=>yi()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{yi()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{yi()&&globalThis.localStorage.removeItem(r)}};function uf(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function ZI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const sr={debug:!!(globalThis&&yi()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Am extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eN extends Am{}async function tN(r,e,t){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),sr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new eN(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(sr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}ZI();const nN={url:dI,storageKey:pI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cf(r,e,t){return await t()}class Si{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Si.nextInstanceID,Si.nextInstanceID+=1,this.instanceID>0&&Bt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},nN),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new JI({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=xm(i.fetch),this.lock=i.lock||cf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Bt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=tN:this.lock=cf,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:yi()?this.storage=XI:(this.memoryStorage={},this.storage=uf(this.memoryStorage)):(this.memoryStorage={},this.storage=uf(this.memoryStorage)),Bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_m}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=OI(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Bt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),wI(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Te(t)?{error:t}:{error:new wm("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:gn}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Te(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,n,i;try{let s;if("email"in e){const{email:h,password:d,options:f}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await ir(this.storage,this.storageKey)),s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:_},xform:gn})}else if("phone"in e){const{phone:h,password:d,options:f}=e;s=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:gn})}else throw new ds("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Te(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:o,options:a}=e;t=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:lf})}else if("phone"in e){const{phone:s,password:o,options:a}=e;t=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:lf})}else throw new ds("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new da}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await ms(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:s,error:o}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gn});if(await gs(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new da}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Te(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:s,nonce:o}=e,a=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gn}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new da}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,s,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await ir(this.storage,this.storageKey));const{error:d}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:h}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h}}throw new ds("You must provide either an email or phone number.")}catch(a){if(Te(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await Oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:gn});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Te(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await ir(this.storage,this.storageKey)),await Oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:KI})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new mn;const{error:i}=await Oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Te(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await Oe(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:a}=await Oe(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new ds("You must provide either an email or phone number and a type")}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ms(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<fa:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,h)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,h))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:vn}):await this._useSession(async t=>{var n,i,s;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new mn}:await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:vn})})}catch(t){if(Te(t))return bI(t)&&(await this._removeSession(),await gs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new mn;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await ir(this.storage,this.storageKey));const{data:c,error:h}=await Oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:vn});if(h)throw h;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new mn;const t=Date.now()/1e3;let n=t,i=!0,s=null;const{payload:o}=ma(e.access_token);if(o.exp&&(n=o.exp,i=n<=t),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Te(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new mn;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Bt())throw new ps("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ps(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new tf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ps("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new tf("No code detected.");const{data:b,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!s||!a||!o||!c)throw new ps("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(a);let f=h+d;l&&(f=parseInt(l));const p=f-h;p*1e3<=cr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const _=f-d;h-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,h):h-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,h);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const m={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(Te(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ms(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(_I(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await gs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=NI(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:s},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ir(this.storage,this.storageKey,!0));try{return await Oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:i}=await this._useSession(async s=>{var o,a,l,c,h;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Oe(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return Bt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Te(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)throw o;return await Oe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await RI(async i=>(i>0&&await CI(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await Oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gn})),(i,s)=>{const o=200*Math.pow(2,i);return s&&pa(s)&&Date.now()+o-n<cr})}catch(n){if(this._debug(t,"error",n),Te(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Bt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ms(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const i=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<fa;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${fa}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),pa(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new mn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new So;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new mn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Te(s)){const o={session:null,error:s};return pa(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Tm(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await gs(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Bt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),cr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/cr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${cr}ms, refresh threshold is ${Xa} ticks`),i<=Xa&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Am)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await ir(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await Oe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await Oe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{data:null,error:s};const{data:o,error:a}=await Oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(Te(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await Oe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Te(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ma(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const h=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+yI>Date.now()))return n;const{data:i,error:s}=await Oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new gi("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(o=>o.kid===e),!n)throw new gi("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:p,error:_}=await this.getSession();if(_||!p.session)return{data:null,error:_};n=p.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=ma(n);if(FI(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:o},error:null}}const c=qI(i.alg),h=await this.fetchJwk(i.kid,t),d=await crypto.subtle.importKey("jwk",h,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,SI(`${a}.${l}`)))throw new gi("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}}Si.nextInstanceID=0;const rN=Si;class iN extends rN{constructor(e){super(e)}}var sN=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{c(n.next(h))}catch(d){o(d)}}function l(h){try{c(n.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):i(h.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class oN{constructor(e,t,n){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=hI(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:rI,realtime:sI,auth:Object.assign(Object.assign({},iI),{storageKey:l}),global:nI},h=fI(n??{},c);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=uI(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new TS(`${a}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new eS(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ZS(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return sN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:s,flowType:o,lock:a,debug:l},c,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iN({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:o,lock:a,debug:l,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new $S(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const aN=(r,e,t)=>new oN(r,e,t),lN="https://dzmecnikrhsdedcagvzs.supabase.co",uN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR6bWVjbmlrcmhzZGVkY2FndnpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTQ2NzcsImV4cCI6MjA1OTEzMDY3N30.JMMQMbVTS7QHDPkFInynQ-MszbrH_mEFl4uEDP9E5pk";let km=null;try{km=aN(lN,uN),console.log("Supabase client initialized.")}catch(r){console.error("Error initializing Supabase client:",r)}const st=km,hf="img",cN=({onUploadSuccess:r,onUploadComplete:e})=>{const[t,n]=Y.useState("idle"),[i,s]=Y.useState(null),[o,a]=Y.useState(null),[l,c]=Y.useState(null),[h,d]=Y.useState(null),[f,p]=Y.useState(!1),[_,g]=Y.useState("Copy Link"),y=Y.useRef(null),{showToast:m}=un(),b=()=>{n("idle"),s(null),a(null),c(null),d(null),p(!1),g("Copy Link"),y.current&&(y.current.value="")},S=x=>{if(x&&x.type.startsWith("image/")){s(x),d(null),n("idle"),c(null);const I=URL.createObjectURL(x);a(I),N(x)}else s(null),a(null),x&&(d("Please select an image file."),m("Please select an image file.","error"))},v=x=>{var I;S(((I=x.target.files)==null?void 0:I[0])??null),x.target&&(x.target.value="")},O=x=>{var I;x.preventDefault(),x.stopPropagation(),p(!1),S(((I=x.dataTransfer.files)==null?void 0:I[0])??null)},R=x=>{x.preventDefault(),x.stopPropagation(),p(!0)},E=x=>{x.preventDefault(),x.stopPropagation(),x.currentTarget.contains(x.relatedTarget)||p(!1)},w=()=>{var x;(x=y.current)==null||x.click()},N=async x=>{if(!st){d("Supabase client is not initialized."),n("error"),m("Supabase client not initialized.","error"),e==null||e();return}if(!x){d("No file selected for upload."),n("error"),e==null||e();return}n("uploading"),d(null),g("Copy Link");const k=`public/${Date.now()}_${x.name}`;try{const{error:j}=await st.storage.from(hf).upload(k,x,{cacheControl:"3600",upsert:!1});if(j)throw j;const{data:V}=st.storage.from(hf).getPublicUrl(k);if(!V||!V.publicUrl)throw new Error("Failed to retrieve public URL after upload.");const z=V.publicUrl;c(z),n("success"),m("Image uploaded successfully!","success"),r==null||r(z)}catch(j){console.error("Upload process failed:",j);const V=`Upload failed: ${j instanceof Error?j.message:"Unknown error"}`;d(V),n("error"),m(V,"error")}finally{e==null||e()}};return{status:t,selectedFile:i,previewUrl:o,uploadedUrl:l,error:h,isDragging:f,copyButtonText:_,fileInputRef:y,handleInputChange:v,handleDrop:O,handleDragOver:R,handleDragLeave:E,triggerFileInput:w,handleCopyLink:async()=>{if(l)try{await navigator.clipboard.writeText(l),g("Copied!"),setTimeout(()=>g("Copy Link"),2e3)}catch(x){console.error("Failed to copy:",x);const I="Failed to copy link to clipboard.";d(I),m(I,"error")}},resetState:b}},si="img",hN=({onFileSelect:r})=>{const[e,t]=Y.useState([]),[n,i]=Y.useState(!0),[s,o]=Y.useState(null),[a,l]=Y.useState(null),[c,h]=Y.useState(null),[d,f]=Y.useState(""),[p,_]=Y.useState(null),[g,y]=Y.useState([]),{showToast:m,requestConfirmation:b}=un(),S=Y.useCallback(k=>{if(!st)return null;const{data:j}=st.storage.from(si).getPublicUrl(k);return(j==null?void 0:j.publicUrl)??null},[]),v=Y.useCallback(async()=>{if(i(!0),o(null),!st){o("Supabase client not initialized."),i(!1);return}try{const{data:k,error:j}=await st.storage.from(si).list("public",{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(j)throw j;if(k){const V=k.filter(z=>z.name!==".emptyFolderPlaceholder");t(V)}}catch(k){console.error("Error fetching file history:",k);const j=`Failed to load history: ${k instanceof Error?k.message:"Unknown error"}`;o(j),m(j,"error")}finally{i(!1)}},[m]);Y.useEffect(()=>{v()},[v]);const O=(k,j)=>{y(V=>j?V.includes(k)?V:[...V,k]:V.filter(z=>z!==k))},R=()=>{if(!r||g.length===0)return;let k=[],j=[];g.forEach(V=>{const z=S(V);z?(r(z),k.push(z)):(j.push(V),console.error("Could not get public URL for selected file:",V))}),j.length>0&&m(`Failed to get URLs for: ${j.map(V=>V.split("/").pop()).join(", ")}`,"error"),k.length>0&&(m(`${k.length} URL(s) selected successfully.`,"success"),y([]))},E=Y.useCallback(async k=>{if(!st){m("Supabase client not initialized.","error");return}const V=`Are you sure you want to delete ${k.split("/").pop()||"this file"}? This cannot be undone.`;b({message:V,confirmText:"Confirm Delete",onConfirm:async()=>{if(!st){m("Supabase client not initialized.","error");return}try{const{error:z}=await st.storage.from(si).remove([k]);if(z)throw z;m("File deleted successfully.","success"),v(),y(H=>H.filter(te=>te!==k))}catch(z){console.error("Error deleting file:",z),m(`Failed to delete file: ${z instanceof Error?z.message:"Unknown error"}`,"error")}}})},[st,m,b,v]),w=Y.useCallback(async()=>{if(!st||g.length===0)return;const k=g.map(V=>V.split("/").pop()||"unknown file"),j=`Are you sure you want to delete ${g.length} selected file(s)?

- ${k.join(`
- `)}

This cannot be undone.`;b({message:j,confirmText:"Confirm Delete",onConfirm:async()=>{if(!st){m("Supabase client not initialized.","error");return}try{const{data:V,error:z}=await st.storage.from(si).remove(g);if(z)throw z;console.log("Successfully deleted files:",V),m(`${g.length} file(s) deleted successfully.`,"success"),y([]),v()}catch(V){console.error("Error deleting selected files:",V),m(`Failed to delete selected files: ${V instanceof Error?V.message:"Unknown error"}`,"error")}}})},[st,g,m,b,v]),N=Y.useCallback(async k=>{const j=S(k),V=k;if(!j){l({fileId:V,message:"Error!"}),setTimeout(()=>l(null),2e3),m("Could not get public URL.","error");return}try{await navigator.clipboard.writeText(j),l({fileId:V,message:"Copied!"}),setTimeout(()=>l(null),2e3)}catch(z){console.error("Failed to copy history link:",z),l({fileId:V,message:"Failed!"}),setTimeout(()=>l(null),2e3),m("Failed to copy link.","error")}},[S,m]),T=(k,j)=>{h(k);const V=j.substring(0,j.lastIndexOf("."));f(V),_(null)},x=()=>{h(null),f(""),_(null)},I=Y.useCallback(async k=>{if(!st){_("Supabase client not initialized."),m("Supabase client not initialized.","error");return}const j=k.split("/").pop();if(!j){_("Invalid old file path.");return}const V=d.trim();if(!V||V===j.substring(0,j.lastIndexOf("."))){_("Please enter a valid new name.");return}if(V.includes("/")){_("Filename cannot contain slashes.");return}const z=j.includes(".")?j.substring(j.lastIndexOf(".")):"",H=V+z,te=`public/${H}`;if(te===k){_("New name is the same as the old name.");return}_(null);try{const{error:K}=await st.storage.from(si).move(k,te);if(K)throw K.message.includes("already exists")?new Error(`A file named '${H}' already exists.`):K;m("File renamed successfully!","success"),x(),v(),y(q=>q.map(L=>L===k?te:L))}catch(K){console.error("Error renaming file:",K);const q=`Rename failed: ${K instanceof Error?K.message:"Unknown error"}`;_(q),m(q,"error")}},[st,d,v,m]);return{fileHistory:e,historyLoading:n,historyError:s,historyCopyStatus:a,editingFileId:c,newName:d,renameError:p,selectedHistoryFiles:g,fetchHistory:v,handleHistorySelectionChange:O,handleUseSelected:R,handleDeleteFile:E,handleDeleteSelected:w,handleCopyHistoryLink:N,handleEditClick:T,handleCancelEdit:x,handleSaveRename:I,setNewName:f,getPublicUrl:S}},fN=({isDragging:r,error:e,fileInputRef:t,handleDrop:n,handleDragOver:i,handleDragLeave:s,triggerFileInput:o,handleInputChange:a})=>P.jsxs("div",{className:`w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center transition-all duration-300 ${r?"border-blue-500 border-2":"border-gray-200 border"}`,onDrop:n,onDragOver:i,onDragLeave:s,children:[P.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-2",children:"Upload your image"}),P.jsx("p",{className:"text-xs text-gray-500 mb-6",children:"File should be Jpeg, Png,..."}),P.jsxs("div",{className:`bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl p-10 mb-6 transition-colors duration-300 ${r?"border-blue-400 bg-blue-50":""}`,children:[P.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:P.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),P.jsx("p",{className:"text-sm text-gray-500",children:"Drag & Drop your image here"})]}),P.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Or"}),P.jsx("button",{onClick:o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300",children:"Choose a file"}),P.jsx("input",{ref:t,type:"file",accept:"image/*",onChange:a,className:"hidden","aria-label":"File input"}),e&&P.jsx("p",{className:"text-red-500 text-sm mt-4",children:e})]}),dN=({status:r,previewUrl:e,uploadedUrl:t,error:n,copyButtonText:i,handleCopyLink:s,resetState:o})=>{const a=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsxs("svg",{className:"animate-spin mx-auto h-10 w-10 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[P.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),P.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),P.jsx("h2",{className:"text-lg font-medium text-gray-700",children:"Uploading..."})]}),l=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsx("svg",{className:"mx-auto h-10 w-10 text-green-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),P.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-4",children:"Uploaded Successfully!"}),e&&P.jsx("div",{className:"mb-6 rounded-xl overflow-hidden border border-gray-200",children:P.jsx("img",{src:e,alt:"Uploaded preview",className:"max-w-full max-h-64 object-contain mx-auto"})}),P.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg p-2 bg-gray-50 mb-4",children:[P.jsx("input",{type:"text",value:t??"",readOnly:!0,className:"flex-grow text-xs text-gray-700 bg-transparent border-none focus:ring-0 p-1 truncate","aria-label":"Uploaded image link"}),P.jsx("button",{onClick:s,className:"ml-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors duration-300 flex-shrink-0",children:i})]}),P.jsx("button",{onClick:o,className:"text-sm text-blue-600 hover:underline",children:"Upload another image"})]}),c=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsx("svg",{className:"mx-auto h-10 w-10 text-red-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),P.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-2",children:"Upload Failed"}),P.jsx("p",{className:"text-red-500 text-sm mb-6",children:n||"An unknown error occurred."}),e&&P.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-200 opacity-70",children:P.jsx("img",{src:e,alt:"Upload failed preview",className:"max-w-full max-h-48 object-contain mx-auto"})}),P.jsx("button",{onClick:o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300",children:"Try Again"})]});switch(r){case"uploading":return a();case"success":return l();case"error":return c();default:return null}},pN=(r,e=2)=>{if(r===0)return"0 Bytes";const t=1024,n=e<0?0:e,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(r)/Math.log(t));return parseFloat((r/Math.pow(t,s)).toFixed(n))+" "+i[s]},mN=({fileHistory:r,historyLoading:e,historyError:t,selectedHistoryFiles:n,editingFileId:i,newName:s,renameError:o,historyCopyStatus:a,getPublicUrl:l,handleHistorySelectionChange:c,handleUseSelected:h,handleDeleteSelected:d,handleCopyHistoryLink:f,handleEditClick:p,handleCancelEdit:_,handleSaveRename:g,handleDeleteFile:y,setNewName:m})=>{if(e)return P.jsx("div",{className:"text-center p-4",children:"Loading history..."});if(t)return P.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error loading history: ",t]});const b=S=>`public/${S.name}`;return P.jsxs("div",{className:"mt-8 border-t pt-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Image History"}),n.length>0&&P.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded-md flex items-center justify-between",children:[P.jsxs("span",{className:"text-sm text-gray-700",children:[n.length," file(s) selected"]}),P.jsxs("div",{children:[P.jsx("button",{onClick:h,className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors mr-2",title:"Use selected image URL(s)",children:"Use Selected"}),P.jsx("button",{onClick:d,className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors",title:"Delete selected files",children:"Delete Selected"})]})]}),r.length===0?P.jsx("p",{className:"text-gray-500 text-sm text-center",children:"No images uploaded yet."}):P.jsx("ul",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:r.map(S=>{var N;const v=b(S),O=l(v),R=n.includes(v),E=i===v,w=(a==null?void 0:a.fileId)===v?a.message:"Copy Link";return P.jsxs("li",{className:"flex items-center justify-between p-3 bg-white rounded-lg shadow-sm border border-gray-200 hover:bg-gray-50 transition-colors",children:[P.jsxs("div",{className:"flex items-center space-x-3 flex-grow min-w-0",children:[P.jsx("input",{type:"checkbox",checked:R,onChange:T=>c(v,T.target.checked),className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500","aria-label":`Select ${S.name}`}),O?P.jsx("img",{src:O,alt:S.name,className:"h-10 w-10 object-cover rounded bg-gray-100"}):P.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center text-gray-400",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),P.jsxs("div",{className:"flex-grow min-w-0",children:[E?P.jsxs("div",{className:"flex flex-col",children:[P.jsxs("div",{className:"flex items-center",children:[P.jsx("input",{type:"text",value:s,onChange:T=>m(T.target.value),className:"text-sm p-1 border border-gray-300 rounded mr-2 flex-grow focus:ring-1 focus:ring-blue-500 focus:border-blue-500","aria-label":"New file name"}),P.jsx("button",{onClick:()=>g(v),className:"text-xs text-green-600 hover:text-green-800 mr-1",title:"Save",children:"✓"}),P.jsx("button",{onClick:_,className:"text-xs text-red-600 hover:text-red-800",title:"Cancel",children:"✕"})]}),o&&P.jsx("p",{className:"text-red-500 text-xs mt-1",children:o})]}):P.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",title:S.name,children:S.name}),P.jsxs("p",{className:"text-xs text-gray-500",children:[pN(((N=S.metadata)==null?void 0:N.size)??0)," - ",new Date(S.created_at).toLocaleDateString()]})]})]}),!E&&P.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 ml-2",children:[P.jsx("button",{onClick:()=>f(v),className:`text-xs px-2 py-1 rounded transition-colors ${w==="Copied!"?"bg-green-100 text-green-700":w==="Failed!"||w==="Error!"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:w!=="Copy Link",title:"Copy image URL",children:w}),P.jsx("button",{onClick:()=>p(v,S.name),className:"text-gray-500 hover:text-gray-700",title:"Rename file",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),P.jsx("button",{onClick:()=>y(v),className:"text-red-500 hover:text-red-700",title:"Delete file",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},S.id||S.name)})})]})},gN=({onUploadSuccess:r})=>{const e=hN({onFileSelect:r}),t=cN({onUploadSuccess:n=>{r==null||r(n),e.fetchHistory()}});return P.jsxs("div",{className:"space-y-6",children:[t.status==="idle"?P.jsx(fN,{isDragging:t.isDragging,error:t.error,fileInputRef:t.fileInputRef,handleDrop:t.handleDrop,handleDragOver:t.handleDragOver,handleDragLeave:t.handleDragLeave,triggerFileInput:t.triggerFileInput,handleInputChange:t.handleInputChange}):P.jsx(dN,{status:t.status,previewUrl:t.previewUrl,uploadedUrl:t.uploadedUrl,error:t.error,copyButtonText:t.copyButtonText,handleCopyLink:t.handleCopyLink,resetState:t.resetState}),P.jsx(mN,{fileHistory:e.fileHistory,historyLoading:e.historyLoading,historyError:e.historyError,selectedHistoryFiles:e.selectedHistoryFiles,editingFileId:e.editingFileId,newName:e.newName,renameError:e.renameError,historyCopyStatus:e.historyCopyStatus,getPublicUrl:e.getPublicUrl,handleHistorySelectionChange:e.handleHistorySelectionChange,handleUseSelected:e.handleUseSelected,handleDeleteSelected:e.handleDeleteSelected,handleCopyHistoryLink:e.handleCopyHistoryLink,handleEditClick:e.handleEditClick,handleCancelEdit:e.handleCancelEdit,handleSaveRename:e.handleSaveRename,handleDeleteFile:e.handleDeleteFile,setNewName:e.setNewName})]})},dr=(r,e,t,n,i,s,o)=>e.length===1&&e[0]==="projects"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsxs("div",{className:"flex justify-between items-center mb-3",children:[P.jsx("h4",{className:"text-lg font-semibold capitalize",children:String(e[0]).replace(/([A-Z])/g," $1")}),s&&P.jsx("button",{onClick:s,className:"bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded focus:outline-none focus:shadow-outline",children:"+ Add Project"})]}),Object.entries(r).map(([a,l])=>{if(a!=="title"&&typeof l=="object"&&l!==null&&!Array.isArray(l)){const c=[...e,a];return P.jsxs("div",{className:"mb-6 p-4 bg-white border border-gray-200 rounded-lg shadow-sm relative",children:[P.jsxs("div",{className:"flex justify-between items-start mb-3",children:[" ",P.jsxs("h5",{className:"text-lg font-semibold text-gray-700 mr-4",children:["Project: ",P.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:a})]}),o&&P.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete project "${a}"?`)&&o(c)},className:"bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete project ${a}`,children:"Delete Project"})]}),P.jsxs("div",{className:"space-y-4",children:[" ",dr(l,c,t,n,i,void 0,o)]})]},c.join("."))}else if(a==="title"&&typeof l=="string"){const c=[...e,a],h=c.join("."),d=n===h;return P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?P.jsx("input",{type:"text",id:h,name:h,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2",value:l,onChange:f=>t(c,f.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"mt-1 block w-full rounded-md border border-transparent p-2 cursor-pointer hover:bg-gray-100 min-h-[38px]",onClick:()=>i(h),children:l||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},h)}return null})]},e.join(".")):Object.entries(r).map(([a,l])=>{const c=[...e,a],h=c.map(String).join("."),d=n===h;return typeof l=="string"?P.jsxs("div",{className:"mb-4 px-1 sm:px-0",children:[P.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?P.jsx("textarea",{id:h,name:h,rows:l.length>100?4:2,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:l,onChange:f=>t(c,f.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[50px] whitespace-pre-wrap text-gray-800",onClick:()=>i(h),children:l||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},h):typeof l=="object"&&l!==null&&!Array.isArray(l)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize",children:String(a).replace(/([A-Z])/g," $1")}),dr(l,c,t,n,i,void 0,o)]},h):Array.isArray(l)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-white shadow-sm",children:[P.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize text-gray-700",children:String(a).replace(/([A-Z])/g," $1")}),P.jsxs("div",{className:"space-y-3",children:[" ",l.map((f,p)=>{const _=[...c,p],g=_.map(String).join("."),y=n===g;return typeof f=="string"?P.jsxs("div",{className:"flex items-center space-x-2",children:[y?P.jsx("input",{type:"text",id:g,name:g,className:"flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:f,onChange:m=>t(_,m.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"flex-grow rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[38px] text-gray-800",onClick:()=>i(g),children:f||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})}),o&&P.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this item?")&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete item ${p+1}`,children:"Delete"})]},g):typeof f=="object"&&f!==null?P.jsxs("div",{className:"mb-4 p-3 border border-gray-100 rounded relative",children:[" ",P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[" ",P.jsxs("h5",{className:"text-md font-medium",children:["Item ",p+1]}),o&&P.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete Item ${p+1}?`)&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-0.5 px-1.5 rounded focus:outline-none focus:shadow-outline","aria-label":`Delete item ${p+1}`,children:"Delete"})]}),dr(f,_,t,n,i,void 0,o)]},g):null})]})," "]},h):null}),yN=r=>r===null?!1:r in Pt.en,ys={pageViews:"1,234",totalPages:"12",comments:"45",averageRating:"4.8"},vN=()=>P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Page Views"}),P.jsx(Jv,{className:"text-blue-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.pageViews}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Last 30 days"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Total Pages"}),P.jsx(tp,{className:"text-green-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.totalPages}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Published content"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Comments"}),P.jsx(v_,{className:"text-purple-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.comments}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Awaiting response"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Average Rating"}),P.jsx(N_,{className:"text-yellow-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.averageRating}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Based on feedback"})]})]}),_N=({activeTab:r,isLoading:e,translations:t,editingPath:n,setEditingPath:i,handleInputChange:s,handleAddNewProject:o,handleAddNewService:a,handleDeleteItem:l})=>{if(e)return P.jsx("div",{className:"flex items-center justify-center py-10",children:P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});if(!r||r==="dashboard")return vN();if(r==="styleEditor")return P.jsx(ew,{});if(r==="socialLinks")return P.jsx(rw,{});if(r==="pages")return P.jsx(Kk,{});if(r==="media")return P.jsx(gN,{});if(yN(r)){const c=Vs(r);return P.jsxs(P.Fragment,{children:[P.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-700 capitalize",children:c}),r==="projects"?P.jsx(K_,{data:t.en.projects,path:r?[r]:[],handleChange:s,editingPath:n,setEditingPath:i,handleAddProject:o,handleDelete:l,renderFields:dr}):r==="services"?P.jsx(G_,{data:t.en.services,path:r?[r]:[],handleChange:s,editingPath:n,setEditingPath:i,handleAddService:a,handleDelete:l,renderFields:dr}):r==="generalInfo"?P.jsx(iw,{translations:t,handleInputChange:s,editingPath:n,setEditingPath:i,getStaticSectionName:Vs}):dr(t.en[r],[r],s,n,i,void 0,l)]})}return P.jsxs("p",{className:"text-red-500",children:["Error: Invalid tab '",r,"' selected."]})},bN=[{icon:P.jsx(a_,{size:20}),label:"Dashboard",tab:"dashboard"},{icon:P.jsx(tp,{size:20}),label:"Pages",tab:"pages"},{icon:P.jsx(e_,{size:20}),label:"Projects",tab:"projects"},{icon:P.jsx(i_,{size:20}),label:"Media",tab:"media"},{icon:P.jsx(op,{size:20}),label:"Appearance",tab:"styleEditor"},{icon:P.jsx(u_,{size:20}),label:"Social Links",tab:"socialLinks"},{icon:P.jsx(k_,{size:20}),label:"Settings",tab:"generalInfo"}],wN=()=>{const r=df(),[e,t]=Y.useState(!1),[n,i]=Y.useState(()=>{const v=localStorage.getItem("desktopSidebarCollapsed");return v?JSON.parse(v):!1}),[s,o]=Y.useState(window.innerWidth<768);Y.useEffect(()=>{const v=()=>{const O=window.innerWidth<768;o(O),O||t(!1)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]),Y.useEffect(()=>{s||localStorage.setItem("desktopSidebarCollapsed",JSON.stringify(n))},[n,s]);const{translations:a,isLoading:l,saveStatus:c,handleInputChange:h,handleAddNewProject:d,handleAddNewService:f,saveChanges:p,handleDeleteItem:_}=B_(),[g,y]=Y.useState("dashboard"),[m,b]=Y.useState(null),S=async()=>{if(!Mt){console.error("Firebase auth instance is not available."),alert("Logout service unavailable. Please try again later.");return}try{await _g(Mt),r("/admin/login")}catch(v){console.error("Logout failed:",v),alert("Failed to log out. Please try again.")}};return P.jsx(up,{children:P.jsxs("div",{className:"min-h-screen bg-gray-100",children:[P.jsx(z_,{isMobile:s,isSidebarOpen:e,isDesktopSidebarCollapsed:n,onToggleMobileSidebar:()=>t(!e),onToggleDesktopSidebar:()=>i(!n),onLogout:S}),P.jsxs("div",{className:"flex pt-16",children:[P.jsx(H_,{isMobile:s,isSidebarOpen:e,isDesktopSidebarCollapsed:n,activeTab:g,navItems:bN,onTabClick:v=>{y(v),s&&t(!1)},onCloseMobileSidebar:()=>t(!1)}),P.jsx("main",{className:`flex-1 transition-all duration-300 ${s?"ml-0":n?"md:ml-20":"md:ml-64"}`,children:P.jsxs("div",{className:"p-4 md:p-8",children:[P.jsxs("div",{className:"mb-4 md:mb-6",children:[P.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:g?Vs(g):"Dashboard"}),P.jsxs("p",{className:"text-sm text-gray-500",children:["Home / ",g?Vs(g):"Dashboard"]})]}),P.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:P.jsx(_N,{activeTab:g,isLoading:l,translations:a,editingPath:m,setEditingPath:b,handleInputChange:h,handleAddNewProject:d,handleAddNewService:f,handleDeleteItem:_})}),g&&g!=="styleEditor"&&g!=="socialLinks"&&g!=="pages"&&P.jsxs("div",{className:"mt-6 flex justify-end items-center gap-4",children:[c&&P.jsx("span",{className:"text-green-600 text-sm",children:c}),P.jsx("button",{onClick:()=>p(),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors",disabled:l,children:"Save Changes"})]})]})})]})]})})},EN=({page:r})=>{const e=eg();return r?P.jsx("div",{className:"min-h-screen text-white",style:{background:"linear-gradient(to bottom right, var(--background-from-color, #111827), var(--background-to-color, #1F2937))"},children:P.jsxs("div",{className:"container mx-auto px-4 py-16",children:[P.jsx("h1",{className:"text-4xl font-bold mb-6",style:{color:"var(--title-color)"},children:r.title}),P.jsxs("div",{className:"prose prose-invert max-w-none text-text",children:[" ",P.jsx("div",{className:"ql-snow",children:P.jsx("div",{className:"ql-editor",dangerouslySetInnerHTML:{__html:r.content}})})]}),P.jsx("div",{className:"mt-12 text-center",children:P.jsx(vi,{to:"/",className:"text-blue-400 hover:text-blue-300 underline",children:"← Back to Home"})})]})}):P.jsxs("div",{className:"container mx-auto px-4 py-16 text-center text-white min-h-screen flex flex-col items-center justify-center",children:[P.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Page Not Found"}),P.jsxs("p",{className:"text-xl",children:["The page you requested (",e.pathname,") could not be found."]}),P.jsx(vi,{to:"/",className:"mt-6 inline-block bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded",children:"Go Home"})]})},xN=()=>{const[r,e]=Y.useState(!1),t=()=>{window.pageYOffset>300?e(!0):e(!1)};Y.useEffect(()=>(window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}),[]);const n=()=>{window.scrollTo({top:0,behavior:"smooth"})};return P.jsx("button",{type:"button",onClick:n,className:`fixed bottom-5 right-5 p-3 rounded-full bg-blue-500 text-white shadow-lg transition-opacity duration-300 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,"aria-label":"Scroll to top",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})})},TN=(r=Pt)=>{const e=r.en,t=e==null?void 0:e.projects,n=t?Object.entries(t).filter(([i,s])=>i!=="title"&&typeof s=="object"&&s!==null).map(([i,s])=>({title:(s==null?void 0:s.title)??`Project ${i}`,description:(s==null?void 0:s.description)??"Description missing.",tags:(s==null?void 0:s.tags)??[],link:(s==null?void 0:s.link)??""})):[];return{title:(t==null?void 0:t.title)??"Featured Projects",projects:n}},AN=""+new URL("../logo.png",import.meta.url).href,kN=({logoUrl:r,altText:e="Site Logo",className:t=""})=>{const n=r||AN;return P.jsx("img",{src:n,alt:e,className:`logo-image ${t}`})};function SN(r="en"){const[e,t]=Y.useState(Pt[r]),[n,i]=Y.useState(!0),[s,o]=Y.useState(null);return Y.useEffect(()=>{if(!de){console.error("useTranslations: Firestore instance is not available."),o(new Error("Firestore not available")),i(!1),t(Pt[r]);return}i(!0),o(null);const l=nt(de,"translations",r);console.log(`useTranslations: Setting up listener for translations/${r}...`);const c=zl(l,h=>{if(h.exists()){const d=h.data();console.log(`useTranslations: Received translations update for ${r}:`,d),t(f=>({...Pt[r],...d}))}else t(Pt[r]),console.log(`useTranslations: No translations document found for ${r}, using defaults.`);i(!1)},h=>{console.error(`useTranslations: Firestore snapshot error for ${r}:`,h),o(h),t(Pt[r]),i(!1)});return()=>{console.log(`useTranslations: Unsubscribing from translations/${r} listener.`),c()}},[r]),{t:Y.useMemo(()=>e,[e]),isLoading:n,error:s}}const IN={Github:np,Facebook:ep,Mail:sp,Instagram:rp,Linkedin:ip,Twitter:ap};function NN(){const[r,e]=Y.useState([]),[t,n]=Y.useState(!0),[i,s]=Y.useState(null);return Y.useEffect(()=>{(async()=>{if(!de){console.error("useSocialLinks: Firestore instance is not available."),s(new Error("Firestore not available")),n(!1);return}n(!0),s(null);try{const a=br(de,"socialLinks"),l=uo(a,co("order","asc")),h=(await Mi(l)).docs.map(d=>({id:d.id,...d.data()}));e(h),console.log("useSocialLinks: Fetched social links:",h)}catch(a){console.error("useSocialLinks: Error fetching social links:",a),s(a instanceof Error?a:new Error(String(a)))}finally{n(!1)}})()},[]),{socialLinks:r,iconComponents:IN,isLoading:t,error:i}}const ON=Y.lazy(()=>ln(()=>import("./ServicesSection-DGDj_Nap.js"),__vite__mapDeps([2,1,3]),import.meta.url)),PN=Y.lazy(()=>ln(()=>import("./ProjectsSection-T4zhqq8x.js"),__vite__mapDeps([4,1,3]),import.meta.url)),CN=Y.lazy(()=>ln(()=>import("./ContactSection-F2Wq3QDb.js"),__vite__mapDeps([5,1,3]),import.meta.url)),RN=({dynamicPages:r})=>{const{t:e,isLoading:t,error:n}=SN("en"),[i,s]=Y.useState(!1),{socialLinks:o,iconComponents:a,isLoading:l,error:c}=NN();Y.useEffect(()=>{n&&console.error("MainSite: Error loading translations:",n)},[n]),Y.useEffect(()=>{c&&console.error("MainSite: Error loading social links:",c)},[c]),Y.useEffect(()=>{const _=g=>{g.ctrlKey&&g.altKey&&g.key==="a"&&(g.preventDefault(),s(y=>!y))};return document.addEventListener("keydown",_),()=>{document.removeEventListener("keydown",_)}},[]);const h=Y.useMemo(()=>TN({en:e}),[e]),d=P.jsx("div",{className:"flex items-center justify-center p-8",children:P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});return t?P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):P.jsxs("div",{className:"min-h-screen text-white ltr",style:{background:"linear-gradient(to bottom right, var(--background-from-color, #111827), var(--background-to-color, #1F2937))"},children:[P.jsx("header",{className:"container mx-auto px-4 py-16 md:py-0",children:P.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[P.jsx(kN,{logoUrl:e.generalInfo.logoUrl}),P.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6 text-primary",style:{pointerEvents:"none",userSelect:"none"},children:e.generalInfo.siteTitle}),P.jsx("p",{className:"text-xl md:text-2xl text-secondary mb-8",style:{pointerEvents:"none",userSelect:"none"},children:e.generalInfo.siteRole}),P.jsx("div",{className:"flex justify-center space-x-6",children:l?P.jsx("div",{className:"text-secondary",children:"Loading links..."}):o.map(_=>{const g=a[_.icon];return g?P.jsx("a",{href:_.url,target:"_blank",rel:"noopener noreferrer","aria-label":_.name,className:"text-primary hover:text-text transition-colors transform hover:scale-110",children:P.jsx(g,{size:24})},_.id):null})}),r&&r.length>0&&P.jsx("nav",{className:"mb-4 flex justify-center flex-wrap gap-x-4 gap-y-2 mt-8",children:r.map(_=>P.jsx(vi,{to:`/${_.slug}`,className:"text-secondary hover:text-primary transition-colors text-sm",children:_.title},_.id))})]})}),P.jsx(Y.Suspense,{fallback:d,children:P.jsx(PN,{title:h.title,projects:h.projects})}),P.jsx("section",{className:"container mx-auto px-4 py-16 bg-gray-800/50 backdrop-blur-sm",children:P.jsxs("div",{className:"max-w-3xl mx-auto",children:[P.jsx("h2",{className:"text-3xl font-bold text-center mb-8",style:{color:"var(--title-color)"},children:e.about.title}),P.jsx("p",{className:"text-lg leading-relaxed text-text",children:e.about.description})]})}),P.jsx(Y.Suspense,{fallback:d,children:P.jsx(ON,{title:e.services.title,services:e.services.list})}),P.jsx(Y.Suspense,{fallback:d,children:P.jsx(CN,{t:e.contact})}),P.jsxs("footer",{className:"container mx-auto px-4 py-8 text-center relative",children:[P.jsx("p",{className:"text-secondary mb-4",children:e.generalInfo.footerText}),P.jsx(vi,{to:"/admin/dashboard",className:`absolute bottom-2 left-1/2 -translate-x-1/2 text-sm text-primary hover:text-text underline transition-opacity duration-300 ${i?"opacity-100":"opacity-0 pointer-events-none"}`,children:"Admin Dashboard"})]})]})},jN=()=>P.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center px-4",style:{background:"linear-gradient(to bottom right, var(--background-from-color, #111827), var(--background-to-color, #1F2937))",color:"var(--text-color, #c6d3e2)"},children:[P.jsx("h1",{className:"text-6xl font-bold mb-4",style:{color:"var(--primary-color, #60a5fa)"},children:"404"}),P.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Page Not Found"}),P.jsx("p",{className:"mb-8 max-w-md",children:"Sorry, the page you are looking for does not exist. It might have been moved or deleted."}),P.jsx(vi,{to:"/",className:"px-6 py-2 rounded text-white transition-colors bg-primary hover:brightness-110",style:{backgroundColor:"var(--primary-color)"},children:"Go Back Home"})]}),LN=({children:r})=>{const[e,t]=Y.useState(null),[n,i]=Y.useState(!0);return Y.useEffect(()=>{if(!Mt){i(!1);return}const s=mf(Mt,o=>{t(o),i(!1)});return()=>s()},[]),n?P.jsx("div",{className:"flex items-center justify-center min-h-screen",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):e?r:P.jsx(pf,{to:"/admin/login",replace:!0})};function DN(){const[r,e]=Y.useState([]),[t,n]=Y.useState(!0);return Y.useEffect(()=>{if(!de){console.error("App.tsx: Firestore not initialized correctly for loading styles.");return}const i=nt(de,"settings","styles");console.log("App.tsx: Setting up real-time listener for global styles...");const s=zl(i,o=>{if(o.exists()){const a=o.data();console.log("App.tsx: Received style update from Firestore:",a),document.documentElement.style.setProperty("--primary-color",a.primaryColor),document.documentElement.style.setProperty("--secondary-color",a.secondaryColor),document.documentElement.style.setProperty("--font-family",a.fontFamily),document.documentElement.style.setProperty("--title-color",a.titleColor||"#d7e3ee"),document.documentElement.style.setProperty("--h3title-color",a.h3TitleColor||"#d7e3ee"),document.documentElement.style.setProperty("--text-color",a.textColor||"#c6d3e2"),document.documentElement.style.setProperty("--background-from-color",a.backgroundFromColor||"#111827"),document.documentElement.style.setProperty("--background-to-color",a.backgroundToColor||"#1F2937"),document.documentElement.style.setProperty("--section-bg-color",a.sectionBgColor||"#374151")}else console.log("App.tsx: No global styles document found in Firestore, applying CSS defaults.")},o=>{console.error("App.tsx: Error listening to global styles:",o)});return()=>{console.log("App.tsx: Unsubscribing from global styles listener."),s()}},[]),Y.useEffect(()=>{if(n(!0),!de){console.error("App.tsx: Firestore not initialized correctly for loading pages."),n(!1);return}(async()=>{if(!de){console.error("App.tsx: Firestore not initialized correctly for loading pages."),n(!1);return}try{const s=br(de,"pages"),o=uo(s,co("order","asc")),l=(await Mi(o)).docs.map(c=>({id:c.id,...c.data()}));e(l),console.log("App.tsx: Fetched dynamic pages:",l)}catch(s){console.error("App.tsx: Error fetching dynamic pages:",s)}finally{n(!1)}})()},[]),t?P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):P.jsxs(up,{children:[" ",P.jsxs(tg,{children:[P.jsxs(ng,{children:[P.jsx(Zn,{path:"/",element:P.jsx(RN,{dynamicPages:r})}),r.map(i=>P.jsx(Zn,{path:`/${i.slug}`,element:P.jsx(EN,{page:i})},i.id)),P.jsx(Zn,{path:"/admin/login",element:P.jsx(jv,{})}),P.jsx(Zn,{path:"/admin/dashboard",element:P.jsx(LN,{children:P.jsx(wN,{})})}),P.jsx(Zn,{path:"/admin",element:P.jsx(pf,{to:"/admin/login",replace:!0})}),P.jsx(Zn,{path:"*",element:P.jsx(jN,{})})]}),P.jsx(xN,{})," "]})]})}vf(document.getElementById("root")).render(P.jsx(DN,{}));export{je as c,P as j};
//# sourceMappingURL=index-CtVEFBCW.js.map
