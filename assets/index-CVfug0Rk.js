const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-CKC9vik6.js","assets/react-vendor-ByTr29QW.js","assets/ServicesSection-DVpx7NKb.js","assets/firebase-vendor-CJFYC82U.js","assets/ProjectsSection-BK8Qby6q.js","assets/ContactSection-uIu3QQCT.js"])))=>i.map(i=>d[i]);
import{r as Y,a as df,N as pf,u as mf,c as Ge,g as eg,b as tg,d as ng,L as vi,B as rg,R as ig,e as Zn}from"./react-vendor-ByTr29QW.js";import{L as sg,_ as og,C as ag,r as ru,F as lg,a as cg,g as ug,b as hg,c as fg,d as nn,e as dg,f as pg,S as mg,h as Rt,i as gg,j as yg,k as vg,l as _g,o as gf,s as bg,m as wg}from"./firebase-vendor-CJFYC82U.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var yf={exports:{}},Ks={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg=Y,Eg=Symbol.for("react.element"),Tg=Symbol.for("react.fragment"),Ag=Object.prototype.hasOwnProperty,kg=xg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sg={key:!0,ref:!0,__self:!0,__source:!0};function vf(r,e,t){var n,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Ag.call(e,n)&&!Sg.hasOwnProperty(n)&&(i[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Eg,type:r,key:s,ref:o,props:i,_owner:kg.current}}Ks.Fragment=Tg;Ks.jsx=vf;Ks.jsxs=vf;yf.exports=Ks;var N=yf.exports,_f,iu=df;_f=iu.createRoot,iu.hydrateRoot;var su=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bn,bf;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,w){function P(){}P.prototype=w.prototype,x.D=w.prototype,x.prototype=new P,x.prototype.constructor=x,x.C=function(T,A,S){for(var E=Array(arguments.length-2),j=2;j<arguments.length;j++)E[j-2]=arguments[j];return w.prototype[A].apply(T,E)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,w,P){P||(P=0);var T=Array(16);if(typeof w=="string")for(var A=0;16>A;++A)T[A]=w.charCodeAt(P++)|w.charCodeAt(P++)<<8|w.charCodeAt(P++)<<16|w.charCodeAt(P++)<<24;else for(A=0;16>A;++A)T[A]=w[P++]|w[P++]<<8|w[P++]<<16|w[P++]<<24;w=x.g[0],P=x.g[1],A=x.g[2];var S=x.g[3],E=w+(S^P&(A^S))+T[0]+3614090360&4294967295;w=P+(E<<7&4294967295|E>>>25),E=S+(A^w&(P^A))+T[1]+3905402710&4294967295,S=w+(E<<12&4294967295|E>>>20),E=A+(P^S&(w^P))+T[2]+606105819&4294967295,A=S+(E<<17&4294967295|E>>>15),E=P+(w^A&(S^w))+T[3]+3250441966&4294967295,P=A+(E<<22&4294967295|E>>>10),E=w+(S^P&(A^S))+T[4]+4118548399&4294967295,w=P+(E<<7&4294967295|E>>>25),E=S+(A^w&(P^A))+T[5]+1200080426&4294967295,S=w+(E<<12&4294967295|E>>>20),E=A+(P^S&(w^P))+T[6]+2821735955&4294967295,A=S+(E<<17&4294967295|E>>>15),E=P+(w^A&(S^w))+T[7]+4249261313&4294967295,P=A+(E<<22&4294967295|E>>>10),E=w+(S^P&(A^S))+T[8]+1770035416&4294967295,w=P+(E<<7&4294967295|E>>>25),E=S+(A^w&(P^A))+T[9]+2336552879&4294967295,S=w+(E<<12&4294967295|E>>>20),E=A+(P^S&(w^P))+T[10]+4294925233&4294967295,A=S+(E<<17&4294967295|E>>>15),E=P+(w^A&(S^w))+T[11]+2304563134&4294967295,P=A+(E<<22&4294967295|E>>>10),E=w+(S^P&(A^S))+T[12]+1804603682&4294967295,w=P+(E<<7&4294967295|E>>>25),E=S+(A^w&(P^A))+T[13]+4254626195&4294967295,S=w+(E<<12&4294967295|E>>>20),E=A+(P^S&(w^P))+T[14]+2792965006&4294967295,A=S+(E<<17&4294967295|E>>>15),E=P+(w^A&(S^w))+T[15]+1236535329&4294967295,P=A+(E<<22&4294967295|E>>>10),E=w+(A^S&(P^A))+T[1]+4129170786&4294967295,w=P+(E<<5&4294967295|E>>>27),E=S+(P^A&(w^P))+T[6]+3225465664&4294967295,S=w+(E<<9&4294967295|E>>>23),E=A+(w^P&(S^w))+T[11]+643717713&4294967295,A=S+(E<<14&4294967295|E>>>18),E=P+(S^w&(A^S))+T[0]+3921069994&4294967295,P=A+(E<<20&4294967295|E>>>12),E=w+(A^S&(P^A))+T[5]+3593408605&4294967295,w=P+(E<<5&4294967295|E>>>27),E=S+(P^A&(w^P))+T[10]+38016083&4294967295,S=w+(E<<9&4294967295|E>>>23),E=A+(w^P&(S^w))+T[15]+3634488961&4294967295,A=S+(E<<14&4294967295|E>>>18),E=P+(S^w&(A^S))+T[4]+3889429448&4294967295,P=A+(E<<20&4294967295|E>>>12),E=w+(A^S&(P^A))+T[9]+568446438&4294967295,w=P+(E<<5&4294967295|E>>>27),E=S+(P^A&(w^P))+T[14]+3275163606&4294967295,S=w+(E<<9&4294967295|E>>>23),E=A+(w^P&(S^w))+T[3]+4107603335&4294967295,A=S+(E<<14&4294967295|E>>>18),E=P+(S^w&(A^S))+T[8]+1163531501&4294967295,P=A+(E<<20&4294967295|E>>>12),E=w+(A^S&(P^A))+T[13]+2850285829&4294967295,w=P+(E<<5&4294967295|E>>>27),E=S+(P^A&(w^P))+T[2]+4243563512&4294967295,S=w+(E<<9&4294967295|E>>>23),E=A+(w^P&(S^w))+T[7]+1735328473&4294967295,A=S+(E<<14&4294967295|E>>>18),E=P+(S^w&(A^S))+T[12]+2368359562&4294967295,P=A+(E<<20&4294967295|E>>>12),E=w+(P^A^S)+T[5]+4294588738&4294967295,w=P+(E<<4&4294967295|E>>>28),E=S+(w^P^A)+T[8]+2272392833&4294967295,S=w+(E<<11&4294967295|E>>>21),E=A+(S^w^P)+T[11]+1839030562&4294967295,A=S+(E<<16&4294967295|E>>>16),E=P+(A^S^w)+T[14]+4259657740&4294967295,P=A+(E<<23&4294967295|E>>>9),E=w+(P^A^S)+T[1]+2763975236&4294967295,w=P+(E<<4&4294967295|E>>>28),E=S+(w^P^A)+T[4]+1272893353&4294967295,S=w+(E<<11&4294967295|E>>>21),E=A+(S^w^P)+T[7]+4139469664&4294967295,A=S+(E<<16&4294967295|E>>>16),E=P+(A^S^w)+T[10]+3200236656&4294967295,P=A+(E<<23&4294967295|E>>>9),E=w+(P^A^S)+T[13]+681279174&4294967295,w=P+(E<<4&4294967295|E>>>28),E=S+(w^P^A)+T[0]+3936430074&4294967295,S=w+(E<<11&4294967295|E>>>21),E=A+(S^w^P)+T[3]+3572445317&4294967295,A=S+(E<<16&4294967295|E>>>16),E=P+(A^S^w)+T[6]+76029189&4294967295,P=A+(E<<23&4294967295|E>>>9),E=w+(P^A^S)+T[9]+3654602809&4294967295,w=P+(E<<4&4294967295|E>>>28),E=S+(w^P^A)+T[12]+3873151461&4294967295,S=w+(E<<11&4294967295|E>>>21),E=A+(S^w^P)+T[15]+530742520&4294967295,A=S+(E<<16&4294967295|E>>>16),E=P+(A^S^w)+T[2]+3299628645&4294967295,P=A+(E<<23&4294967295|E>>>9),E=w+(A^(P|~S))+T[0]+4096336452&4294967295,w=P+(E<<6&4294967295|E>>>26),E=S+(P^(w|~A))+T[7]+1126891415&4294967295,S=w+(E<<10&4294967295|E>>>22),E=A+(w^(S|~P))+T[14]+2878612391&4294967295,A=S+(E<<15&4294967295|E>>>17),E=P+(S^(A|~w))+T[5]+4237533241&4294967295,P=A+(E<<21&4294967295|E>>>11),E=w+(A^(P|~S))+T[12]+1700485571&4294967295,w=P+(E<<6&4294967295|E>>>26),E=S+(P^(w|~A))+T[3]+2399980690&4294967295,S=w+(E<<10&4294967295|E>>>22),E=A+(w^(S|~P))+T[10]+4293915773&4294967295,A=S+(E<<15&4294967295|E>>>17),E=P+(S^(A|~w))+T[1]+2240044497&4294967295,P=A+(E<<21&4294967295|E>>>11),E=w+(A^(P|~S))+T[8]+1873313359&4294967295,w=P+(E<<6&4294967295|E>>>26),E=S+(P^(w|~A))+T[15]+4264355552&4294967295,S=w+(E<<10&4294967295|E>>>22),E=A+(w^(S|~P))+T[6]+2734768916&4294967295,A=S+(E<<15&4294967295|E>>>17),E=P+(S^(A|~w))+T[13]+1309151649&4294967295,P=A+(E<<21&4294967295|E>>>11),E=w+(A^(P|~S))+T[4]+4149444226&4294967295,w=P+(E<<6&4294967295|E>>>26),E=S+(P^(w|~A))+T[11]+3174756917&4294967295,S=w+(E<<10&4294967295|E>>>22),E=A+(w^(S|~P))+T[2]+718787259&4294967295,A=S+(E<<15&4294967295|E>>>17),E=P+(S^(A|~w))+T[9]+3951481745&4294967295,x.g[0]=x.g[0]+w&4294967295,x.g[1]=x.g[1]+(A+(E<<21&4294967295|E>>>11))&4294967295,x.g[2]=x.g[2]+A&4294967295,x.g[3]=x.g[3]+S&4294967295}n.prototype.u=function(x,w){w===void 0&&(w=x.length);for(var P=w-this.blockSize,T=this.B,A=this.h,S=0;S<w;){if(A==0)for(;S<=P;)i(this,x,S),S+=this.blockSize;if(typeof x=="string"){for(;S<w;)if(T[A++]=x.charCodeAt(S++),A==this.blockSize){i(this,T),A=0;break}}else for(;S<w;)if(T[A++]=x[S++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=w},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var w=1;w<x.length-8;++w)x[w]=0;var P=8*this.o;for(w=x.length-8;w<x.length;++w)x[w]=P&255,P/=256;for(this.u(x),x=Array(16),w=P=0;4>w;++w)for(var T=0;32>T;T+=8)x[P++]=this.g[w]>>>T&255;return x};function s(x,w){var P=a;return Object.prototype.hasOwnProperty.call(P,x)?P[x]:P[x]=w(x)}function o(x,w){this.h=w;for(var P=[],T=!0,A=x.length-1;0<=A;A--){var S=x[A]|0;T&&S==w||(P[A]=S,T=!1)}this.g=P}var a={};function l(x){return-128<=x&&128>x?s(x,function(w){return new o([w|0],0>w?-1:0)}):new o([x|0],0>x?-1:0)}function u(x){if(isNaN(x)||!isFinite(x))return d;if(0>x)return y(u(-x));for(var w=[],P=1,T=0;x>=P;T++)w[T]=x/P|0,P*=4294967296;return new o(w,0)}function h(x,w){if(x.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(x.charAt(0)=="-")return y(h(x.substring(1),w));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(w,8)),T=d,A=0;A<x.length;A+=8){var S=Math.min(8,x.length-A),E=parseInt(x.substring(A,A+S),w);8>S?(S=u(Math.pow(w,S)),T=T.j(S).add(u(E))):(T=T.j(P),T=T.add(u(E)))}return T}var d=l(0),f=l(1),p=l(16777216);r=o.prototype,r.m=function(){if(g(this))return-y(this).m();for(var x=0,w=1,P=0;P<this.g.length;P++){var T=this.i(P);x+=(0<=T?T:4294967296+T)*w,w*=4294967296}return x},r.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(_(this))return"0";if(g(this))return"-"+y(this).toString(x);for(var w=u(Math.pow(x,6)),P=this,T="";;){var A=v(P,w).g;P=m(P,A.j(w));var S=((0<P.g.length?P.g[0]:P.h)>>>0).toString(x);if(P=A,_(P))return S+T;for(;6>S.length;)S="0"+S;T=S+T}},r.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function _(x){if(x.h!=0)return!1;for(var w=0;w<x.g.length;w++)if(x.g[w]!=0)return!1;return!0}function g(x){return x.h==-1}r.l=function(x){return x=m(this,x),g(x)?-1:_(x)?0:1};function y(x){for(var w=x.g.length,P=[],T=0;T<w;T++)P[T]=~x.g[T];return new o(P,~x.h).add(f)}r.abs=function(){return g(this)?y(this):this},r.add=function(x){for(var w=Math.max(this.g.length,x.g.length),P=[],T=0,A=0;A<=w;A++){var S=T+(this.i(A)&65535)+(x.i(A)&65535),E=(S>>>16)+(this.i(A)>>>16)+(x.i(A)>>>16);T=E>>>16,S&=65535,E&=65535,P[A]=E<<16|S}return new o(P,P[P.length-1]&-2147483648?-1:0)};function m(x,w){return x.add(y(w))}r.j=function(x){if(_(this)||_(x))return d;if(g(this))return g(x)?y(this).j(y(x)):y(y(this).j(x));if(g(x))return y(this.j(y(x)));if(0>this.l(p)&&0>x.l(p))return u(this.m()*x.m());for(var w=this.g.length+x.g.length,P=[],T=0;T<2*w;T++)P[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<x.g.length;A++){var S=this.i(T)>>>16,E=this.i(T)&65535,j=x.i(A)>>>16,V=x.i(A)&65535;P[2*T+2*A]+=E*V,b(P,2*T+2*A),P[2*T+2*A+1]+=S*V,b(P,2*T+2*A+1),P[2*T+2*A+1]+=E*j,b(P,2*T+2*A+1),P[2*T+2*A+2]+=S*j,b(P,2*T+2*A+2)}for(T=0;T<w;T++)P[T]=P[2*T+1]<<16|P[2*T];for(T=w;T<2*w;T++)P[T]=0;return new o(P,0)};function b(x,w){for(;(x[w]&65535)!=x[w];)x[w+1]+=x[w]>>>16,x[w]&=65535,w++}function k(x,w){this.g=x,this.h=w}function v(x,w){if(_(w))throw Error("division by zero");if(_(x))return new k(d,d);if(g(x))return w=v(y(x),w),new k(y(w.g),y(w.h));if(g(w))return w=v(x,y(w)),new k(y(w.g),w.h);if(30<x.g.length){if(g(x)||g(w))throw Error("slowDivide_ only works with positive integers.");for(var P=f,T=w;0>=T.l(x);)P=O(P),T=O(T);var A=R(P,1),S=R(T,1);for(T=R(T,2),P=R(P,2);!_(T);){var E=S.add(T);0>=E.l(x)&&(A=A.add(P),S=E),T=R(T,1),P=R(P,1)}return w=m(x,A.j(w)),new k(A,w)}for(A=d;0<=x.l(w);){for(P=Math.max(1,Math.floor(x.m()/w.m())),T=Math.ceil(Math.log(P)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),S=u(P),E=S.j(w);g(E)||0<E.l(x);)P-=T,S=u(P),E=S.j(w);_(S)&&(S=f),A=A.add(S),x=m(x,E)}return new k(A,x)}r.A=function(x){return v(this,x).h},r.and=function(x){for(var w=Math.max(this.g.length,x.g.length),P=[],T=0;T<w;T++)P[T]=this.i(T)&x.i(T);return new o(P,this.h&x.h)},r.or=function(x){for(var w=Math.max(this.g.length,x.g.length),P=[],T=0;T<w;T++)P[T]=this.i(T)|x.i(T);return new o(P,this.h|x.h)},r.xor=function(x){for(var w=Math.max(this.g.length,x.g.length),P=[],T=0;T<w;T++)P[T]=this.i(T)^x.i(T);return new o(P,this.h^x.h)};function O(x){for(var w=x.g.length+1,P=[],T=0;T<w;T++)P[T]=x.i(T)<<1|x.i(T-1)>>>31;return new o(P,x.h)}function R(x,w){var P=w>>5;w%=32;for(var T=x.g.length-P,A=[],S=0;S<T;S++)A[S]=0<w?x.i(S+P)>>>w|x.i(S+P+1)<<32-w:x.i(S+P);return new o(A,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,bf=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,bn=o}).apply(typeof su<"u"?su:typeof self<"u"?self:typeof window<"u"?window:{});var rs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wf,oi,xf,vs,ya,Ef,Tf,Af;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,I,C){return c==Array.prototype||c==Object.prototype||(c[I]=C.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof rs=="object"&&rs];for(var I=0;I<c.length;++I){var C=c[I];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var n=t(this);function i(c,I){if(I)e:{var C=n;c=c.split(".");for(var D=0;D<c.length-1;D++){var Q=c[D];if(!(Q in C))break e;C=C[Q]}c=c[c.length-1],D=C[c],I=I(D),I!=D&&I!=null&&e(C,c,{configurable:!0,writable:!0,value:I})}}function s(c,I){c instanceof String&&(c+="");var C=0,D=!1,Q={next:function(){if(!D&&C<c.length){var X=C++;return{value:I(X,c[X]),done:!1}}return D=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}i("Array.prototype.values",function(c){return c||function(){return s(this,function(I,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var I=typeof c;return I=I!="object"?I:c?Array.isArray(c)?"array":I:"null",I=="array"||I=="object"&&typeof c.length=="number"}function u(c){var I=typeof c;return I=="object"&&c!=null||I=="function"}function h(c,I,C){return c.call.apply(c.bind,arguments)}function d(c,I,C){if(!c)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,D),c.apply(I,Q)}}return function(){return c.apply(I,arguments)}}function f(c,I,C){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function p(c,I){var C=Array.prototype.slice.call(arguments,1);return function(){var D=C.slice();return D.push.apply(D,arguments),c.apply(this,D)}}function _(c,I){function C(){}C.prototype=I.prototype,c.aa=I.prototype,c.prototype=new C,c.prototype.constructor=c,c.Qb=function(D,Q,X){for(var ae=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)ae[Fe-2]=arguments[Fe];return I.prototype[Q].apply(D,ae)}}function g(c){const I=c.length;if(0<I){const C=Array(I);for(let D=0;D<I;D++)C[D]=c[D];return C}return[]}function y(c,I){for(let C=1;C<arguments.length;C++){const D=arguments[C];if(l(D)){const Q=c.length||0,X=D.length||0;c.length=Q+X;for(let ae=0;ae<X;ae++)c[Q+ae]=D[ae]}else c.push(D)}}class m{constructor(I,C){this.i=I,this.j=C,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function b(c){return/^[\s\xa0]*$/.test(c)}function k(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function v(c){return v[" "](c),c}v[" "]=function(){};var O=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function R(c,I,C){for(const D in c)I.call(C,c[D],D,c)}function x(c,I){for(const C in c)I.call(void 0,c[C],C,c)}function w(c){const I={};for(const C in c)I[C]=c[C];return I}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(c,I){let C,D;for(let Q=1;Q<arguments.length;Q++){D=arguments[Q];for(C in D)c[C]=D[C];for(let X=0;X<P.length;X++)C=P[X],Object.prototype.hasOwnProperty.call(D,C)&&(c[C]=D[C])}}function A(c){var I=1;c=c.split(":");const C=[];for(;0<I&&c.length;)C.push(c.shift()),I--;return c.length&&C.push(c.join(":")),C}function S(c){a.setTimeout(()=>{throw c},0)}function E(){var c=G;let I=null;return c.g&&(I=c.g,c.g=c.g.next,c.g||(c.h=null),I.next=null),I}class j{constructor(){this.h=this.g=null}add(I,C){const D=V.get();D.set(I,C),this.h?this.h.next=D:this.g=D,this.h=D}}var V=new m(()=>new z,c=>c.reset());class z{constructor(){this.next=this.g=this.h=null}set(I,C){this.h=I,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let H,ee=!1,G=new j,q=()=>{const c=a.Promise.resolve(void 0);H=()=>{c.then(L)}};var L=()=>{for(var c;c=E();){try{c.h.call(c.g)}catch(C){S(C)}var I=V;I.j(c),100>I.h&&(I.h++,c.next=I.g,I.g=c)}ee=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(c,I){this.type=c,this.g=this.target=I,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var W=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,I=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const C=()=>{};a.addEventListener("test",C,I),a.removeEventListener("test",C,I)}catch{}return c}();function U(c,I){if(F.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var C=this.type=c.type,D=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=I,I=c.relatedTarget){if(O){e:{try{v(I.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(I=null)}}else C=="mouseover"?I=c.fromElement:C=="mouseout"&&(I=c.toElement);this.relatedTarget=I,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:M[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&U.aa.h.call(this)}}_(U,F);var M={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),K=0;function J(c,I,C,D,Q){this.listener=c,this.proxy=null,this.src=I,this.type=C,this.capture=!!D,this.ha=Q,this.key=++K,this.da=this.fa=!1}function re(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ce(c){this.src=c,this.g={},this.h=0}ce.prototype.add=function(c,I,C,D,Q){var X=c.toString();c=this.g[X],c||(c=this.g[X]=[],this.h++);var ae=ye(c,I,D,Q);return-1<ae?(I=c[ae],C||(I.fa=!1)):(I=new J(I,this.src,X,!!D,Q),I.fa=C,c.push(I)),I};function me(c,I){var C=I.type;if(C in c.g){var D=c.g[C],Q=Array.prototype.indexOf.call(D,I,void 0),X;(X=0<=Q)&&Array.prototype.splice.call(D,Q,1),X&&(re(I),c.g[C].length==0&&(delete c.g[C],c.h--))}}function ye(c,I,C,D){for(var Q=0;Q<c.length;++Q){var X=c[Q];if(!X.da&&X.listener==I&&X.capture==!!C&&X.ha==D)return Q}return-1}var Se="closure_lm_"+(1e6*Math.random()|0),Le={};function lt(c,I,C,D,Q){if(Array.isArray(I)){for(var X=0;X<I.length;X++)lt(c,I[X],C,D,Q);return null}return C=ke(C),c&&c[B]?c.K(I,C,u(D)?!!D.capture:!!D,Q):Ye(c,I,C,!1,D,Q)}function Ye(c,I,C,D,Q,X){if(!I)throw Error("Invalid event type");var ae=u(Q)?!!Q.capture:!!Q,Fe=we(c);if(Fe||(c[Se]=Fe=new ce(c)),C=Fe.add(I,C,D,ae,X),C.proxy)return C;if(D=Z(),C.proxy=D,D.src=c,D.listener=C,c.addEventListener)W||(Q=ae),Q===void 0&&(Q=!1),c.addEventListener(I.toString(),D,Q);else if(c.attachEvent)c.attachEvent(ue(I.toString()),D);else if(c.addListener&&c.removeListener)c.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return C}function Z(){function c(C){return I.call(c.src,c.listener,C)}const I=se;return c}function te(c,I,C,D,Q){if(Array.isArray(I))for(var X=0;X<I.length;X++)te(c,I[X],C,D,Q);else D=u(D)?!!D.capture:!!D,C=ke(C),c&&c[B]?(c=c.i,I=String(I).toString(),I in c.g&&(X=c.g[I],C=ye(X,C,D,Q),-1<C&&(re(X[C]),Array.prototype.splice.call(X,C,1),X.length==0&&(delete c.g[I],c.h--)))):c&&(c=we(c))&&(I=c.g[I.toString()],c=-1,I&&(c=ye(I,C,D,Q)),(C=-1<c?I[c]:null)&&le(C))}function le(c){if(typeof c!="number"&&c&&!c.da){var I=c.src;if(I&&I[B])me(I.i,c);else{var C=c.type,D=c.proxy;I.removeEventListener?I.removeEventListener(C,D,c.capture):I.detachEvent?I.detachEvent(ue(C),D):I.addListener&&I.removeListener&&I.removeListener(D),(C=we(I))?(me(C,c),C.h==0&&(C.src=null,I[Se]=null)):re(c)}}}function ue(c){return c in Le?Le[c]:Le[c]="on"+c}function se(c,I){if(c.da)c=!0;else{I=new U(I,this);var C=c.listener,D=c.ha||c.src;c.fa&&le(c),c=C.call(D,I)}return c}function we(c){return c=c[Se],c instanceof ce?c:null}var xe="__closure_events_fn_"+(1e9*Math.random()>>>0);function ke(c){return typeof c=="function"?c:(c[xe]||(c[xe]=function(I){return c.handleEvent(I)}),c[xe])}function Ve(){$.call(this),this.i=new ce(this),this.M=this,this.F=null}_(Ve,$),Ve.prototype[B]=!0,Ve.prototype.removeEventListener=function(c,I,C,D){te(this,c,I,C,D)};function Ue(c,I){var C,D=c.F;if(D)for(C=[];D;D=D.F)C.push(D);if(c=c.M,D=I.type||I,typeof I=="string")I=new F(I,c);else if(I instanceof F)I.target=I.target||c;else{var Q=I;I=new F(D,c),T(I,Q)}if(Q=!0,C)for(var X=C.length-1;0<=X;X--){var ae=I.g=C[X];Q=$e(ae,D,!0,I)&&Q}if(ae=I.g=c,Q=$e(ae,D,!0,I)&&Q,Q=$e(ae,D,!1,I)&&Q,C)for(X=0;X<C.length;X++)ae=I.g=C[X],Q=$e(ae,D,!1,I)&&Q}Ve.prototype.N=function(){if(Ve.aa.N.call(this),this.i){var c=this.i,I;for(I in c.g){for(var C=c.g[I],D=0;D<C.length;D++)re(C[D]);delete c.g[I],c.h--}}this.F=null},Ve.prototype.K=function(c,I,C,D){return this.i.add(String(c),I,!1,C,D)},Ve.prototype.L=function(c,I,C,D){return this.i.add(String(c),I,!0,C,D)};function $e(c,I,C,D){if(I=c.i.g[String(I)],!I)return!0;I=I.concat();for(var Q=!0,X=0;X<I.length;++X){var ae=I[X];if(ae&&!ae.da&&ae.capture==C){var Fe=ae.listener,ct=ae.ha||ae.src;ae.fa&&me(c.i,ae),Q=Fe.call(ct,D)!==!1&&Q}}return Q&&!D.defaultPrevented}function qi(c,I,C){if(typeof c=="function")C&&(c=f(c,C));else if(c&&typeof c.handleEvent=="function")c=f(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:a.setTimeout(c,I||0)}function Ke(c){c.g=qi(()=>{c.g=null,c.i&&(c.i=!1,Ke(c))},c.l);const I=c.h;c.h=null,c.m.apply(null,I)}class qt extends ${constructor(I,C){super(),this.m=I,this.l=C,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:Ke(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ur(c){$.call(this),this.h=c,this.g={}}_(Ur,$);var uc=[];function hc(c){R(c.g,function(I,C){this.g.hasOwnProperty(C)&&le(I)},c),c.g={}}Ur.prototype.N=function(){Ur.aa.N.call(this),hc(this)},Ur.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var No=a.JSON.stringify,Nm=a.JSON.parse,Pm=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Po(){}Po.prototype.h=null;function fc(c){return c.h||(c.h=c.i())}function dc(){}var Br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Oo(){F.call(this,"d")}_(Oo,F);function Co(){F.call(this,"c")}_(Co,F);var jn={},pc=null;function Ui(){return pc=pc||new Ve}jn.La="serverreachability";function mc(c){F.call(this,jn.La,c)}_(mc,F);function zr(c){const I=Ui();Ue(I,new mc(I))}jn.STAT_EVENT="statevent";function gc(c,I){F.call(this,jn.STAT_EVENT,c),this.stat=I}_(gc,F);function bt(c){const I=Ui();Ue(I,new gc(I,c))}jn.Ma="timingevent";function yc(c,I){F.call(this,jn.Ma,c),this.size=I}_(yc,F);function Hr(c,I){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},I)}function Gr(){this.g=!0}Gr.prototype.xa=function(){this.g=!1};function Om(c,I,C,D,Q,X){c.info(function(){if(c.g)if(X)for(var ae="",Fe=X.split("&"),ct=0;ct<Fe.length;ct++){var De=Fe[ct].split("=");if(1<De.length){var dt=De[0];De=De[1];var pt=dt.split("_");ae=2<=pt.length&&pt[1]=="type"?ae+(dt+"="+De+"&"):ae+(dt+"=redacted&")}}else ae=null;else ae=X;return"XMLHTTP REQ ("+D+") [attempt "+Q+"]: "+I+`
`+C+`
`+ae})}function Cm(c,I,C,D,Q,X,ae){c.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+Q+"]: "+I+`
`+C+`
`+X+" "+ae})}function Qn(c,I,C,D){c.info(function(){return"XMLHTTP TEXT ("+I+"): "+jm(c,C)+(D?" "+D:"")})}function Rm(c,I){c.info(function(){return"TIMEOUT: "+I})}Gr.prototype.info=function(){};function jm(c,I){if(!c.g)return I;if(!I)return null;try{var C=JSON.parse(I);if(C){for(c=0;c<C.length;c++)if(Array.isArray(C[c])){var D=C[c];if(!(2>D.length)){var Q=D[1];if(Array.isArray(Q)&&!(1>Q.length)){var X=Q[0];if(X!="noop"&&X!="stop"&&X!="close")for(var ae=1;ae<Q.length;ae++)Q[ae]=""}}}}return No(C)}catch{return I}}var Bi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ro;function zi(){}_(zi,Po),zi.prototype.g=function(){return new XMLHttpRequest},zi.prototype.i=function(){return{}},Ro=new zi;function hn(c,I,C,D){this.j=c,this.i=I,this.l=C,this.R=D||1,this.U=new Ur(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _c}function _c(){this.i=null,this.g="",this.h=!1}var bc={},jo={};function Lo(c,I,C){c.L=1,c.v=Wi(Jt(I)),c.m=C,c.P=!0,wc(c,null)}function wc(c,I){c.F=Date.now(),Hi(c),c.A=Jt(c.v);var C=c.A,D=c.R;Array.isArray(D)||(D=[String(D)]),Lc(C.i,"t",D),c.C=0,C=c.j.J,c.h=new _c,c.g=Zc(c.j,C?I:null,!c.m),0<c.O&&(c.M=new qt(f(c.Y,c,c.g),c.O)),I=c.U,C=c.g,D=c.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(uc[0]=Q.toString()),Q=uc);for(var X=0;X<Q.length;X++){var ae=lt(C,Q[X],D||I.handleEvent,!1,I.h||I);if(!ae)break;I.g[ae.key]=ae}I=c.H?w(c.H):{},c.m?(c.u||(c.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,I)):(c.u="GET",c.g.ea(c.A,c.u,null,I)),zr(),Om(c.i,c.u,c.A,c.l,c.R,c.m)}hn.prototype.ca=function(c){c=c.target;const I=this.M;I&&Xt(c)==3?I.j():this.Y(c)},hn.prototype.Y=function(c){try{if(c==this.g)e:{const pt=Xt(this.g);var I=this.g.Ba();const Xn=this.g.Z();if(!(3>pt)&&(pt!=3||this.g&&(this.h.h||this.g.oa()||Uc(this.g)))){this.J||pt!=4||I==7||(I==8||0>=Xn?zr(3):zr(2)),Do(this);var C=this.g.Z();this.X=C;t:if(xc(this)){var D=Uc(this.g);c="";var Q=D.length,X=Xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ln(this),Kr(this);var ae="";break t}this.h.i=new a.TextDecoder}for(I=0;I<Q;I++)this.h.h=!0,c+=this.h.i.decode(D[I],{stream:!(X&&I==Q-1)});D.length=0,this.h.g+=c,this.C=0,ae=this.h.g}else ae=this.g.oa();if(this.o=C==200,Cm(this.i,this.u,this.A,this.l,this.R,pt,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,ct=this.g;if((Fe=ct.g?ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Fe)){var De=Fe;break t}}De=null}if(C=De)Qn(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mo(this,C);else{this.o=!1,this.s=3,bt(12),Ln(this),Kr(this);break e}}if(this.P){C=!0;let Lt;for(;!this.J&&this.C<ae.length;)if(Lt=Lm(this,ae),Lt==jo){pt==4&&(this.s=4,bt(14),C=!1),Qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==bc){this.s=4,bt(15),Qn(this.i,this.l,ae,"[Invalid Chunk]"),C=!1;break}else Qn(this.i,this.l,Lt,null),Mo(this,Lt);if(xc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||ae.length!=0||this.h.h||(this.s=1,bt(16),C=!1),this.o=this.o&&C,!C)Qn(this.i,this.l,ae,"[Invalid Chunked Response]"),Ln(this),Kr(this);else if(0<ae.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Bo(dt),dt.M=!0,bt(11))}}else Qn(this.i,this.l,ae,null),Mo(this,ae);pt==4&&Ln(this),this.o&&!this.J&&(pt==4?Qc(this.j,this):(this.o=!1,Hi(this)))}else Xm(this.g),C==400&&0<ae.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),Ln(this),Kr(this)}}}catch{}finally{}};function xc(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Lm(c,I){var C=c.C,D=I.indexOf(`
`,C);return D==-1?jo:(C=Number(I.substring(C,D)),isNaN(C)?bc:(D+=1,D+C>I.length?jo:(I=I.slice(D,D+C),c.C=D+C,I)))}hn.prototype.cancel=function(){this.J=!0,Ln(this)};function Hi(c){c.S=Date.now()+c.I,Ec(c,c.I)}function Ec(c,I){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Hr(f(c.ba,c),I)}function Do(c){c.B&&(a.clearTimeout(c.B),c.B=null)}hn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(Rm(this.i,this.A),this.L!=2&&(zr(),bt(17)),Ln(this),this.s=2,Kr(this)):Ec(this,this.S-c)};function Kr(c){c.j.G==0||c.J||Qc(c.j,c)}function Ln(c){Do(c);var I=c.M;I&&typeof I.ma=="function"&&I.ma(),c.M=null,hc(c.U),c.g&&(I=c.g,c.g=null,I.abort(),I.ma())}function Mo(c,I){try{var C=c.j;if(C.G!=0&&(C.g==c||Vo(C.h,c))){if(!c.K&&Vo(C.h,c)&&C.G==3){try{var D=C.Da.g.parse(I)}catch{D=null}if(Array.isArray(D)&&D.length==3){var Q=D;if(Q[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<c.F)es(C),Xi(C);else break e;Uo(C),bt(18)}}else C.za=Q[1],0<C.za-C.T&&37500>Q[2]&&C.F&&C.v==0&&!C.C&&(C.C=Hr(f(C.Za,C),6e3));if(1>=kc(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Mn(C,11)}else if((c.K||C.g==c)&&es(C),!b(I))for(Q=C.Da.g.parse(I),I=0;I<Q.length;I++){let De=Q[I];if(C.T=De[0],De=De[1],C.G==2)if(De[0]=="c"){C.K=De[1],C.ia=De[2];const dt=De[3];dt!=null&&(C.la=dt,C.j.info("VER="+C.la));const pt=De[4];pt!=null&&(C.Aa=pt,C.j.info("SVER="+C.Aa));const Xn=De[5];Xn!=null&&typeof Xn=="number"&&0<Xn&&(D=1.5*Xn,C.L=D,C.j.info("backChannelRequestTimeoutMs_="+D)),D=C;const Lt=c.g;if(Lt){const ns=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ns){var X=D.h;X.g||ns.indexOf("spdy")==-1&&ns.indexOf("quic")==-1&&ns.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&($o(X,X.h),X.h=null))}if(D.D){const zo=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;zo&&(D.ya=zo,Be(D.I,D.D,zo))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-c.F,C.j.info("Handshake RTT: "+C.R+"ms")),D=C;var ae=c;if(D.qa=Xc(D,D.J?D.ia:null,D.W),ae.K){Sc(D.h,ae);var Fe=ae,ct=D.L;ct&&(Fe.I=ct),Fe.B&&(Do(Fe),Hi(Fe)),D.g=ae}else Kc(D);0<C.i.length&&Zi(C)}else De[0]!="stop"&&De[0]!="close"||Mn(C,7);else C.G==3&&(De[0]=="stop"||De[0]=="close"?De[0]=="stop"?Mn(C,7):qo(C):De[0]!="noop"&&C.l&&C.l.ta(De),C.v=0)}}zr(4)}catch{}}var Dm=class{constructor(c,I){this.g=c,this.map=I}};function Tc(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ac(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function kc(c){return c.h?1:c.g?c.g.size:0}function Vo(c,I){return c.h?c.h==I:c.g?c.g.has(I):!1}function $o(c,I){c.g?c.g.add(I):c.h=I}function Sc(c,I){c.h&&c.h==I?c.h=null:c.g&&c.g.has(I)&&c.g.delete(I)}Tc.prototype.cancel=function(){if(this.i=Ic(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Ic(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let I=c.i;for(const C of c.g.values())I=I.concat(C.D);return I}return g(c.i)}function Mm(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var I=[],C=c.length,D=0;D<C;D++)I.push(c[D]);return I}I=[],C=0;for(D in c)I[C++]=c[D];return I}function Vm(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var I=[];c=c.length;for(var C=0;C<c;C++)I.push(C);return I}I=[],C=0;for(const D in c)I[C++]=D;return I}}}function Nc(c,I){if(c.forEach&&typeof c.forEach=="function")c.forEach(I,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,I,void 0);else for(var C=Vm(c),D=Mm(c),Q=D.length,X=0;X<Q;X++)I.call(void 0,D[X],C&&C[X],c)}var Pc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $m(c,I){if(c){c=c.split("&");for(var C=0;C<c.length;C++){var D=c[C].indexOf("="),Q=null;if(0<=D){var X=c[C].substring(0,D);Q=c[C].substring(D+1)}else X=c[C];I(X,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function Dn(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Dn){this.h=c.h,Gi(this,c.j),this.o=c.o,this.g=c.g,Ki(this,c.s),this.l=c.l;var I=c.i,C=new Yr;C.i=I.i,I.g&&(C.g=new Map(I.g),C.h=I.h),Oc(this,C),this.m=c.m}else c&&(I=String(c).match(Pc))?(this.h=!1,Gi(this,I[1]||"",!0),this.o=Wr(I[2]||""),this.g=Wr(I[3]||"",!0),Ki(this,I[4]),this.l=Wr(I[5]||"",!0),Oc(this,I[6]||"",!0),this.m=Wr(I[7]||"")):(this.h=!1,this.i=new Yr(null,this.h))}Dn.prototype.toString=function(){var c=[],I=this.j;I&&c.push(Qr(I,Cc,!0),":");var C=this.g;return(C||I=="file")&&(c.push("//"),(I=this.o)&&c.push(Qr(I,Cc,!0),"@"),c.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&c.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&c.push("/"),c.push(Qr(C,C.charAt(0)=="/"?Um:qm,!0))),(C=this.i.toString())&&c.push("?",C),(C=this.m)&&c.push("#",Qr(C,zm)),c.join("")};function Jt(c){return new Dn(c)}function Gi(c,I,C){c.j=C?Wr(I,!0):I,c.j&&(c.j=c.j.replace(/:$/,""))}function Ki(c,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);c.s=I}else c.s=null}function Oc(c,I,C){I instanceof Yr?(c.i=I,Hm(c.i,c.h)):(C||(I=Qr(I,Bm)),c.i=new Yr(I,c.h))}function Be(c,I,C){c.i.set(I,C)}function Wi(c){return Be(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Wr(c,I){return c?I?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Qr(c,I,C){return typeof c=="string"?(c=encodeURI(c).replace(I,Fm),C&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Fm(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Cc=/[#\/\?@]/g,qm=/[#\?:]/g,Um=/[#\?]/g,Bm=/[#\?@]/g,zm=/#/g;function Yr(c,I){this.h=this.g=null,this.i=c||null,this.j=!!I}function fn(c){c.g||(c.g=new Map,c.h=0,c.i&&$m(c.i,function(I,C){c.add(decodeURIComponent(I.replace(/\+/g," ")),C)}))}r=Yr.prototype,r.add=function(c,I){fn(this),this.i=null,c=Yn(this,c);var C=this.g.get(c);return C||this.g.set(c,C=[]),C.push(I),this.h+=1,this};function Rc(c,I){fn(c),I=Yn(c,I),c.g.has(I)&&(c.i=null,c.h-=c.g.get(I).length,c.g.delete(I))}function jc(c,I){return fn(c),I=Yn(c,I),c.g.has(I)}r.forEach=function(c,I){fn(this),this.g.forEach(function(C,D){C.forEach(function(Q){c.call(I,Q,D,this)},this)},this)},r.na=function(){fn(this);const c=Array.from(this.g.values()),I=Array.from(this.g.keys()),C=[];for(let D=0;D<I.length;D++){const Q=c[D];for(let X=0;X<Q.length;X++)C.push(I[D])}return C},r.V=function(c){fn(this);let I=[];if(typeof c=="string")jc(this,c)&&(I=I.concat(this.g.get(Yn(this,c))));else{c=Array.from(this.g.values());for(let C=0;C<c.length;C++)I=I.concat(c[C])}return I},r.set=function(c,I){return fn(this),this.i=null,c=Yn(this,c),jc(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[I]),this.h+=1,this},r.get=function(c,I){return c?(c=this.V(c),0<c.length?String(c[0]):I):I};function Lc(c,I,C){Rc(c,I),0<C.length&&(c.i=null,c.g.set(Yn(c,I),g(C)),c.h+=C.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],I=Array.from(this.g.keys());for(var C=0;C<I.length;C++){var D=I[C];const X=encodeURIComponent(String(D)),ae=this.V(D);for(D=0;D<ae.length;D++){var Q=X;ae[D]!==""&&(Q+="="+encodeURIComponent(String(ae[D]))),c.push(Q)}}return this.i=c.join("&")};function Yn(c,I){return I=String(I),c.j&&(I=I.toLowerCase()),I}function Hm(c,I){I&&!c.j&&(fn(c),c.i=null,c.g.forEach(function(C,D){var Q=D.toLowerCase();D!=Q&&(Rc(this,D),Lc(this,Q,C))},c)),c.j=I}function Gm(c,I){const C=new Gr;if(a.Image){const D=new Image;D.onload=p(dn,C,"TestLoadImage: loaded",!0,I,D),D.onerror=p(dn,C,"TestLoadImage: error",!1,I,D),D.onabort=p(dn,C,"TestLoadImage: abort",!1,I,D),D.ontimeout=p(dn,C,"TestLoadImage: timeout",!1,I,D),a.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=c}else I(!1)}function Km(c,I){const C=new Gr,D=new AbortController,Q=setTimeout(()=>{D.abort(),dn(C,"TestPingServer: timeout",!1,I)},1e4);fetch(c,{signal:D.signal}).then(X=>{clearTimeout(Q),X.ok?dn(C,"TestPingServer: ok",!0,I):dn(C,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(Q),dn(C,"TestPingServer: error",!1,I)})}function dn(c,I,C,D,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),D(C)}catch{}}function Wm(){this.g=new Pm}function Qm(c,I,C){const D=C||"";try{Nc(c,function(Q,X){let ae=Q;u(Q)&&(ae=No(Q)),I.push(D+X+"="+encodeURIComponent(ae))})}catch(Q){throw I.push(D+"type="+encodeURIComponent("_badmap")),Q}}function Qi(c){this.l=c.Ub||null,this.j=c.eb||!1}_(Qi,Po),Qi.prototype.g=function(){return new Yi(this.l,this.j)},Qi.prototype.i=function(c){return function(){return c}}({});function Yi(c,I){Ve.call(this),this.D=c,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Yi,Ve),r=Yi.prototype,r.open=function(c,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=I,this.readyState=1,Xr(this)},r.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(I.body=c),(this.D||a).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=0},r.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Xr(this)),this.g&&(this.readyState=3,Xr(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dc(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Dc(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}r.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var I=c.value?c.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!c.done}))&&(this.response=this.responseText+=I)}c.done?Jr(this):Xr(this),this.readyState==3&&Dc(this)}},r.Ra=function(c){this.g&&(this.response=this.responseText=c,Jr(this))},r.Qa=function(c){this.g&&(this.response=c,Jr(this))},r.ga=function(){this.g&&Jr(this)};function Jr(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Xr(c)}r.setRequestHeader=function(c,I){this.u.append(c,I)},r.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],I=this.h.entries();for(var C=I.next();!C.done;)C=C.value,c.push(C[0]+": "+C[1]),C=I.next();return c.join(`\r
`)};function Xr(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Mc(c){let I="";return R(c,function(C,D){I+=D,I+=":",I+=C,I+=`\r
`}),I}function Fo(c,I,C){e:{for(D in C){var D=!1;break e}D=!0}D||(C=Mc(C),typeof c=="string"?C!=null&&encodeURIComponent(String(C)):Be(c,I,C))}function Qe(c){Ve.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Qe,Ve);var Ym=/^https?$/i,Jm=["POST","PUT"];r=Qe.prototype,r.Ha=function(c){this.J=c},r.ea=function(c,I,C,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);I=I?I.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ro.g(),this.v=this.o?fc(this.o):fc(Ro),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(I,String(c),!0),this.B=!1}catch(X){Vc(this,X);return}if(c=C||"",C=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var Q in D)C.set(Q,D[Q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const X of D.keys())C.set(X,D.get(X));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(C.keys()).find(X=>X.toLowerCase()=="content-type"),Q=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Jm,I,void 0))||D||Q||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ae]of C)this.g.setRequestHeader(X,ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qc(this),this.u=!0,this.g.send(c),this.u=!1}catch(X){Vc(this,X)}};function Vc(c,I){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=I,c.m=5,$c(c),Ji(c)}function $c(c){c.A||(c.A=!0,Ue(c,"complete"),Ue(c,"error"))}r.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Ue(this,"complete"),Ue(this,"abort"),Ji(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ji(this,!0)),Qe.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Fc(this):this.bb())},r.bb=function(){Fc(this)};function Fc(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Xt(c)!=4||c.Z()!=2)){if(c.u&&Xt(c)==4)qi(c.Ea,0,c);else if(Ue(c,"readystatechange"),Xt(c)==4){c.h=!1;try{const ae=c.Z();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var C;if(!(C=I)){var D;if(D=ae===0){var Q=String(c.D).match(Pc)[1]||null;!Q&&a.self&&a.self.location&&(Q=a.self.location.protocol.slice(0,-1)),D=!Ym.test(Q?Q.toLowerCase():"")}C=D}if(C)Ue(c,"complete"),Ue(c,"success");else{c.m=6;try{var X=2<Xt(c)?c.g.statusText:""}catch{X=""}c.l=X+" ["+c.Z()+"]",$c(c)}}finally{Ji(c)}}}}function Ji(c,I){if(c.g){qc(c);const C=c.g,D=c.v[0]?()=>{}:null;c.g=null,c.v=null,I||Ue(c,"ready");try{C.onreadystatechange=D}catch{}}}function qc(c){c.I&&(a.clearTimeout(c.I),c.I=null)}r.isActive=function(){return!!this.g};function Xt(c){return c.g?c.g.readyState:0}r.Z=function(){try{return 2<Xt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(c){if(this.g){var I=this.g.responseText;return c&&I.indexOf(c)==0&&(I=I.substring(c.length)),Nm(I)}};function Uc(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Xm(c){const I={};c=(c.g&&2<=Xt(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<c.length;D++){if(b(c[D]))continue;var C=A(c[D]);const Q=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const X=I[Q]||[];I[Q]=X,X.push(C)}x(I,function(D){return D.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(c,I,C){return C&&C.internalChannelParams&&C.internalChannelParams[c]||I}function Bc(c){this.Aa=0,this.i=[],this.j=new Gr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zr("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zr("baseRetryDelayMs",5e3,c),this.cb=Zr("retryDelaySeedMs",1e4,c),this.Wa=Zr("forwardChannelMaxRetries",2,c),this.wa=Zr("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Tc(c&&c.concurrentRequestLimit),this.Da=new Wm,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Bc.prototype,r.la=8,r.G=1,r.connect=function(c,I,C,D){bt(0),this.W=c,this.H=I||{},C&&D!==void 0&&(this.H.OSID=C,this.H.OAID=D),this.F=this.X,this.I=Xc(this,null,this.W),Zi(this)};function qo(c){if(zc(c),c.G==3){var I=c.U++,C=Jt(c.I);if(Be(C,"SID",c.K),Be(C,"RID",I),Be(C,"TYPE","terminate"),ei(c,C),I=new hn(c,c.j,I),I.L=2,I.v=Wi(Jt(C)),C=!1,a.navigator&&a.navigator.sendBeacon)try{C=a.navigator.sendBeacon(I.v.toString(),"")}catch{}!C&&a.Image&&(new Image().src=I.v,C=!0),C||(I.g=Zc(I.j,null),I.g.ea(I.v)),I.F=Date.now(),Hi(I)}Jc(c)}function Xi(c){c.g&&(Bo(c),c.g.cancel(),c.g=null)}function zc(c){Xi(c),c.u&&(a.clearTimeout(c.u),c.u=null),es(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Zi(c){if(!Ac(c.h)&&!c.s){c.s=!0;var I=c.Ga;H||q(),ee||(H(),ee=!0),G.add(I,c),c.B=0}}function Zm(c,I){return kc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=I.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Hr(f(c.Ga,c,I),Yc(c,c.B)),c.B++,!0)}r.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const Q=new hn(this,this.j,c);let X=this.o;if(this.S&&(X?(X=w(X),T(X,this.S)):X=this.S),this.m!==null||this.O||(Q.H=X,X=null),this.P)e:{for(var I=0,C=0;C<this.i.length;C++){t:{var D=this.i[C];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(I+=D,4096<I){I=C;break e}if(I===4096||C===this.i.length-1){I=C+1;break e}}I=1e3}else I=1e3;I=Gc(this,Q,I),C=Jt(this.I),Be(C,"RID",c),Be(C,"CVER",22),this.D&&Be(C,"X-HTTP-Session-Id",this.D),ei(this,C),X&&(this.O?I="headers="+encodeURIComponent(String(Mc(X)))+"&"+I:this.m&&Fo(C,this.m,X)),$o(this.h,Q),this.Ua&&Be(C,"TYPE","init"),this.P?(Be(C,"$req",I),Be(C,"SID","null"),Q.T=!0,Lo(Q,C,null)):Lo(Q,C,I),this.G=2}}else this.G==3&&(c?Hc(this,c):this.i.length==0||Ac(this.h)||Hc(this))};function Hc(c,I){var C;I?C=I.l:C=c.U++;const D=Jt(c.I);Be(D,"SID",c.K),Be(D,"RID",C),Be(D,"AID",c.T),ei(c,D),c.m&&c.o&&Fo(D,c.m,c.o),C=new hn(c,c.j,C,c.B+1),c.m===null&&(C.H=c.o),I&&(c.i=I.D.concat(c.i)),I=Gc(c,C,1e3),C.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),$o(c.h,C),Lo(C,D,I)}function ei(c,I){c.H&&R(c.H,function(C,D){Be(I,D,C)}),c.l&&Nc({},function(C,D){Be(I,D,C)})}function Gc(c,I,C){C=Math.min(c.i.length,C);var D=c.l?f(c.l.Na,c.l,c):null;e:{var Q=c.i;let X=-1;for(;;){const ae=["count="+C];X==-1?0<C?(X=Q[0].g,ae.push("ofs="+X)):X=0:ae.push("ofs="+X);let Fe=!0;for(let ct=0;ct<C;ct++){let De=Q[ct].g;const dt=Q[ct].map;if(De-=X,0>De)X=Math.max(0,Q[ct].g-100),Fe=!1;else try{Qm(dt,ae,"req"+De+"_")}catch{D&&D(dt)}}if(Fe){D=ae.join("&");break e}}}return c=c.i.splice(0,C),I.D=c,D}function Kc(c){if(!c.g&&!c.u){c.Y=1;var I=c.Fa;H||q(),ee||(H(),ee=!0),G.add(I,c),c.v=0}}function Uo(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Hr(f(c.Fa,c),Yc(c,c.v)),c.v++,!0)}r.Fa=function(){if(this.u=null,Wc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Hr(f(this.ab,this),c)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),Xi(this),Wc(this))};function Bo(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Wc(c){c.g=new hn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var I=Jt(c.qa);Be(I,"RID","rpc"),Be(I,"SID",c.K),Be(I,"AID",c.T),Be(I,"CI",c.F?"0":"1"),!c.F&&c.ja&&Be(I,"TO",c.ja),Be(I,"TYPE","xmlhttp"),ei(c,I),c.m&&c.o&&Fo(I,c.m,c.o),c.L&&(c.g.I=c.L);var C=c.g;c=c.ia,C.L=1,C.v=Wi(Jt(I)),C.m=null,C.P=!0,wc(C,c)}r.Za=function(){this.C!=null&&(this.C=null,Xi(this),Uo(this),bt(19))};function es(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Qc(c,I){var C=null;if(c.g==I){es(c),Bo(c),c.g=null;var D=2}else if(Vo(c.h,I))C=I.D,Sc(c.h,I),D=1;else return;if(c.G!=0){if(I.o)if(D==1){C=I.m?I.m.length:0,I=Date.now()-I.F;var Q=c.B;D=Ui(),Ue(D,new yc(D,C)),Zi(c)}else Kc(c);else if(Q=I.s,Q==3||Q==0&&0<I.X||!(D==1&&Zm(c,I)||D==2&&Uo(c)))switch(C&&0<C.length&&(I=c.h,I.i=I.i.concat(C)),Q){case 1:Mn(c,5);break;case 4:Mn(c,10);break;case 3:Mn(c,6);break;default:Mn(c,2)}}}function Yc(c,I){let C=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(C*=2),C*I}function Mn(c,I){if(c.j.info("Error code "+I),I==2){var C=f(c.fb,c),D=c.Xa;const Q=!D;D=new Dn(D||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Gi(D,"https"),Wi(D),Q?Gm(D.toString(),C):Km(D.toString(),C)}else bt(2);c.G=0,c.l&&c.l.sa(I),Jc(c),zc(c)}r.fb=function(c){c?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Jc(c){if(c.G=0,c.ka=[],c.l){const I=Ic(c.h);(I.length!=0||c.i.length!=0)&&(y(c.ka,I),y(c.ka,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.ra()}}function Xc(c,I,C){var D=C instanceof Dn?Jt(C):new Dn(C);if(D.g!="")I&&(D.g=I+"."+D.g),Ki(D,D.s);else{var Q=a.location;D=Q.protocol,I=I?I+"."+Q.hostname:Q.hostname,Q=+Q.port;var X=new Dn(null);D&&Gi(X,D),I&&(X.g=I),Q&&Ki(X,Q),C&&(X.l=C),D=X}return C=c.D,I=c.ya,C&&I&&Be(D,C,I),Be(D,"VER",c.la),ei(c,D),D}function Zc(c,I,C){if(I&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=c.Ca&&!c.pa?new Qe(new Qi({eb:C})):new Qe(c.pa),I.Ha(c.J),I}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function eu(){}r=eu.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function ts(){}ts.prototype.g=function(c,I){return new It(c,I)};function It(c,I){Ve.call(this),this.g=new Bc(I),this.l=c,this.h=I&&I.messageUrlParams||null,c=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(c?c["X-WebChannel-Content-Type"]=I.messageContentType:c={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(c?c["X-WebChannel-Client-Profile"]=I.va:c={"X-WebChannel-Client-Profile":I.va}),this.g.S=c,(c=I&&I.Sb)&&!b(c)&&(this.g.m=c),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!b(I)&&(this.g.D=I,c=this.h,c!==null&&I in c&&(c=this.h,I in c&&delete c[I])),this.j=new Jn(this)}_(It,Ve),It.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},It.prototype.close=function(){qo(this.g)},It.prototype.o=function(c){var I=this.g;if(typeof c=="string"){var C={};C.__data__=c,c=C}else this.u&&(C={},C.__data__=No(c),c=C);I.i.push(new Dm(I.Ya++,c)),I.G==3&&Zi(I)},It.prototype.N=function(){this.g.l=null,delete this.j,qo(this.g),delete this.g,It.aa.N.call(this)};function tu(c){Oo.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var I=c.__sm__;if(I){e:{for(const C in I){c=C;break e}c=void 0}(this.i=c)&&(c=this.i,I=I!==null&&c in I?I[c]:void 0),this.data=I}else this.data=c}_(tu,Oo);function nu(){Co.call(this),this.status=1}_(nu,Co);function Jn(c){this.g=c}_(Jn,eu),Jn.prototype.ua=function(){Ue(this.g,"a")},Jn.prototype.ta=function(c){Ue(this.g,new tu(c))},Jn.prototype.sa=function(c){Ue(this.g,new nu)},Jn.prototype.ra=function(){Ue(this.g,"b")},ts.prototype.createWebChannel=ts.prototype.g,It.prototype.send=It.prototype.o,It.prototype.open=It.prototype.m,It.prototype.close=It.prototype.close,Af=function(){return new ts},Tf=function(){return Ui()},Ef=jn,ya={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bi.NO_ERROR=0,Bi.TIMEOUT=8,Bi.HTTP_ERROR=6,vs=Bi,vc.COMPLETE="complete",xf=vc,dc.EventType=Br,Br.OPEN="a",Br.CLOSE="b",Br.ERROR="c",Br.MESSAGE="d",Ve.prototype.listen=Ve.prototype.K,oi=dc,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,wf=Qe}).apply(typeof rs<"u"?rs:typeof self<"u"?self:typeof window<"u"?window:{});const ou="@firebase/firestore",au="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};gt.UNAUTHENTICATED=new gt(null),gt.GOOGLE_CREDENTIALS=new gt("google-credentials-uid"),gt.FIRST_PARTY=new gt("first-party-uid"),gt.MOCK_USER=new gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ar="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new sg("@firebase/firestore");function or(){return zn.logLevel}function fe(r,...e){if(zn.logLevel<=nn.DEBUG){const t=e.map(tl);zn.debug(`Firestore (${Ar}): ${r}`,...t)}}function an(r,...e){if(zn.logLevel<=nn.ERROR){const t=e.map(tl);zn.error(`Firestore (${Ar}): ${r}`,...t)}}function dr(r,...e){if(zn.logLevel<=nn.WARN){const t=e.map(tl);zn.warn(`Firestore (${Ar}): ${r}`,...t)}}function tl(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(r="Unexpected state"){const e=`FIRESTORE (${Ar}) INTERNAL ASSERTION FAILED: `+r;throw an(e),new Error(e)}function Me(r,e){r||ge()}function _e(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends lg{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ig{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gt.UNAUTHENTICATED))}shutdown(){}}class Ng{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Pg{constructor(e){this.t=e,this.currentUser=gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Me(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new sn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new sn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new sn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Me(typeof n.accessToken=="string"),new kf(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Me(e===null||typeof e=="string"),new gt(e)}}class Og{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=gt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Cg{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Og(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Rg{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,cg(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Me(this.o===void 0);const n=s=>{s.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new lu(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Me(typeof t.token=="string"),this.R=t.token,new lu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jg(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=jg(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function Ie(r,e){return r<e?-1:r>e?1:0}function va(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return Ie(n,i);{const s=Sf(),o=Lg(s.encode(cu(r,t)),s.encode(cu(e,t)));return o!==0?o:Ie(n,i)}}t+=n>65535?2:1}return Ie(r.length,e.length)}function cu(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function Lg(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return Ie(r[t],e[t]);return Ie(r.length,e.length)}function pr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=-62135596800,hu=1e6;class it{static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*hu);return new it(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<uu)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hu}_compareTo(e){return this.seconds===e.seconds?Ie(this.nanoseconds,e.nanoseconds):Ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-uu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new it(0,0))}static max(){return new ve(new it(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu="__name__";class zt{constructor(e,t,n){t===void 0?t=0:t>e.length&&ge(),n===void 0?n=e.length-t:n>e.length-t&&ge(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return zt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof zt?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=zt.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Ie(e.length,t.length)}static compareSegments(e,t){const n=zt.isNumericId(e),i=zt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?zt.extractNumericId(e).compare(zt.extractNumericId(t)):va(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return bn.fromString(e.substring(4,e.length-2))}}class He extends zt{construct(e,t,n){return new He(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new he(ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new He(t)}static emptyPath(){return new He([])}}const Dg=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ht extends zt{construct(e,t,n){return new ht(e,t,n)}static isValidIdentifier(e){return Dg.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ht.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fu}static keyField(){return new ht([fu])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new he(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new he(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new he(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ht(t)}static emptyPath(){return new ht([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(He.fromString(e))}static fromName(e){return new pe(He.fromString(e).popFirst(5))}static empty(){return new pe(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return He.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new He(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=-1;function Mg(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=ve.fromTimestamp(n===1e9?new it(t+1,0):new it(t,n));return new xn(i,pe.empty(),e)}function Vg(r){return new xn(r.readTime,r.key,_i)}class xn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new xn(ve.min(),pe.empty(),_i)}static max(){return new xn(ve.max(),pe.empty(),_i)}}function $g(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=pe.comparator(r.documentKey,e.documentKey),t!==0?t:Ie(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qg{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kr(r){if(r.code!==ne.FAILED_PRECONDITION||r.message!==Fg)throw r;fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(t){return ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ie.reject(t)}static resolve(e){return new ie((t,n)=>{t(e)})}static reject(e){return new ie((t,n)=>{n(e)})}static waitFor(e){return new ie((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>n(l))}),o=!0,s===i&&t()})}static or(e){let t=ie.resolve(!1);for(const n of e)t=t.next(i=>i?ie.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ie((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===s&&n(o)},h=>i(h))}})}static doWhile(e,t){return new ie((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function Ug(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Sr(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Ws.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=-1;function Qs(r){return r==null}function As(r){return r===0&&1/r==-1/0}function Bg(r){return typeof r=="number"&&Number.isInteger(r)&&!As(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="";function zg(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=du(e)),e=Hg(r.get(t),e);return du(e)}function Hg(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case Nf:t+="";break;default:t+=s}}return t}function du(r){return r+Nf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function In(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Pf(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,t){this.comparator=e,this.root=t||ut.EMPTY}insert(e,t){return new We(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new is(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new is(this.root,e,this.comparator,!1)}getReverseIterator(){return new is(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new is(this.root,e,this.comparator,!0)}}class is{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??ut.RED,this.left=i??ut.EMPTY,this.right=s??ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new ut(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ut.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,t,n,i,s){return this}insert(e,t,n){return new ut(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mu(this.data.getIterator())}getIteratorFrom(e){return new mu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class mu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.fields=e,e.sort(ht.comparator)}static empty(){return new Pt([])}unionWith(e){let t=new st(ht.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Pt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Of("Invalid base64 string: "+s):s}}(e);return new ft(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ft(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ft.EMPTY_BYTE_STRING=new ft("");const Gg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function En(r){if(Me(!!r),typeof r=="string"){let e=0;const t=Gg.exec(r);if(Me(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Je(r.seconds),nanos:Je(r.nanos)}}function Je(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Tn(r){return typeof r=="string"?ft.fromBase64String(r):ft.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="server_timestamp",Rf="__type__",jf="__previous_value__",Lf="__local_write_time__";function rl(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Rf])===null||t===void 0?void 0:t.stringValue)===Cf}function Ys(r){const e=r.mapValue.fields[jf];return rl(e)?Ys(e):e}function bi(r){const e=En(r.mapValue.fields[Lf].timestampValue);return new it(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t,n,i,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}const ks="(default)";class wi{constructor(e,t){this.projectId=e,this.database=t||ks}static empty(){return new wi("","")}get isDefaultDatabase(){return this.database===ks}isEqual(e){return e instanceof wi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df="__type__",Mf="__max__",ss={mapValue:{fields:{__type__:{stringValue:Mf}}}},Vf="__vector__",Ss="value";function An(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?rl(r)?4:Qg(r)?9007199254740991:Wg(r)?10:11:ge()}function Wt(r,e){if(r===e)return!0;const t=An(r);if(t!==An(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return bi(r).isEqual(bi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=En(i.timestampValue),a=En(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Tn(i.bytesValue).isEqual(Tn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Je(i.geoPointValue.latitude)===Je(s.geoPointValue.latitude)&&Je(i.geoPointValue.longitude)===Je(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Je(i.integerValue)===Je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Je(i.doubleValue),a=Je(s.doubleValue);return o===a?As(o)===As(a):isNaN(o)&&isNaN(a)}return!1}(r,e);case 9:return pr(r.arrayValue.values||[],e.arrayValue.values||[],Wt);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(pu(o)!==pu(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Wt(o[l],a[l])))return!1;return!0}(r,e);default:return ge()}}function xi(r,e){return(r.values||[]).find(t=>Wt(t,e))!==void 0}function mr(r,e){if(r===e)return 0;const t=An(r),n=An(e);if(t!==n)return Ie(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ie(r.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Je(s.integerValue||s.doubleValue),l=Je(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(r,e);case 3:return gu(r.timestampValue,e.timestampValue);case 4:return gu(bi(r),bi(e));case 5:return va(r.stringValue,e.stringValue);case 6:return function(s,o){const a=Tn(s),l=Tn(o);return a.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=Ie(a[u],l[u]);if(h!==0)return h}return Ie(a.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ie(Je(s.latitude),Je(o.latitude));return a!==0?a:Ie(Je(s.longitude),Je(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return yu(r.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,h;const d=s.fields||{},f=o.fields||{},p=(a=d[Ss])===null||a===void 0?void 0:a.arrayValue,_=(l=f[Ss])===null||l===void 0?void 0:l.arrayValue,g=Ie(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0);return g!==0?g:yu(p,_)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===ss.mapValue&&o===ss.mapValue)return 0;if(s===ss.mapValue)return 1;if(o===ss.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=va(l[d],h[d]);if(f!==0)return f;const p=mr(a[l[d]],u[h[d]]);if(p!==0)return p}return Ie(l.length,h.length)}(r.mapValue,e.mapValue);default:throw ge()}}function gu(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ie(r,e);const t=En(r),n=En(e),i=Ie(t.seconds,n.seconds);return i!==0?i:Ie(t.nanos,n.nanos)}function yu(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=mr(t[i],n[i]);if(s)return s}return Ie(t.length,n.length)}function gr(r){return _a(r)}function _a(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=En(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Tn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return pe.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=_a(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${_a(t.fields[o])}`;return i+"}"}(r.mapValue):ge()}function _s(r){switch(An(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ys(r);return e?16+_s(e):16;case 5:return 2*r.stringValue.length;case 6:return Tn(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+_s(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return In(n.fields,(s,o)=>{i+=s.length+_s(o)}),i}(r.mapValue);default:throw ge()}}function vu(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function ba(r){return!!r&&"integerValue"in r}function il(r){return!!r&&"arrayValue"in r}function _u(r){return!!r&&"nullValue"in r}function bu(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function bs(r){return!!r&&"mapValue"in r}function Wg(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Df])===null||t===void 0?void 0:t.stringValue)===Vf}function hi(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return In(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=hi(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hi(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Qg(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Mf}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.value=e}static empty(){return new St({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!bs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hi(t)}setAll(e){let t=ht.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=hi(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());bs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];bs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){In(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new St(hi(this.value))}}function $f(r){const e=[];return In(r.fields,(t,n)=>{const i=new ht([t]);if(bs(n)){const s=$f(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Pt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,ve.min(),ve.min(),ve.min(),St.empty(),0)}static newFoundDocument(e,t,n,i){return new yt(e,1,t,ve.min(),n,i,0)}static newNoDocument(e,t){return new yt(e,2,t,ve.min(),ve.min(),St.empty(),0)}static newUnknownDocument(e,t){return new yt(e,3,t,ve.min(),ve.min(),St.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,t){this.position=e,this.inclusive=t}}function wu(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=pe.comparator(pe.fromName(o.referenceValue),t.key):n=mr(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function xu(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Wt(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,t="asc"){this.field=e,this.dir=t}}function Yg(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{}class tt extends Ff{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Xg(e,t,n):t==="array-contains"?new ty(e,n):t==="in"?new ny(e,n):t==="not-in"?new ry(e,n):t==="array-contains-any"?new iy(e,n):new tt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Zg(e,n):new ey(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(mr(t,this.value)):t!==null&&An(this.value)===An(t)&&this.matchesComparison(mr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $t extends Ff{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new $t(e,t)}matches(e){return qf(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function qf(r){return r.op==="and"}function Uf(r){return Jg(r)&&qf(r)}function Jg(r){for(const e of r.filters)if(e instanceof $t)return!1;return!0}function wa(r){if(r instanceof tt)return r.field.canonicalString()+r.op.toString()+gr(r.value);if(Uf(r))return r.filters.map(e=>wa(e)).join(",");{const e=r.filters.map(t=>wa(t)).join(",");return`${r.op}(${e})`}}function Bf(r,e){return r instanceof tt?function(n,i){return i instanceof tt&&n.op===i.op&&n.field.isEqual(i.field)&&Wt(n.value,i.value)}(r,e):r instanceof $t?function(n,i){return i instanceof $t&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,a)=>s&&Bf(o,i.filters[a]),!0):!1}(r,e):void ge()}function zf(r){return r instanceof tt?function(t){return`${t.field.canonicalString()} ${t.op} ${gr(t.value)}`}(r):r instanceof $t?function(t){return t.op.toString()+" {"+t.getFilters().map(zf).join(" ,")+"}"}(r):"Filter"}class Xg extends tt{constructor(e,t,n){super(e,t,n),this.key=pe.fromName(n.referenceValue)}matches(e){const t=pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Zg extends tt{constructor(e,t){super(e,"in",t),this.keys=Hf("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ey extends tt{constructor(e,t){super(e,"not-in",t),this.keys=Hf("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Hf(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>pe.fromName(n.referenceValue))}class ty extends tt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return il(t)&&xi(t.arrayValue,this.value)}}class ny extends tt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&xi(this.value.arrayValue,t)}}class ry extends tt{constructor(e,t){super(e,"not-in",t)}matches(e){if(xi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!xi(this.value.arrayValue,t)}}class iy extends tt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>xi(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.le=null}}function Eu(r,e=null,t=[],n=[],i=null,s=null,o=null){return new sy(r,e,t,n,i,s,o)}function sl(r){const e=_e(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>wa(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Qs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>gr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>gr(n)).join(",")),e.le=t}return e.le}function ol(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!Yg(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Bf(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!xu(r.startAt,e.startAt)&&xu(r.endAt,e.endAt)}function xa(r){return pe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function oy(r,e,t,n,i,s,o,a){return new Ir(r,e,t,n,i,s,o,a)}function Js(r){return new Ir(r)}function Tu(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Gf(r){return r.collectionGroup!==null}function fi(r){const e=_e(r);if(e.he===null){e.he=[];const t=new Set;for(const s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new st(ht.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new Ei(s,n))}),t.has(ht.keyField().canonicalString())||e.he.push(new Ei(ht.keyField(),n))}return e.he}function Ht(r){const e=_e(r);return e.Pe||(e.Pe=ay(e,fi(r))),e.Pe}function ay(r,e){if(r.limitType==="F")return Eu(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ei(i.field,s)});const t=r.endAt?new Is(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Is(r.startAt.position,r.startAt.inclusive):null;return Eu(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Ea(r,e){const t=r.filters.concat([e]);return new Ir(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Ta(r,e,t){return new Ir(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Xs(r,e){return ol(Ht(r),Ht(e))&&r.limitType===e.limitType}function Kf(r){return`${sl(Ht(r))}|lt:${r.limitType}`}function ar(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>zf(i)).join(", ")}]`),Qs(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>gr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>gr(i)).join(",")),`Target(${n})`}(Ht(r))}; limitType=${r.limitType})`}function Zs(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):pe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of fi(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,a,l){const u=wu(o,a,l);return o.inclusive?u<=0:u<0}(n.startAt,fi(n),i)||n.endAt&&!function(o,a,l){const u=wu(o,a,l);return o.inclusive?u>=0:u>0}(n.endAt,fi(n),i))}(r,e)}function ly(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Wf(r){return(e,t)=>{let n=!1;for(const i of fi(r)){const s=cy(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function cy(r,e,t){const n=r.field.isKeyField()?pe.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?mr(l,u):ge()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ge()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){In(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Pf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new We(pe.comparator);function ln(){return uy}const Qf=new We(pe.comparator);function ai(...r){let e=Qf;for(const t of r)e=e.insert(t.key,t);return e}function Yf(r){let e=Qf;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Un(){return di()}function Jf(){return di()}function di(){return new Gn(r=>r.toString(),(r,e)=>r.isEqual(e))}const hy=new We(pe.comparator),fy=new st(pe.comparator);function Oe(...r){let e=fy;for(const t of r)e=e.add(t);return e}const dy=new st(Ie);function py(){return dy}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:As(e)?"-0":e}}function Xf(r){return{integerValue:""+r}}function my(r,e){return Bg(e)?Xf(e):al(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){this._=void 0}}function gy(r,e,t){return r instanceof Ns?function(i,s){const o={fields:{[Rf]:{stringValue:Cf},[Lf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rl(s)&&(s=Ys(s)),s&&(o.fields[jf]=s),{mapValue:o}}(t,e):r instanceof Ti?ed(r,e):r instanceof Ai?td(r,e):function(i,s){const o=Zf(i,s),a=Au(o)+Au(i.Ie);return ba(o)&&ba(i.Ie)?Xf(a):al(i.serializer,a)}(r,e)}function yy(r,e,t){return r instanceof Ti?ed(r,e):r instanceof Ai?td(r,e):t}function Zf(r,e){return r instanceof Ps?function(n){return ba(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Ns extends eo{}class Ti extends eo{constructor(e){super(),this.elements=e}}function ed(r,e){const t=nd(e);for(const n of r.elements)t.some(i=>Wt(i,n))||t.push(n);return{arrayValue:{values:t}}}class Ai extends eo{constructor(e){super(),this.elements=e}}function td(r,e){let t=nd(e);for(const n of r.elements)t=t.filter(i=>!Wt(i,n));return{arrayValue:{values:t}}}class Ps extends eo{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Au(r){return Je(r.integerValue||r.doubleValue)}function nd(r){return il(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function vy(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ti&&i instanceof Ti||n instanceof Ai&&i instanceof Ai?pr(n.elements,i.elements,Wt):n instanceof Ps&&i instanceof Ps?Wt(n.Ie,i.Ie):n instanceof Ns&&i instanceof Ns}(r.transform,e.transform)}class _y{constructor(e,t){this.version=e,this.transformResults=t}}class xt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xt}static exists(e){return new xt(void 0,e)}static updateTime(e){return new xt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ws(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class to{}function rd(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new no(r.key,xt.none()):new Ni(r.key,r.data,xt.none());{const t=r.data,n=St.empty();let i=new st(ht.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Nn(r.key,n,new Pt(i.toArray()),xt.none())}}function by(r,e,t){r instanceof Ni?function(i,s,o){const a=i.value.clone(),l=Su(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):r instanceof Nn?function(i,s,o){if(!ws(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Su(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(id(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pi(r,e,t,n){return r instanceof Ni?function(s,o,a,l){if(!ws(s.precondition,o))return a;const u=s.value.clone(),h=Iu(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(r,e,t,n):r instanceof Nn?function(s,o,a,l){if(!ws(s.precondition,o))return a;const u=Iu(s.fieldTransforms,l,o),h=o.data;return h.setAll(id(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(s,o,a){return ws(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(r,e,t)}function wy(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=Zf(n.transform,i||null);s!=null&&(t===null&&(t=St.empty()),t.set(n.field,s))}return t||null}function ku(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&pr(n,i,(s,o)=>vy(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Ni extends to{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Nn extends to{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function id(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Su(r,e,t){const n=new Map;Me(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,yy(o,a,t[i]))}return n}function Iu(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,gy(s,o,e))}return n}class no extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xy extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&by(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Jf();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=rd(o,a);l!==null&&n.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ve.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Oe())}isEqual(e){return this.batchId===e.batchId&&pr(this.mutations,e.mutations,(t,n)=>ku(t,n))&&pr(this.baseMutations,e.baseMutations,(t,n)=>ku(t,n))}}class ll{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){Me(e.mutations.length===n.length);let i=function(){return hy}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new ll(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,je;function ky(r){switch(r){case ne.OK:return ge();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0;default:return ge()}}function sd(r){if(r===void 0)return an("GRPC error has no .code"),ne.UNKNOWN;switch(r){case et.OK:return ne.OK;case et.CANCELLED:return ne.CANCELLED;case et.UNKNOWN:return ne.UNKNOWN;case et.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case et.INTERNAL:return ne.INTERNAL;case et.UNAVAILABLE:return ne.UNAVAILABLE;case et.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case et.NOT_FOUND:return ne.NOT_FOUND;case et.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case et.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case et.ABORTED:return ne.ABORTED;case et.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case et.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case et.DATA_LOSS:return ne.DATA_LOSS;default:return ge()}}(je=et||(et={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy=new bn([4294967295,4294967295],0);function Nu(r){const e=Sf().encode(r),t=new bf;return t.update(e),new Uint8Array(t.digest())}function Pu(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new bn([t,n],0),new bn([i,s],0)]}class cl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new li(`Invalid padding: ${t}`);if(n<0)throw new li(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new li(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new li(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=bn.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(bn.fromNumber(n)));return i.compare(Sy)===1&&(i=new bn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=Nu(e),[n,i]=Pu(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);if(!this.Re(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new cl(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=Nu(e),[n,i]=Pu(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class li extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Pi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ro(ve.min(),i,new We(Ie),ln(),Oe())}}class Pi{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Pi(n,t,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}}class od{constructor(e,t){this.targetId=e,this.ge=t}}class ad{constructor(e,t,n=ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Ou{constructor(){this.pe=0,this.ye=Cu(),this.we=ft.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Oe(),t=Oe(),n=Oe();return this.ye.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ge()}}),new Pi(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Cu()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Me(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class Iy{constructor(e){this.ke=e,this.qe=new Map,this.Qe=ln(),this.$e=os(),this.Ue=os(),this.Ke=new We(Ie)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:ge()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){const s=i.target;if(xa(s))if(n===0){const o=new pe(s.path);this.ze(t,o,yt.newNoDocument(o,ve.min()))}else Me(n===1);else{const o=this.et(t);if(o!==n){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,u)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Tn(n).toUint8Array()}catch(l){if(l instanceof Of)return dr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new cl(o,i,s)}catch(l){return dr(l instanceof li?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,s,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&xa(a.target)){const l=new pe(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,yt.newNoDocument(l,e))}s.ve&&(t.set(o,s.Fe()),s.Me())}});let n=Oe();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Xe(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(e));const i=new ro(e,t,this.Ke,this.Qe,n);return this.Qe=ln(),this.$e=os(),this.Ue=os(),this.Ke=new We(Ie),i}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Ou,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new st(Ie),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new st(Ie),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||fe("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Ou),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function os(){return new We(pe.comparator)}function Cu(){return new We(pe.comparator)}const Ny={asc:"ASCENDING",desc:"DESCENDING"},Py={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oy={and:"AND",or:"OR"};class Cy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Aa(r,e){return r.useProto3Json||Qs(e)?e:{value:e}}function Os(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ld(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function Ry(r,e){return Os(r,e.toTimestamp())}function Gt(r){return Me(!!r),ve.fromTimestamp(function(t){const n=En(t);return new it(n.seconds,n.nanos)}(r))}function ul(r,e){return ka(r,e).canonicalString()}function ka(r,e){const t=function(i){return new He(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function cd(r){const e=He.fromString(r);return Me(pd(e)),e}function Sa(r,e){return ul(r.databaseId,e.path)}function Ho(r,e){const t=cd(e);if(t.get(1)!==r.databaseId.projectId)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new pe(hd(t))}function ud(r,e){return ul(r.databaseId,e)}function jy(r){const e=cd(r);return e.length===4?He.emptyPath():hd(e)}function Ia(r){return new He(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function hd(r){return Me(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Ru(r,e,t){return{name:Sa(r,e),fields:t.value.mapValue.fields}}function Ly(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ge()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(Me(h===void 0||typeof h=="string"),ft.fromBase64String(h||"")):(Me(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ft.fromUint8Array(h||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?ne.UNKNOWN:sd(u.code);return new he(h,u.message||"")}(o);t=new ad(n,i,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Ho(r,n.document.name),s=Gt(n.document.updateTime),o=n.document.createTime?Gt(n.document.createTime):ve.min(),a=new St({mapValue:{fields:n.document.fields}}),l=yt.newFoundDocument(i,s,o,a),u=n.targetIds||[],h=n.removedTargetIds||[];t=new xs(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Ho(r,n.document),s=n.readTime?Gt(n.readTime):ve.min(),o=yt.newNoDocument(i,s),a=n.removedTargetIds||[];t=new xs([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Ho(r,n.document),s=n.removedTargetIds||[];t=new xs([],s,i,null)}else{if(!("filter"in e))return ge();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new Ay(i,s),a=n.targetId;t=new od(a,o)}}return t}function Dy(r,e){let t;if(e instanceof Ni)t={update:Ru(r,e.key,e.value)};else if(e instanceof no)t={delete:Sa(r,e.key)};else if(e instanceof Nn)t={update:Ru(r,e.key,e.data),updateMask:Hy(e.fieldMask)};else{if(!(e instanceof xy))return ge();t={verify:Sa(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof Ns)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ti)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ps)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ge()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Ry(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ge()}(r,e.precondition)),t}function My(r,e){return r&&r.length>0?(Me(e!==void 0),r.map(t=>function(i,s){let o=i.updateTime?Gt(i.updateTime):Gt(s);return o.isEqual(ve.min())&&(o=Gt(s)),new _y(o,i.transformResults||[])}(t,e))):[]}function Vy(r,e){return{documents:[ud(r,e.path)]}}function $y(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=ud(r,i);const s=function(u){if(u.length!==0)return dd($t.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(h=>function(f){return{field:lr(f.field),direction:Uy(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Aa(r,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ht:t,parent:i}}function Fy(r){let e=jy(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){Me(n===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(d){const f=fd(d);return f instanceof $t&&Uf(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(_){return new Ei(cr(_.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Qs(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,p=d.values||[];return new Is(p,f)}(t.startAt));let u=null;return t.endAt&&(u=function(d){const f=!d.before,p=d.values||[];return new Is(p,f)}(t.endAt)),oy(e,i,o,s,a,"F",l,u)}function qy(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function fd(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=cr(t.unaryFilter.field);return tt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=cr(t.unaryFilter.field);return tt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=cr(t.unaryFilter.field);return tt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=cr(t.unaryFilter.field);return tt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(r):r.fieldFilter!==void 0?function(t){return tt.create(cr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return $t.create(t.compositeFilter.filters.map(n=>fd(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ge()}}(t.compositeFilter.op))}(r):ge()}function Uy(r){return Ny[r]}function By(r){return Py[r]}function zy(r){return Oy[r]}function lr(r){return{fieldPath:r.canonicalString()}}function cr(r){return ht.fromServerFormat(r.fieldPath)}function dd(r){return r instanceof tt?function(t){if(t.op==="=="){if(bu(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NAN"}};if(_u(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bu(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NOT_NAN"}};if(_u(t.value))return{unaryFilter:{field:lr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lr(t.field),op:By(t.op),value:t.value}}}(r):r instanceof $t?function(t){const n=t.getFilters().map(i=>dd(i));return n.length===1?n[0]:{compositeFilter:{op:zy(t.op),filters:n}}}(r):ge()}function Hy(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function pd(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,n,i,s=ve.min(),o=ve.min(),a=ft.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new _n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(e){this.Tt=e}}function Ky(r){const e=Fy({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ta(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(){this.Tn=new Qy}addToCollectionParentIndex(e,t){return this.Tn.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(xn.min())}updateCollectionGroup(e,t,n){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class Qy{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new st(He.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new st(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ju={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},md=41943040;class At{static withCacheSize(e){return new At(e,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */At.DEFAULT_COLLECTION_PERCENTILE=10,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,At.DEFAULT=new At(md,At.DEFAULT_COLLECTION_PERCENTILE,At.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),At.DISABLED=new At(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new yr(0)}static Kn(){return new yr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu="LruGarbageCollector",Yy=1048576;function Du([r,e],[t,n]){const i=Ie(r,t);return i===0?Ie(e,n):i}class Jy{constructor(e){this.Hn=e,this.buffer=new st(Du),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Du(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Xy{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){fe(Lu,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Sr(t)?fe(Lu,"Ignoring IndexedDB error during garbage collection: ",t):await kr(t)}await this.er(3e5)})}}class Zy{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ie.resolve(Ws.ae);const n=new Jy(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(ju)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ju):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(n=d,a=Date.now(),this.removeTargets(e,n,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(u=Date.now(),or()<=nn.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function e0(r,e){return new Zy(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(){this.changes=new Gn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ie.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&pi(n.mutation,i,Pt.empty(),it.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Oe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Oe()){const i=Un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=ai();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Un();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Oe()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=ln();const o=di(),a=function(){return di()}();return t.forEach((l,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Nn)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),pi(h.mutation,u,h.mutation.getFieldMask(),it.now())):o.set(u.key,Pt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var d;return a.set(u,new n0(h,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=di();let i=new We((o,a)=>o-a),s=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=n.get(l)||Pt.empty();h=a.applyToLocalView(u,h),n.set(l,h);const d=(i.get(a.batchId)||Oe()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,d=Jf();h.forEach(f=>{if(!s.has(f)){const p=rd(t.get(f),n.get(f));p!==null&&d.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return ie.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Gf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ie.resolve(Un());let a=_i,l=s;return o.next(u=>ie.forEach(u,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(h)?ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Oe())).next(h=>({batchId:a,changes:Yf(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pe(t)).next(n=>{let i=ai();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=ai();return this.indexManager.getCollectionParents(e,s).next(a=>ie.forEach(a,l=>{const u=function(d,f){return new Ir(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,yt.newInvalidDocument(h)))});let a=ai();return o.forEach((l,u)=>{const h=s.get(l);h!==void 0&&pi(h.mutation,u,Pt.empty(),it.now()),Zs(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return ie.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Gt(i.createTime)}}(t)),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:Ky(i.bundledQuery),readTime:Gt(i.readTime)}}(t)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(){this.overlays=new We(pe.comparator),this.Rr=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Un();return ie.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.Et(e,t,s)}),ie.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),ie.resolve()}getOverlaysForCollection(e,t,n){const i=Un(),s=t.length+1,o=new pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ie.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new We((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>n){let h=s.get(u.largestBatchId);h===null&&(h=Un(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Un(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return ie.resolve(a)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Ty(t,n));let s=this.Rr.get(t);s===void 0&&(s=Oe(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(){this.sessionToken=ft.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.Vr=new st(at.mr),this.gr=new st(at.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new at(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new at(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){const t=new pe(new He([])),n=new at(t,e),i=new at(t,e+1),s=[];return this.gr.forEachInRange([n,i],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new pe(new He([])),n=new at(t,e),i=new at(t,e+1);let s=Oe();return this.gr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new at(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class at{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return pe.comparator(e.key,t.key)||Ie(e.Cr,t.Cr)}static pr(e,t){return Ie(e.Cr,t.Cr)||pe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new st(at.mr)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ey(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Mr=this.Mr.add(new at(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,t){return ie.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),s=i<0?0:i;return ie.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?nl:this.Fr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new at(t,0),i=new at(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,i],o=>{const a=this.Or(o.Cr);s.push(a)}),ie.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new st(Ie);return t.forEach(i=>{const s=new at(i,0),o=new at(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],a=>{n=n.add(a.Cr)})}),ie.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;pe.isDocumentKey(s)||(s=s.child(""));const o=new at(new pe(s),0);let a=new st(Ie);return this.Mr.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.Cr)),!0)},o),ie.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Me(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return ie.forEach(t.mutations,i=>{const s=new at(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new at(t,0),i=this.Mr.firstAfterOrEqual(n);return ie.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e){this.kr=e,this.docs=function(){return new We(pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ie.resolve(n?n.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let n=ln();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),ie.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=ln();const o=t.path,a=new pe(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||$g(Vg(h),n)<=0||(i.has(h.key)||Zs(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ie.resolve(s)}getAllFromCollectionGroup(e,t,n,i){ge()}qr(e,t){return ie.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new c0(this)}getSize(e){return ie.resolve(this.size)}}class c0 extends t0{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),ie.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.persistence=e,this.Qr=new Gn(t=>sl(t),ol),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.$r=0,this.Ur=new hl,this.targetCount=0,this.Kr=yr.Un()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),ie.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new yr(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.zn(t),ie.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ie.waitFor(s).next(()=>i)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return ie.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),ie.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ie.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return ie.resolve(n)}containsKey(e,t){return ie.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Ws(0),this.zr=!1,this.zr=!0,this.jr=new o0,this.referenceDelegate=e(this),this.Hr=new u0(this),this.indexManager=new Wy,this.remoteDocumentCache=function(i){return new l0(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new Gy(t),this.Yr=new i0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new s0,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new a0(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){fe("MemoryPersistence","Starting transaction:",e);const i=new h0(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return ie.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class h0 extends qg{constructor(e){super(),this.currentSequenceNumber=e}}class fl{constructor(e){this.persistence=e,this.ti=new hl,this.ni=null}static ri(e){return new fl(e)}get ii(){if(this.ni)return this.ni;throw ge()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),ie.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),ie.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.ii,n=>{const i=pe.fromPath(n);return this.si(e,i).next(s=>{s||t.removeEntry(i,ve.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return ie.or([()=>ie.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Cs{constructor(e,t){this.persistence=e,this.oi=new Gn(n=>zg(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=e0(this,t)}static ri(e,t){return new Cs(e,t)}Zr(){}Xr(e){return ie.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return ie.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(s=>s?ie.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,t).next(a=>{a||(n++,s.removeEntry(o,ve.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),ie.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ie.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),ie.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_s(e.data.value)),t}ar(e,t,n){return ie.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return ie.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=Oe(),i=Oe();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new dl(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return gg()?8:Ug(yg())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new f0;return this._s(e,t,o).next(a=>{if(s.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>s.result)}us(e,t,n,i){return n.documentReadCount<this.es?(or()<=nn.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",ar(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ie.resolve()):(or()<=nn.DEBUG&&fe("QueryEngine","Query:",ar(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(or()<=nn.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",ar(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ht(t))):ie.resolve())}rs(e,t){if(Tu(t))return ie.resolve(null);let n=Ht(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ta(t,null,"F"),n=Ht(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Oe(...s);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const u=this.cs(t,a);return this.ls(t,u,o,l.readTime)?this.rs(e,Ta(t,null,"F")):this.hs(e,u,t,l)}))})))}ss(e,t,n,i){return Tu(t)||i.isEqual(ve.min())?ie.resolve(null):this.ns.getDocuments(e,n).next(s=>{const o=this.cs(t,s);return this.ls(t,o,n,i)?ie.resolve(null):(or()<=nn.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ar(t)),this.hs(e,o,t,Mg(i,_i)).next(a=>a))})}cs(e,t){let n=new st(Wf(e));return t.forEach((i,s)=>{Zs(e,s)&&(n=n.add(s))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,n){return or()<=nn.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",ar(t)),this.ns.getDocumentsMatchingQuery(e,t,xn.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="LocalStore",p0=3e8;class m0{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new We(Ie),this.Is=new Gn(s=>sl(s),ol),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r0(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function g0(r,e,t,n){return new m0(r,e,t,n)}async function yd(r,e){const t=_e(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Oe();for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(n,l).next(u=>({Rs:u,removedBatchIds:o,addedBatchIds:a}))})})}function y0(r,e){const t=_e(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const d=u.batch,f=d.keys();let p=ie.resolve();return f.forEach(_=>{p=p.next(()=>h.getEntry(l,_)).next(g=>{const y=u.docVersions.get(_);Me(y!==null),g.version.compareTo(y)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),h.addEntry(g)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let l=Oe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function vd(r){const e=_e(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function v0(r,e){const t=_e(r),n=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const a=[];e.targetChanges.forEach((h,d)=>{const f=i.get(d);if(!f)return;a.push(t.Hr.removeMatchingKeys(s,h.removedDocuments,d).next(()=>t.Hr.addMatchingKeys(s,h.addedDocuments,d)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(ft.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):h.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(h.resumeToken,n)),i=i.insert(d,p),function(g,y,m){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=p0?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(f,p,h)&&a.push(t.Hr.updateTargetData(s,p))});let l=ln(),u=Oe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(_0(s,o,e.documentUpdates).next(h=>{l=h.Vs,u=h.fs})),!n.isEqual(ve.min())){const h=t.Hr.getLastRemoteSnapshotVersion(s).next(d=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(h)}return ie.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.Ts=i,s))}function _0(r,e,t){let n=Oe(),i=Oe();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=ln();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ve.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):fe(pl,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Vs:o,fs:i}})}function b0(r,e){const t=_e(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=nl),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function w0(r,e){const t=_e(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(s=>s?(i=s,ie.resolve(i)):t.Hr.allocateTargetId(n).next(o=>(i=new _n(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function Na(r,e,t){const n=_e(r),i=n.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Sr(o))throw o;fe(pl,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Mu(r,e,t){const n=_e(r);let i=ve.min(),s=Oe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const d=_e(l),f=d.Is.get(h);return f!==void 0?ie.resolve(d.Ts.get(f)):d.Hr.getTargetData(u,h)}(n,o,Ht(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Ps.getDocumentsMatchingQuery(o,e,t?i:ve.min(),t?s:Oe())).next(a=>(x0(n,ly(e),a),{documents:a,gs:s})))}function x0(r,e,t){let n=r.Es.get(e)||ve.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Es.set(e,n)}class Vu{constructor(){this.activeTargetIds=py()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E0{constructor(){this.ho=new Vu,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Vu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u="ConnectivityMonitor";class Fu{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){fe($u,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){fe($u,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let as=null;function Pa(){return as===null?as=function(){return 268435456+Math.round(2147483648*Math.random())}():as++,"0x"+as.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go="RestConnection",A0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class k0{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===ks?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,s){const o=Pa(),a=this.bo(e,t.toUriEncodedString());fe(Go,`Sending RPC '${e}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,i,s),this.vo(e,a,l,n).then(u=>(fe(Go,`Received RPC '${e}' ${o}: `,u),u),u=>{throw dr(Go,`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",n),u})}Co(e,t,n,i,s,o){return this.So(e,t,n,i,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ar}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}bo(e,t){const n=A0[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt="WebChannelConnection";class I0 extends k0{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const s=Pa();return new Promise((o,a)=>{const l=new wf;l.setWithCredentials(!0),l.listenOnce(xf.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case vs.NO_ERROR:const h=l.getResponseJson();fe(mt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case vs.TIMEOUT:fe(mt,`RPC '${e}' ${s} timed out`),a(new he(ne.DEADLINE_EXCEEDED,"Request time out"));break;case vs.HTTP_ERROR:const d=l.getStatus();if(fe(mt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const _=function(y){const m=y.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(m)>=0?m:ne.UNKNOWN}(p.status);a(new he(_,p.message))}else a(new he(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new he(ne.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{fe(mt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);fe(mt,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",u,n,15)})}Wo(e,t,n){const i=Pa(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Af(),a=Tf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const h=s.join("");fe(mt,`Creating RPC '${e}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);let f=!1,p=!1;const _=new S0({Fo:y=>{p?fe(mt,`Not sending because RPC '${e}' stream ${i} is closed:`,y):(f||(fe(mt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),f=!0),fe(mt,`RPC '${e}' stream ${i} sending:`,y),d.send(y))},Mo:()=>d.close()}),g=(y,m,b)=>{y.listen(m,k=>{try{b(k)}catch(v){setTimeout(()=>{throw v},0)}})};return g(d,oi.EventType.OPEN,()=>{p||(fe(mt,`RPC '${e}' stream ${i} transport opened.`),_.Qo())}),g(d,oi.EventType.CLOSE,()=>{p||(p=!0,fe(mt,`RPC '${e}' stream ${i} transport closed`),_.Uo())}),g(d,oi.EventType.ERROR,y=>{p||(p=!0,dr(mt,`RPC '${e}' stream ${i} transport errored:`,y),_.Uo(new he(ne.UNAVAILABLE,"The operation could not be completed")))}),g(d,oi.EventType.MESSAGE,y=>{var m;if(!p){const b=y.data[0];Me(!!b);const k=b,v=(k==null?void 0:k.error)||((m=k[0])===null||m===void 0?void 0:m.error);if(v){fe(mt,`RPC '${e}' stream ${i} received error:`,v);const O=v.status;let R=function(P){const T=et[P];if(T!==void 0)return sd(T)}(O),x=v.message;R===void 0&&(R=ne.INTERNAL,x="Unknown error status: "+O+" with message "+v.message),p=!0,_.Uo(new he(R,x)),d.close()}else fe(mt,`RPC '${e}' stream ${i} received:`,b),_.Ko(b)}}),g(a,Ef.STAT_EVENT,y=>{y.stat===ya.PROXY?fe(mt,`RPC '${e}' stream ${i} detected buffering proxy`):y.stat===ya.NOPROXY&&fe(mt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.$o()},0),_}}function Ko(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(r){return new Cy(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qu="PersistentStream";class bd{constructor(e,t,n,i,s,o,a,l){this.Ti=e,this.n_=n,this.r_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new _d(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?(an(t.toString()),an("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new he(ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return fe(qu,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(fe(qu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class N0 extends bd{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=Ly(this.serializer,e),n=function(s){if(!("targetChange"in s))return ve.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?Gt(o.readTime):ve.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Ia(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=xa(l)?{documents:Vy(s,l)}:{query:$y(s,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=ld(s,o.resumeToken);const u=Aa(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Os(s,o.snapshotVersion.toTimestamp());const u=Aa(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const n=qy(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Ia(this.serializer),t.removeTarget=e,this.I_(t)}}class P0 extends bd{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Me(!!e.streamToken),this.lastStreamToken=e.streamToken,Me(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Me(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=My(e.writeResults,e.commitTime),n=Gt(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Ia(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Dy(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{}class C0 extends O0{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,ka(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new he(ne.UNKNOWN,s.toString())})}Co(e,t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,ka(t,n),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new he(ne.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class R0{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(an(t),this.N_=!1):fe("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="RemoteStore";class j0{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{n.enqueueAndForget(async()=>{Kn(this)&&(fe(Hn,"Restarting streams for network reachability change."),await async function(l){const u=_e(l);u.W_.add(4),await Oi(u),u.j_.set("Unknown"),u.W_.delete(4),await so(u)}(this))})}),this.j_=new R0(n,i)}}async function so(r){if(Kn(r))for(const e of r.G_)await e(!0)}async function Oi(r){for(const e of r.G_)await e(!1)}function wd(r,e){const t=_e(r);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),vl(t)?yl(t):Nr(t).c_()&&gl(t,e))}function ml(r,e){const t=_e(r),n=Nr(t);t.K_.delete(e),n.c_()&&xd(t,e),t.K_.size===0&&(n.c_()?n.P_():Kn(t)&&t.j_.set("Unknown"))}function gl(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Nr(r).y_(e)}function xd(r,e){r.H_.Ne(e),Nr(r).w_(e)}function yl(r){r.H_=new Iy({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.K_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),Nr(r).start(),r.j_.B_()}function vl(r){return Kn(r)&&!Nr(r).u_()&&r.K_.size>0}function Kn(r){return _e(r).W_.size===0}function Ed(r){r.H_=void 0}async function L0(r){r.j_.set("Online")}async function D0(r){r.K_.forEach((e,t)=>{gl(r,e)})}async function M0(r,e){Ed(r),vl(r)?(r.j_.q_(e),yl(r)):r.j_.set("Unknown")}async function V0(r,e,t){if(r.j_.set("Online"),e instanceof ad&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.K_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.K_.delete(a),i.H_.removeTarget(a))}(r,e)}catch(n){fe(Hn,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Rs(r,n)}else if(e instanceof xs?r.H_.We(e):e instanceof od?r.H_.Ze(e):r.H_.je(e),!t.isEqual(ve.min()))try{const n=await vd(r.localStore);t.compareTo(n)>=0&&await function(s,o){const a=s.H_.ot(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.K_.get(u);h&&s.K_.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.K_.get(l);if(!h)return;s.K_.set(l,h.withResumeToken(ft.EMPTY_BYTE_STRING,h.snapshotVersion)),xd(s,l);const d=new _n(h.target,l,u,h.sequenceNumber);gl(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(r,t)}catch(n){fe(Hn,"Failed to raise snapshot:",n),await Rs(r,n)}}async function Rs(r,e,t){if(!Sr(e))throw e;r.W_.add(1),await Oi(r),r.j_.set("Offline"),t||(t=()=>vd(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{fe(Hn,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await so(r)})}function Td(r,e){return e().catch(t=>Rs(r,t,e))}async function oo(r){const e=_e(r),t=kn(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:nl;for(;$0(e);)try{const i=await b0(e.localStore,n);if(i===null){e.U_.length===0&&t.P_();break}n=i.batchId,F0(e,i)}catch(i){await Rs(e,i)}Ad(e)&&kd(e)}function $0(r){return Kn(r)&&r.U_.length<10}function F0(r,e){r.U_.push(e);const t=kn(r);t.c_()&&t.S_&&t.b_(e.mutations)}function Ad(r){return Kn(r)&&!kn(r).u_()&&r.U_.length>0}function kd(r){kn(r).start()}async function q0(r){kn(r).C_()}async function U0(r){const e=kn(r);for(const t of r.U_)e.b_(t.mutations)}async function B0(r,e,t){const n=r.U_.shift(),i=ll.from(n,e,t);await Td(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await oo(r)}async function z0(r,e){e&&kn(r).S_&&await async function(n,i){if(function(o){return ky(o)&&o!==ne.ABORTED}(i.code)){const s=n.U_.shift();kn(n).h_(),await Td(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await oo(n)}}(r,e),Ad(r)&&kd(r)}async function Uu(r,e){const t=_e(r);t.asyncQueue.verifyOperationInProgress(),fe(Hn,"RemoteStore received new credentials");const n=Kn(t);t.W_.add(3),await Oi(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await so(t)}async function H0(r,e){const t=_e(r);e?(t.W_.delete(2),await so(t)):e||(t.W_.add(2),await Oi(t),t.j_.set("Unknown"))}function Nr(r){return r.J_||(r.J_=function(t,n,i){const s=_e(t);return s.M_(),new N0(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:L0.bind(null,r),No:D0.bind(null,r),Lo:M0.bind(null,r),p_:V0.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),vl(r)?yl(r):r.j_.set("Unknown")):(await r.J_.stop(),Ed(r))})),r.J_}function kn(r){return r.Y_||(r.Y_=function(t,n,i){const s=_e(t);return s.M_(),new P0(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:q0.bind(null,r),Lo:z0.bind(null,r),D_:U0.bind(null,r),v_:B0.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await oo(r)):(await r.Y_.stop(),r.U_.length>0&&(fe(Hn,`Stopping write stream with ${r.U_.length} pending writes`),r.U_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new _l(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bl(r,e){if(an("AsyncQueue",`${e}: ${r}`),Sr(r))return new he(ne.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{static emptySet(e){return new hr(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||pe.comparator(t.key,n.key):(t,n)=>pe.comparator(t.key,n.key),this.keyedMap=ai(),this.sortedSet=new We(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new hr;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(){this.Z_=new We(pe.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):ge():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class vr{constructor(e,t,n,i,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new vr(e,t,hr.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class K0{constructor(){this.queries=zu(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=_e(t),s=i.queries;i.queries=zu(),s.forEach((o,a)=>{for(const l of a.ta)l.onError(n)})})(this,new he(ne.ABORTED,"Firestore shutting down"))}}function zu(){return new Gn(r=>Kf(r),Xs)}async function wl(r,e){const t=_e(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.na()&&e.ra()&&(n=2):(s=new G0,n=e.ra()?0:1);try{switch(n){case 0:s.ea=await t.onListen(i,!0);break;case 1:s.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=bl(o,`Initialization of query '${ar(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&El(t)}async function xl(r,e){const t=_e(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.ta.indexOf(e);o>=0&&(s.ta.splice(o,1),s.ta.length===0?i=e.ra()?0:1:!s.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function W0(r,e){const t=_e(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.ta)a.oa(i)&&(n=!0);o.ea=i}}n&&El(t)}function Q0(r,e,t){const n=_e(r),i=n.queries.get(e);if(i)for(const s of i.ta)s.onError(t);n.queries.delete(e)}function El(r){r.ia.forEach(e=>{e.next()})}var Oa,Hu;(Hu=Oa||(Oa={}))._a="default",Hu.Cache="cache";class Tl{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new vr(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=vr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Oa.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this.key=e}}class Id{constructor(e){this.key=e}}class Y0{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Oe(),this.mutatedKeys=Oe(),this.ya=Wf(e),this.wa=new hr(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new Bu,i=t?t.wa:this.wa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,d)=>{const f=i.get(h),p=Zs(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;f&&p?f.data.isEqual(p.data)?_!==g&&(n.track({type:3,doc:p}),y=!0):this.va(f,p)||(n.track({type:2,doc:p}),y=!0,(l&&this.ya(p,l)>0||u&&this.ya(p,u)<0)&&(a=!0)):!f&&p?(n.track({type:0,doc:p}),y=!0):f&&!p&&(n.track({type:1,doc:f}),y=!0,(l||u)&&(a=!0)),y&&(p?(o=o.add(p),s=g?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),n.track({type:1,doc:h})}return{wa:o,Da:n,ls:a,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((h,d)=>function(p,_){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return g(p)-g(_)}(h.type,d.type)||this.ya(h.doc,d.doc)),this.Ca(n),i=i!=null&&i;const a=t&&!i?this.Fa():[],l=this.pa.size===0&&this.current&&!i?1:0,u=l!==this.ga;return this.ga=l,o.length!==0||u?{snapshot:new vr(this.query,e.wa,s,o,e.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Bu,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Oe(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new Id(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new Sd(n))}),t}Oa(e){this.fa=e.gs,this.pa=Oe();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return vr.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Al="SyncEngine";class J0{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class X0{constructor(e){this.key=e,this.Ba=!1}}class Z0{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Gn(a=>Kf(a),Xs),this.qa=new Map,this.Qa=new Set,this.$a=new We(pe.comparator),this.Ua=new Map,this.Ka=new hl,this.Wa={},this.Ga=new Map,this.za=yr.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function ev(r,e,t=!0){const n=jd(r);let i;const s=n.ka.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Na()):i=await Nd(n,e,t,!0),i}async function tv(r,e){const t=jd(r);await Nd(t,e,!0,!1)}async function Nd(r,e,t,n){const i=await w0(r.localStore,Ht(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let a;return n&&(a=await nv(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&wd(r.remoteStore,i),a}async function nv(r,e,t,n,i){r.Ha=(d,f,p)=>async function(g,y,m,b){let k=y.view.ba(m);k.ls&&(k=await Mu(g.localStore,y.query,!1).then(({documents:x})=>y.view.ba(x,k)));const v=b&&b.targetChanges.get(y.targetId),O=b&&b.targetMismatches.get(y.targetId)!=null,R=y.view.applyChanges(k,g.isPrimaryClient,v,O);return Ku(g,y.targetId,R.Ma),R.snapshot}(r,d,f,p);const s=await Mu(r.localStore,e,!0),o=new Y0(e,s.gs),a=o.ba(s.documents),l=Pi.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),u=o.applyChanges(a,r.isPrimaryClient,l);Ku(r,t,u.Ma);const h=new J0(e,t,o);return r.ka.set(e,h),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),u.snapshot}async function rv(r,e,t){const n=_e(r),i=n.ka.get(e),s=n.qa.get(i.targetId);if(s.length>1)return n.qa.set(i.targetId,s.filter(o=>!Xs(o,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Na(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&ml(n.remoteStore,i.targetId),Ca(n,i.targetId)}).catch(kr)):(Ca(n,i.targetId),await Na(n.localStore,i.targetId,!0))}async function iv(r,e){const t=_e(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),ml(t.remoteStore,n.targetId))}async function sv(r,e,t){const n=fv(r);try{const i=await function(o,a){const l=_e(o),u=it.now(),h=a.reduce((p,_)=>p.add(_.key),Oe());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let _=ln(),g=Oe();return l.ds.getEntries(p,h).next(y=>{_=y,_.forEach((m,b)=>{b.isValidDocument()||(g=g.add(m))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,_)).next(y=>{d=y;const m=[];for(const b of a){const k=wy(b,d.get(b.key).overlayedDocument);k!=null&&m.push(new Nn(b.key,k,$f(k.value.mapValue),xt.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,m,a)}).next(y=>{f=y;const m=y.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,y.batchId,m)})}).then(()=>({batchId:f.batchId,changes:Yf(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Wa[o.currentUser.toKey()];u||(u=new We(Ie)),u=u.insert(a,l),o.Wa[o.currentUser.toKey()]=u}(n,i.batchId,t),await Ci(n,i.changes),await oo(n.remoteStore)}catch(i){const s=bl(i,"Failed to persist write");t.reject(s)}}async function Pd(r,e){const t=_e(r);try{const n=await v0(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Ua.get(s);o&&(Me(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?Me(o.Ba):i.removedDocuments.size>0&&(Me(o.Ba),o.Ba=!1))}),await Ci(t,n,e)}catch(n){await kr(n)}}function Gu(r,e,t){const n=_e(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((s,o)=>{const a=o.view.sa(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=_e(o);l.onlineState=a;let u=!1;l.queries.forEach((h,d)=>{for(const f of d.ta)f.sa(a)&&(u=!0)}),u&&El(l)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function ov(r,e,t){const n=_e(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Ua.get(e),s=i&&i.key;if(s){let o=new We(pe.comparator);o=o.insert(s,yt.newNoDocument(s,ve.min()));const a=Oe().add(s),l=new ro(ve.min(),new Map,new We(Ie),o,a);await Pd(n,l),n.$a=n.$a.remove(s),n.Ua.delete(e),kl(n)}else await Na(n.localStore,e,!1).then(()=>Ca(n,e,t)).catch(kr)}async function av(r,e){const t=_e(r),n=e.batch.batchId;try{const i=await y0(t.localStore,e);Cd(t,n,null),Od(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Ci(t,i)}catch(i){await kr(i)}}async function lv(r,e,t){const n=_e(r);try{const i=await function(o,a){const l=_e(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(d=>(Me(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(n.localStore,e);Cd(n,e,t),Od(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Ci(n,i)}catch(i){await kr(i)}}function Od(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Cd(r,e,t){const n=_e(r);let i=n.Wa[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function Ca(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ka.br(e).forEach(n=>{r.Ka.containsKey(n)||Rd(r,n)})}function Rd(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(ml(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ua.delete(t),kl(r))}function Ku(r,e,t){for(const n of t)n instanceof Sd?(r.Ka.addReference(n.key,e),cv(r,n)):n instanceof Id?(fe(Al,"Document no longer in limbo: "+n.key),r.Ka.removeReference(n.key,e),r.Ka.containsKey(n.key)||Rd(r,n.key)):ge()}function cv(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(fe(Al,"New document in limbo: "+t),r.Qa.add(n),kl(r))}function kl(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new pe(He.fromString(e)),n=r.za.next();r.Ua.set(n,new X0(t)),r.$a=r.$a.insert(t,n),wd(r.remoteStore,new _n(Ht(Js(t.path)),n,"TargetPurposeLimboResolution",Ws.ae))}}async function Ci(r,e,t){const n=_e(r),i=[],s=[],o=[];n.ka.isEmpty()||(n.ka.forEach((a,l)=>{o.push(n.Ha(l,e,t).then(u=>{var h;if((u||t)&&n.isPrimaryClient){const d=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){i.push(u);const d=dl.Yi(l.targetId,u);s.push(d)}}))}),await Promise.all(o),n.La.p_(i),await async function(l,u){const h=_e(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ie.forEach(u,f=>ie.forEach(f.Hi,p=>h.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>ie.forEach(f.Ji,p=>h.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!Sr(d))throw d;fe(pl,"Failed to update sequence numbers: "+d)}for(const d of u){const f=d.targetId;if(!d.fromCache){const p=h.Ts.get(f),_=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(_);h.Ts=h.Ts.insert(f,g)}}}(n.localStore,s))}async function uv(r,e){const t=_e(r);if(!t.currentUser.isEqual(e)){fe(Al,"User change. New user:",e.toKey());const n=await yd(t.localStore,e);t.currentUser=e,function(s,o){s.Ga.forEach(a=>{a.forEach(l=>{l.reject(new he(ne.CANCELLED,o))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Ci(t,n.Rs)}}function hv(r,e){const t=_e(r),n=t.Ua.get(e);if(n&&n.Ba)return Oe().add(n.key);{let i=Oe();const s=t.qa.get(e);if(!s)return i;for(const o of s){const a=t.ka.get(o);i=i.unionWith(a.view.Sa)}return i}}function jd(r){const e=_e(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ov.bind(null,e),e.La.p_=W0.bind(null,e.eventManager),e.La.Ja=Q0.bind(null,e.eventManager),e}function fv(r){const e=_e(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=av.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lv.bind(null,e),e}class js{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=io(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return g0(this.persistence,new d0,e.initialUser,this.serializer)}Xa(e){return new gd(fl.ri,this.serializer)}Za(e){return new E0}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}js.provider={build:()=>new js};class dv extends js{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Me(this.persistence.referenceDelegate instanceof Cs);const n=this.persistence.referenceDelegate.garbageCollector;return new Xy(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?At.withCacheSize(this.cacheSizeBytes):At.DEFAULT;return new gd(n=>Cs.ri(n,t),this.serializer)}}class Ra{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Gu(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=uv.bind(null,this.syncEngine),await H0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new K0}()}createDatastore(e){const t=io(e.databaseInfo.databaseId),n=function(s){return new I0(s)}(e.databaseInfo);return function(s,o,a,l){return new C0(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,a){return new j0(n,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Gu(this.syncEngine,t,0),function(){return Fu.D()?new Fu:new T0}())}createSyncEngine(e,t){return function(i,s,o,a,l,u,h){const d=new Z0(i,s,o,a,l,u);return h&&(d.ja=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=_e(i);fe(Hn,"RemoteStore shutting down."),s.W_.add(5),await Oi(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Ra.provider={build:()=>new Ra};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):an("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn="FirestoreClient";class pv{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=gt.UNAUTHENTICATED,this.clientId=If.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{fe(Sn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(fe(Sn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bl(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Wo(r,e){r.asyncQueue.verifyOperationInProgress(),fe(Sn,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await yd(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Wu(r,e){r.asyncQueue.verifyOperationInProgress();const t=await mv(r);fe(Sn,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Uu(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>Uu(e.remoteStore,i)),r._onlineComponents=e}async function mv(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){fe(Sn,"Using user provided OfflineComponentProvider");try{await Wo(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ne.FAILED_PRECONDITION||i.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;dr("Error using user provided cache. Falling back to memory cache: "+t),await Wo(r,new js)}}else fe(Sn,"Using default OfflineComponentProvider"),await Wo(r,new dv(void 0));return r._offlineComponents}async function Ld(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(fe(Sn,"Using user provided OnlineComponentProvider"),await Wu(r,r._uninitializedComponentsProvider._online)):(fe(Sn,"Using default OnlineComponentProvider"),await Wu(r,new Ra))),r._onlineComponents}function gv(r){return Ld(r).then(e=>e.syncEngine)}async function Ls(r){const e=await Ld(r),t=e.eventManager;return t.onListen=ev.bind(null,e.syncEngine),t.onUnlisten=rv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=iv.bind(null,e.syncEngine),t}function yv(r,e,t={}){const n=new sn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Sl({next:f=>{h.su(),o.enqueueAndForget(()=>xl(s,d));const p=f.docs.has(a);!p&&f.fromCache?u.reject(new he(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?u.reject(new he(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new Tl(Js(a.path),h,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await Ls(r),r.asyncQueue,e,t,n)),n.promise}function vv(r,e,t={}){const n=new sn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Sl({next:f=>{h.su(),o.enqueueAndForget(()=>xl(s,d)),f.fromCache&&l.source==="server"?u.reject(new he(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),d=new Tl(a,h,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await Ls(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(r,e,t){if(!t)throw new he(ne.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function _v(r,e,t,n){if(e===!0&&n===!0)throw new he(ne.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Yu(r){if(!pe.isDocumentKey(r))throw new he(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Ju(r){if(pe.isDocumentKey(r))throw new he(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function ao(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":ge()}function Et(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new he(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ao(r);throw new he(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="firestore.googleapis.com",Xu=!0;class Zu{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new he(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Vd,this.ssl=Xu}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Xu;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=md;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Yy)throw new he(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_v("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Dd((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lo{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Zu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Zu(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Ig;switch(n.type){case"firstParty":return new Cg(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new he(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Qu.get(t);n&&(fe("ComponentProvider","Removing Datastore"),Qu.delete(t),n.terminate())}(this),Promise.resolve()}}function bv(r,e,t,n={}){var i;const s=(r=Et(r,lo))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:r._getEmulatorOptions()}),a=`${e}:${t}`;s.host!==Vd&&s.host!==a&&dr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},s),{host:a,ssl:!1,emulatorOptions:n});if(!dg(l,o)&&(r._setSettings(l),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=gt.MOCK_USER;else{u=pg(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new he(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new gt(d)}r._authCredentials=new Ng(new kf(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Pn(this.firestore,e,this._query)}}class _t{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class wn extends Pn{constructor(e,t,n){super(e,t,Js(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new pe(e))}withConverter(e){return new wn(this.firestore,e,this._path)}}function _r(r,e,...t){if(r=Rt(r),Md("collection","path",e),r instanceof lo){const n=He.fromString(e,...t);return Ju(n),new wn(r,null,n)}{if(!(r instanceof _t||r instanceof wn))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return Ju(n),new wn(r.firestore,null,n)}}function rt(r,e,...t){if(r=Rt(r),arguments.length===1&&(e=If.newId()),Md("doc","path",e),r instanceof lo){const n=He.fromString(e,...t);return Yu(n),new _t(r,null,new pe(n))}{if(!(r instanceof _t||r instanceof wn))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return Yu(n),new _t(r.firestore,r instanceof wn?r.converter:null,new pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh="AsyncQueue";class th{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new _d(this,"async_queue_retry"),this.Su=()=>{const n=Ko();n&&fe(eh,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const t=Ko();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Ko();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new sn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Sr(e))throw e;fe(eh,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(n);throw an("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=_l.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&ge()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function nh(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Qt extends lo{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new th,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new th(e),this._firestoreClient=void 0,await e}}}function wv(r,e){const t=typeof r=="object"?r:ug(),n=typeof r=="string"?r:ks,i=hg(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=fg("firestore");s&&bv(i,...s)}return i}function Ri(r){if(r._terminated)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||xv(r),r._firestoreClient}function xv(r){var e,t,n;const i=r._freezeSettings(),s=function(a,l,u,h){return new Kg(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Dd(h.experimentalLongPollingOptions),h.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new pv(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new br(ft.fromBase64String(e))}catch(t){throw new he(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new br(ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ht(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ie(this._lat,e._lat)||Ie(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev=/^__.*__$/;class Tv{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ni(e,this.data,t,this.fieldTransforms)}}class $d{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Fd(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class Ol{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Ol(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Uu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Ds(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(Fd(this.Lu)&&Ev.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class Av{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||io(e)}ju(e,t,n,i=!1){return new Ol({Lu:e,methodName:t,zu:n,path:ht.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Li(r){const e=r._freezeSettings(),t=io(r._databaseId);return new Av(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Cl(r,e,t,n,i,s={}){const o=r.ju(s.merge||s.mergeFields?2:0,e,t,i);Rl("Data must be an object, but it was:",o,n);const a=Bd(n,o);let l,u;if(s.merge)l=new Pt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const d of s.mergeFields){const f=ja(e,d,t);if(!o.contains(f))throw new he(ne.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Hd(h,f)||h.push(f)}l=new Pt(h),u=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=o.fieldTransforms;return new Tv(new St(a),l,u)}class co extends Il{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof co}}function qd(r,e,t,n){const i=r.ju(1,e,t);Rl("Data must be an object, but it was:",i,n);const s=[],o=St.empty();In(n,(l,u)=>{const h=jl(e,l,t);u=Rt(u);const d=i.Uu(h);if(u instanceof co)s.push(h);else{const f=Di(u,d);f!=null&&(s.push(h),o.set(h,f))}});const a=new Pt(s);return new $d(o,a,i.fieldTransforms)}function Ud(r,e,t,n,i,s){const o=r.ju(1,e,t),a=[ja(e,n,t)],l=[i];if(s.length%2!=0)throw new he(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(ja(e,s[f])),l.push(s[f+1]);const u=[],h=St.empty();for(let f=a.length-1;f>=0;--f)if(!Hd(u,a[f])){const p=a[f];let _=l[f];_=Rt(_);const g=o.Uu(p);if(_ instanceof co)u.push(p);else{const y=Di(_,g);y!=null&&(u.push(p),h.set(p,y))}}const d=new Pt(u);return new $d(h,d,o.fieldTransforms)}function kv(r,e,t,n=!1){return Di(t,r.ju(n?4:3,e))}function Di(r,e){if(zd(r=Rt(r)))return Rl("Unsupported field value:",e,r),Bd(r,e);if(r instanceof Il)return function(n,i){if(!Fd(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const a of n){let l=Di(a,i.Ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Rt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return my(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=it.fromDate(n);return{timestampValue:Os(i.serializer,s)}}if(n instanceof it){const s=new it(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Os(i.serializer,s)}}if(n instanceof Nl)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof br)return{bytesValue:ld(i.serializer,n._byteString)};if(n instanceof _t){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ul(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Pl)return function(o,a){return{mapValue:{fields:{[Df]:{stringValue:Vf},[Ss]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Wu("VectorValues must only contain numeric values.");return al(a.serializer,u)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${ao(n)}`)}(r,e)}function Bd(r,e){const t={};return Pf(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):In(r,(n,i)=>{const s=Di(i,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function zd(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof it||r instanceof Nl||r instanceof br||r instanceof _t||r instanceof Il||r instanceof Pl)}function Rl(r,e,t){if(!zd(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=ao(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function ja(r,e,t){if((e=Rt(e))instanceof ji)return e._internalPath;if(typeof e=="string")return jl(r,e);throw Ds("Field path arguments must be of type string or ",r,!1,void 0,t)}const Sv=new RegExp("[~\\*/\\[\\]]");function jl(r,e,t){if(e.search(Sv)>=0)throw Ds(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new ji(...e.split("."))._internalPath}catch{throw Ds(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Ds(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${i}`),l+=")"),new he(ne.INVALID_ARGUMENT,a+r+l)}function Hd(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Iv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ll("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Iv extends Gd{data(){return super.data()}}function Ll(r,e){return typeof e=="string"?jl(r,e):e instanceof ji?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kd(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new he(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dl{}class Wd extends Dl{}function uo(r,e,...t){let n=[];e instanceof Dl&&n.push(e),n=n.concat(t),function(s){const o=s.filter(l=>l instanceof Vl).length,a=s.filter(l=>l instanceof Ml).length;if(o>1||o>0&&a>0)throw new he(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Ml extends Wd{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ml(e,t,n)}_apply(e){const t=this._parse(e);return Qd(e._query,t),new Pn(e.firestore,e.converter,Ea(e._query,t))}_parse(e){const t=Li(e.firestore);return function(s,o,a,l,u,h,d){let f;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new he(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ih(d,h);const _=[];for(const g of d)_.push(rh(l,s,g));f={arrayValue:{values:_}}}else f=rh(l,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ih(d,h),f=kv(a,o,d,h==="in"||h==="not-in");return tt.create(u,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Vl extends Dl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vl(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:$t.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Qd(o,l),o=Ea(o,l)}(e._query,t),new Pn(e.firestore,e.converter,Ea(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $l extends Wd{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $l(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ei(s,o)}(e._query,this._field,this._direction);return new Pn(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function ho(r,e="asc"){const t=e,n=Ll("orderBy",r);return $l._create(n,t)}function rh(r,e,t){if(typeof(t=Rt(t))=="string"){if(t==="")throw new he(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Gf(e)&&t.indexOf("/")!==-1)throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(He.fromString(t));if(!pe.isDocumentKey(n))throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return vu(r,new pe(n))}if(t instanceof _t)return vu(r,t._key);throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ao(t)}.`)}function ih(r,e){if(!Array.isArray(r)||r.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Qd(r,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Nv{convertValue(e,t="none"){switch(An(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ge()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return In(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Ss].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Je(o.doubleValue));return new Pl(s)}convertGeoPoint(e){return new Nl(Je(e.latitude),Je(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ys(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(bi(e));default:return null}}convertTimestamp(e){const t=En(e);return new it(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=He.fromString(e);Me(pd(n));const i=new wi(n.get(1),n.get(3)),s=new pe(n.popFirst(5));return i.isEqual(t)||an(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fl(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Yd extends Gd{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Es(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ll("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Es extends Yd{data(e={}){return super.data(e)}}class Jd{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ci(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Es(this._firestore,this._userDataWriter,n.key,n,new ci(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Pv(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Pv(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(r){r=Et(r,_t);const e=Et(r.firestore,Qt);return yv(Ri(e),r._key).then(t=>Xd(e,r,t))}class ql extends Nv{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}function Mi(r){r=Et(r,Pn);const e=Et(r.firestore,Qt),t=Ri(e),n=new ql(e);return Kd(r._query),vv(t,r._query).then(i=>new Jd(e,n,r,i))}function La(r,e,t){r=Et(r,_t);const n=Et(r.firestore,Qt),i=Fl(r.converter,e,t);return Vi(n,[Cl(Li(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,xt.none())])}function Ms(r,e,t,...n){r=Et(r,_t);const i=Et(r.firestore,Qt),s=Li(i);let o;return o=typeof(e=Rt(e))=="string"||e instanceof ji?Ud(s,"updateDoc",r._key,e,t,n):qd(s,"updateDoc",r._key,e),Vi(i,[o.toMutation(r._key,xt.exists(!0))])}function Ul(r){return Vi(Et(r.firestore,Qt),[new no(r._key,xt.none())])}function Bl(r,e){const t=Et(r.firestore,Qt),n=rt(r),i=Fl(r.converter,e);return Vi(t,[Cl(Li(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,xt.exists(!1))]).then(()=>n)}function zl(r,...e){var t,n,i;r=Rt(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||nh(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(nh(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,u,h;if(r instanceof _t)u=Et(r.firestore,Qt),h=Js(r._key.path),l={next:d=>{e[o]&&e[o](Xd(u,r,d))},error:e[o+1],complete:e[o+2]};else{const d=Et(r,Pn);u=Et(d.firestore,Qt),h=d._query;const f=new ql(u);l={next:p=>{e[o]&&e[o](new Jd(u,f,d,p))},error:e[o+1],complete:e[o+2]},Kd(r._query)}return function(f,p,_,g){const y=new Sl(g),m=new Tl(p,y,_);return f.asyncQueue.enqueueAndForget(async()=>wl(await Ls(f),m)),()=>{y.su(),f.asyncQueue.enqueueAndForget(async()=>xl(await Ls(f),m))}}(Ri(u),h,a,l)}function Vi(r,e){return function(n,i){const s=new sn;return n.asyncQueue.enqueueAndForget(async()=>sv(await gv(n),i,s)),s.promise}(Ri(r),e)}function Xd(r,e,t){const n=t.docs.get(e._key),i=new ql(r);return new Yd(r,i,e._key,n,new ci(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Li(e)}set(e,t,n){this._verifyNotCommitted();const i=Qo(e,this._firestore),s=Fl(i.converter,t,n),o=Cl(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,xt.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Qo(e,this._firestore);let o;return o=typeof(t=Rt(t))=="string"||t instanceof ji?Ud(this._dataReader,"WriteBatch.update",s._key,t,n,i):qd(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,xt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Qo(e,this._firestore);return this._mutations=this._mutations.concat(new no(t._key,xt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Qo(r,e){if((r=Rt(r)).firestore!==e)throw new he(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(r){return Ri(r=Et(r,Qt)),new Cv(r,e=>Vi(r,e))}(function(e,t=!0){(function(i){Ar=i})(mg),og(new ag("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),a=new Qt(new Pg(n.getProvider("auth-internal")),new Rg(o,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new he(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wi(u.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ru(ou,au,e),ru(ou,au,"esm2017")})();const Rv={apiKey:"AIzaSyAsGrtbRSjz77iShv4tB0vQ33A23ie9JM8",authDomain:"tiger3homs-f3a5f-d60da.firebaseapp.com",projectId:"tiger3homs-f3a5f-d60da",storageBucket:"tiger3homs-f3a5f-d60da.firebasestorage.app",messagingSenderId:"509990310606",appId:"1:509990310606:web:e36d91ea748c4cd64d369f",measurementId:"G-DDZTZ6MR6S"};let Yo=null,Mt=null,de=null;try{Yo=vg(Rv),Mt=_g(Yo),de=wv(Yo)}catch(r){throw console.error("Firebase initialization error:",r),new Error(`Firebase initialization failed: ${r instanceof Error?r.message:String(r)}`)}if(!de)throw new Error("Firestore failed to initialize and is null.");const jv=()=>{Y.useEffect(()=>{if(!de){console.error("useGlobalStyles: Firestore not initialized correctly.");return}const r=rt(de,"settings","styles"),e=zl(r,t=>{if(t.exists()){const n=t.data();document.documentElement.style.setProperty("--color-primary",n.primaryColor),document.documentElement.style.setProperty("--color-secondary",n.secondaryColor),document.documentElement.style.setProperty("--font-family",n.fontFamily),document.documentElement.style.setProperty("--color-text",n.textColor||"#c6d3e2"),document.documentElement.style.setProperty("--title-color",n.titleColor||n.primaryColor||"#FFFFFF"),document.documentElement.style.setProperty("--h3-title-color",n.h3TitleColor||n.textColor||"#E5E7EB"),document.documentElement.style.setProperty("--color-background",n.backgroundFromColor||"#111827"),document.documentElement.style.setProperty("--color-background-secondary",n.backgroundToColor||"#1F2937"),document.documentElement.style.setProperty("--section-bg-color",n.sectionBgColor||"#374151")}},t=>{console.error("useGlobalStyles: Error listening to global styles:",t)});return()=>{e()}},[])},Lv=()=>{const[r,e]=Y.useState([]),[t,n]=Y.useState(!0),[i,s]=Y.useState(null);return Y.useEffect(()=>{if(n(!0),s(null),!de){console.error("useDynamicPages: Firestore not initialized correctly."),s(new Error("Firestore not initialized correctly.")),n(!1);return}(async()=>{if(!de){console.error("useDynamicPages: Firestore not initialized inside fetchPages."),s(new Error("Firestore not initialized.")),n(!1);return}try{const a=_r(de,"pages"),l=uo(a,ho("order","asc")),h=(await Mi(l)).docs.map(d=>({id:d.id,...d.data()}));e(h)}catch(a){console.error("useDynamicPages: Error fetching dynamic pages:",a),s(a instanceof Error?a:new Error("An unknown error occurred"))}finally{n(!1)}})()},[]),{dynamicPages:r,loadingPages:t,errorPages:i}},Dv=({message:r,type:e})=>{if(!r||!e)return null;const t=e==="success"?"bg-green-500":"bg-red-500",n=e==="success"?N.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):N.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});return N.jsxs("div",{className:`fixed bottom-5 right-5 ${t} text-white px-4 py-2 rounded-md shadow-lg flex items-center z-[100] transition-opacity duration-300 animate-fade-in-out max-w-sm`,children:[n,N.jsx("span",{children:r})]})},Mv=({isOpen:r,message:e,onConfirm:t,onCancel:n,confirmText:i="Confirm",cancelText:s="Cancel",title:o="Confirm Action"})=>r?N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:N.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full",children:[N.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:o}),N.jsx("p",{className:"text-sm text-gray-600 mb-6 whitespace-pre-wrap",children:e}),N.jsxs("div",{className:"flex justify-end space-x-3",children:[N.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm",children:s}),N.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:i})]})]})}):null,ep=Y.createContext(void 0),Yt=()=>{const r=Y.useContext(ep);if(!r)throw new Error("useNotifications must be used within a NotificationProvider");return r},tp=({children:r})=>{const[e,t]=Y.useState(null),[n,i]=Y.useState(null),s=Y.useRef(null),[o,a]=Y.useState(null),[l,u]=Y.useState(!1),h=Y.useCallback((g,y="success",m=3e3)=>{s.current&&clearTimeout(s.current),t(g),i(y),s.current=setTimeout(()=>{t(null),i(null),s.current=null},m)},[]);Y.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]);const d=Y.useCallback(g=>{a(g),u(!0)},[]),f=()=>{o!=null&&o.onConfirm&&o.onConfirm(),u(!1),a(null)},p=()=>{u(!1),a(null)},_={showToast:h,requestConfirmation:d};return N.jsxs(ep.Provider,{value:_,children:[r,N.jsx(Dv,{message:e,type:n}),o&&N.jsx(Mv,{isOpen:l,message:o.message,onConfirm:f,onCancel:p,confirmText:o.confirmText||"Confirm Delete",cancelText:o.cancelText,title:o.title})]})},Vv=({children:r})=>{const[e,t]=Y.useState(null),[n,i]=Y.useState(!0);return Y.useEffect(()=>{if(!Mt){console.error("ProtectedRoute: Firebase auth is not initialized."),i(!1);return}const s=gf(Mt,o=>{t(o),i(!1)});return()=>s()},[]),n?N.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:N.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):e?N.jsx(N.Fragment,{children:r}):N.jsx(pf,{to:"/admin/login",replace:!0})},$v=()=>{const[r,e]=Y.useState(!1),t=()=>{window.pageYOffset>300?e(!0):e(!1)};Y.useEffect(()=>(window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}),[]);const n=()=>{window.scrollTo({top:0,behavior:"smooth"})};return N.jsx("button",{type:"button",onClick:n,className:`fixed bottom-5 right-5 p-3 rounded-full bg-primary text-text shadow-lg transition-opacity duration-300 hover:bg-gradient-to-br from-background to-background-secondary ${r?"opacity-100":"opacity-0 pointer-events-none"}`,"aria-label":"Scroll to top",children:N.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})})},Fv=r=>{const t=/[A-Z]/.test(r),n=/[a-z]/.test(r),i=/\d/.test(r),s=/[!@#$%^&*(),.?":{}|<>]/.test(r);return r.length>=8&&t&&n&&i&&s},qv=()=>{const[r,e]=Y.useState(""),[t,n]=Y.useState(""),[i,s]=Y.useState(""),[o,a]=Y.useState(!1),l=mf();Y.useEffect(()=>{const h=setTimeout(()=>{Mt&&Mt.signOut()},18e5);return()=>clearTimeout(h)},[]),Y.useEffect(()=>{if(!Mt)return;const h=gf(Mt,d=>{d&&l("/admin/dashboard",{replace:!0})});return()=>h()},[l]);const u=async h=>{if(h.preventDefault(),s(""),a(!0),!r.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){s("Please enter a valid email address"),a(!1);return}if(!Fv(t)){s("Password must be at least 8 characters long and contain uppercase, lowercase, numbers, and special characters"),a(!1);return}if(!Mt){s("Authentication service is not available."),a(!1);return}try{await bg(Mt,r,t)}catch(d){let f="Failed to log in. Please check your credentials.";if(d.code)switch(d.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":f="Invalid email or password.";break;case"auth/invalid-email":f="Invalid email format.";break;case"auth/too-many-requests":f="Too many failed attempts. Please try again later.";break;default:console.error("Firebase Login error:",d)}s(f)}finally{a(!1)}};return N.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:N.jsxs("div",{className:"p-8 bg-white rounded shadow-md w-full max-w-sm",children:[N.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Admin Login"}),N.jsxs("form",{onSubmit:u,children:[N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),N.jsx("input",{type:"email",id:"email",value:r,onChange:h=>e(h.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"password",children:"Password"}),N.jsx("input",{type:"password",id:"password",value:t,onChange:h=>n(h.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),i&&N.jsx("p",{className:"text-red-500 text-xs italic mb-4",children:i}),N.jsx("div",{className:"flex items-center justify-between",children:N.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full disabled:opacity-50",disabled:o,children:o?"Logging in...":"Login"})})]})]})})};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Bv=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),sh=r=>{const e=Bv(r);return e.charAt(0).toUpperCase()+e.slice(1)},np=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=Y.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>Y.createElement("svg",{ref:l,...zv,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:np("lucide",i),...a},[...o.map(([u,h])=>Y.createElement(u,h)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=(r,e)=>{const t=Y.forwardRef(({className:n,...i},s)=>Y.createElement(Hv,{ref:s,iconNode:e,className:np(`lucide-${Uv(sh(r))}`,`lucide-${r}`,n),...i}));return t.displayName=sh(r),t};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Da=Ce("arrow-down",Gv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Ma=Ce("arrow-up",Kv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Qv=Ce("briefcase",Wv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Hl=Ce("chevron-down",Yv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],rp=Ce("chevron-up",Jv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Gl=Ce("circle-help",Xv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],e_=Ce("circle-plus",Zv);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],n_=Ce("circle-x",t_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],i_=Ce("copy",r_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],o_=Ce("eye",s_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],ip=Ce("facebook",a_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l_=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],c_=Ce("file-pen",l_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],sp=Ce("file-text",u_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h_=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],op=Ce("github",h_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],d_=Ce("image",f_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],ap=Ce("instagram",p_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m_=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],g_=Ce("layout-dashboard",m_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],v_=Ce("link-2",y_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],lp=Ce("linkedin",__);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],w_=Ce("log-out",b_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x_=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],cp=Ce("mail",x_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],T_=Ce("maximize-2",E_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],oh=Ce("menu",A_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],S_=Ce("message-square",k_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],N_=Ce("minimize-2",I_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],up=Ce("palette",P_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],C_=Ce("refresh-cw",O_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Va=Ce("save",R_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L_=Ce("settings",j_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ki=Ce("square-pen",D_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],V_=Ce("star",M_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wr=Ce("trash-2",$_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],hp=Ce("twitter",F_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],U_=Ce("type",q_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],z_=Ce("user",B_);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],G_=Ce("wand-sparkles",H_),Ot={en:{generalInfo:{title:"General Information",siteTitle:"Tiger3Homs",siteRole:"Website Developer & Tech Enthusiast",logoUrl:"https://raw.githubusercontent.com/tiger3homs/home/refs/heads/main/public/logo.png",footerText:" 2025. Built and designed by Tiger3homs"},about:{title:"About Me",description:"I'm a passionate software developer with expertise in web development and system architecture. I love building efficient, scalable solutions and contributing to open-source projects. When I'm not coding, you can find me exploring new technologies and sharing knowledge with the developer community."},projects:{title:"Featured Projects",project1:{title:"OS Design v1",description:"The website offers a sleek, intuitive design with straightforward navigation and professional fonts. It highlights the company's services and expertise, making it easy for visitors to get in touch. Simple visuals and effective calls-to-action ensure a smooth and engaging experience. For more information, explore the site.",tags:["Modern","User-friendly","Professional"],link:""},project2:{title:"Project 2",description:"Coming soon.",tags:["Wait","For","It"],link:""},project3:{title:"New Project",description:"This is a new project description.",tags:["New","Exciting","Innovative"],link:""}},contact:{title:"Contact Me",nameLabel:"Name",namePlaceholder:"Enter your name",emailLabel:"Email",emailPlaceholder:"Enter your email",messageLabel:"Message",messagePlaceholder:"Enter your message",submitButton:"Send Message"},services:{title:"Services",list:[{title:"Web Development",description:"Building modern, responsive websites tailored to your needs."},{title:"UI/UX Design",description:"Crafting user-friendly and visually appealing designs."},{title:"SEO Optimization",description:"Improving your website's visibility on search engines."},{title:"Consulting",description:"Providing expert advice to help you achieve your goals."}]}}},K_={title:"New Project Title",description:"New project description.",tags:["Tag1","Tag2"],link:""},W_=(r,e,t)=>{if(!e||e.length===0)return r;const n=typeof structuredClone=="function"?structuredClone(r):JSON.parse(JSON.stringify(r));let i=n;for(let o=0;o<e.length-1;o++){const a=e[o];if(i[a]===void 0||i[a]===null){const l=typeof e[o+1]=="number";i[a]=l?[]:{}}if(Array.isArray(i)&&typeof a=="number")for(;i.length<=a;)i.push(void 0);else if(typeof i!="object"||i===null)return console.error("Cannot traverse into non-object:",i,"at path segment",a),r;i=i[a]}const s=e[e.length-1];if(typeof i!="object"||i===null)return console.error("Cannot set property on non-object/array:",i,"at path",e),r;if(Array.isArray(i)&&typeof s=="number")for(;i.length<=s;)i.push(void 0);return i[s]=t,n},Vs=r=>r?r.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()):"",ti="translations/en",Q_={title:"New Service Title",description:"New service description."},Y_=()=>{const[r,e]=Y.useState(Ot),[t,n]=Y.useState(!0),[i,s]=Y.useState(""),{showToast:o}=Yt();Y.useEffect(()=>{if(!de){console.error("Firestore instance is not available."),s("Error: Firestore connection failed."),n(!1);return}const p=rt(de,ti);n(!0);const _=zl(p,g=>{if(g.exists()){const y=g.data();e(m=>({...m,en:y}))}else e(Ot),console.log("No translations document found in Firestore, using defaults.");n(!1)},g=>{console.error("Firestore snapshot error:",g),s("Error fetching data from Firestore."),n(!1)});return()=>_()},[]);const a=Y.useCallback((p,_)=>{e(g=>{const y="en";if(!p||p.length===0)return g;const m=W_(g[y],p,_);return{...g,[y]:m}}),s("")},[]),l=Y.useCallback(()=>{e(p=>{const _=`project_${Date.now()}`,g={...p.en};return(typeof g.projects!="object"||g.projects===null)&&(g.projects={title:Ot.en.projects.title}),g.projects[_]={...K_},{...p,en:g}}),s("New project added. Edit details and save.")},[]),u=Y.useCallback(()=>{e(p=>{var b;const _=(b=p.en)==null?void 0:b.services,y=[...Array.isArray(_==null?void 0:_.list)?_.list:[],{...Q_}],m={...p.en,services:{..._||{title:Ot.en.services.title||"Services",list:[]},list:y}};return{...p,en:m}}),s("New service added. Edit details and save.")},[]),h=async p=>{const _=p||r.en;if(!de){s("Error: Firestore connection failed.");return}s("Saving...");try{const g=rt(de,ti);await La(g,_,{merge:!0}),o("Content changes saved successfully!","success"),s("")}catch(g){console.error("Failed to save translations to Firestore:",g),o("Error saving content changes.","error"),s("")}finally{}},d=Y.useCallback(async p=>{var _;if(!p||p.length<1){console.error("Invalid path for deletion:",p),o("Error: Invalid deletion path.","error");return}if(p[0]==="services"&&p[1]==="list"&&typeof p[2]=="number"){const g=p[2],y=(_=r.en.services)==null?void 0:_.list;if(!Array.isArray(y)){console.error("Cannot delete service item: services.list is not an array or is missing.",y),o("Error: Services data structure issue.","error");return}const m=y.filter((k,v)=>v!==g);if(e(k=>({...k,en:{...k.en,services:{...k.en.services||{title:"",list:[]},list:m}}})),!de){o("Error: Firestore connection failed.","error");return}const b=rt(de,ti);try{s("Deleting service item..."),await Ms(b,{"services.list":m}),o("Service item deleted.","success")}catch(k){console.error("Failed to update services list in Firestore:",k),o("Error deleting service item.","error")}finally{s("")}}else if(p[0]==="projects"&&p.length===2){const g=p[1],y=p.join(".");if(typeof g!="string"||!y){console.error("Invalid project path for deletion:",p),o("Error: Could not determine project to delete.","error");return}if(e(b=>{const k={...b.en.projects};return delete k[g],{...b,en:{...b.en,projects:k}}}),!de){o("Error: Firestore connection failed.","error");return}const m=rt(de,ti);try{s("Deleting project item...");const k={...r.en.projects};k.hasOwnProperty(g)?delete k[g]:console.warn(`Attempted to delete non-existent project key: ${g}`),await Ms(m,{projects:k}),o("Project item deleted.","success")}catch(b){console.error("Failed to delete project item from Firestore:",b),o("Error deleting project item.","error"),console.error("Firestore delete failed, local state might be inconsistent until next snapshot/refresh.")}finally{s("")}}else console.error("Unhandled deletion path:",p),o("Error: Deletion logic not implemented for this path.","error")},[r,o]);return{translations:r,isLoading:t,saveStatus:i,setSaveStatus:s,setTranslations:e,handleInputChange:a,handleAddNewProject:l,handleAddNewService:u,saveChanges:h,handleDeleteItem:d,resetToDefaults:async()=>{if(!de){s("Error: Firestore connection failed.");return}if(window.confirm("Are you sure you want to reset the English text content (About, Contact, Services, General Info) to the default values? This cannot be undone and does not affect Projects, Styles, or Social Links.")){s("Resetting...");const p={...Ot.en,projects:r.en.projects};try{const _=rt(de,ti);await La(_,p),o("Text content sections reset to defaults.","success"),s("")}catch(_){console.error("Failed to reset translations in Firestore:",_),o("Error resetting content.","error"),s("")}}}}},J_=({onToggleMobileSidebar:r,onToggleDesktopSidebar:e,onLogout:t})=>{const[n,i]=Y.useState(!1);return N.jsx("nav",{className:"bg-white shadow-md fixed w-full z-10",children:N.jsxs("div",{className:"px-4 h-16 flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center space-x-4",children:[N.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 md:hidden","aria-label":"Toggle sidebar",children:N.jsx(oh,{size:24})}),N.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 hidden md:block","aria-label":"Toggle sidebar",children:N.jsx(oh,{size:24})})]}),N.jsx("div",{className:"flex items-center space-x-4",children:N.jsxs("div",{className:"relative",children:[N.jsxs("button",{onClick:()=>i(!n),className:"flex items-center space-x-2 text-gray-700 hover:text-gray-900","aria-expanded":n,"aria-haspopup":"true",children:[N.jsx(z_,{size:20}),N.jsx("span",{children:"Admin"}),N.jsx(Hl,{size:16})]}),n&&N.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 border border-gray-200",children:N.jsxs("button",{onClick:()=>{t(),i(!1)},className:"w-full px-4 py-2 text-left text-red-600 hover:bg-gray-50 flex items-center space-x-2",children:[N.jsx(w_,{size:16}),N.jsx("span",{children:"Logout"})]})})]})})]})})},X_=({isMobile:r,isSidebarOpen:e,isDesktopSidebarCollapsed:t,activeTab:n,navItems:i,onTabClick:s,onCloseMobileSidebar:o})=>N.jsxs(N.Fragment,{children:[r&&e&&N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 md:hidden",onClick:o,"aria-hidden":"true"}),N.jsx("aside",{className:`fixed top-16 h-[calc(100vh-4rem)] bg-gray-800 text-white transition-transform duration-300 ease-in-out z-30 md:translate-x-0 md:transition-all md:duration-300
          ${r?e?"translate-x-0 w-64":"-translate-x-full w-64":t?"w-20":"w-64"}
        `,"aria-label":"Main Navigation",children:N.jsx("nav",{className:"p-4 overflow-y-auto h-full",children:i.map(a=>N.jsxs("button",{onClick:()=>s(a.tab),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${n===a.tab?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,"aria-current":n===a.tab?"page":void 0,children:[a.icon,N.jsx("span",{className:`${r&&e||!r&&!t?"inline":"hidden"}`,children:a.label})]},a.tab))})})]}),Z_=({data:r,path:e,handleChange:t,handleAddProject:n,handleDelete:i})=>{const{requestConfirmation:s}=Yt(),[o,a]=Y.useState({});if(!r||typeof r!="object")return N.jsx("p",{className:"text-red-500",children:"Error: Projects data is missing or invalid."});const l=[...e,"title"],u=Object.entries(r).filter(([m,b])=>m!=="title"&&typeof b=="object"&&b!==null),h=m=>{a(b=>({...b,[m]:!b[m]}))},[d,f]=Y.useState({}),p=(m,b,k)=>{const v=(d[m]||"").trim();v&&!k.includes(v)?(t(b,[...k,v]),f(O=>({...O,[m]:""}))):v||f(O=>({...O,[m]:""}))},_=(m,b,k)=>{t(m,b.filter(v=>v!==k))},g=(m,b)=>{b.endsWith(",")?f(k=>({...k,[m]:b.slice(0,-1)})):f(k=>({...k,[m]:b}))},y=(m,b,k,v)=>{(m.key==="Enter"||m.key===",")&&(m.preventDefault(),p(b,k,v))};return N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:"projects-section-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Section Title"}),N.jsx("input",{id:"projects-section-title",type:"text",value:typeof r.title=="string"?r.title:"",onChange:m=>t(l,m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter the title for the projects section"})]}),N.jsx("div",{className:"flex justify-end",children:N.jsxs("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex items-center gap-2","aria-label":"Add new project item",children:[N.jsx(ki,{size:16})," Add New Project"]})}),N.jsxs("div",{className:"space-y-3",children:[N.jsxs("h3",{className:"text-lg font-medium text-gray-800 border-b pb-2 mb-3",children:["Project Items (",u.length,")"]}),u.length===0?N.jsx("p",{className:"text-gray-500 italic",children:'No projects added yet. Click "Add New Project" to begin.'}):u.map(([m,b])=>{const k=[...e,m],v=[...k,"title"],O=[...k,"description"],R=[...k,"tags"],x=[...k,"link"],w=o[m]||!1,P=(b==null?void 0:b.title)||"",T=(b==null?void 0:b.description)||"",A=Array.isArray(b==null?void 0:b.tags)?b.tags:[],S=(b==null?void 0:b.link)||"";return N.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[N.jsxs("div",{className:"flex items-center p-3 cursor-pointer hover:bg-gray-100 relative group",onClick:()=>h(m),role:"button",tabIndex:0,onKeyDown:E=>{(E.key==="Enter"||E.key===" ")&&h(m)},"aria-expanded":w,"aria-controls":`project-content-${m}`,children:[N.jsx("div",{className:"mr-3 text-gray-500",children:w?N.jsx(rp,{size:18}):N.jsx(Hl,{size:18})}),N.jsxs("div",{className:"flex-grow mr-2 font-medium text-gray-700 truncate",children:[P||`Project: ${m}`," "]}),N.jsx("button",{onClick:E=>{E.stopPropagation(),s({message:`Are you sure you want to delete project "${P||m}"?
This action cannot be undone.`,onConfirm:()=>i(k),confirmText:"Delete Project",title:"Confirm Deletion"})},className:"p-1 text-gray-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity focus:outline-none focus:ring-1 focus:ring-red-500 rounded-full z-10","aria-label":`Delete project ${P||m}`,children:N.jsx(wr,{size:18})})]}),w&&N.jsxs("div",{id:`project-content-${m}`,className:"p-4 border-t border-gray-200 bg-white space-y-4",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:`project-title-${m}`,className:"block text-sm font-medium text-gray-600 mb-1",children:"Project Title"}),N.jsx("input",{id:`project-title-${m}`,type:"text",value:P,onChange:E=>t(v,E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter project title"})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:`project-description-${m}`,className:"block text-sm font-medium text-gray-600 mb-1",children:"Description"}),N.jsx("textarea",{id:`project-description-${m}`,value:T,onChange:E=>t(O,E.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter project description"})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:`project-tags-input-${m}`,className:"block text-sm font-medium text-gray-600 mb-1",children:"Tags (add with Enter or comma)"}),N.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-md bg-white",children:[A.map((E,j)=>N.jsxs("span",{className:"flex items-center bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:[E,N.jsx("button",{type:"button",onClick:()=>_(R,A,E),className:"ml-1.5 text-blue-600 hover:text-blue-800 focus:outline-none","aria-label":`Remove tag ${E}`,children:" "})]},j)),N.jsx("input",{id:`project-tags-input-${m}`,type:"text",value:d[m]||"",onChange:E=>g(m,E.target.value),onKeyDown:E=>y(E,m,R,A),className:"flex-grow px-1 py-0.5 border-none focus:ring-0 focus:outline-none text-sm",placeholder:A.length===0?"e.g., react, typescript":"Add tag..."})]})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:`project-link-${m}`,className:"block text-sm font-medium text-gray-600 mb-1",children:"Project Link (URL)"}),N.jsx("input",{id:`project-link-${m}`,type:"url",value:S,onChange:E=>t(x,E.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"https://example.com"})]})]})]},m)})]})]})},eb=({data:r,path:e,handleChange:t,handleDelete:n,handleAddService:i})=>{const{requestConfirmation:s}=Yt(),[o,a]=Y.useState({});if(!r||typeof r!="object")return N.jsx("p",{className:"text-red-500",children:"Error: Services data is missing or invalid."});const l=Array.isArray(r.list)?r.list:[],u=[...e,"title"],h=d=>{a(f=>({...f,[d]:!f[d]}))};return N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:"services-section-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Section Title"}),N.jsx("input",{id:"services-section-title",type:"text",value:r.title||"",onChange:d=>t(u,d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter the title for the services section"})]}),N.jsx("div",{className:"flex justify-end",children:N.jsxs("button",{onClick:i,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 flex items-center gap-2","aria-label":"Add new service item",children:[N.jsx(ki,{size:16})," Add New Service"]})}),N.jsxs("div",{className:"space-y-3",children:[N.jsxs("h3",{className:"text-lg font-medium text-gray-800 border-b pb-2 mb-3",children:["Service Items (",l.length,")"]}),l.length===0?N.jsx("p",{className:"text-gray-500 italic",children:'No services added yet. Click "Add New Service" to begin.'}):l.map((d,f)=>{const p=[...e,"list",f],_=[...p,"title"],g=[...p,"description"],y=o[f]||!1;return N.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[N.jsxs("div",{className:"flex items-center p-3 cursor-pointer hover:bg-gray-100 relative group",onClick:()=>h(f),role:"button",tabIndex:0,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&h(f)},"aria-expanded":y,"aria-controls":`service-content-${f}`,children:[N.jsx("div",{className:"mr-3 text-gray-500",children:y?N.jsx(rp,{size:18}):N.jsx(Hl,{size:18})}),N.jsxs("div",{className:"flex-grow mr-2",children:[N.jsxs("label",{htmlFor:`service-title-${f}`,className:"sr-only",children:["Service Title #",f+1]}),N.jsx("input",{id:`service-title-${f}`,type:"text",value:d.title||"",onChange:m=>{m.stopPropagation(),t(_,m.target.value)},onClick:m=>m.stopPropagation(),className:"w-full px-2 py-1 border border-transparent rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 bg-transparent hover:border-gray-300 focus:bg-white",placeholder:`Service Title #${f+1}`})]}),N.jsx("button",{onClick:m=>{m.stopPropagation(),s({message:`Are you sure you want to delete service "${d.title||`Item #${f+1}`}"?
This action cannot be undone.`,onConfirm:()=>n([...e,"list",f]),confirmText:"Delete Service",title:"Confirm Deletion"})},className:"p-1 text-gray-400 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-opacity focus:outline-none focus:ring-1 focus:ring-red-500 rounded-full z-10","aria-label":`Delete service ${f+1}`,children:N.jsx(wr,{size:18})})]}),y&&N.jsxs("div",{id:`service-content-${f}`,className:"p-4 border-t border-gray-200 bg-white",children:[N.jsx("label",{htmlFor:`service-description-${f}`,className:"block text-sm font-medium text-gray-600 mb-1",children:"Description"}),N.jsx("textarea",{id:`service-description-${f}`,value:d.description||"",onChange:m=>t(g,m.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter service description"})]})]},f)})]})]})},{min:tb,max:nb}=Math,Bn=(r,e=0,t=1)=>tb(nb(e,r),t),Kl=r=>{r._clipped=!1,r._unclipped=r.slice(0);for(let e=0;e<=3;e++)e<3?((r[e]<0||r[e]>255)&&(r._clipped=!0),r[e]=Bn(r[e],0,255)):e===3&&(r[e]=Bn(r[e],0,1));return r},fp={};for(let r of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])fp[`[object ${r}]`]=r.toLowerCase();function Ne(r){return fp[Object.prototype.toString.call(r)]||"object"}const Ee=(r,e=null)=>r.length>=3?Array.prototype.slice.call(r):Ne(r[0])=="object"&&e?e.split("").filter(t=>r[0][t]!==void 0).map(t=>r[0][t]):r[0].slice(0),Pr=r=>{if(r.length<2)return null;const e=r.length-1;return Ne(r[e])=="string"?r[e].toLowerCase():null},{PI:fo,min:dp,max:pp}=Math,Ct=r=>Math.round(r*100)/100,$a=r=>Math.round(r*100)/100,tn=fo*2,Jo=fo/3,rb=fo/180,ib=180/fo;function mp(r){return[...r.slice(0,3).reverse(),...r.slice(3)]}const be={format:{},autodetect:[]};class oe{constructor(...e){const t=this;if(Ne(e[0])==="object"&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];let n=Pr(e),i=!1;if(!n){i=!0,be.sorted||(be.autodetect=be.autodetect.sort((s,o)=>o.p-s.p),be.sorted=!0);for(let s of be.autodetect)if(n=s.test(...e),n)break}if(be.format[n]){const s=be.format[n].apply(null,i?e:e.slice(0,-1));t._rgb=Kl(s)}else throw new Error("unknown format: "+e);t._rgb.length===3&&t._rgb.push(1)}toString(){return Ne(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const sb="3.1.2",Ae=(...r)=>new oe(...r);Ae.version=sb;const xr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},ob=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,ab=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,gp=r=>{if(r.match(ob)){(r.length===4||r.length===7)&&(r=r.substr(1)),r.length===3&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]);const e=parseInt(r,16),t=e>>16,n=e>>8&255,i=e&255;return[t,n,i,1]}if(r.match(ab)){(r.length===5||r.length===9)&&(r=r.substr(1)),r.length===4&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]);const e=parseInt(r,16),t=e>>24&255,n=e>>16&255,i=e>>8&255,s=Math.round((e&255)/255*100)/100;return[t,n,i,s]}throw new Error(`unknown hex color: ${r}`)},{round:ls}=Math,yp=(...r)=>{let[e,t,n,i]=Ee(r,"rgba"),s=Pr(r)||"auto";i===void 0&&(i=1),s==="auto"&&(s=i<1?"rgba":"rgb"),e=ls(e),t=ls(t),n=ls(n);let a="000000"+(e<<16|t<<8|n).toString(16);a=a.substr(a.length-6);let l="0"+ls(i*255).toString(16);switch(l=l.substr(l.length-2),s.toLowerCase()){case"rgba":return`#${a}${l}`;case"argb":return`#${l}${a}`;default:return`#${a}`}};oe.prototype.name=function(){const r=yp(this._rgb,"rgb");for(let e of Object.keys(xr))if(xr[e]===r)return e.toLowerCase();return r};be.format.named=r=>{if(r=r.toLowerCase(),xr[r])return gp(xr[r]);throw new Error("unknown color name: "+r)};be.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&xr[r.toLowerCase()])return"named"}});oe.prototype.alpha=function(r,e=!1){return r!==void 0&&Ne(r)==="number"?e?(this._rgb[3]=r,this):new oe([this._rgb[0],this._rgb[1],this._rgb[2],r],"rgb"):this._rgb[3]};oe.prototype.clipped=function(){return this._rgb._clipped||!1};const Kt={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},lb=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function rn(r){const e=lb.get(String(r).toLowerCase());if(!e)throw new Error("unknown Lab illuminant "+r);Kt.labWhitePoint=r,Kt.Xn=e[0],Kt.Zn=e[1]}function Si(){return Kt.labWhitePoint}const Wl=(...r)=>{r=Ee(r,"lab");const[e,t,n]=r,[i,s,o]=cb(e,t,n),[a,l,u]=vp(i,s,o);return[a,l,u,r.length>3?r[3]:1]},cb=(r,e,t)=>{const{kE:n,kK:i,kKE:s,Xn:o,Yn:a,Zn:l}=Kt,u=(r+16)/116,h=.002*e+u,d=u-.005*t,f=h*h*h,p=d*d*d,_=f>n?f:(116*h-16)/i,g=r>s?Math.pow((r+16)/116,3):r/i,y=p>n?p:(116*d-16)/i,m=_*o,b=g*a,k=y*l;return[m,b,k]},Xo=r=>{const e=Math.sign(r);return r=Math.abs(r),(r<=.0031308?r*12.92:1.055*Math.pow(r,1/2.4)-.055)*e},vp=(r,e,t)=>{const{MtxAdaptMa:n,MtxAdaptMaI:i,MtxXYZ2RGB:s,RefWhiteRGB:o,Xn:a,Yn:l,Zn:u}=Kt,h=a*n.m00+l*n.m10+u*n.m20,d=a*n.m01+l*n.m11+u*n.m21,f=a*n.m02+l*n.m12+u*n.m22,p=o.X*n.m00+o.Y*n.m10+o.Z*n.m20,_=o.X*n.m01+o.Y*n.m11+o.Z*n.m21,g=o.X*n.m02+o.Y*n.m12+o.Z*n.m22,y=(r*n.m00+e*n.m10+t*n.m20)*(p/h),m=(r*n.m01+e*n.m11+t*n.m21)*(_/d),b=(r*n.m02+e*n.m12+t*n.m22)*(g/f),k=y*i.m00+m*i.m10+b*i.m20,v=y*i.m01+m*i.m11+b*i.m21,O=y*i.m02+m*i.m12+b*i.m22,R=Xo(k*s.m00+v*s.m10+O*s.m20),x=Xo(k*s.m01+v*s.m11+O*s.m21),w=Xo(k*s.m02+v*s.m12+O*s.m22);return[R*255,x*255,w*255]},Ql=(...r)=>{const[e,t,n,...i]=Ee(r,"rgb"),[s,o,a]=_p(e,t,n),[l,u,h]=ub(s,o,a);return[l,u,h,...i.length>0&&i[0]<1?[i[0]]:[]]};function ub(r,e,t){const{Xn:n,Yn:i,Zn:s,kE:o,kK:a}=Kt,l=r/n,u=e/i,h=t/s,d=l>o?Math.pow(l,1/3):(a*l+16)/116,f=u>o?Math.pow(u,1/3):(a*u+16)/116,p=h>o?Math.pow(h,1/3):(a*h+16)/116;return[116*f-16,500*(d-f),200*(f-p)]}function Zo(r){const e=Math.sign(r);return r=Math.abs(r),(r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4))*e}const _p=(r,e,t)=>{r=Zo(r/255),e=Zo(e/255),t=Zo(t/255);const{MtxRGB2XYZ:n,MtxAdaptMa:i,MtxAdaptMaI:s,Xn:o,Yn:a,Zn:l,As:u,Bs:h,Cs:d}=Kt;let f=r*n.m00+e*n.m10+t*n.m20,p=r*n.m01+e*n.m11+t*n.m21,_=r*n.m02+e*n.m12+t*n.m22;const g=o*i.m00+a*i.m10+l*i.m20,y=o*i.m01+a*i.m11+l*i.m21,m=o*i.m02+a*i.m12+l*i.m22;let b=f*i.m00+p*i.m10+_*i.m20,k=f*i.m01+p*i.m11+_*i.m21,v=f*i.m02+p*i.m12+_*i.m22;return b*=g/u,k*=y/h,v*=m/d,f=b*s.m00+k*s.m10+v*s.m20,p=b*s.m01+k*s.m11+v*s.m21,_=b*s.m02+k*s.m12+v*s.m22,[f,p,_]};oe.prototype.lab=function(){return Ql(this._rgb)};const hb=(...r)=>new oe(...r,"lab");Object.assign(Ae,{lab:hb,getLabWhitePoint:Si,setLabWhitePoint:rn});be.format.lab=Wl;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"lab"),Ne(r)==="array"&&r.length===3)return"lab"}});oe.prototype.darken=function(r=1){const e=this,t=e.lab();return t[0]-=Kt.Kn*r,new oe(t,"lab").alpha(e.alpha(),!0)};oe.prototype.brighten=function(r=1){return this.darken(-r)};oe.prototype.darker=oe.prototype.darken;oe.prototype.brighter=oe.prototype.brighten;oe.prototype.get=function(r){const[e,t]=r.split("."),n=this[e]();if(t){const i=e.indexOf(t)-(e.substr(0,2)==="ok"?2:0);if(i>-1)return n[i];throw new Error(`unknown channel ${t} in mode ${e}`)}else return n};const{pow:fb}=Math,db=1e-7,pb=20;oe.prototype.luminance=function(r,e="rgb"){if(r!==void 0&&Ne(r)==="number"){if(r===0)return new oe([0,0,0,this._rgb[3]],"rgb");if(r===1)return new oe([255,255,255,this._rgb[3]],"rgb");let t=this.luminance(),n=pb;const i=(o,a)=>{const l=o.interpolate(a,.5,e),u=l.luminance();return Math.abs(r-u)<db||!n--?l:u>r?i(o,l):i(l,a)},s=(t>r?i(new oe([0,0,0]),this):i(this,new oe([255,255,255]))).rgb();return new oe([...s,this._rgb[3]])}return mb(...this._rgb.slice(0,3))};const mb=(r,e,t)=>(r=ea(r),e=ea(e),t=ea(t),.2126*r+.7152*e+.0722*t),ea=r=>(r/=255,r<=.03928?r/12.92:fb((r+.055)/1.055,2.4)),vt={},Er=(r,e,t=.5,...n)=>{let i=n[0]||"lrgb";if(!vt[i]&&!n.length&&(i=Object.keys(vt)[0]),!vt[i])throw new Error(`interpolation mode ${i} is not defined`);return Ne(r)!=="object"&&(r=new oe(r)),Ne(e)!=="object"&&(e=new oe(e)),vt[i](r,e,t).alpha(r.alpha()+t*(e.alpha()-r.alpha()))};oe.prototype.mix=oe.prototype.interpolate=function(r,e=.5,...t){return Er(this,r,e,...t)};oe.prototype.premultiply=function(r=!1){const e=this._rgb,t=e[3];return r?(this._rgb=[e[0]*t,e[1]*t,e[2]*t,t],this):new oe([e[0]*t,e[1]*t,e[2]*t,t],"rgb")};const{sin:gb,cos:yb}=Math,bp=(...r)=>{let[e,t,n]=Ee(r,"lch");return isNaN(n)&&(n=0),n=n*rb,[e,yb(n)*t,gb(n)*t]},Yl=(...r)=>{r=Ee(r,"lch");const[e,t,n]=r,[i,s,o]=bp(e,t,n),[a,l,u]=Wl(i,s,o);return[a,l,u,r.length>3?r[3]:1]},vb=(...r)=>{const e=mp(Ee(r,"hcl"));return Yl(...e)},{sqrt:_b,atan2:bb,round:wb}=Math,wp=(...r)=>{const[e,t,n]=Ee(r,"lab"),i=_b(t*t+n*n);let s=(bb(n,t)*ib+360)%360;return wb(i*1e4)===0&&(s=Number.NaN),[e,i,s]},Jl=(...r)=>{const[e,t,n,...i]=Ee(r,"rgb"),[s,o,a]=Ql(e,t,n),[l,u,h]=wp(s,o,a);return[l,u,h,...i.length>0&&i[0]<1?[i[0]]:[]]};oe.prototype.lch=function(){return Jl(this._rgb)};oe.prototype.hcl=function(){return mp(Jl(this._rgb))};const xb=(...r)=>new oe(...r,"lch"),Eb=(...r)=>new oe(...r,"hcl");Object.assign(Ae,{lch:xb,hcl:Eb});be.format.lch=Yl;be.format.hcl=vb;["lch","hcl"].forEach(r=>be.autodetect.push({p:2,test:(...e)=>{if(e=Ee(e,r),Ne(e)==="array"&&e.length===3)return r}}));oe.prototype.saturate=function(r=1){const e=this,t=e.lch();return t[1]+=Kt.Kn*r,t[1]<0&&(t[1]=0),new oe(t,"lch").alpha(e.alpha(),!0)};oe.prototype.desaturate=function(r=1){return this.saturate(-r)};oe.prototype.set=function(r,e,t=!1){const[n,i]=r.split("."),s=this[n]();if(i){const o=n.indexOf(i)-(n.substr(0,2)==="ok"?2:0);if(o>-1){if(Ne(e)=="string")switch(e.charAt(0)){case"+":s[o]+=+e;break;case"-":s[o]+=+e;break;case"*":s[o]*=+e.substr(1);break;case"/":s[o]/=+e.substr(1);break;default:s[o]=+e}else if(Ne(e)==="number")s[o]=e;else throw new Error("unsupported value for Color.set");const a=new oe(s,n);return t?(this._rgb=a._rgb,this):a}throw new Error(`unknown channel ${i} in mode ${n}`)}else return s};oe.prototype.tint=function(r=.5,...e){return Er(this,"white",r,...e)};oe.prototype.shade=function(r=.5,...e){return Er(this,"black",r,...e)};const Tb=(r,e,t)=>{const n=r._rgb,i=e._rgb;return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"rgb")};vt.rgb=Tb;const{sqrt:ta,pow:er}=Math,Ab=(r,e,t)=>{const[n,i,s]=r._rgb,[o,a,l]=e._rgb;return new oe(ta(er(n,2)*(1-t)+er(o,2)*t),ta(er(i,2)*(1-t)+er(a,2)*t),ta(er(s,2)*(1-t)+er(l,2)*t),"rgb")};vt.lrgb=Ab;const kb=(r,e,t)=>{const n=r.lab(),i=e.lab();return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"lab")};vt.lab=kb;const Or=(r,e,t,n)=>{let i,s;n==="hsl"?(i=r.hsl(),s=e.hsl()):n==="hsv"?(i=r.hsv(),s=e.hsv()):n==="hcg"?(i=r.hcg(),s=e.hcg()):n==="hsi"?(i=r.hsi(),s=e.hsi()):n==="lch"||n==="hcl"?(n="hcl",i=r.hcl(),s=e.hcl()):n==="oklch"&&(i=r.oklch().reverse(),s=e.oklch().reverse());let o,a,l,u,h,d;(n.substr(0,1)==="h"||n==="oklch")&&([o,l,h]=i,[a,u,d]=s);let f,p,_,g;return!isNaN(o)&&!isNaN(a)?(a>o&&a-o>180?g=a-(o+360):a<o&&o-a>180?g=a+360-o:g=a-o,p=o+t*g):isNaN(o)?isNaN(a)?p=Number.NaN:(p=a,(h==1||h==0)&&n!="hsv"&&(f=u)):(p=o,(d==1||d==0)&&n!="hsv"&&(f=l)),f===void 0&&(f=l+t*(u-l)),_=h+t*(d-h),n==="oklch"?new oe([_,f,p],n):new oe([p,f,_],n)},xp=(r,e,t)=>Or(r,e,t,"lch");vt.lch=xp;vt.hcl=xp;const Sb=r=>{if(Ne(r)=="number"&&r>=0&&r<=16777215){const e=r>>16,t=r>>8&255,n=r&255;return[e,t,n,1]}throw new Error("unknown num color: "+r)},Ib=(...r)=>{const[e,t,n]=Ee(r,"rgb");return(e<<16)+(t<<8)+n};oe.prototype.num=function(){return Ib(this._rgb)};const Nb=(...r)=>new oe(...r,"num");Object.assign(Ae,{num:Nb});be.format.num=Sb;be.autodetect.push({p:5,test:(...r)=>{if(r.length===1&&Ne(r[0])==="number"&&r[0]>=0&&r[0]<=16777215)return"num"}});const Pb=(r,e,t)=>{const n=r.num(),i=e.num();return new oe(n+t*(i-n),"num")};vt.num=Pb;const{floor:Ob}=Math,Cb=(...r)=>{r=Ee(r,"hcg");let[e,t,n]=r,i,s,o;n=n*255;const a=t*255;if(t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const l=Ob(e),u=e-l,h=n*(1-t),d=h+a*(1-u),f=h+a*u,p=h+a;switch(l){case 0:[i,s,o]=[p,f,h];break;case 1:[i,s,o]=[d,p,h];break;case 2:[i,s,o]=[h,p,f];break;case 3:[i,s,o]=[h,d,p];break;case 4:[i,s,o]=[f,h,p];break;case 5:[i,s,o]=[p,h,d];break}}return[i,s,o,r.length>3?r[3]:1]},Rb=(...r)=>{const[e,t,n]=Ee(r,"rgb"),i=dp(e,t,n),s=pp(e,t,n),o=s-i,a=o*100/255,l=i/(255-o)*100;let u;return o===0?u=Number.NaN:(e===s&&(u=(t-n)/o),t===s&&(u=2+(n-e)/o),n===s&&(u=4+(e-t)/o),u*=60,u<0&&(u+=360)),[u,a,l]};oe.prototype.hcg=function(){return Rb(this._rgb)};const jb=(...r)=>new oe(...r,"hcg");Ae.hcg=jb;be.format.hcg=Cb;be.autodetect.push({p:1,test:(...r)=>{if(r=Ee(r,"hcg"),Ne(r)==="array"&&r.length===3)return"hcg"}});const Lb=(r,e,t)=>Or(r,e,t,"hcg");vt.hcg=Lb;const{cos:tr}=Math,Db=(...r)=>{r=Ee(r,"hsi");let[e,t,n]=r,i,s,o;return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e>360&&(e-=360),e<0&&(e+=360),e/=360,e<1/3?(o=(1-t)/3,i=(1+t*tr(tn*e)/tr(Jo-tn*e))/3,s=1-(o+i)):e<2/3?(e-=1/3,i=(1-t)/3,s=(1+t*tr(tn*e)/tr(Jo-tn*e))/3,o=1-(i+s)):(e-=2/3,s=(1-t)/3,o=(1+t*tr(tn*e)/tr(Jo-tn*e))/3,i=1-(s+o)),i=Bn(n*i*3),s=Bn(n*s*3),o=Bn(n*o*3),[i*255,s*255,o*255,r.length>3?r[3]:1]},{min:Mb,sqrt:Vb,acos:$b}=Math,Fb=(...r)=>{let[e,t,n]=Ee(r,"rgb");e/=255,t/=255,n/=255;let i;const s=Mb(e,t,n),o=(e+t+n)/3,a=o>0?1-s/o:0;return a===0?i=NaN:(i=(e-t+(e-n))/2,i/=Vb((e-t)*(e-t)+(e-n)*(t-n)),i=$b(i),n>t&&(i=tn-i),i/=tn),[i*360,a,o]};oe.prototype.hsi=function(){return Fb(this._rgb)};const qb=(...r)=>new oe(...r,"hsi");Ae.hsi=qb;be.format.hsi=Db;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"hsi"),Ne(r)==="array"&&r.length===3)return"hsi"}});const Ub=(r,e,t)=>Or(r,e,t,"hsi");vt.hsi=Ub;const Fa=(...r)=>{r=Ee(r,"hsl");const[e,t,n]=r;let i,s,o;if(t===0)i=s=o=n*255;else{const a=[0,0,0],l=[0,0,0],u=n<.5?n*(1+t):n+t-n*t,h=2*n-u,d=e/360;a[0]=d+1/3,a[1]=d,a[2]=d-1/3;for(let f=0;f<3;f++)a[f]<0&&(a[f]+=1),a[f]>1&&(a[f]-=1),6*a[f]<1?l[f]=h+(u-h)*6*a[f]:2*a[f]<1?l[f]=u:3*a[f]<2?l[f]=h+(u-h)*(2/3-a[f])*6:l[f]=h;[i,s,o]=[l[0]*255,l[1]*255,l[2]*255]}return r.length>3?[i,s,o,r[3]]:[i,s,o,1]},Ep=(...r)=>{r=Ee(r,"rgba");let[e,t,n]=r;e/=255,t/=255,n/=255;const i=dp(e,t,n),s=pp(e,t,n),o=(s+i)/2;let a,l;return s===i?(a=0,l=Number.NaN):a=o<.5?(s-i)/(s+i):(s-i)/(2-s-i),e==s?l=(t-n)/(s-i):t==s?l=2+(n-e)/(s-i):n==s&&(l=4+(e-t)/(s-i)),l*=60,l<0&&(l+=360),r.length>3&&r[3]!==void 0?[l,a,o,r[3]]:[l,a,o]};oe.prototype.hsl=function(){return Ep(this._rgb)};const Bb=(...r)=>new oe(...r,"hsl");Ae.hsl=Bb;be.format.hsl=Fa;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"hsl"),Ne(r)==="array"&&r.length===3)return"hsl"}});const zb=(r,e,t)=>Or(r,e,t,"hsl");vt.hsl=zb;const{floor:Hb}=Math,Gb=(...r)=>{r=Ee(r,"hsv");let[e,t,n]=r,i,s,o;if(n*=255,t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const a=Hb(e),l=e-a,u=n*(1-t),h=n*(1-t*l),d=n*(1-t*(1-l));switch(a){case 0:[i,s,o]=[n,d,u];break;case 1:[i,s,o]=[h,n,u];break;case 2:[i,s,o]=[u,n,d];break;case 3:[i,s,o]=[u,h,n];break;case 4:[i,s,o]=[d,u,n];break;case 5:[i,s,o]=[n,u,h];break}}return[i,s,o,r.length>3?r[3]:1]},{min:Kb,max:Wb}=Math,Qb=(...r)=>{r=Ee(r,"rgb");let[e,t,n]=r;const i=Kb(e,t,n),s=Wb(e,t,n),o=s-i;let a,l,u;return u=s/255,s===0?(a=Number.NaN,l=0):(l=o/s,e===s&&(a=(t-n)/o),t===s&&(a=2+(n-e)/o),n===s&&(a=4+(e-t)/o),a*=60,a<0&&(a+=360)),[a,l,u]};oe.prototype.hsv=function(){return Qb(this._rgb)};const Yb=(...r)=>new oe(...r,"hsv");Ae.hsv=Yb;be.format.hsv=Gb;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"hsv"),Ne(r)==="array"&&r.length===3)return"hsv"}});const Jb=(r,e,t)=>Or(r,e,t,"hsv");vt.hsv=Jb;function $s(r,e){let t=r.length;Array.isArray(r[0])||(r=[r]),Array.isArray(e[0])||(e=e.map(o=>[o]));let n=e[0].length,i=e[0].map((o,a)=>e.map(l=>l[a])),s=r.map(o=>i.map(a=>Array.isArray(o)?o.reduce((l,u,h)=>l+u*(a[h]||0),0):a.reduce((l,u)=>l+u*o,0)));return t===1&&(s=s[0]),n===1?s.map(o=>o[0]):s}const Xl=(...r)=>{r=Ee(r,"lab");const[e,t,n,...i]=r,[s,o,a]=Xb([e,t,n]),[l,u,h]=vp(s,o,a);return[l,u,h,...i.length>0&&i[0]<1?[i[0]]:[]]};function Xb(r){var e=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],t=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],n=$s(t,r);return $s(e,n.map(i=>i**3))}const Zl=(...r)=>{const[e,t,n,...i]=Ee(r,"rgb"),s=_p(e,t,n);return[...Zb(s),...i.length>0&&i[0]<1?[i[0]]:[]]};function Zb(r){const e=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],t=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],n=$s(e,r);return $s(t,n.map(i=>Math.cbrt(i)))}oe.prototype.oklab=function(){return Zl(this._rgb)};const e1=(...r)=>new oe(...r,"oklab");Object.assign(Ae,{oklab:e1});be.format.oklab=Xl;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"oklab"),Ne(r)==="array"&&r.length===3)return"oklab"}});const t1=(r,e,t)=>{const n=r.oklab(),i=e.oklab();return new oe(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"oklab")};vt.oklab=t1;const n1=(r,e,t)=>Or(r,e,t,"oklch");vt.oklch=n1;const{pow:na,sqrt:ra,PI:ia,cos:ah,sin:lh,atan2:r1}=Math,i1=(r,e="lrgb",t=null)=>{const n=r.length;t||(t=Array.from(new Array(n)).map(()=>1));const i=n/t.reduce(function(d,f){return d+f});if(t.forEach((d,f)=>{t[f]*=i}),r=r.map(d=>new oe(d)),e==="lrgb")return s1(r,t);const s=r.shift(),o=s.get(e),a=[];let l=0,u=0;for(let d=0;d<o.length;d++)if(o[d]=(o[d]||0)*t[0],a.push(isNaN(o[d])?0:t[0]),e.charAt(d)==="h"&&!isNaN(o[d])){const f=o[d]/180*ia;l+=ah(f)*t[0],u+=lh(f)*t[0]}let h=s.alpha()*t[0];r.forEach((d,f)=>{const p=d.get(e);h+=d.alpha()*t[f+1];for(let _=0;_<o.length;_++)if(!isNaN(p[_]))if(a[_]+=t[f+1],e.charAt(_)==="h"){const g=p[_]/180*ia;l+=ah(g)*t[f+1],u+=lh(g)*t[f+1]}else o[_]+=p[_]*t[f+1]});for(let d=0;d<o.length;d++)if(e.charAt(d)==="h"){let f=r1(u/a[d],l/a[d])/ia*180;for(;f<0;)f+=360;for(;f>=360;)f-=360;o[d]=f}else o[d]=o[d]/a[d];return h/=n,new oe(o,e).alpha(h>.99999?1:h,!0)},s1=(r,e)=>{const t=r.length,n=[0,0,0,0];for(let i=0;i<r.length;i++){const s=r[i],o=e[i]/t,a=s._rgb;n[0]+=na(a[0],2)*o,n[1]+=na(a[1],2)*o,n[2]+=na(a[2],2)*o,n[3]+=a[3]*o}return n[0]=ra(n[0]),n[1]=ra(n[1]),n[2]=ra(n[2]),n[3]>.9999999&&(n[3]=1),new oe(Kl(n))},{pow:o1}=Math;function Fs(r){let e="rgb",t=Ae("#ccc"),n=0,i=[0,1],s=[],o=[0,0],a=!1,l=[],u=!1,h=0,d=1,f=!1,p={},_=!0,g=1;const y=function(x){if(x=x||["#fff","#000"],x&&Ne(x)==="string"&&Ae.brewer&&Ae.brewer[x.toLowerCase()]&&(x=Ae.brewer[x.toLowerCase()]),Ne(x)==="array"){x.length===1&&(x=[x[0],x[0]]),x=x.slice(0);for(let w=0;w<x.length;w++)x[w]=Ae(x[w]);s.length=0;for(let w=0;w<x.length;w++)s.push(w/(x.length-1))}return O(),l=x},m=function(x){if(a!=null){const w=a.length-1;let P=0;for(;P<w&&x>=a[P];)P++;return P-1}return 0};let b=x=>x,k=x=>x;const v=function(x,w){let P,T;if(w==null&&(w=!1),isNaN(x)||x===null)return t;w?T=x:a&&a.length>2?T=m(x)/(a.length-2):d!==h?T=(x-h)/(d-h):T=1,T=k(T),w||(T=b(T)),g!==1&&(T=o1(T,g)),T=o[0]+T*(1-o[0]-o[1]),T=Bn(T,0,1);const A=Math.floor(T*1e4);if(_&&p[A])P=p[A];else{if(Ne(l)==="array")for(let S=0;S<s.length;S++){const E=s[S];if(T<=E){P=l[S];break}if(T>=E&&S===s.length-1){P=l[S];break}if(T>E&&T<s[S+1]){T=(T-E)/(s[S+1]-E),P=Ae.interpolate(l[S],l[S+1],T,e);break}}else Ne(l)==="function"&&(P=l(T));_&&(p[A]=P)}return P};var O=()=>p={};y(r);const R=function(x){const w=Ae(v(x));return u&&w[u]?w[u]():w};return R.classes=function(x){if(x!=null){if(Ne(x)==="array")a=x,i=[x[0],x[x.length-1]];else{const w=Ae.analyze(i);x===0?a=[w.min,w.max]:a=Ae.limits(w,"e",x)}return R}return a},R.domain=function(x){if(!arguments.length)return i;h=x[0],d=x[x.length-1],s=[];const w=l.length;if(x.length===w&&h!==d)for(let P of Array.from(x))s.push((P-h)/(d-h));else{for(let P=0;P<w;P++)s.push(P/(w-1));if(x.length>2){const P=x.map((A,S)=>S/(x.length-1)),T=x.map(A=>(A-h)/(d-h));T.every((A,S)=>P[S]===A)||(k=A=>{if(A<=0||A>=1)return A;let S=0;for(;A>=T[S+1];)S++;const E=(A-T[S])/(T[S+1]-T[S]);return P[S]+E*(P[S+1]-P[S])})}}return i=[h,d],R},R.mode=function(x){return arguments.length?(e=x,O(),R):e},R.range=function(x,w){return y(x),R},R.out=function(x){return u=x,R},R.spread=function(x){return arguments.length?(n=x,R):n},R.correctLightness=function(x){return x==null&&(x=!0),f=x,O(),f?b=function(w){const P=v(0,!0).lab()[0],T=v(1,!0).lab()[0],A=P>T;let S=v(w,!0).lab()[0];const E=P+(T-P)*w;let j=S-E,V=0,z=1,H=20;for(;Math.abs(j)>.01&&H-- >0;)(function(){return A&&(j*=-1),j<0?(V=w,w+=(z-w)*.5):(z=w,w+=(V-w)*.5),S=v(w,!0).lab()[0],j=S-E})();return w}:b=w=>w,R},R.padding=function(x){return x!=null?(Ne(x)==="number"&&(x=[x,x]),o=x,R):o},R.colors=function(x,w){arguments.length<2&&(w="hex");let P=[];if(arguments.length===0)P=l.slice(0);else if(x===1)P=[R(.5)];else if(x>1){const T=i[0],A=i[1]-T;P=a1(0,x).map(S=>R(T+S/(x-1)*A))}else{r=[];let T=[];if(a&&a.length>2)for(let A=1,S=a.length,E=1<=S;E?A<S:A>S;E?A++:A--)T.push((a[A-1]+a[A])*.5);else T=i;P=T.map(A=>R(A))}return Ae[w]&&(P=P.map(T=>T[w]())),P},R.cache=function(x){return x!=null?(_=x,R):_},R.gamma=function(x){return x!=null?(g=x,R):g},R.nodata=function(x){return x!=null?(t=Ae(x),R):t},R}function a1(r,e,t){let n=[],i=r<e,s=e;for(let o=r;i?o<s:o>s;i?o++:o--)n.push(o);return n}const l1=function(r){let e=[1,1];for(let t=1;t<r;t++){let n=[1];for(let i=1;i<=e.length;i++)n[i]=(e[i]||0)+e[i-1];e=n}return e},c1=function(r){let e,t,n,i;if(r=r.map(s=>new oe(s)),r.length===2)[t,n]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>t[a]+s*(n[a]-t[a]));return new oe(o,"lab")};else if(r.length===3)[t,n,i]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>(1-s)*(1-s)*t[a]+2*(1-s)*s*n[a]+s*s*i[a]);return new oe(o,"lab")};else if(r.length===4){let s;[t,n,i,s]=r.map(o=>o.lab()),e=function(o){const a=[0,1,2].map(l=>(1-o)*(1-o)*(1-o)*t[l]+3*(1-o)*(1-o)*o*n[l]+3*(1-o)*o*o*i[l]+o*o*o*s[l]);return new oe(a,"lab")}}else if(r.length>=5){let s,o,a;s=r.map(l=>l.lab()),a=r.length-1,o=l1(a),e=function(l){const u=1-l,h=[0,1,2].map(d=>s.reduce((f,p,_)=>f+o[_]*u**(a-_)*l**_*p[d],0));return new oe(h,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return e},u1=r=>{const e=c1(r);return e.scale=()=>Fs(e),e},{round:Tp}=Math;oe.prototype.rgb=function(r=!0){return r===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Tp)};oe.prototype.rgba=function(r=!0){return this._rgb.slice(0,4).map((e,t)=>t<3?r===!1?e:Tp(e):e)};const h1=(...r)=>new oe(...r,"rgb");Object.assign(Ae,{rgb:h1});be.format.rgb=(...r)=>{const e=Ee(r,"rgba");return e[3]===void 0&&(e[3]=1),e};be.autodetect.push({p:3,test:(...r)=>{if(r=Ee(r,"rgba"),Ne(r)==="array"&&(r.length===3||r.length===4&&Ne(r[3])=="number"&&r[3]>=0&&r[3]<=1))return"rgb"}});const Ft=(r,e,t)=>{if(!Ft[t])throw new Error("unknown blend mode "+t);return Ft[t](r,e)},On=r=>(e,t)=>{const n=Ae(t).rgb(),i=Ae(e).rgb();return Ae.rgb(r(n,i))},Cn=r=>(e,t)=>{const n=[];return n[0]=r(e[0],t[0]),n[1]=r(e[1],t[1]),n[2]=r(e[2],t[2]),n},f1=r=>r,d1=(r,e)=>r*e/255,p1=(r,e)=>r>e?e:r,m1=(r,e)=>r>e?r:e,g1=(r,e)=>255*(1-(1-r/255)*(1-e/255)),y1=(r,e)=>e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255)),v1=(r,e)=>255*(1-(1-e/255)/(r/255)),_1=(r,e)=>r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r);Ft.normal=On(Cn(f1));Ft.multiply=On(Cn(d1));Ft.screen=On(Cn(g1));Ft.overlay=On(Cn(y1));Ft.darken=On(Cn(p1));Ft.lighten=On(Cn(m1));Ft.dodge=On(Cn(_1));Ft.burn=On(Cn(v1));const{pow:b1,sin:w1,cos:x1}=Math;function E1(r=300,e=-1.5,t=1,n=1,i=[0,1]){let s=0,o;Ne(i)==="array"?o=i[1]-i[0]:(o=0,i=[i,i]);const a=function(l){const u=tn*((r+120)/360+e*l),h=b1(i[0]+o*l,n),f=(s!==0?t[0]+l*s:t)*h*(1-h)/2,p=x1(u),_=w1(u),g=h+f*(-.14861*p+1.78277*_),y=h+f*(-.29227*p-.90649*_),m=h+f*(1.97294*p);return Ae(Kl([g*255,y*255,m*255,1]))};return a.start=function(l){return l==null?r:(r=l,a)},a.rotations=function(l){return l==null?e:(e=l,a)},a.gamma=function(l){return l==null?n:(n=l,a)},a.hue=function(l){return l==null?t:(t=l,Ne(t)==="array"?(s=t[1]-t[0],s===0&&(t=t[1])):s=0,a)},a.lightness=function(l){return l==null?i:(Ne(l)==="array"?(i=l,o=l[1]-l[0]):(i=[l,l],o=0),a)},a.scale=()=>Ae.scale(a),a.hue(t),a}const T1="0123456789abcdef",{floor:A1,random:k1}=Math,S1=()=>{let r="#";for(let e=0;e<6;e++)r+=T1.charAt(A1(k1()*16));return new oe(r,"hex")},{log:ch,pow:I1,floor:N1,abs:P1}=Math;function Ap(r,e=null){const t={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Ne(r)==="object"&&(r=Object.values(r)),r.forEach(n=>{e&&Ne(n)==="object"&&(n=n[e]),n!=null&&!isNaN(n)&&(t.values.push(n),t.sum+=n,n<t.min&&(t.min=n),n>t.max&&(t.max=n),t.count+=1)}),t.domain=[t.min,t.max],t.limits=(n,i)=>kp(t,n,i),t}function kp(r,e="equal",t=7){Ne(r)=="array"&&(r=Ap(r));const{min:n,max:i}=r,s=r.values.sort((a,l)=>a-l);if(t===1)return[n,i];const o=[];if(e.substr(0,1)==="c"&&(o.push(n),o.push(i)),e.substr(0,1)==="e"){o.push(n);for(let a=1;a<t;a++)o.push(n+a/t*(i-n));o.push(i)}else if(e.substr(0,1)==="l"){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");const a=Math.LOG10E*ch(n),l=Math.LOG10E*ch(i);o.push(n);for(let u=1;u<t;u++)o.push(I1(10,a+u/t*(l-a)));o.push(i)}else if(e.substr(0,1)==="q"){o.push(n);for(let a=1;a<t;a++){const l=(s.length-1)*a/t,u=N1(l);if(u===l)o.push(s[u]);else{const h=l-u;o.push(s[u]*(1-h)+s[u+1]*h)}}o.push(i)}else if(e.substr(0,1)==="k"){let a;const l=s.length,u=new Array(l),h=new Array(t);let d=!0,f=0,p=null;p=[],p.push(n);for(let y=1;y<t;y++)p.push(n+y/t*(i-n));for(p.push(i);d;){for(let m=0;m<t;m++)h[m]=0;for(let m=0;m<l;m++){const b=s[m];let k=Number.MAX_VALUE,v;for(let O=0;O<t;O++){const R=P1(p[O]-b);R<k&&(k=R,v=O),h[v]++,u[m]=v}}const y=new Array(t);for(let m=0;m<t;m++)y[m]=null;for(let m=0;m<l;m++)a=u[m],y[a]===null?y[a]=s[m]:y[a]+=s[m];for(let m=0;m<t;m++)y[m]*=1/h[m];d=!1;for(let m=0;m<t;m++)if(y[m]!==p[m]){d=!0;break}p=y,f++,f>200&&(d=!1)}const _={};for(let y=0;y<t;y++)_[y]=[];for(let y=0;y<l;y++)a=u[y],_[a].push(s[y]);let g=[];for(let y=0;y<t;y++)g.push(_[y][0]),g.push(_[y][_[y].length-1]);g=g.sort((y,m)=>y-m),o.push(g[0]);for(let y=1;y<g.length;y+=2){const m=g[y];!isNaN(m)&&o.indexOf(m)===-1&&o.push(m)}}return o}const O1=(r,e)=>{r=new oe(r),e=new oe(e);const t=r.luminance(),n=e.luminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const uh=.027,C1=5e-4,R1=.1,hh=1.14,cs=.022,fh=1.414,j1=(r,e)=>{r=new oe(r),e=new oe(e),r.alpha()<1&&(r=Er(e,r,r.alpha(),"rgb"));const t=dh(...r.rgb()),n=dh(...e.rgb()),i=t>=cs?t:t+Math.pow(cs-t,fh),s=n>=cs?n:n+Math.pow(cs-n,fh),o=Math.pow(s,.56)-Math.pow(i,.57),a=Math.pow(s,.65)-Math.pow(i,.62),l=Math.abs(s-i)<C1?0:i<s?o*hh:a*hh;return(Math.abs(l)<R1?0:l>0?l-uh:l+uh)*100};function dh(r,e,t){return .2126729*Math.pow(r/255,2.4)+.7151522*Math.pow(e/255,2.4)+.072175*Math.pow(t/255,2.4)}const{sqrt:Zt,pow:Xe,min:L1,max:D1,atan2:ph,abs:mh,cos:us,sin:gh,exp:M1,PI:yh}=Math;function V1(r,e,t=1,n=1,i=1){var s=function(F){return 360*F/(2*yh)},o=function(F){return 2*yh*F/360};r=new oe(r),e=new oe(e);const[a,l,u]=Array.from(r.lab()),[h,d,f]=Array.from(e.lab()),p=(a+h)/2,_=Zt(Xe(l,2)+Xe(u,2)),g=Zt(Xe(d,2)+Xe(f,2)),y=(_+g)/2,m=.5*(1-Zt(Xe(y,7)/(Xe(y,7)+Xe(25,7)))),b=l*(1+m),k=d*(1+m),v=Zt(Xe(b,2)+Xe(u,2)),O=Zt(Xe(k,2)+Xe(f,2)),R=(v+O)/2,x=s(ph(u,b)),w=s(ph(f,k)),P=x>=0?x:x+360,T=w>=0?w:w+360,A=mh(P-T)>180?(P+T+360)/2:(P+T)/2,S=1-.17*us(o(A-30))+.24*us(o(2*A))+.32*us(o(3*A+6))-.2*us(o(4*A-63));let E=T-P;E=mh(E)<=180?E:T<=P?E+360:E-360,E=2*Zt(v*O)*gh(o(E)/2);const j=h-a,V=O-v,z=1+.015*Xe(p-50,2)/Zt(20+Xe(p-50,2)),H=1+.045*R,ee=1+.015*R*S,G=30*M1(-Xe((A-275)/25,2)),L=-(2*Zt(Xe(R,7)/(Xe(R,7)+Xe(25,7))))*gh(2*o(G)),$=Zt(Xe(j/(t*z),2)+Xe(V/(n*H),2)+Xe(E/(i*ee),2)+L*(V/(n*H))*(E/(i*ee)));return D1(0,L1(100,$))}function $1(r,e,t="lab"){r=new oe(r),e=new oe(e);const n=r.get(t),i=e.get(t);let s=0;for(let o in n){const a=(n[o]||0)-(i[o]||0);s+=a*a}return Math.sqrt(s)}const F1=(...r)=>{try{return new oe(...r),!0}catch{return!1}},q1={cool(){return Fs([Ae.hsl(180,1,.9),Ae.hsl(250,.7,.4)])},hot(){return Fs(["#000","#f00","#ff0","#fff"]).mode("rgb")}},qa={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Sp=Object.keys(qa),vh=new Map(Sp.map(r=>[r.toLowerCase(),r])),U1=typeof Proxy=="function"?new Proxy(qa,{get(r,e){const t=e.toLowerCase();if(vh.has(t))return r[vh.get(t)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(Sp)}}):qa,B1=(...r)=>{r=Ee(r,"cmyk");const[e,t,n,i]=r,s=r.length>4?r[4]:1;return i===1?[0,0,0,s]:[e>=1?0:255*(1-e)*(1-i),t>=1?0:255*(1-t)*(1-i),n>=1?0:255*(1-n)*(1-i),s]},{max:_h}=Math,z1=(...r)=>{let[e,t,n]=Ee(r,"rgb");e=e/255,t=t/255,n=n/255;const i=1-_h(e,_h(t,n)),s=i<1?1/(1-i):0,o=(1-e-i)*s,a=(1-t-i)*s,l=(1-n-i)*s;return[o,a,l,i]};oe.prototype.cmyk=function(){return z1(this._rgb)};const H1=(...r)=>new oe(...r,"cmyk");Object.assign(Ae,{cmyk:H1});be.format.cmyk=B1;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"cmyk"),Ne(r)==="array"&&r.length===4)return"cmyk"}});const G1=(...r)=>{const e=Ee(r,"hsla");let t=Pr(r)||"lsa";return e[0]=Ct(e[0]||0)+"deg",e[1]=Ct(e[1]*100)+"%",e[2]=Ct(e[2]*100)+"%",t==="hsla"||e.length>3&&e[3]<1?(e[3]="/ "+(e.length>3?e[3]:1),t="hsla"):e.length=3,`${t.substr(0,3)}(${e.join(" ")})`},K1=(...r)=>{const e=Ee(r,"lab");let t=Pr(r)||"lab";return e[0]=Ct(e[0])+"%",e[1]=Ct(e[1]),e[2]=Ct(e[2]),t==="laba"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lab(${e.join(" ")})`},W1=(...r)=>{const e=Ee(r,"lch");let t=Pr(r)||"lab";return e[0]=Ct(e[0])+"%",e[1]=Ct(e[1]),e[2]=isNaN(e[2])?"none":Ct(e[2])+"deg",t==="lcha"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lch(${e.join(" ")})`},Q1=(...r)=>{const e=Ee(r,"lab");return e[0]=Ct(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=$a(e[2]),e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklab(${e.join(" ")})`},Ip=(...r)=>{const[e,t,n,...i]=Ee(r,"rgb"),[s,o,a]=Zl(e,t,n),[l,u,h]=wp(s,o,a);return[l,u,h,...i.length>0&&i[0]<1?[i[0]]:[]]},Y1=(...r)=>{const e=Ee(r,"lch");return e[0]=Ct(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=isNaN(e[2])?"none":Ct(e[2])+"deg",e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklch(${e.join(" ")})`},{round:sa}=Math,J1=(...r)=>{const e=Ee(r,"rgba");let t=Pr(r)||"rgb";if(t.substr(0,3)==="hsl")return G1(Ep(e),t);if(t.substr(0,3)==="lab"){const n=Si();rn("d50");const i=K1(Ql(e),t);return rn(n),i}if(t.substr(0,3)==="lch"){const n=Si();rn("d50");const i=W1(Jl(e),t);return rn(n),i}return t.substr(0,5)==="oklab"?Q1(Zl(e)):t.substr(0,5)==="oklch"?Y1(Ip(e)):(e[0]=sa(e[0]),e[1]=sa(e[1]),e[2]=sa(e[2]),(t==="rgba"||e.length>3&&e[3]<1)&&(e[3]="/ "+(e.length>3?e[3]:1),t="rgba"),`${t.substr(0,3)}(${e.slice(0,t==="rgb"?3:4).join(" ")})`)},Np=(...r)=>{r=Ee(r,"lch");const[e,t,n,...i]=r,[s,o,a]=bp(e,t,n),[l,u,h]=Xl(s,o,a);return[l,u,h,...i.length>0&&i[0]<1?[i[0]]:[]]},on=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,Vt=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,qs=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,jt=/\s*/.source,Cr=/\s+/.source,ec=/\s*,\s*/.source,po=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,Rr=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,Pp=new RegExp("^rgba?\\("+jt+[on,on,on].join(Cr)+Rr+"\\)$"),Op=new RegExp("^rgb\\("+jt+[on,on,on].join(ec)+jt+"\\)$"),Cp=new RegExp("^rgba\\("+jt+[on,on,on,Vt].join(ec)+jt+"\\)$"),Rp=new RegExp("^hsla?\\("+jt+[po,qs,qs].join(Cr)+Rr+"\\)$"),jp=new RegExp("^hsl?\\("+jt+[po,qs,qs].join(ec)+jt+"\\)$"),Lp=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Dp=new RegExp("^lab\\("+jt+[Vt,Vt,Vt].join(Cr)+Rr+"\\)$"),Mp=new RegExp("^lch\\("+jt+[Vt,Vt,po].join(Cr)+Rr+"\\)$"),Vp=new RegExp("^oklab\\("+jt+[Vt,Vt,Vt].join(Cr)+Rr+"\\)$"),$p=new RegExp("^oklch\\("+jt+[Vt,Vt,po].join(Cr)+Rr+"\\)$"),{round:Fp}=Math,nr=r=>r.map((e,t)=>t<=2?Bn(Fp(e),0,255):e),Ze=(r,e=0,t=100,n=!1)=>(typeof r=="string"&&r.endsWith("%")&&(r=parseFloat(r.substring(0,r.length-1))/100,n?r=e+(r+1)*.5*(t-e):r=e+r*(t-e)),+r),wt=(r,e)=>r==="none"?e:r,tc=r=>{if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];let e;if(be.format.named)try{return be.format.named(r)}catch{}if((e=r.match(Pp))||(e=r.match(Op))){let t=e.slice(1,4);for(let i=0;i<3;i++)t[i]=+Ze(wt(t[i],0),0,255);t=nr(t);const n=e[4]!==void 0?+Ze(e[4],0,1):1;return t[3]=n,t}if(e=r.match(Cp)){const t=e.slice(1,5);for(let n=0;n<4;n++)t[n]=+Ze(t[n],0,255);return t}if((e=r.match(Rp))||(e=r.match(jp))){const t=e.slice(1,4);t[0]=+wt(t[0].replace("deg",""),0),t[1]=+Ze(wt(t[1],0),0,100)*.01,t[2]=+Ze(wt(t[2],0),0,100)*.01;const n=nr(Fa(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}if(e=r.match(Lp)){const t=e.slice(1,4);t[1]*=.01,t[2]*=.01;const n=Fa(t);for(let i=0;i<3;i++)n[i]=Fp(n[i]);return n[3]=+e[4],n}if(e=r.match(Dp)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,100),t[1]=Ze(wt(t[1],0),-125,125,!0),t[2]=Ze(wt(t[2],0),-125,125,!0);const n=Si();rn("d50");const i=nr(Wl(t));rn(n);const s=e[4]!==void 0?+Ze(e[4],0,1):1;return i[3]=s,i}if(e=r.match(Mp)){const t=e.slice(1,4);t[0]=Ze(t[0],0,100),t[1]=Ze(wt(t[1],0),0,150,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=Si();rn("d50");const i=nr(Yl(t));rn(n);const s=e[4]!==void 0?+Ze(e[4],0,1):1;return i[3]=s,i}if(e=r.match(Vp)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,1),t[1]=Ze(wt(t[1],0),-.4,.4,!0),t[2]=Ze(wt(t[2],0),-.4,.4,!0);const n=nr(Xl(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}if(e=r.match($p)){const t=e.slice(1,4);t[0]=Ze(wt(t[0],0),0,1),t[1]=Ze(wt(t[1],0),0,.4,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=nr(Np(t)),i=e[4]!==void 0?+Ze(e[4],0,1):1;return n[3]=i,n}};tc.test=r=>Pp.test(r)||Rp.test(r)||Dp.test(r)||Mp.test(r)||Vp.test(r)||$p.test(r)||Op.test(r)||Cp.test(r)||jp.test(r)||Lp.test(r)||r==="transparent";oe.prototype.css=function(r){return J1(this._rgb,r)};const X1=(...r)=>new oe(...r,"css");Ae.css=X1;be.format.css=tc;be.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&tc.test(r))return"css"}});be.format.gl=(...r)=>{const e=Ee(r,"rgba");return e[0]*=255,e[1]*=255,e[2]*=255,e};const Z1=(...r)=>new oe(...r,"gl");Ae.gl=Z1;oe.prototype.gl=function(){const r=this._rgb;return[r[0]/255,r[1]/255,r[2]/255,r[3]]};oe.prototype.hex=function(r){return yp(this._rgb,r)};const ew=(...r)=>new oe(...r,"hex");Ae.hex=ew;be.format.hex=gp;be.autodetect.push({p:4,test:(r,...e)=>{if(!e.length&&Ne(r)==="string"&&[3,4,5,6,7,8,9].indexOf(r.length)>=0)return"hex"}});const{log:hs}=Math,qp=r=>{const e=r/100;let t,n,i;return e<66?(t=255,n=e<6?0:-155.25485562709179-.44596950469579133*(n=e-2)+104.49216199393888*hs(n),i=e<20?0:-254.76935184120902+.8274096064007395*(i=e-10)+115.67994401066147*hs(i)):(t=351.97690566805693+.114206453784165*(t=e-55)-40.25366309332127*hs(t),n=325.4494125711974+.07943456536662342*(n=e-50)-28.0852963507957*hs(n),i=255),[t,n,i,1]},{round:tw}=Math,nw=(...r)=>{const e=Ee(r,"rgb"),t=e[0],n=e[2];let i=1e3,s=4e4;const o=.4;let a;for(;s-i>o;){a=(s+i)*.5;const l=qp(a);l[2]/l[0]>=n/t?s=a:i=a}return tw(a)};oe.prototype.temp=oe.prototype.kelvin=oe.prototype.temperature=function(){return nw(this._rgb)};const oa=(...r)=>new oe(...r,"temp");Object.assign(Ae,{temp:oa,kelvin:oa,temperature:oa});be.format.temp=be.format.kelvin=be.format.temperature=qp;oe.prototype.oklch=function(){return Ip(this._rgb)};const rw=(...r)=>new oe(...r,"oklch");Object.assign(Ae,{oklch:rw});be.format.oklch=Np;be.autodetect.push({p:2,test:(...r)=>{if(r=Ee(r,"oklch"),Ne(r)==="array"&&r.length===3)return"oklch"}});Object.assign(Ae,{analyze:Ap,average:i1,bezier:u1,blend:Ft,brewer:U1,Color:oe,colors:xr,contrast:O1,contrastAPCA:j1,cubehelix:E1,deltaE:V1,distance:$1,input:be,interpolate:Er,limits:kp,mix:Er,random:S1,scale:Fs,scales:q1,valid:F1});const Re={primaryColor:"#377dc8",secondaryColor:"#0f3257",fontFamily:"'Noto Sans', sans-serif",titleColor:"#d7e3ee",h3TitleColor:"#d7e3ee",textColor:"#c6d3e2",backgroundFromColor:"#111827",backgroundToColor:"#1F2937",sectionBgColor:"#374151"},iw=()=>{const[r,e]=Y.useState(Re.primaryColor),[t,n]=Y.useState(Re.secondaryColor),[i,s]=Y.useState(Re.fontFamily),[o,a]=Y.useState(Re.titleColor),[l,u]=Y.useState(Re.h3TitleColor),[h,d]=Y.useState(Re.textColor),[f,p]=Y.useState(Re.backgroundFromColor),[_,g]=Y.useState(Re.backgroundToColor),[y,m]=Y.useState(Re.sectionBgColor),[b,k]=Y.useState(!0),[v,O]=Y.useState(!1),[R,x]=Y.useState(0),[w,P]=Y.useState([]),[T,A]=Y.useState(""),[S,E]=Y.useState(!0),{showToast:j,requestConfirmation:V}=Yt(),z=Y.useCallback(U=>{const M={};return Object.entries(U).forEach(([B,K])=>{const J=typeof K=="string"?K:"";M[B]=J.match(/^#[0-9A-F]{6}$/i)?J:Re[B]||"#000000"}),M},[]),H=Y.useCallback(()=>{const U=document.documentElement,M=z({primaryColor:r,secondaryColor:t,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y});Object.entries(M).forEach(([B,K])=>{U.style.setProperty(`--${B.replace(/([A-Z])/g,"-$1").toLowerCase()}`,K)}),U.style.setProperty("--font-family",i)},[r,t,o,l,h,f,_,y,i,z]),ee=Y.useCallback(async()=>{if(!de){console.error("Firestore not available"),j("Error: Firestore connection lost.","error"),k(!1),E(!1);return}k(!0),E(!0);try{const U=await Ov(rt(de,"settings","styles"));if(U.exists()){const K=U.data();e(K.primaryColor||Re.primaryColor),n(K.secondaryColor||Re.secondaryColor),s(K.fontFamily||Re.fontFamily),a(K.titleColor||Re.titleColor||"#ffffff"),u(K.h3TitleColor||Re.h3TitleColor||"#d7e3ee"),d(K.textColor||Re.textColor||"#c6d3e2"),p(K.backgroundFromColor||Re.backgroundFromColor||"#111827"),g(K.backgroundToColor||Re.backgroundToColor||"#1F2937"),m(K.sectionBgColor||Re.sectionBgColor||"#374151")}else e(Re.primaryColor),n(Re.secondaryColor),s(Re.fontFamily),a(Re.titleColor??"#ffffff"),u(Re.h3TitleColor??"#d7e3ee"),d(Re.textColor??"#c6d3e2"),p(Re.backgroundFromColor??"#111827"),g(Re.backgroundToColor??"#1F2937"),m(Re.sectionBgColor??"#374151");const B=(await Mi(_r(de,"themes"))).docs.map(K=>({id:K.id,...K.data()}));P(B)}catch(U){console.error("Error loading data:",U),j("Failed to load styles or themes. Check console.","error")}finally{k(!1),E(!1)}},[j]),G=Y.useCallback(async()=>{if(!de){j("Error: Firestore connection lost.","error");return}O(!0);try{const U={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y};await La(rt(de,"settings","styles"),U),j("Styles saved successfully!","success")}catch(U){console.error("Error saving styles:",U),j("Failed to save styles. Check console.","error")}finally{O(!1)}},[de,j,r,t,i,o,l,h,f,_,y]),q=Y.useCallback(async()=>{if(!de){j("Error: Firestore connection lost.","error");return}if(!T.trim()){j("Please enter a name for the theme.","error");return}O(!0);try{const U={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:h,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:y},M={name:T.trim(),style:U},B=await Bl(_r(de,"themes"),M);P(K=>[...K,{id:B.id,...M}]),A(""),j("Theme saved successfully!","success")}catch(U){console.error("Error saving theme:",U),j("Failed to save theme. Check console.","error")}finally{O(!1)}},[de,j,T,r,t,i,o,l,h,f,_,y]),L=Y.useCallback(async U=>{const M=w.find(B=>B.id===U);!de||!M||V({message:`Are you sure you want to delete the theme "${M.name}"?`,onConfirm:async()=>{if(!de){j("Error: Firestore connection lost.","error");return}try{await Ul(rt(de,"themes",U)),P(B=>B.filter(K=>K.id!==U)),j("Theme deleted successfully!","success")}catch(B){console.error("Error deleting theme:",B),j("Failed to delete theme. Check console.","error")}},confirmText:"Delete Theme",title:"Confirm Deletion"})},[de,V,j,w]),$=Y.useCallback(U=>{const{style:M}=U;e(M.primaryColor),n(M.secondaryColor),s(M.fontFamily),a(M.titleColor||Re.titleColor||"#ffffff"),u(M.h3TitleColor||Re.h3TitleColor||"#d7e3ee"),d(M.textColor||Re.textColor||"#c6d3e2"),p(M.backgroundFromColor||Re.backgroundFromColor||"#111827"),g(M.backgroundToColor||Re.backgroundToColor||"#1F2937"),m(M.sectionBgColor||Re.sectionBgColor||"#374151"),j(`Theme "${U.name}" applied!`,"success")},[j]),F=Y.useCallback(()=>{try{const U=Ae.valid(r)?Ae(r):Ae(Re.primaryColor),M=R%3;let B;switch(M){case 1:B=U.set("hsl.h","+30").hex();break;case 2:B=U.set("hsl.h","+120").hex();break;default:B=U.set("hsl.h","+180").hex();break}n(B);const K=Ae.mix(f,_).luminance(),J=Ae.contrast(r,K>.5?"#000000":"#ffffff"),re=Ae.contrast(B,K>.5?"#000000":"#ffffff");a(J>4.5?r:K>.5?"#333333":"#eeeeee"),u(re>3?B:K>.5?"#555555":"#cccccc"),d(K>.5?"#666666":"#bbbbbb"),p(U.darken(2.2).desaturate(.5).hex()),g(U.darken(1.8).desaturate(.3).hex()),m(U.darken(1.5).desaturate(.4).hex()),x(ce=>ce+1),j(`AI colors generated (Mode ${M+1})!`,"success")}catch(U){console.error("Error generating AI colors:",U),j("Failed to generate colors. Check console.","error")}},[R,r,f,_,j]),W=Y.useCallback(U=>{e(U.primaryColor),n(U.secondaryColor),a(U.titleColor),u(U.h3TitleColor),d(U.textColor),p(U.backgroundFromColor),g(U.backgroundToColor),m(U.sectionBgColor)},[]);return Y.useEffect(()=>{ee()},[ee]),Y.useEffect(()=>{b||H()},[b,H]),{primaryColor:r,setPrimaryColor:e,secondaryColor:t,setSecondaryColor:n,fontFamily:i,setFontFamily:s,titleColor:o,setTitleColor:a,h3TitleColor:l,setH3TitleColor:u,textColor:h,setTextColor:d,backgroundFromColor:f,setBackgroundFromColor:p,backgroundToColor:_,setBackgroundToColor:g,sectionBgColor:y,setSectionBgColor:m,isLoading:b,isSaving:v,aiMode:R,savedThemes:w,newThemeName:T,setNewThemeName:A,isLoadingThemes:S,handleSaveStyles:G,handleSaveTheme:q,handleDeleteTheme:L,handleApplyTheme:$,handleGenerateAIColors:F,handleGlobalThemeSelect:W}},pn=({label:r,value:e,onChange:t,description:n})=>{const{showToast:i}=Yt(),s=l=>{const u=l.target.value;u.match(/^#?[0-9A-Fa-f]{0,6}$/)&&t(u.startsWith("#")?u:`#${u}`)},o=l=>{let u=l.target.value;u.startsWith("#")||(u=`#${u}`),u.length>1&&u.length<7&&(u=u.padEnd(7,u.substring(u.length-1).repeat(7-u.length))),u.match(/^#[0-9A-Fa-f]{6}$/i)?t(u):(t(e),i("Invalid hex color format. Reverted.","error"))},a=()=>{navigator.clipboard.writeText(e),i("Color code copied!","success")};return N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r}),N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[N.jsx("input",{type:"color",value:e,onChange:l=>t(l.target.value),className:"h-10 w-10 p-1 border border-gray-300 rounded cursor-pointer self-start sm:self-center bg-white"}),N.jsx("input",{type:"text",value:e,onChange:s,onBlur:o,className:"w-full sm:flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",maxLength:7,placeholder:"#rrggbb"}),N.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 self-start sm:self-center",title:"Copy color code",type:"button",children:N.jsx(i_,{size:20})})]}),n&&N.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n})]})},aa={light:{primaryColor:"#3b82f6",secondaryColor:"#6b7280",titleColor:"#1f2937",h3TitleColor:"#1f2937",textColor:"#1f2937",backgroundFromColor:"#ffffff",backgroundToColor:"#f3f4f6",sectionBgColor:"#f3f4f6"},dark:{primaryColor:"#60a5fa",secondaryColor:"#9ca3af",titleColor:"#f9fafb",h3TitleColor:"#f9fafb",textColor:"#f9fafb",backgroundFromColor:"#111827",backgroundToColor:"#1f2937",sectionBgColor:"#111827"},forest:{primaryColor:"#34d399",secondaryColor:"#6b7280",titleColor:"#064e3b",h3TitleColor:"#064e3b",textColor:"#064e3b",backgroundFromColor:"#d1fae5",backgroundToColor:"#ecfdf5",sectionBgColor:"#d1fae5"},ocean:{primaryColor:"#38bdf8",secondaryColor:"#94a3b8",titleColor:"#0c4a6e",h3TitleColor:"#0c4a6e",textColor:"#0c4a6e",backgroundFromColor:"#e0f2fe",backgroundToColor:"#f0f9ff",sectionBgColor:"#e0f2fe"},sunset:{primaryColor:"#fb7185",secondaryColor:"#f97316",titleColor:"#881337",h3TitleColor:"#881337",textColor:"#881337",backgroundFromColor:"#ffe4e6",backgroundToColor:"#fff1f2",sectionBgColor:"#ffe4e6"}},sw=({onThemeSelect:r})=>{const e=[{name:"Light",value:"light",icon:""},{name:"Dark",value:"dark",icon:""},{name:"Forest",value:"forest",icon:""},{name:"Ocean",value:"ocean",icon:""},{name:"Sunset",value:"sunset",icon:""}],[t,n]=Y.useState(()=>{if(typeof window<"u"){const s=localStorage.getItem("theme");return s&&aa[s]?s:"light"}return"light"});Y.useEffect(()=>{if(typeof window<"u"){const s=Object.keys(aa);document.documentElement.classList.remove(...s),document.documentElement.classList.add(t),localStorage.setItem("theme",t)}},[t]);const i=s=>{const o=aa[s];o?(n(s),r(o)):console.warn(`Theme data not found for: ${s}`)};return N.jsx("div",{className:"theme-switcher",children:N.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2 p-1 sm:p-2 bg-[var(--color-background-secondary)] rounded-lg border border-gray-300 dark:border-gray-700",children:N.jsx("div",{className:"flex space-x-1",children:e.map(s=>N.jsx("button",{onClick:()=>i(s.value),className:`p-1 sm:p-2 rounded-md text-xs sm:text-sm transition-colors duration-150 ${t===s.value?"bg-[var(--color-primary)] text-white shadow-md":"bg-[var(--color-background-secondary)] text-[var(--color-text)] hover:bg-[var(--color-secondary)] hover:text-white"}`,title:s.name,children:N.jsx("span",{className:"flex items-center",children:N.jsx("span",{className:"mr-1",children:s.icon})})},s.value))})})})},ow=[{id:"colors",label:"Colors",icon:N.jsx(up,{size:20})},{id:"typography",label:"Typography",icon:N.jsx(U_,{size:20})}],aw=()=>{const[r,e]=Y.useState("colors"),{primaryColor:t,setPrimaryColor:n,secondaryColor:i,setSecondaryColor:s,fontFamily:o,setFontFamily:a,titleColor:l,setTitleColor:u,h3TitleColor:h,setH3TitleColor:d,textColor:f,setTextColor:p,backgroundFromColor:_,setBackgroundFromColor:g,backgroundToColor:y,setBackgroundToColor:m,sectionBgColor:b,setSectionBgColor:k,isLoading:v,isSaving:O,aiMode:R,savedThemes:x,newThemeName:w,setNewThemeName:P,isLoadingThemes:T,handleSaveStyles:A,handleSaveTheme:S,handleDeleteTheme:E,handleApplyTheme:j,handleGenerateAIColors:V,handleGlobalThemeSelect:z}=iw();return v?N.jsxs("div",{className:"flex items-center justify-center h-64 p-4 md:p-6",children:[N.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),N.jsx("span",{className:"ml-3 text-gray-600",children:"Loading Styles..."})]}):N.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-4 md:p-6",children:[N.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[N.jsx("div",{className:"border-b border-gray-200 overflow-x-auto",children:N.jsx("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 whitespace-nowrap",children:ow.map(H=>N.jsxs("button",{onClick:()=>e(H.id),className:`
                  flex items-center space-x-2 py-3 px-2 sm:py-4 sm:px-3 border-b-2 font-medium text-sm transition-colors duration-150 ease-in-out
                  ${r===H.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[H.icon,N.jsx("span",{className:"hidden sm:inline",children:H.label})]},H.id))})}),N.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[r==="colors"&&N.jsxs("div",{className:"space-y-6",children:[N.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-4 sm:space-y-0",children:[N.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Color Settings"}),N.jsxs("button",{onClick:V,className:"flex items-center justify-center sm:justify-start space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors w-full sm:w-auto text-sm",title:`Generate colors (Mode ${R%3+1})`,children:[N.jsx(G_,{size:16}),N.jsx("span",{children:"Generate AI Colors"})]})]}),N.jsx(pn,{label:"Primary Color",value:t,onChange:n,description:"Main brand color for buttons, links, etc."}),N.jsx(pn,{label:"Secondary Color",value:i,onChange:s,description:"Supporting color for accents, secondary actions."}),N.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[N.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Text Colors"}),N.jsx(pn,{label:"Title Color",value:l,onChange:u,description:"Color for main headings (h1, h2)."}),N.jsx(pn,{label:"Subtitle Color",value:h,onChange:d,description:"Color for subheadings (h3, h4)."}),N.jsx(pn,{label:"Body Text Color",value:f,onChange:p,description:"Default color for paragraphs and general text."})]}),N.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[N.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Background Colors"}),N.jsx(pn,{label:"Background Start",value:_,onChange:g,description:"Starting color for main background gradient."}),N.jsx(pn,{label:"Background End",value:y,onChange:m,description:"Ending color for main background gradient."}),N.jsx(pn,{label:"Section Background",value:b,onChange:k,description:"Background for content cards/sections."})]})]}),r==="typography"&&N.jsxs("div",{className:"space-y-6",children:[N.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Typography Settings"}),N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:"fontFamilySelect",className:"block text-sm font-medium text-gray-700 mb-1",children:"Font Family"}),N.jsxs("select",{id:"fontFamilySelect",value:o,onChange:H=>a(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-gray-900",children:[N.jsx("option",{value:"'Noto Sans', sans-serif",children:"Noto Sans"}),N.jsx("option",{value:"Arial, Helvetica, sans-serif",children:"Arial"})," ",N.jsx("option",{value:"Helvetica, Arial, sans-serif",children:"Helvetica"})," ",N.jsx("option",{value:"Georgia, serif",children:"Georgia"}),N.jsx("option",{value:"'Times New Roman', Times, serif",children:"Times New Roman"})]}),N.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select the primary font for the website."})]})]}),N.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:N.jsx("button",{onClick:A,disabled:O,className:`w-full flex items-center justify-center space-x-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${O?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:O?N.jsxs(N.Fragment,{children:[N.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),N.jsx("span",{children:"Saving..."})]}):N.jsxs(N.Fragment,{children:[N.jsx(Va,{size:16}),N.jsx("span",{children:"Save Current Styles"})]})})})]})]}),N.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[N.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[N.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Saved Themes"}),T?N.jsxs("div",{className:"flex items-center justify-center h-20",children:[N.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),N.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading themes..."})]}):x.length>0?N.jsx("ul",{className:"space-y-3 max-h-60 overflow-y-auto pr-2",children:x.map(H=>N.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors",children:[N.jsx("span",{className:"text-sm font-medium text-gray-800 truncate mr-2",title:H.name,children:H.name}),N.jsxs("div",{className:"flex space-x-2 flex-shrink-0",children:[N.jsx("button",{onClick:()=>j(H),className:"p-1 text-blue-600 hover:text-blue-800",title:"Apply Theme",children:N.jsx(C_,{size:16})}),N.jsx("button",{onClick:()=>E(H.id),className:"p-1 text-red-500 hover:text-red-700",title:"Delete Theme",children:N.jsx(wr,{size:16})})]})]},H.id))}):N.jsx("p",{className:"text-sm text-gray-500",children:"No themes saved yet."}),N.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[N.jsx("label",{htmlFor:"newThemeName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Save Current as New Theme"}),N.jsxs("div",{className:"flex space-x-2",children:[N.jsx("input",{type:"text",id:"newThemeName",value:w,onChange:H=>P(H.target.value),placeholder:"Enter theme name",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 text-sm"}),N.jsx("button",{onClick:S,disabled:O||!w.trim(),className:`flex-shrink-0 px-3 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${O||!w.trim()?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,title:"Save current settings as a new theme",children:N.jsx(Va,{size:16})})]})]})]}),N.jsx(sw,{onThemeSelect:z})]})]})},bh=["Github","Facebook","Mail","Instagram","Linkedin","Twitter"],Up={Github:op,Facebook:ip,Mail:cp,Instagram:ap,Linkedin:lp,Twitter:hp,HelpCircle:Gl},lw=({initialData:r,isEditing:e,onSubmit:t,onCancel:n})=>{const i={name:"",url:"",icon:bh[0]||"",order:0},[s,o]=Y.useState(r||i);Y.useEffect(()=>{o(r||i)},[r]);const a=h=>{const{name:d,value:f}=h.target;o(p=>({...p,[d]:d==="order"?parseInt(f,10)||0:f}))},l=h=>{if(h.preventDefault(),!s.name||!s.url||!s.icon){alert("Name, URL, and Icon are required.");return}t(s)},u=Up[s.icon]||Gl;return N.jsxs("form",{onSubmit:l,className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg shadow-md",children:[N.jsx("h3",{className:"text-xl font-medium mb-4 text-gray-800",children:e?"Edit Link":"Add New Link"}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[N.jsxs("div",{children:[N.jsx("label",{htmlFor:"link-name",className:"block text-sm font-medium text-gray-600 mb-1",children:"Name"}),N.jsx("input",{id:"link-name",type:"text",name:"name",placeholder:"Link Name (e.g., GitHub)",value:s.name,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"link-url",className:"block text-sm font-medium text-gray-600 mb-1",children:"URL"}),N.jsx("input",{id:"link-url",type:"url",name:"url",placeholder:"Full URL (e.g., https://github.com/user)",value:s.url,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"link-icon",className:"block text-sm font-medium text-gray-600 mb-1",children:"Icon"}),N.jsxs("div",{className:"flex items-center gap-2",children:[" ",N.jsxs("select",{id:"link-icon",name:"icon",value:s.icon,onChange:a,className:"flex-grow p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0,children:[N.jsx("option",{value:"",disabled:!0,children:"Select Icon"}),bh.map(h=>N.jsx("option",{value:h,children:h},h))]}),N.jsx(u,{size:24,className:"text-gray-500 flex-shrink-0"})]})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"link-order",className:"block text-sm font-medium text-gray-600 mb-1",children:"Order"}),N.jsx("input",{id:"link-order",type:"number",name:"order",placeholder:"Order (e.g., 1)",value:s.order,onChange:a,className:"w-full p-2 rounded bg-white text-gray-800 border border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",required:!0,min:"0"})]})]}),N.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[N.jsxs("button",{type:"submit",className:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[N.jsx(Va,{size:18})," ",e?"Save Changes":"Add Link"]}),N.jsxs("button",{type:"button",onClick:n,className:"flex items-center gap-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md border border-gray-300",children:[N.jsx(n_,{size:18})," Cancel"]})]})]})},cw=({link:r,index:e,isFirst:t,isLast:n,onEdit:i,onDelete:s,onMoveUp:o,onMoveDown:a})=>{const l=Up[r.icon]||Gl;return N.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow p-4 md:grid md:grid-cols-12 md:gap-4 md:items-center md:bg-transparent md:hover:bg-gray-50 md:shadow-none md:rounded-none md:border-b md:border-gray-200 md:last:border-b-0 md:py-3 md:px-3 transition-colors duration-150",children:[N.jsxs("div",{className:"md:hidden space-y-3",children:[N.jsxs("div",{className:"flex justify-between items-start gap-2",children:[N.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[N.jsx(l,{size:20,className:"text-gray-500 flex-shrink-0"}),N.jsx("span",{className:"font-semibold text-lg text-gray-800 truncate",children:r.name})]}),N.jsxs("span",{className:"text-sm text-gray-500 flex-shrink-0",children:["(Order: ",r.order,")"]})]}),N.jsxs("div",{className:"text-sm break-words",children:[N.jsx("span",{className:"font-medium text-gray-500",children:"URL: "}),N.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r.url})]}),N.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-200 mt-3",children:[N.jsx("button",{onClick:()=>o(e),disabled:t,className:`p-1 rounded ${t?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Up",children:N.jsx(Ma,{size:18})}),N.jsx("button",{onClick:()=>a(e),disabled:n,className:`p-1 rounded ${n?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Down",children:N.jsx(Da,{size:18})}),N.jsx("button",{onClick:()=>i(r),className:"text-yellow-500 hover:text-yellow-400 hover:bg-gray-100 p-1 rounded",title:"Edit",children:N.jsx(ki,{size:18})}),N.jsx("button",{onClick:()=>s(r.id),className:"text-red-600 hover:text-red-500 hover:bg-gray-100 p-1 rounded",title:"Delete",children:N.jsx(wr,{size:18})})]})]}),N.jsxs("div",{className:"hidden md:contents",children:[" ",N.jsx("div",{className:"col-span-1 text-center text-gray-700",children:r.order}),N.jsx("div",{className:"col-span-1 flex items-center justify-center",children:N.jsx(l,{size:20,className:"text-gray-500"})}),N.jsx("div",{className:"col-span-3 truncate pr-2 text-gray-800",children:r.name}),N.jsx("div",{className:"col-span-4 truncate pr-2",children:N.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r.url})}),N.jsxs("div",{className:"col-span-3 flex items-center justify-end gap-1 pr-2",children:[" ",N.jsx("button",{onClick:()=>o(e),disabled:t,className:`p-1 rounded ${t?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Up",children:N.jsx(Ma,{size:18})}),N.jsx("button",{onClick:()=>a(e),disabled:n,className:`p-1 rounded ${n?"text-gray-400 cursor-not-allowed opacity-50":"text-blue-600 hover:text-blue-500 hover:bg-gray-100"}`,title:"Move Down",children:N.jsx(Da,{size:18})}),N.jsx("button",{onClick:()=>i(r),className:"text-yellow-500 hover:text-yellow-400 hover:bg-gray-100 p-1 rounded",title:"Edit",children:N.jsx(ki,{size:18})}),N.jsx("button",{onClick:()=>s(r.id),className:"text-red-600 hover:text-red-500 hover:bg-gray-100 p-1 rounded",title:"Delete",children:N.jsx(wr,{size:18})})]})]})]})},uw=()=>{const{showToast:r,requestConfirmation:e}=Yt(),[t,n]=Y.useState([]),[i,s]=Y.useState(!0),[o,a]=Y.useState(!1),[l,u]=Y.useState(null),[h,d]=Y.useState(null),f=Y.useMemo(()=>de?_r(de,"socialLinks"):null,[]),p=Y.useCallback(async()=>{if(!de||!f){r("Error: Firestore is not initialized.","error"),s(!1);return}s(!0);try{const x=uo(f,ho("order","asc")),P=(await Mi(x)).docs.map(T=>({...T.data(),id:T.id}));n(P)}catch(x){console.error("Error fetching social links:",x),r("Failed to load social links. Please try again.","error")}finally{s(!1)}},[f,r]);Y.useEffect(()=>{p()},[p]);const _=()=>{a(!1),u(null),d(null)},g=async x=>{if(!de||!f){r("Error: Firestore is not initialized.","error");return}try{const w=t.length>0?Math.max(...t.map(P=>P.order))+1:0;await Bl(f,{...x,order:w}),r("Link added successfully!","success"),_(),p()}catch(w){console.error("Error adding link:",w),r("Failed to add link. Please try again.","error")}},y=async x=>{if(!l||!de){r("Error: Cannot update link or Firestore is not initialized.","error");return}try{const w=rt(de,"socialLinks",l);await Ms(w,x),r("Link updated successfully!","success"),_(),p()}catch(w){console.error("Error updating link:",w),r("Failed to update link. Please try again.","error")}},m=async(x,w)=>{if(!de){r("Error: Firestore is not initialized.","error");return}const P=w==="up"?x-1:x+1;if(P<0||P>=t.length)return;const T=t[x],A=t[P],S=Zd(de),E=rt(de,"socialLinks",T.id),j=rt(de,"socialLinks",A.id);S.update(E,{order:A.order}),S.update(j,{order:T.order});try{await S.commit(),r(`Link moved ${w} successfully.`,"success"),p()}catch(V){console.error(`Error moving link ${w}:`,V),r("Failed to reorder link. Please try again.","error")}},b=x=>m(x,"up"),k=x=>m(x,"down"),v=async x=>{const w=t.find(P=>P.id===x);w&&e({message:`Are you sure you want to delete the link "${w.name}"?`,onConfirm:async()=>{if(!de){r("Error: Firestore is not initialized.","error");return}try{const P=rt(de,"socialLinks",x);await Ul(P),r("Link deleted successfully!","success"),p(),l===x&&_()}catch(P){console.error("Error deleting link:",P),r("Failed to delete link. Please try again.","error")}},confirmText:"Delete Link",title:"Confirm Deletion"})},O=x=>{u(x.id),d({name:x.name,url:x.url,icon:x.icon,order:x.order}),a(!1)},R=x=>{l?y(x):g(x)};return N.jsxs("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow-lg text-gray-800",children:[N.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-900",children:"Manage Social Links"}),i&&N.jsx("p",{className:"text-center text-gray-500",children:"Loading links..."}),(o||l)&&N.jsx(lw,{initialData:h,isEditing:!!l,onSubmit:R,onCancel:_},l||"add-form"),!o&&!l&&!i&&N.jsxs("button",{onClick:()=>{a(!0),u(null),d(null)},className:"mb-6 flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[N.jsx(e_,{size:18})," Add New Link"]}),!i&&t.length>0&&N.jsxs("div",{className:"space-y-3",children:[N.jsxs("div",{className:"hidden md:grid md:grid-cols-12 gap-4 bg-gray-100 border-b border-gray-300 rounded-t-lg p-3 font-semibold text-gray-600 items-center sticky top-0 z-10",children:[N.jsx("div",{className:"col-span-1 text-center",children:"Order"}),N.jsx("div",{className:"col-span-1 text-center",children:"Icon"}),N.jsx("div",{className:"col-span-3",children:"Name"}),N.jsx("div",{className:"col-span-4",children:"URL"}),N.jsx("div",{className:"col-span-3 text-right pr-2",children:"Actions"})]}),t.map((x,w)=>N.jsx(cw,{link:x,index:w,isFirst:w===0,isLast:w===t.length-1,onEdit:O,onDelete:v,onMoveUp:b,onMoveDown:k},x.id))]}),!i&&t.length===0&&!o&&N.jsxs("div",{className:"text-center text-gray-500 mt-6 p-6 border border-dashed border-gray-300 rounded-lg bg-gray-50",children:[N.jsx("p",{className:"font-medium",children:"No social links found."}),N.jsx("p",{className:"text-sm mt-1",children:'Click "Add New Link" above to get started.'})]})]})},wh=({fieldKey:r,value:e,path:t,handleChange:n,editingPath:i,setEditingPath:s})=>{const o=t.join("."),a=i===o,l=r.replace(/([A-Z])/g," $1").replace(/^./,h=>h.toUpperCase()),u=/url|link/i.test(r);return N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:l}),a?u?N.jsx("input",{type:"url",id:o,name:o,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:h=>n(t,h.target.value),onBlur:()=>s(null),autoFocus:!0}):N.jsx("textarea",{id:o,name:o,rows:e.length>100?5:3,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:h=>n(t,h.target.value),onBlur:()=>s(null),autoFocus:!0}):N.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[40px] whitespace-pre-wrap text-gray-800 transition-colors duration-150 ease-in-out break-words",onClick:()=>s(o),children:e||N.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},o)},hw=({translations:r,handleInputChange:e,editingPath:t,setEditingPath:n,getStaticSectionName:i})=>{const s=r.en.generalInfo,o=r.en.about;return N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[N.jsxs("div",{className:"space-y-4",children:[" ",s?Object.entries(s).map(([a,l])=>typeof l=="string"?N.jsx(wh,{fieldKey:a,value:l,path:["generalInfo",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):N.jsx("p",{className:"text-gray-500 italic",children:"General Info data not available."})]}),N.jsxs("div",{className:"space-y-4",children:[" ",N.jsx("h3",{className:"text-xl font-semibold text-gray-800 capitalize border-b border-gray-300 pb-2 mb-4",children:i("about")}),o?Object.entries(o).map(([a,l])=>typeof l=="string"?N.jsx(wh,{fieldKey:a,value:l,path:["about",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):N.jsx("p",{className:"text-gray-500 italic",children:"About section data not available."})]})]})},fw=()=>{const{showToast:r,requestConfirmation:e}=Yt(),[t,n]=Y.useState([]),[i,s]=Y.useState(!1),[o,a]=Y.useState(null),l=Y.useMemo(()=>de?_r(de,"pages"):null,[]),u=Y.useCallback(async()=>{if(!de||!l){r("Error: Firestore database is not initialized.","error"),s(!1);return}s(!0);try{const m=uo(l,ho("order","asc")),k=(await Mi(m)).docs.map(v=>({id:v.id,...v.data()}));n(k)}catch(m){console.error("Error fetching pages:",m),r("Failed to load pages. Check console for details.","error")}finally{s(!1)}},[l,r]);Y.useEffect(()=>{u()},[u]);const h=Y.useCallback(()=>{a(null)},[]),d=Y.useCallback(async m=>{if(s(!0),!de){r("Error: Firestore database is not initialized.","error"),s(!1);return}try{let b;if(o){const v=t.find(O=>O.id===o);b=(v==null?void 0:v.order)??0}else b=t.length>0?Math.max(...t.map(v=>v.order))+1:0;const k={...m,order:b};if(o){const v=rt(de,"pages",o);await Ms(v,k),r("Page updated successfully!","success")}else{if(!l)throw new Error("Collection reference not available");await Bl(l,k),r("Page added successfully!","success")}h(),u()}catch(b){console.error("Error saving page:",b),r("Failed to save page. Check console for details.","error"),s(!1)}},[de,l,o,t,r,u,h]),f=Y.useCallback(m=>{var b;if(!m){r("Cannot delete page: Invalid ID.","error");return}e({message:`Are you sure you want to delete the page "${((b=t.find(k=>k.id===m))==null?void 0:b.title)||m}"?
This action cannot be undone.`,onConfirm:async()=>{if(!de){r("Error: Firestore database is not initialized.","error"),s(!1);return}s(!0);try{const k=rt(de,"pages",m);await Ul(k),r("Page deleted successfully!","success"),o===m&&h(),u()}catch(k){console.error("Error deleting page:",k),r("Failed to delete page. Check console for details.","error"),s(!1)}},confirmText:"Delete Page",title:"Confirm Deletion"})},[de,t,o,r,e,u,h]),p=Y.useCallback(m=>{if(!m.id){r("Cannot edit page: Invalid ID.","error");return}a(m.id)},[r]),_=Y.useCallback(async(m,b)=>{const k=b==="up"?m-1:m+1;if(k<0||k>=t.length)return;if(!de||!l){r("Error: Firestore database or collection ref is not initialized.","error");return}s(!0);const v=t[m],O=t[k],R=Zd(de),x=rt(l,v.id),w=rt(l,O.id);R.update(x,{order:O.order}),R.update(w,{order:v.order});try{await R.commit(),r(`Page moved ${b} successfully.`,"success"),u()}catch(P){console.error(`Error moving page ${b}:`,P),r("Failed to reorder page. Please try again.","error"),s(!1)}},[de,l,t,r,u]),g=Y.useCallback(m=>_(m,"up"),[_]),y=Y.useCallback(m=>_(m,"down"),[_]);return{pages:t,isLoading:i,isEditing:o,handleFormSubmit:d,handleDelete:f,startEditing:p,resetForm:h,handleMoveUp:g,handleMoveDown:y}};function dw(){this.__data__=[],this.size=0}var pw=dw;function mw(r,e){return r===e||r!==r&&e!==e}var Bp=mw,gw=Bp;function yw(r,e){for(var t=r.length;t--;)if(gw(r[t][0],e))return t;return-1}var mo=yw,vw=mo,_w=Array.prototype,bw=_w.splice;function ww(r){var e=this.__data__,t=vw(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():bw.call(e,t,1),--this.size,!0}var xw=ww,Ew=mo;function Tw(r){var e=this.__data__,t=Ew(e,r);return t<0?void 0:e[t][1]}var Aw=Tw,kw=mo;function Sw(r){return kw(this.__data__,r)>-1}var Iw=Sw,Nw=mo;function Pw(r,e){var t=this.__data__,n=Nw(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var Ow=Pw,Cw=pw,Rw=xw,jw=Aw,Lw=Iw,Dw=Ow;function jr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}jr.prototype.clear=Cw;jr.prototype.delete=Rw;jr.prototype.get=jw;jr.prototype.has=Lw;jr.prototype.set=Dw;var go=jr,Mw=go;function Vw(){this.__data__=new Mw,this.size=0}var $w=Vw;function Fw(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var qw=Fw;function Uw(r){return this.__data__.get(r)}var Bw=Uw;function zw(r){return this.__data__.has(r)}var Hw=zw,Gw=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,zp=Gw,Kw=zp,Ww=typeof self=="object"&&self&&self.Object===Object&&self,Qw=Kw||Ww||Function("return this")(),un=Qw,Yw=un,Jw=Yw.Symbol,nc=Jw,xh=nc,Hp=Object.prototype,Xw=Hp.hasOwnProperty,Zw=Hp.toString,ni=xh?xh.toStringTag:void 0;function e2(r){var e=Xw.call(r,ni),t=r[ni];try{r[ni]=void 0;var n=!0}catch{}var i=Zw.call(r);return n&&(e?r[ni]=t:delete r[ni]),i}var t2=e2,n2=Object.prototype,r2=n2.toString;function i2(r){return r2.call(r)}var s2=i2,Eh=nc,o2=t2,a2=s2,l2="[object Null]",c2="[object Undefined]",Th=Eh?Eh.toStringTag:void 0;function u2(r){return r==null?r===void 0?c2:l2:Th&&Th in Object(r)?o2(r):a2(r)}var yo=u2;function h2(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Gp=h2,f2=yo,d2=Gp,p2="[object AsyncFunction]",m2="[object Function]",g2="[object GeneratorFunction]",y2="[object Proxy]";function v2(r){if(!d2(r))return!1;var e=f2(r);return e==m2||e==g2||e==p2||e==y2}var Kp=v2,_2=un,b2=_2["__core-js_shared__"],w2=b2,la=w2,Ah=function(){var r=/[^.]+$/.exec(la&&la.keys&&la.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function x2(r){return!!Ah&&Ah in r}var E2=x2,T2=Function.prototype,A2=T2.toString;function k2(r){if(r!=null){try{return A2.call(r)}catch{}try{return r+""}catch{}}return""}var Wp=k2,S2=Kp,I2=E2,N2=Gp,P2=Wp,O2=/[\\^$.*+?()[\]{}|]/g,C2=/^\[object .+?Constructor\]$/,R2=Function.prototype,j2=Object.prototype,L2=R2.toString,D2=j2.hasOwnProperty,M2=RegExp("^"+L2.call(D2).replace(O2,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function V2(r){if(!N2(r)||I2(r))return!1;var e=S2(r)?M2:C2;return e.test(P2(r))}var $2=V2;function F2(r,e){return r==null?void 0:r[e]}var q2=F2,U2=$2,B2=q2;function z2(r,e){var t=B2(r,e);return U2(t)?t:void 0}var Lr=z2,H2=Lr,G2=un,K2=H2(G2,"Map"),rc=K2,W2=Lr,Q2=W2(Object,"create"),vo=Q2,kh=vo;function Y2(){this.__data__=kh?kh(null):{},this.size=0}var J2=Y2;function X2(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var Z2=X2,ex=vo,tx="__lodash_hash_undefined__",nx=Object.prototype,rx=nx.hasOwnProperty;function ix(r){var e=this.__data__;if(ex){var t=e[r];return t===tx?void 0:t}return rx.call(e,r)?e[r]:void 0}var sx=ix,ox=vo,ax=Object.prototype,lx=ax.hasOwnProperty;function cx(r){var e=this.__data__;return ox?e[r]!==void 0:lx.call(e,r)}var ux=cx,hx=vo,fx="__lodash_hash_undefined__";function dx(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=hx&&e===void 0?fx:e,this}var px=dx,mx=J2,gx=Z2,yx=sx,vx=ux,_x=px;function Dr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Dr.prototype.clear=mx;Dr.prototype.delete=gx;Dr.prototype.get=yx;Dr.prototype.has=vx;Dr.prototype.set=_x;var bx=Dr,Sh=bx,wx=go,xx=rc;function Ex(){this.size=0,this.__data__={hash:new Sh,map:new(xx||wx),string:new Sh}}var Tx=Ex;function Ax(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var kx=Ax,Sx=kx;function Ix(r,e){var t=r.__data__;return Sx(e)?t[typeof e=="string"?"string":"hash"]:t.map}var _o=Ix,Nx=_o;function Px(r){var e=Nx(this,r).delete(r);return this.size-=e?1:0,e}var Ox=Px,Cx=_o;function Rx(r){return Cx(this,r).get(r)}var jx=Rx,Lx=_o;function Dx(r){return Lx(this,r).has(r)}var Mx=Dx,Vx=_o;function $x(r,e){var t=Vx(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var Fx=$x,qx=Tx,Ux=Ox,Bx=jx,zx=Mx,Hx=Fx;function Mr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Mr.prototype.clear=qx;Mr.prototype.delete=Ux;Mr.prototype.get=Bx;Mr.prototype.has=zx;Mr.prototype.set=Hx;var Qp=Mr,Gx=go,Kx=rc,Wx=Qp,Qx=200;function Yx(r,e){var t=this.__data__;if(t instanceof Gx){var n=t.__data__;if(!Kx||n.length<Qx-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new Wx(n)}return t.set(r,e),this.size=t.size,this}var Jx=Yx,Xx=go,Zx=$w,eE=qw,tE=Bw,nE=Hw,rE=Jx;function Vr(r){var e=this.__data__=new Xx(r);this.size=e.size}Vr.prototype.clear=Zx;Vr.prototype.delete=eE;Vr.prototype.get=tE;Vr.prototype.has=nE;Vr.prototype.set=rE;var iE=Vr,sE="__lodash_hash_undefined__";function oE(r){return this.__data__.set(r,sE),this}var aE=oE;function lE(r){return this.__data__.has(r)}var cE=lE,uE=Qp,hE=aE,fE=cE;function Us(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new uE;++e<t;)this.add(r[e])}Us.prototype.add=Us.prototype.push=hE;Us.prototype.has=fE;var dE=Us;function pE(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var mE=pE;function gE(r,e){return r.has(e)}var yE=gE,vE=dE,_E=mE,bE=yE,wE=1,xE=2;function EE(r,e,t,n,i,s){var o=t&wE,a=r.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var u=s.get(r),h=s.get(e);if(u&&h)return u==e&&h==r;var d=-1,f=!0,p=t&xE?new vE:void 0;for(s.set(r,e),s.set(e,r);++d<a;){var _=r[d],g=e[d];if(n)var y=o?n(g,_,d,e,r,s):n(_,g,d,r,e,s);if(y!==void 0){if(y)continue;f=!1;break}if(p){if(!_E(e,function(m,b){if(!bE(p,b)&&(_===m||i(_,m,t,n,s)))return p.push(b)})){f=!1;break}}else if(!(_===g||i(_,g,t,n,s))){f=!1;break}}return s.delete(r),s.delete(e),f}var Yp=EE,TE=un,AE=TE.Uint8Array,kE=AE;function SE(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var IE=SE;function NE(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var PE=NE,Ih=nc,Nh=kE,OE=Bp,CE=Yp,RE=IE,jE=PE,LE=1,DE=2,ME="[object Boolean]",VE="[object Date]",$E="[object Error]",FE="[object Map]",qE="[object Number]",UE="[object RegExp]",BE="[object Set]",zE="[object String]",HE="[object Symbol]",GE="[object ArrayBuffer]",KE="[object DataView]",Ph=Ih?Ih.prototype:void 0,ca=Ph?Ph.valueOf:void 0;function WE(r,e,t,n,i,s,o){switch(t){case KE:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case GE:return!(r.byteLength!=e.byteLength||!s(new Nh(r),new Nh(e)));case ME:case VE:case qE:return OE(+r,+e);case $E:return r.name==e.name&&r.message==e.message;case UE:case zE:return r==e+"";case FE:var a=RE;case BE:var l=n&LE;if(a||(a=jE),r.size!=e.size&&!l)return!1;var u=o.get(r);if(u)return u==e;n|=DE,o.set(r,e);var h=CE(a(r),a(e),n,i,s,o);return o.delete(r),h;case HE:if(ca)return ca.call(r)==ca.call(e)}return!1}var QE=WE;function YE(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var JE=YE,XE=Array.isArray,ic=XE,ZE=JE,eT=ic;function tT(r,e,t){var n=e(r);return eT(r)?n:ZE(n,t(r))}var nT=tT;function rT(r,e){for(var t=-1,n=r==null?0:r.length,i=0,s=[];++t<n;){var o=r[t];e(o,t,r)&&(s[i++]=o)}return s}var iT=rT;function sT(){return[]}var oT=sT,aT=iT,lT=oT,cT=Object.prototype,uT=cT.propertyIsEnumerable,Oh=Object.getOwnPropertySymbols,hT=Oh?function(r){return r==null?[]:(r=Object(r),aT(Oh(r),function(e){return uT.call(r,e)}))}:lT,fT=hT;function dT(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var pT=dT;function mT(r){return r!=null&&typeof r=="object"}var bo=mT,gT=yo,yT=bo,vT="[object Arguments]";function _T(r){return yT(r)&&gT(r)==vT}var bT=_T,Ch=bT,wT=bo,Jp=Object.prototype,xT=Jp.hasOwnProperty,ET=Jp.propertyIsEnumerable,TT=Ch(function(){return arguments}())?Ch:function(r){return wT(r)&&xT.call(r,"callee")&&!ET.call(r,"callee")},AT=TT,Bs={exports:{}};function kT(){return!1}var ST=kT;Bs.exports;(function(r,e){var t=un,n=ST,i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,a=o?t.Buffer:void 0,l=a?a.isBuffer:void 0,u=l||n;r.exports=u})(Bs,Bs.exports);var Xp=Bs.exports,IT=9007199254740991,NT=/^(?:0|[1-9]\d*)$/;function PT(r,e){var t=typeof r;return e=e??IT,!!e&&(t=="number"||t!="symbol"&&NT.test(r))&&r>-1&&r%1==0&&r<e}var OT=PT,CT=9007199254740991;function RT(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=CT}var Zp=RT,jT=yo,LT=Zp,DT=bo,MT="[object Arguments]",VT="[object Array]",$T="[object Boolean]",FT="[object Date]",qT="[object Error]",UT="[object Function]",BT="[object Map]",zT="[object Number]",HT="[object Object]",GT="[object RegExp]",KT="[object Set]",WT="[object String]",QT="[object WeakMap]",YT="[object ArrayBuffer]",JT="[object DataView]",XT="[object Float32Array]",ZT="[object Float64Array]",eA="[object Int8Array]",tA="[object Int16Array]",nA="[object Int32Array]",rA="[object Uint8Array]",iA="[object Uint8ClampedArray]",sA="[object Uint16Array]",oA="[object Uint32Array]",ze={};ze[XT]=ze[ZT]=ze[eA]=ze[tA]=ze[nA]=ze[rA]=ze[iA]=ze[sA]=ze[oA]=!0;ze[MT]=ze[VT]=ze[YT]=ze[$T]=ze[JT]=ze[FT]=ze[qT]=ze[UT]=ze[BT]=ze[zT]=ze[HT]=ze[GT]=ze[KT]=ze[WT]=ze[QT]=!1;function aA(r){return DT(r)&&LT(r.length)&&!!ze[jT(r)]}var lA=aA;function cA(r){return function(e){return r(e)}}var uA=cA,zs={exports:{}};zs.exports;(function(r,e){var t=zp,n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();r.exports=a})(zs,zs.exports);var hA=zs.exports,fA=lA,dA=uA,Rh=hA,jh=Rh&&Rh.isTypedArray,pA=jh?dA(jh):fA,em=pA,mA=pT,gA=AT,yA=ic,vA=Xp,_A=OT,bA=em,wA=Object.prototype,xA=wA.hasOwnProperty;function EA(r,e){var t=yA(r),n=!t&&gA(r),i=!t&&!n&&vA(r),s=!t&&!n&&!i&&bA(r),o=t||n||i||s,a=o?mA(r.length,String):[],l=a.length;for(var u in r)(e||xA.call(r,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||_A(u,l)))&&a.push(u);return a}var TA=EA,AA=Object.prototype;function kA(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||AA;return r===t}var SA=kA;function IA(r,e){return function(t){return r(e(t))}}var NA=IA,PA=NA,OA=PA(Object.keys,Object),CA=OA,RA=SA,jA=CA,LA=Object.prototype,DA=LA.hasOwnProperty;function MA(r){if(!RA(r))return jA(r);var e=[];for(var t in Object(r))DA.call(r,t)&&t!="constructor"&&e.push(t);return e}var VA=MA,$A=Kp,FA=Zp;function qA(r){return r!=null&&FA(r.length)&&!$A(r)}var UA=qA,BA=TA,zA=VA,HA=UA;function GA(r){return HA(r)?BA(r):zA(r)}var KA=GA,WA=nT,QA=fT,YA=KA;function JA(r){return WA(r,YA,QA)}var XA=JA,Lh=XA,ZA=1,ek=Object.prototype,tk=ek.hasOwnProperty;function nk(r,e,t,n,i,s){var o=t&ZA,a=Lh(r),l=a.length,u=Lh(e),h=u.length;if(l!=h&&!o)return!1;for(var d=l;d--;){var f=a[d];if(!(o?f in e:tk.call(e,f)))return!1}var p=s.get(r),_=s.get(e);if(p&&_)return p==e&&_==r;var g=!0;s.set(r,e),s.set(e,r);for(var y=o;++d<l;){f=a[d];var m=r[f],b=e[f];if(n)var k=o?n(b,m,f,e,r,s):n(m,b,f,r,e,s);if(!(k===void 0?m===b||i(m,b,t,n,s):k)){g=!1;break}y||(y=f=="constructor")}if(g&&!y){var v=r.constructor,O=e.constructor;v!=O&&"constructor"in r&&"constructor"in e&&!(typeof v=="function"&&v instanceof v&&typeof O=="function"&&O instanceof O)&&(g=!1)}return s.delete(r),s.delete(e),g}var rk=nk,ik=Lr,sk=un,ok=ik(sk,"DataView"),ak=ok,lk=Lr,ck=un,uk=lk(ck,"Promise"),hk=uk,fk=Lr,dk=un,pk=fk(dk,"Set"),mk=pk,gk=Lr,yk=un,vk=gk(yk,"WeakMap"),_k=vk,Ua=ak,Ba=rc,za=hk,Ha=mk,Ga=_k,tm=yo,$r=Wp,Dh="[object Map]",bk="[object Object]",Mh="[object Promise]",Vh="[object Set]",$h="[object WeakMap]",Fh="[object DataView]",wk=$r(Ua),xk=$r(Ba),Ek=$r(za),Tk=$r(Ha),Ak=$r(Ga),$n=tm;(Ua&&$n(new Ua(new ArrayBuffer(1)))!=Fh||Ba&&$n(new Ba)!=Dh||za&&$n(za.resolve())!=Mh||Ha&&$n(new Ha)!=Vh||Ga&&$n(new Ga)!=$h)&&($n=function(r){var e=tm(r),t=e==bk?r.constructor:void 0,n=t?$r(t):"";if(n)switch(n){case wk:return Fh;case xk:return Dh;case Ek:return Mh;case Tk:return Vh;case Ak:return $h}return e});var kk=$n,ua=iE,Sk=Yp,Ik=QE,Nk=rk,qh=kk,Uh=ic,Bh=Xp,Pk=em,Ok=1,zh="[object Arguments]",Hh="[object Array]",fs="[object Object]",Ck=Object.prototype,Gh=Ck.hasOwnProperty;function Rk(r,e,t,n,i,s){var o=Uh(r),a=Uh(e),l=o?Hh:qh(r),u=a?Hh:qh(e);l=l==zh?fs:l,u=u==zh?fs:u;var h=l==fs,d=u==fs,f=l==u;if(f&&Bh(r)){if(!Bh(e))return!1;o=!0,h=!1}if(f&&!h)return s||(s=new ua),o||Pk(r)?Sk(r,e,t,n,i,s):Ik(r,e,l,t,n,i,s);if(!(t&Ok)){var p=h&&Gh.call(r,"__wrapped__"),_=d&&Gh.call(e,"__wrapped__");if(p||_){var g=p?r.value():r,y=_?e.value():e;return s||(s=new ua),i(g,y,t,n,s)}}return f?(s||(s=new ua),Nk(r,e,t,n,i,s)):!1}var jk=Rk,Lk=jk,Kh=bo;function nm(r,e,t,n,i){return r===e?!0:r==null||e==null||!Kh(r)&&!Kh(e)?r!==r&&e!==e:Lk(r,e,t,n,nm,i)}var Dk=nm,Mk=Dk;function Vk(r,e){return Mk(r,e)}var $k=Vk,rm={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:Ge,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),a=i(19),l=i(45),u=i(46),h=i(47),d=i(48),f=i(49),p=i(12),_=i(32),g=i(33),y=i(31),m=i(1),b={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:s.default,Format:o.default,Leaf:a.default,Embed:d.default,Scroll:l.default,Block:h.default,Inline:u.default,Text:f.default,Attributor:{Attribute:p.default,Class:_.default,Style:g.default,Store:y.default}};n.default=b},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var k in b)b.hasOwnProperty(k)&&(m[k]=b[k])};return function(m,b){y(m,b);function k(){this.constructor=m}m.prototype=b===null?Object.create(b):(k.prototype=b.prototype,new k)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(y){s(m,y);function m(b){var k=this;return b="[Parchment] "+b,k=y.call(this,b)||this,k.message=b,k.name=k.constructor.name,k}return m}(Error);n.ParchmentError=o;var a={},l={},u={},h={};n.DATA_KEY="__blot";var d;(function(y){y[y.TYPE=3]="TYPE",y[y.LEVEL=12]="LEVEL",y[y.ATTRIBUTE=13]="ATTRIBUTE",y[y.BLOT=14]="BLOT",y[y.INLINE=7]="INLINE",y[y.BLOCK=11]="BLOCK",y[y.BLOCK_BLOT=10]="BLOCK_BLOT",y[y.INLINE_BLOT=6]="INLINE_BLOT",y[y.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",y[y.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",y[y.ANY=15]="ANY"})(d=n.Scope||(n.Scope={}));function f(y,m){var b=_(y);if(b==null)throw new o("Unable to create "+y+" blot");var k=b,v=y instanceof Node||y.nodeType===Node.TEXT_NODE?y:k.create(m);return new k(v,m)}n.create=f;function p(y,m){return m===void 0&&(m=!1),y==null?null:y[n.DATA_KEY]!=null?y[n.DATA_KEY].blot:m?p(y.parentNode,m):null}n.find=p;function _(y,m){m===void 0&&(m=d.ANY);var b;if(typeof y=="string")b=h[y]||a[y];else if(y instanceof Text||y.nodeType===Node.TEXT_NODE)b=h.text;else if(typeof y=="number")y&d.LEVEL&d.BLOCK?b=h.block:y&d.LEVEL&d.INLINE&&(b=h.inline);else if(y instanceof HTMLElement){var k=(y.getAttribute("class")||"").split(/\s+/);for(var v in k)if(b=l[k[v]],b)break;b=b||u[y.tagName]}return b==null?null:m&d.LEVEL&b.scope&&m&d.TYPE&b.scope?b:null}n.query=_;function g(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];if(y.length>1)return y.map(function(v){return g(v)});var b=y[0];if(typeof b.blotName!="string"&&typeof b.attrName!="string")throw new o("Invalid definition");if(b.blotName==="abstract")throw new o("Cannot register abstract class");if(h[b.blotName||b.attrName]=b,typeof b.keyName=="string")a[b.keyName]=b;else if(b.className!=null&&(l[b.className]=b),b.tagName!=null){Array.isArray(b.tagName)?b.tagName=b.tagName.map(function(v){return v.toUpperCase()}):b.tagName=b.tagName.toUpperCase();var k=Array.isArray(b.tagName)?b.tagName:[b.tagName];k.forEach(function(v){(u[v]==null||b.className==null)&&(u[v]=b)})}return b}n.register=g},function(t,n,i){var s=i(51),o=i(11),a=i(3),l=i(20),u="\0",h=function(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]};h.prototype.insert=function(d,f){var p={};return d.length===0?this:(p.insert=d,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p))},h.prototype.delete=function(d){return d<=0?this:this.push({delete:d})},h.prototype.retain=function(d,f){if(d<=0)return this;var p={retain:d};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p)},h.prototype.push=function(d){var f=this.ops.length,p=this.ops[f-1];if(d=a(!0,{},d),typeof p=="object"){if(typeof d.delete=="number"&&typeof p.delete=="number")return this.ops[f-1]={delete:p.delete+d.delete},this;if(typeof p.delete=="number"&&d.insert!=null&&(f-=1,p=this.ops[f-1],typeof p!="object"))return this.ops.unshift(d),this;if(o(d.attributes,p.attributes)){if(typeof d.insert=="string"&&typeof p.insert=="string")return this.ops[f-1]={insert:p.insert+d.insert},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof p.retain=="number")return this.ops[f-1]={retain:p.retain+d.retain},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this}}return f===this.ops.length?this.ops.push(d):this.ops.splice(f,0,d),this},h.prototype.chop=function(){var d=this.ops[this.ops.length-1];return d&&d.retain&&!d.attributes&&this.ops.pop(),this},h.prototype.filter=function(d){return this.ops.filter(d)},h.prototype.forEach=function(d){this.ops.forEach(d)},h.prototype.map=function(d){return this.ops.map(d)},h.prototype.partition=function(d){var f=[],p=[];return this.forEach(function(_){var g=d(_)?f:p;g.push(_)}),[f,p]},h.prototype.reduce=function(d,f){return this.ops.reduce(d,f)},h.prototype.changeLength=function(){return this.reduce(function(d,f){return f.insert?d+l.length(f):f.delete?d-f.delete:d},0)},h.prototype.length=function(){return this.reduce(function(d,f){return d+l.length(f)},0)},h.prototype.slice=function(d,f){d=d||0,typeof f!="number"&&(f=1/0);for(var p=[],_=l.iterator(this.ops),g=0;g<f&&_.hasNext();){var y;g<d?y=_.next(d-g):(y=_.next(f-g),p.push(y)),g+=l.length(y)}return new h(p)},h.prototype.compose=function(d){var f=l.iterator(this.ops),p=l.iterator(d.ops),_=[],g=p.peek();if(g!=null&&typeof g.retain=="number"&&g.attributes==null){for(var y=g.retain;f.peekType()==="insert"&&f.peekLength()<=y;)y-=f.peekLength(),_.push(f.next());g.retain-y>0&&p.next(g.retain-y)}for(var m=new h(_);f.hasNext()||p.hasNext();)if(p.peekType()==="insert")m.push(p.next());else if(f.peekType()==="delete")m.push(f.next());else{var b=Math.min(f.peekLength(),p.peekLength()),k=f.next(b),v=p.next(b);if(typeof v.retain=="number"){var O={};typeof k.retain=="number"?O.retain=b:O.insert=k.insert;var R=l.attributes.compose(k.attributes,v.attributes,typeof k.retain=="number");if(R&&(O.attributes=R),m.push(O),!p.hasNext()&&o(m.ops[m.ops.length-1],O)){var x=new h(f.rest());return m.concat(x).chop()}}else typeof v.delete=="number"&&typeof k.retain=="number"&&m.push(v)}return m.chop()},h.prototype.concat=function(d){var f=new h(this.ops.slice());return d.ops.length>0&&(f.push(d.ops[0]),f.ops=f.ops.concat(d.ops.slice(1))),f},h.prototype.diff=function(d,f){if(this.ops===d.ops)return new h;var p=[this,d].map(function(b){return b.map(function(k){if(k.insert!=null)return typeof k.insert=="string"?k.insert:u;var v=b===d?"on":"with";throw new Error("diff() called "+v+" non-document")}).join("")}),_=new h,g=s(p[0],p[1],f),y=l.iterator(this.ops),m=l.iterator(d.ops);return g.forEach(function(b){for(var k=b[1].length;k>0;){var v=0;switch(b[0]){case s.INSERT:v=Math.min(m.peekLength(),k),_.push(m.next(v));break;case s.DELETE:v=Math.min(k,y.peekLength()),y.next(v),_.delete(v);break;case s.EQUAL:v=Math.min(y.peekLength(),m.peekLength(),k);var O=y.next(v),R=m.next(v);o(O.insert,R.insert)?_.retain(v,l.attributes.diff(O.attributes,R.attributes)):_.push(R).delete(v);break}k-=v}}),_.chop()},h.prototype.eachLine=function(d,f){f=f||`
`;for(var p=l.iterator(this.ops),_=new h,g=0;p.hasNext();){if(p.peekType()!=="insert")return;var y=p.peek(),m=l.length(y)-p.peekLength(),b=typeof y.insert=="string"?y.insert.indexOf(f,m)-m:-1;if(b<0)_.push(p.next());else if(b>0)_.push(p.next(b));else{if(d(_,p.next(1).attributes||{},g)===!1)return;g+=1,_=new h}}_.length()>0&&d(_,{},g)},h.prototype.transform=function(d,f){if(f=!!f,typeof d=="number")return this.transformPosition(d,f);for(var p=l.iterator(this.ops),_=l.iterator(d.ops),g=new h;p.hasNext()||_.hasNext();)if(p.peekType()==="insert"&&(f||_.peekType()!=="insert"))g.retain(l.length(p.next()));else if(_.peekType()==="insert")g.push(_.next());else{var y=Math.min(p.peekLength(),_.peekLength()),m=p.next(y),b=_.next(y);if(m.delete)continue;b.delete?g.push(b):g.retain(y,l.attributes.transform(m.attributes,b.attributes,f))}return g.chop()},h.prototype.transformPosition=function(d,f){f=!!f;for(var p=l.iterator(this.ops),_=0;p.hasNext()&&_<=d;){var g=p.peekLength(),y=p.peekType();if(p.next(),y==="delete"){d-=Math.min(g,d-_);continue}else y==="insert"&&(_<d||!f)&&(d+=g);_+=g}return d},t.exports=h},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=function(p){return typeof Array.isArray=="function"?Array.isArray(p):s.call(p)==="[object Array]"},u=function(p){if(!p||s.call(p)!=="[object Object]")return!1;var _=i.call(p,"constructor"),g=p.constructor&&p.constructor.prototype&&i.call(p.constructor.prototype,"isPrototypeOf");if(p.constructor&&!_&&!g)return!1;var y;for(y in p);return typeof y>"u"||i.call(p,y)},h=function(p,_){o&&_.name==="__proto__"?o(p,_.name,{enumerable:!0,configurable:!0,value:_.newValue,writable:!0}):p[_.name]=_.newValue},d=function(p,_){if(_==="__proto__")if(i.call(p,_)){if(a)return a(p,_).value}else return;return p[_]};t.exports=function f(){var p,_,g,y,m,b,k=arguments[0],v=1,O=arguments.length,R=!1;for(typeof k=="boolean"&&(R=k,k=arguments[1]||{},v=2),(k==null||typeof k!="object"&&typeof k!="function")&&(k={});v<O;++v)if(p=arguments[v],p!=null)for(_ in p)g=d(k,_),y=d(p,_),k!==y&&(R&&y&&(u(y)||(m=l(y)))?(m?(m=!1,b=g&&l(g)?g:[]):b=g&&u(g)?g:{},h(k,{name:_,newValue:f(R,b,y)})):typeof y<"u"&&h(k,{name:_,newValue:y}));return k}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function A(S,E){for(var j=0;j<E.length;j++){var V=E[j];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(S,V.key,V)}}return function(S,E,j){return E&&A(S.prototype,E),j&&A(S,j),S}}(),o=function A(S,E,j){S===null&&(S=Function.prototype);var V=Object.getOwnPropertyDescriptor(S,E);if(V===void 0){var z=Object.getPrototypeOf(S);return z===null?void 0:A(z,E,j)}else{if("value"in V)return V.value;var H=V.get;return H===void 0?void 0:H.call(j)}},a=i(3),l=k(a),u=i(2),h=k(u),d=i(0),f=k(d),p=i(16),_=k(p),g=i(6),y=k(g),m=i(7),b=k(m);function k(A){return A&&A.__esModule?A:{default:A}}function v(A,S){if(!(A instanceof S))throw new TypeError("Cannot call a class as a function")}function O(A,S){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:A}function R(A,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);A.prototype=Object.create(S&&S.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(A,S):A.__proto__=S)}var x=1,w=function(A){R(S,A);function S(){return v(this,S),O(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"attach",value:function(){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"attach",this).call(this),this.attributes=new f.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new h.default().insert(this.value(),(0,l.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(j,V){var z=f.default.query(j,f.default.Scope.BLOCK_ATTRIBUTE);z!=null&&this.attributes.attribute(z,V)}},{key:"formatAt",value:function(j,V,z,H){this.format(z,H)}},{key:"insertAt",value:function(j,V,z){if(typeof V=="string"&&V.endsWith(`
`)){var H=f.default.create(P.blotName);this.parent.insertBefore(H,j===0?this:this.next),H.insertAt(0,V.slice(0,-1))}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,j,V,z)}}]),S}(f.default.Embed);w.scope=f.default.Scope.BLOCK_BLOT;var P=function(A){R(S,A);function S(E){v(this,S);var j=O(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,E));return j.cache={},j}return s(S,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(f.default.Leaf).reduce(function(j,V){return V.length()===0?j:j.insert(V.value(),T(V))},new h.default).insert(`
`,T(this))),this.cache.delta}},{key:"deleteAt",value:function(j,V){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"deleteAt",this).call(this,j,V),this.cache={}}},{key:"formatAt",value:function(j,V,z,H){V<=0||(f.default.query(z,f.default.Scope.BLOCK)?j+V===this.length()&&this.format(z,H):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,j,Math.min(V,this.length()-j-1),z,H),this.cache={})}},{key:"insertAt",value:function(j,V,z){if(z!=null)return o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,j,V,z);if(V.length!==0){var H=V.split(`
`),ee=H.shift();ee.length>0&&(j<this.length()-1||this.children.tail==null?o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,Math.min(j,this.length()-1),ee):this.children.tail.insertAt(this.children.tail.length(),ee),this.cache={});var G=this;H.reduce(function(q,L){return G=G.split(q,!0),G.insertAt(0,L),L.length},j+ee.length)}}},{key:"insertBefore",value:function(j,V){var z=this.children.head;o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertBefore",this).call(this,j,V),z instanceof _.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"length",this).call(this)+x),this.cache.length}},{key:"moveChildren",value:function(j,V){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"moveChildren",this).call(this,j,V),this.cache={}}},{key:"optimize",value:function(j){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,j),this.cache={}}},{key:"path",value:function(j){return o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"path",this).call(this,j,!0)}},{key:"removeChild",value:function(j){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"removeChild",this).call(this,j),this.cache={}}},{key:"split",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(V&&(j===0||j>=this.length()-x)){var z=this.clone();return j===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var H=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"split",this).call(this,j,V);return this.cache={},H}}}]),S}(f.default.Block);P.blotName="block",P.tagName="P",P.defaultChild="break",P.allowedChildren=[y.default,f.default.Embed,b.default];function T(A){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return A==null||(typeof A.formats=="function"&&(S=(0,l.default)(S,A.formats())),A.parent==null||A.parent.blotName=="scroll"||A.parent.statics.scope!==A.statics.scope)?S:T(A.parent,S)}n.bubbleFormats=T,n.BlockEmbed=w,n.default=P},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},o=function(){function G(q,L){var $=[],F=!0,W=!1,U=void 0;try{for(var M=q[Symbol.iterator](),B;!(F=(B=M.next()).done)&&($.push(B.value),!(L&&$.length===L));F=!0);}catch(K){W=!0,U=K}finally{try{!F&&M.return&&M.return()}finally{if(W)throw U}}return $}return function(q,L){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return G(q,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function G(q,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(q,F.key,F)}}return function(q,L,$){return L&&G(q.prototype,L),$&&G(q,$),q}}();i(50);var l=i(2),u=T(l),h=i(14),d=T(h),f=i(8),p=T(f),_=i(9),g=T(_),y=i(0),m=T(y),b=i(15),k=T(b),v=i(3),O=T(v),R=i(10),x=T(R),w=i(34),P=T(w);function T(G){return G&&G.__esModule?G:{default:G}}function A(G,q,L){return q in G?Object.defineProperty(G,q,{value:L,enumerable:!0,configurable:!0,writable:!0}):G[q]=L,G}function S(G,q){if(!(G instanceof q))throw new TypeError("Cannot call a class as a function")}var E=(0,x.default)("quill"),j=function(){a(G,null,[{key:"debug",value:function(L){L===!0&&(L="log"),x.default.level(L)}},{key:"find",value:function(L){return L.__quill||m.default.find(L)}},{key:"import",value:function(L){return this.imports[L]==null&&E.error("Cannot import "+L+". Are you sure it was registered?"),this.imports[L]}},{key:"register",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof L!="string"){var U=L.attrName||L.blotName;typeof U=="string"?this.register("formats/"+U,L,$):Object.keys(L).forEach(function(M){F.register(M,L[M],$)})}else this.imports[L]!=null&&!W&&E.warn("Overwriting "+L+" with",$),this.imports[L]=$,(L.startsWith("blots/")||L.startsWith("formats/"))&&$.blotName!=="abstract"?m.default.register($):L.startsWith("modules")&&typeof $.register=="function"&&$.register()}}]);function G(q){var L=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(S(this,G),this.options=V(q,$),this.container=this.options.container,this.container==null)return E.error("Invalid Quill container",q);this.options.debug&&G.debug(this.options.debug);var F=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new p.default,this.scroll=m.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new d.default(this.scroll),this.selection=new k.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(p.default.events.EDITOR_CHANGE,function(U){U===p.default.events.TEXT_CHANGE&&L.root.classList.toggle("ql-blank",L.editor.isBlank())}),this.emitter.on(p.default.events.SCROLL_UPDATE,function(U,M){var B=L.selection.lastRange,K=B&&B.length===0?B.index:void 0;z.call(L,function(){return L.editor.update(null,M,K)},U)});var W=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+F+"<p><br></p></div>");this.setContents(W),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return a(G,[{key:"addContainer",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof L=="string"){var F=L;L=document.createElement("div"),L.classList.add(F)}return this.container.insertBefore(L,$),L}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(L,$,F){var W=this,U=H(L,$,F),M=o(U,4);return L=M[0],$=M[1],F=M[3],z.call(this,function(){return W.editor.deleteText(L,$)},F,L,-1*$)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(L),this.container.classList.toggle("ql-disabled",!L)}},{key:"focus",value:function(){var L=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=L,this.scrollIntoView()}},{key:"format",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:p.default.sources.API;return z.call(this,function(){var U=F.getSelection(!0),M=new u.default;if(U==null)return M;if(m.default.query(L,m.default.Scope.BLOCK))M=F.editor.formatLine(U.index,U.length,A({},L,$));else{if(U.length===0)return F.selection.format(L,$),M;M=F.editor.formatText(U.index,U.length,A({},L,$))}return F.setSelection(U,p.default.sources.SILENT),M},W)}},{key:"formatLine",value:function(L,$,F,W,U){var M=this,B=void 0,K=H(L,$,F,W,U),J=o(K,4);return L=J[0],$=J[1],B=J[2],U=J[3],z.call(this,function(){return M.editor.formatLine(L,$,B)},U,L,0)}},{key:"formatText",value:function(L,$,F,W,U){var M=this,B=void 0,K=H(L,$,F,W,U),J=o(K,4);return L=J[0],$=J[1],B=J[2],U=J[3],z.call(this,function(){return M.editor.formatText(L,$,B)},U,L,0)}},{key:"getBounds",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=void 0;typeof L=="number"?F=this.selection.getBounds(L,$):F=this.selection.getBounds(L.index,L.length);var W=this.container.getBoundingClientRect();return{bottom:F.bottom-W.top,height:F.height,left:F.left-W.left,right:F.right-W.left,top:F.top-W.top,width:F.width}}},{key:"getContents",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-L,F=H(L,$),W=o(F,2);return L=W[0],$=W[1],this.editor.getContents(L,$)}},{key:"getFormat",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof L=="number"?this.editor.getFormat(L,$):this.editor.getFormat(L.index,L.length)}},{key:"getIndex",value:function(L){return L.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(L){return this.scroll.leaf(L)}},{key:"getLine",value:function(L){return this.scroll.line(L)}},{key:"getLines",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof L!="number"?this.scroll.lines(L.index,L.length):this.scroll.lines(L,$)}},{key:"getModule",value:function(L){return this.theme.modules[L]}},{key:"getSelection",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return L&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-L,F=H(L,$),W=o(F,2);return L=W[0],$=W[1],this.editor.getText(L,$)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(L,$,F){var W=this,U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:G.sources.API;return z.call(this,function(){return W.editor.insertEmbed(L,$,F)},U,L)}},{key:"insertText",value:function(L,$,F,W,U){var M=this,B=void 0,K=H(L,0,F,W,U),J=o(K,4);return L=J[0],B=J[2],U=J[3],z.call(this,function(){return M.editor.insertText(L,$,B)},U,L,$.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(L,$,F){this.clipboard.dangerouslyPasteHTML(L,$,F)}},{key:"removeFormat",value:function(L,$,F){var W=this,U=H(L,$,F),M=o(U,4);return L=M[0],$=M[1],F=M[3],z.call(this,function(){return W.editor.removeFormat(L,$)},F,L)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(L){var $=this,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return z.call(this,function(){L=new u.default(L);var W=$.getLength(),U=$.editor.deleteText(0,W),M=$.editor.applyDelta(L),B=M.ops[M.ops.length-1];B!=null&&typeof B.insert=="string"&&B.insert[B.insert.length-1]===`
`&&($.editor.deleteText($.getLength()-1,1),M.delete(1));var K=U.compose(M);return K},F)}},{key:"setSelection",value:function(L,$,F){if(L==null)this.selection.setRange(null,$||G.sources.API);else{var W=H(L,$,F),U=o(W,4);L=U[0],$=U[1],F=U[3],this.selection.setRange(new b.Range(L,$),F),F!==p.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API,F=new u.default().insert(L);return this.setContents(F,$)}},{key:"update",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p.default.sources.USER,$=this.scroll.update(L);return this.selection.update(L),$}},{key:"updateContents",value:function(L){var $=this,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return z.call(this,function(){return L=new u.default(L),$.editor.applyDelta(L,F)},F,!0)}}]),G}();j.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},j.events=p.default.events,j.sources=p.default.sources,j.version="1.3.7",j.imports={delta:u.default,parchment:m.default,"core/module":g.default,"core/theme":P.default};function V(G,q){if(q=(0,O.default)(!0,{container:G,modules:{clipboard:!0,keyboard:!0,history:!0}},q),!q.theme||q.theme===j.DEFAULTS.theme)q.theme=P.default;else if(q.theme=j.import("themes/"+q.theme),q.theme==null)throw new Error("Invalid theme "+q.theme+". Did you register it?");var L=(0,O.default)(!0,{},q.theme.DEFAULTS);[L,q].forEach(function(W){W.modules=W.modules||{},Object.keys(W.modules).forEach(function(U){W.modules[U]===!0&&(W.modules[U]={})})});var $=Object.keys(L.modules).concat(Object.keys(q.modules)),F=$.reduce(function(W,U){var M=j.import("modules/"+U);return M==null?E.error("Cannot load "+U+" module. Are you sure you registered it?"):W[U]=M.DEFAULTS||{},W},{});return q.modules!=null&&q.modules.toolbar&&q.modules.toolbar.constructor!==Object&&(q.modules.toolbar={container:q.modules.toolbar}),q=(0,O.default)(!0,{},j.DEFAULTS,{modules:F},L,q),["bounds","container","scrollingContainer"].forEach(function(W){typeof q[W]=="string"&&(q[W]=document.querySelector(q[W]))}),q.modules=Object.keys(q.modules).reduce(function(W,U){return q.modules[U]&&(W[U]=q.modules[U]),W},{}),q}function z(G,q,L,$){if(this.options.strict&&!this.isEnabled()&&q===p.default.sources.USER)return new u.default;var F=L==null?null:this.getSelection(),W=this.editor.delta,U=G();if(F!=null&&(L===!0&&(L=F.index),$==null?F=ee(F,U,q):$!==0&&(F=ee(F,L,$,q)),this.setSelection(F,p.default.sources.SILENT)),U.length()>0){var M,B=[p.default.events.TEXT_CHANGE,U,W,q];if((M=this.emitter).emit.apply(M,[p.default.events.EDITOR_CHANGE].concat(B)),q!==p.default.sources.SILENT){var K;(K=this.emitter).emit.apply(K,B)}}return U}function H(G,q,L,$,F){var W={};return typeof G.index=="number"&&typeof G.length=="number"?typeof q!="number"?(F=$,$=L,L=q,q=G.length,G=G.index):(q=G.length,G=G.index):typeof q!="number"&&(F=$,$=L,L=q,q=0),(typeof L>"u"?"undefined":s(L))==="object"?(W=L,F=$):typeof L=="string"&&($!=null?W[L]=$:F=L),F=F||p.default.sources.API,[G,q,W,F]}function ee(G,q,L,$){if(G==null)return null;var F=void 0,W=void 0;if(q instanceof u.default){var U=[G.index,G.index+G.length].map(function(J){return q.transformPosition(J,$!==p.default.sources.USER)}),M=o(U,2);F=M[0],W=M[1]}else{var B=[G.index,G.index+G.length].map(function(J){return J<q||J===q&&$===p.default.sources.USER?J:L>=0?J+L:Math.max(q,J+L)}),K=o(B,2);F=K[0],W=K[1]}return new b.Range(F,W-F)}n.expandConfig=V,n.overload=H,n.default=j},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var k=0;k<b.length;k++){var v=b[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,k){return b&&y(m.prototype,b),k&&y(m,k),m}}(),o=function y(m,b,k){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,k)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(k)}},a=i(7),l=d(a),u=i(0),h=d(u);function d(y){return y&&y.__esModule?y:{default:y}}function f(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function p(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function _(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var g=function(y){_(m,y);function m(){return f(this,m),p(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"formatAt",value:function(k,v,O,R){if(m.compare(this.statics.blotName,O)<0&&h.default.query(O,h.default.Scope.BLOT)){var x=this.isolate(k,v);R&&x.wrap(O,R)}else o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"formatAt",this).call(this,k,v,O,R)}},{key:"optimize",value:function(k){if(o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,k),this.parent instanceof m&&m.compare(this.statics.blotName,this.parent.statics.blotName)>0){var v=this.parent.isolate(this.offset(),this.length());this.moveChildren(v),v.wrap(this)}}}],[{key:"compare",value:function(k,v){var O=m.order.indexOf(k),R=m.order.indexOf(v);return O>=0||R>=0?O-R:k===v?0:k<v?-1:1}}]),m}(h.default.Inline);g.allowedChildren=[g,h.default.Embed,l.default],g.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function u(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default.Text);n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(k,v){for(var O=0;O<v.length;O++){var R=v[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(k,R.key,R)}}return function(k,v,O){return v&&b(k.prototype,v),O&&b(k,O),k}}(),o=function b(k,v,O){k===null&&(k=Function.prototype);var R=Object.getOwnPropertyDescriptor(k,v);if(R===void 0){var x=Object.getPrototypeOf(k);return x===null?void 0:b(x,v,O)}else{if("value"in R)return R.value;var w=R.get;return w===void 0?void 0:w.call(O)}},a=i(54),l=d(a),u=i(10),h=d(u);function d(b){return b&&b.__esModule?b:{default:b}}function f(b,k){if(!(b instanceof k))throw new TypeError("Cannot call a class as a function")}function p(b,k){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:b}function _(b,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);b.prototype=Object.create(k&&k.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(b,k):b.__proto__=k)}var g=(0,h.default)("quill:events"),y=["selectionchange","mousedown","mouseup","click"];y.forEach(function(b){document.addEventListener(b,function(){for(var k=arguments.length,v=Array(k),O=0;O<k;O++)v[O]=arguments[O];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(R){if(R.__quill&&R.__quill.emitter){var x;(x=R.__quill.emitter).handleDOM.apply(x,v)}})})});var m=function(b){_(k,b);function k(){f(this,k);var v=p(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));return v.listeners={},v.on("error",g.error),v}return s(k,[{key:"emit",value:function(){g.log.apply(g,arguments),o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(O){for(var R=arguments.length,x=Array(R>1?R-1:0),w=1;w<R;w++)x[w-1]=arguments[w];(this.listeners[O.type]||[]).forEach(function(P){var T=P.node,A=P.handler;(O.target===T||T.contains(O.target))&&A.apply(void 0,[O].concat(x))})}},{key:"listenDOM",value:function(O,R,x){this.listeners[O]||(this.listeners[O]=[]),this.listeners[O].push({node:R,handler:x})}}]),k}(l.default);m.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},m.sources={API:"api",SILENT:"silent",USER:"user"},n.default=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}var o=function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,a),this.quill=l,this.options=u};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function a(u){if(s.indexOf(u)<=s.indexOf(o)){for(var h,d=arguments.length,f=Array(d>1?d-1:0),p=1;p<d;p++)f[p-1]=arguments[p];(h=console)[u].apply(h,f)}}function l(u){return s.reduce(function(h,d){return h[d]=a.bind(console,d,u),h},{})}a.level=l.level=function(u){o=u},n.default=l},function(t,n,i){var s=Array.prototype.slice,o=i(52),a=i(53),l=t.exports=function(f,p,_){return _||(_={}),f===p?!0:f instanceof Date&&p instanceof Date?f.getTime()===p.getTime():!f||!p||typeof f!="object"&&typeof p!="object"?_.strict?f===p:f==p:d(f,p,_)};function u(f){return f==null}function h(f){return!(!f||typeof f!="object"||typeof f.length!="number"||typeof f.copy!="function"||typeof f.slice!="function"||f.length>0&&typeof f[0]!="number")}function d(f,p,_){var g,y;if(u(f)||u(p)||f.prototype!==p.prototype)return!1;if(a(f))return a(p)?(f=s.call(f),p=s.call(p),l(f,p,_)):!1;if(h(f)){if(!h(p)||f.length!==p.length)return!1;for(g=0;g<f.length;g++)if(f[g]!==p[g])return!1;return!0}try{var m=o(f),b=o(p)}catch{return!1}if(m.length!=b.length)return!1;for(m.sort(),b.sort(),g=m.length-1;g>=0;g--)if(m[g]!=b[g])return!1;for(g=m.length-1;g>=0;g--)if(y=m[g],!l(f[y],p[y],_))return!1;return typeof f==typeof p}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l,u,h){h===void 0&&(h={}),this.attrName=l,this.keyName=u;var d=s.Scope.TYPE&s.Scope.ATTRIBUTE;h.scope!=null?this.scope=h.scope&s.Scope.LEVEL|d:this.scope=s.Scope.ATTRIBUTE,h.whitelist!=null&&(this.whitelist=h.whitelist)}return a.keys=function(l){return[].map.call(l.attributes,function(u){return u.name})},a.prototype.add=function(l,u){return this.canAdd(l,u)?(l.setAttribute(this.keyName,u),!0):!1},a.prototype.canAdd=function(l,u){var h=s.query(l,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return h==null?!1:this.whitelist==null?!0:typeof u=="string"?this.whitelist.indexOf(u.replace(/["']/g,""))>-1:this.whitelist.indexOf(u)>-1},a.prototype.remove=function(l){l.removeAttribute(this.keyName)},a.prototype.value=function(l){var u=l.getAttribute(this.keyName);return this.canAdd(l,u)&&u?u:""},a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function w(P,T){var A=[],S=!0,E=!1,j=void 0;try{for(var V=P[Symbol.iterator](),z;!(S=(z=V.next()).done)&&(A.push(z.value),!(T&&A.length===T));S=!0);}catch(H){E=!0,j=H}finally{try{!S&&V.return&&V.return()}finally{if(E)throw j}}return A}return function(P,T){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return w(P,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(P,T){for(var A=0;A<T.length;A++){var S=T[A];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(P,S.key,S)}}return function(P,T,A){return T&&w(P.prototype,T),A&&w(P,A),P}}(),a=function w(P,T,A){P===null&&(P=Function.prototype);var S=Object.getOwnPropertyDescriptor(P,T);if(S===void 0){var E=Object.getPrototypeOf(P);return E===null?void 0:w(E,T,A)}else{if("value"in S)return S.value;var j=S.get;return j===void 0?void 0:j.call(A)}},l=i(2),u=b(l),h=i(0),d=b(h),f=i(4),p=b(f),_=i(6),g=b(_),y=i(7),m=b(y);function b(w){return w&&w.__esModule?w:{default:w}}function k(w,P){if(!(w instanceof P))throw new TypeError("Cannot call a class as a function")}function v(w,P){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:w}function O(w,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);w.prototype=Object.create(P&&P.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(w,P):w.__proto__=P)}var R=function(w){O(P,w);function P(){return k(this,P),v(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return P}(g.default);R.blotName="code",R.tagName="CODE";var x=function(w){O(P,w);function P(){return k(this,P),v(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return o(P,[{key:"delta",value:function(){var A=this,S=this.domNode.textContent;return S.endsWith(`
`)&&(S=S.slice(0,-1)),S.split(`
`).reduce(function(E,j){return E.insert(j).insert(`
`,A.formats())},new u.default)}},{key:"format",value:function(A,S){if(!(A===this.statics.blotName&&S)){var E=this.descendant(m.default,this.length()-1),j=s(E,1),V=j[0];V!=null&&V.deleteAt(V.length()-1,1),a(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"format",this).call(this,A,S)}}},{key:"formatAt",value:function(A,S,E,j){if(S!==0&&!(d.default.query(E,d.default.Scope.BLOCK)==null||E===this.statics.blotName&&j===this.statics.formats(this.domNode))){var V=this.newlineIndex(A);if(!(V<0||V>=A+S)){var z=this.newlineIndex(A,!0)+1,H=V-z+1,ee=this.isolate(z,H),G=ee.next;ee.format(E,j),G instanceof P&&G.formatAt(0,A-z+S-H,E,j)}}}},{key:"insertAt",value:function(A,S,E){if(E==null){var j=this.descendant(m.default,A),V=s(j,2),z=V[0],H=V[1];z.insertAt(H,S)}}},{key:"length",value:function(){var A=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?A:A+1}},{key:"newlineIndex",value:function(A){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(S)return this.domNode.textContent.slice(0,A).lastIndexOf(`
`);var E=this.domNode.textContent.slice(A).indexOf(`
`);return E>-1?A+E:-1}},{key:"optimize",value:function(A){this.domNode.textContent.endsWith(`
`)||this.appendChild(d.default.create("text",`
`)),a(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"optimize",this).call(this,A);var S=this.next;S!=null&&S.prev===this&&S.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===S.statics.formats(S.domNode)&&(S.optimize(A),S.moveChildren(this),S.remove())}},{key:"replace",value:function(A){a(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"replace",this).call(this,A),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(S){var E=d.default.find(S);E==null?S.parentNode.removeChild(S):E instanceof d.default.Embed?E.remove():E.unwrap()})}}],[{key:"create",value:function(A){var S=a(P.__proto__||Object.getPrototypeOf(P),"create",this).call(this,A);return S.setAttribute("spellcheck",!1),S}},{key:"formats",value:function(){return!0}}]),P}(p.default);x.blotName="code-block",x.tagName="PRE",x.TAB="  ",n.Code=R,n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},o=function(){function G(q,L){var $=[],F=!0,W=!1,U=void 0;try{for(var M=q[Symbol.iterator](),B;!(F=(B=M.next()).done)&&($.push(B.value),!(L&&$.length===L));F=!0);}catch(K){W=!0,U=K}finally{try{!F&&M.return&&M.return()}finally{if(W)throw U}}return $}return function(q,L){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return G(q,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function G(q,L){for(var $=0;$<L.length;$++){var F=L[$];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(q,F.key,F)}}return function(q,L,$){return L&&G(q.prototype,L),$&&G(q,$),q}}(),l=i(2),u=S(l),h=i(20),d=S(h),f=i(0),p=S(f),_=i(13),g=S(_),y=i(24),m=S(y),b=i(4),k=S(b),v=i(16),O=S(v),R=i(21),x=S(R),w=i(11),P=S(w),T=i(3),A=S(T);function S(G){return G&&G.__esModule?G:{default:G}}function E(G,q,L){return q in G?Object.defineProperty(G,q,{value:L,enumerable:!0,configurable:!0,writable:!0}):G[q]=L,G}function j(G,q){if(!(G instanceof q))throw new TypeError("Cannot call a class as a function")}var V=/^[ -~]*$/,z=function(){function G(q){j(this,G),this.scroll=q,this.delta=this.getDelta()}return a(G,[{key:"applyDelta",value:function(L){var $=this,F=!1;this.scroll.update();var W=this.scroll.length();return this.scroll.batchStart(),L=ee(L),L.reduce(function(U,M){var B=M.retain||M.delete||M.insert.length||1,K=M.attributes||{};if(M.insert!=null){if(typeof M.insert=="string"){var J=M.insert;J.endsWith(`
`)&&F&&(F=!1,J=J.slice(0,-1)),U>=W&&!J.endsWith(`
`)&&(F=!0),$.scroll.insertAt(U,J);var re=$.scroll.line(U),ce=o(re,2),me=ce[0],ye=ce[1],Se=(0,A.default)({},(0,b.bubbleFormats)(me));if(me instanceof k.default){var Le=me.descendant(p.default.Leaf,ye),lt=o(Le,1),Ye=lt[0];Se=(0,A.default)(Se,(0,b.bubbleFormats)(Ye))}K=d.default.attributes.diff(Se,K)||{}}else if(s(M.insert)==="object"){var Z=Object.keys(M.insert)[0];if(Z==null)return U;$.scroll.insertAt(U,Z,M.insert[Z])}W+=B}return Object.keys(K).forEach(function(te){$.scroll.formatAt(U,B,te,K[te])}),U+B},0),L.reduce(function(U,M){return typeof M.delete=="number"?($.scroll.deleteAt(U,M.delete),U):U+(M.retain||M.insert.length||1)},0),this.scroll.batchEnd(),this.update(L)}},{key:"deleteText",value:function(L,$){return this.scroll.deleteAt(L,$),this.update(new u.default().retain(L).delete($))}},{key:"formatLine",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(W).forEach(function(U){if(!(F.scroll.whitelist!=null&&!F.scroll.whitelist[U])){var M=F.scroll.lines(L,Math.max($,1)),B=$;M.forEach(function(K){var J=K.length();if(!(K instanceof g.default))K.format(U,W[U]);else{var re=L-K.offset(F.scroll),ce=K.newlineIndex(re+B)-re+1;K.formatAt(re,ce,U,W[U])}B-=J})}}),this.scroll.optimize(),this.update(new u.default().retain(L).retain($,(0,x.default)(W)))}},{key:"formatText",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(W).forEach(function(U){F.scroll.formatAt(L,$,U,W[U])}),this.update(new u.default().retain(L).retain($,(0,x.default)(W)))}},{key:"getContents",value:function(L,$){return this.delta.slice(L,L+$)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(L,$){return L.concat($.delta())},new u.default)}},{key:"getFormat",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=[],W=[];$===0?this.scroll.path(L).forEach(function(M){var B=o(M,1),K=B[0];K instanceof k.default?F.push(K):K instanceof p.default.Leaf&&W.push(K)}):(F=this.scroll.lines(L,$),W=this.scroll.descendants(p.default.Leaf,L,$));var U=[F,W].map(function(M){if(M.length===0)return{};for(var B=(0,b.bubbleFormats)(M.shift());Object.keys(B).length>0;){var K=M.shift();if(K==null)return B;B=H((0,b.bubbleFormats)(K),B)}return B});return A.default.apply(A.default,U)}},{key:"getText",value:function(L,$){return this.getContents(L,$).filter(function(F){return typeof F.insert=="string"}).map(function(F){return F.insert}).join("")}},{key:"insertEmbed",value:function(L,$,F){return this.scroll.insertAt(L,$,F),this.update(new u.default().retain(L).insert(E({},$,F)))}},{key:"insertText",value:function(L,$){var F=this,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return $=$.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(L,$),Object.keys(W).forEach(function(U){F.scroll.formatAt(L,$.length,U,W[U])}),this.update(new u.default().retain(L).insert($,(0,x.default)(W)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var L=this.scroll.children.head;return L.statics.blotName!==k.default.blotName||L.children.length>1?!1:L.children.head instanceof O.default}},{key:"removeFormat",value:function(L,$){var F=this.getText(L,$),W=this.scroll.line(L+$),U=o(W,2),M=U[0],B=U[1],K=0,J=new u.default;M!=null&&(M instanceof g.default?K=M.newlineIndex(B)-B+1:K=M.length()-B,J=M.delta().slice(B,B+K-1).insert(`
`));var re=this.getContents(L,$+K),ce=re.diff(new u.default().insert(F).concat(J)),me=new u.default().retain(L).concat(ce);return this.applyDelta(me)}},{key:"update",value:function(L){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,W=this.delta;if($.length===1&&$[0].type==="characterData"&&$[0].target.data.match(V)&&p.default.find($[0].target)){var U=p.default.find($[0].target),M=(0,b.bubbleFormats)(U),B=U.offset(this.scroll),K=$[0].oldValue.replace(m.default.CONTENTS,""),J=new u.default().insert(K),re=new u.default().insert(U.value()),ce=new u.default().retain(B).concat(J.diff(re,F));L=ce.reduce(function(me,ye){return ye.insert?me.insert(ye.insert,M):me.push(ye)},new u.default),this.delta=W.compose(L)}else this.delta=this.getDelta(),(!L||!(0,P.default)(W.compose(L),this.delta))&&(L=W.diff(this.delta,F));return L}}]),G}();function H(G,q){return Object.keys(q).reduce(function(L,$){return G[$]==null||(q[$]===G[$]?L[$]=q[$]:Array.isArray(q[$])?q[$].indexOf(G[$])<0&&(L[$]=q[$].concat([G[$]])):L[$]=[q[$],G[$]]),L},{})}function ee(G){return G.reduce(function(q,L){if(L.insert===1){var $=(0,x.default)(L.attributes);return delete $.image,q.insert({image:L.attributes.image},$)}if(L.attributes!=null&&(L.attributes.list===!0||L.attributes.bullet===!0)&&(L=(0,x.default)(L),L.attributes.list?L.attributes.list="ordered":(L.attributes.list="bullet",delete L.attributes.bullet)),typeof L.insert=="string"){var F=L.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return q.insert(F,L.attributes)}return q.push(L)},new u.default)}n.default=z},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function w(P,T){var A=[],S=!0,E=!1,j=void 0;try{for(var V=P[Symbol.iterator](),z;!(S=(z=V.next()).done)&&(A.push(z.value),!(T&&A.length===T));S=!0);}catch(H){E=!0,j=H}finally{try{!S&&V.return&&V.return()}finally{if(E)throw j}}return A}return function(P,T){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return w(P,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(P,T){for(var A=0;A<T.length;A++){var S=T[A];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(P,S.key,S)}}return function(P,T,A){return T&&w(P.prototype,T),A&&w(P,A),P}}(),a=i(0),l=m(a),u=i(21),h=m(u),d=i(11),f=m(d),p=i(8),_=m(p),g=i(10),y=m(g);function m(w){return w&&w.__esModule?w:{default:w}}function b(w){if(Array.isArray(w)){for(var P=0,T=Array(w.length);P<w.length;P++)T[P]=w[P];return T}else return Array.from(w)}function k(w,P){if(!(w instanceof P))throw new TypeError("Cannot call a class as a function")}var v=(0,y.default)("quill:selection"),O=function w(P){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;k(this,w),this.index=P,this.length=T},R=function(){function w(P,T){var A=this;k(this,w),this.emitter=T,this.scroll=P,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=l.default.create("cursor",this),this.lastRange=this.savedRange=new O(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){A.mouseDown||setTimeout(A.update.bind(A,_.default.sources.USER),1)}),this.emitter.on(_.default.events.EDITOR_CHANGE,function(S,E){S===_.default.events.TEXT_CHANGE&&E.length()>0&&A.update(_.default.sources.SILENT)}),this.emitter.on(_.default.events.SCROLL_BEFORE_UPDATE,function(){if(A.hasFocus()){var S=A.getNativeRange();S!=null&&S.start.node!==A.cursor.textNode&&A.emitter.once(_.default.events.SCROLL_UPDATE,function(){try{A.setNativeRange(S.start.node,S.start.offset,S.end.node,S.end.offset)}catch{}})}}),this.emitter.on(_.default.events.SCROLL_OPTIMIZE,function(S,E){if(E.range){var j=E.range,V=j.startNode,z=j.startOffset,H=j.endNode,ee=j.endOffset;A.setNativeRange(V,z,H,ee)}}),this.update(_.default.sources.SILENT)}return o(w,[{key:"handleComposition",value:function(){var T=this;this.root.addEventListener("compositionstart",function(){T.composing=!0}),this.root.addEventListener("compositionend",function(){if(T.composing=!1,T.cursor.parent){var A=T.cursor.restore();if(!A)return;setTimeout(function(){T.setNativeRange(A.startNode,A.startOffset,A.endNode,A.endOffset)},1)}})}},{key:"handleDragging",value:function(){var T=this;this.emitter.listenDOM("mousedown",document.body,function(){T.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){T.mouseDown=!1,T.update(_.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(T,A){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[T])){this.scroll.update();var S=this.getNativeRange();if(!(S==null||!S.native.collapsed||l.default.query(T,l.default.Scope.BLOCK))){if(S.start.node!==this.cursor.textNode){var E=l.default.find(S.start.node,!1);if(E==null)return;if(E instanceof l.default.Leaf){var j=E.split(S.start.offset);E.parent.insertBefore(this.cursor,j)}else E.insertBefore(this.cursor,S.start.node);this.cursor.attach()}this.cursor.format(T,A),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(T){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=this.scroll.length();T=Math.min(T,S-1),A=Math.min(T+A,S-1)-T;var E=void 0,j=this.scroll.leaf(T),V=s(j,2),z=V[0],H=V[1];if(z==null)return null;var ee=z.position(H,!0),G=s(ee,2);E=G[0],H=G[1];var q=document.createRange();if(A>0){q.setStart(E,H);var L=this.scroll.leaf(T+A),$=s(L,2);if(z=$[0],H=$[1],z==null)return null;var F=z.position(H,!0),W=s(F,2);return E=W[0],H=W[1],q.setEnd(E,H),q.getBoundingClientRect()}else{var U="left",M=void 0;return E instanceof Text?(H<E.data.length?(q.setStart(E,H),q.setEnd(E,H+1)):(q.setStart(E,H-1),q.setEnd(E,H),U="right"),M=q.getBoundingClientRect()):(M=z.domNode.getBoundingClientRect(),H>0&&(U="right")),{bottom:M.top+M.height,height:M.height,left:M[U],right:M[U],top:M.top,width:0}}}},{key:"getNativeRange",value:function(){var T=document.getSelection();if(T==null||T.rangeCount<=0)return null;var A=T.getRangeAt(0);if(A==null)return null;var S=this.normalizeNative(A);return v.info("getNativeRange",S),S}},{key:"getRange",value:function(){var T=this.getNativeRange();if(T==null)return[null,null];var A=this.normalizedToRange(T);return[A,T]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(T){var A=this,S=[[T.start.node,T.start.offset]];T.native.collapsed||S.push([T.end.node,T.end.offset]);var E=S.map(function(z){var H=s(z,2),ee=H[0],G=H[1],q=l.default.find(ee,!0),L=q.offset(A.scroll);return G===0?L:q instanceof l.default.Container?L+q.length():L+q.index(ee,G)}),j=Math.min(Math.max.apply(Math,b(E)),this.scroll.length()-1),V=Math.min.apply(Math,[j].concat(b(E)));return new O(V,j-V)}},{key:"normalizeNative",value:function(T){if(!x(this.root,T.startContainer)||!T.collapsed&&!x(this.root,T.endContainer))return null;var A={start:{node:T.startContainer,offset:T.startOffset},end:{node:T.endContainer,offset:T.endOffset},native:T};return[A.start,A.end].forEach(function(S){for(var E=S.node,j=S.offset;!(E instanceof Text)&&E.childNodes.length>0;)if(E.childNodes.length>j)E=E.childNodes[j],j=0;else if(E.childNodes.length===j)E=E.lastChild,j=E instanceof Text?E.data.length:E.childNodes.length+1;else break;S.node=E,S.offset=j}),A}},{key:"rangeToNative",value:function(T){var A=this,S=T.collapsed?[T.index]:[T.index,T.index+T.length],E=[],j=this.scroll.length();return S.forEach(function(V,z){V=Math.min(j-1,V);var H=void 0,ee=A.scroll.leaf(V),G=s(ee,2),q=G[0],L=G[1],$=q.position(L,z!==0),F=s($,2);H=F[0],L=F[1],E.push(H,L)}),E.length<2&&(E=E.concat(E)),E}},{key:"scrollIntoView",value:function(T){var A=this.lastRange;if(A!=null){var S=this.getBounds(A.index,A.length);if(S!=null){var E=this.scroll.length()-1,j=this.scroll.line(Math.min(A.index,E)),V=s(j,1),z=V[0],H=z;if(A.length>0){var ee=this.scroll.line(Math.min(A.index+A.length,E)),G=s(ee,1);H=G[0]}if(!(z==null||H==null)){var q=T.getBoundingClientRect();S.top<q.top?T.scrollTop-=q.top-S.top:S.bottom>q.bottom&&(T.scrollTop+=S.bottom-q.bottom)}}}}},{key:"setNativeRange",value:function(T,A){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:T,E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:A,j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(v.info("setNativeRange",T,A,S,E),!(T!=null&&(this.root.parentNode==null||T.parentNode==null||S.parentNode==null))){var V=document.getSelection();if(V!=null)if(T!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||j||T!==z.startContainer||A!==z.startOffset||S!==z.endContainer||E!==z.endOffset){T.tagName=="BR"&&(A=[].indexOf.call(T.parentNode.childNodes,T),T=T.parentNode),S.tagName=="BR"&&(E=[].indexOf.call(S.parentNode.childNodes,S),S=S.parentNode);var H=document.createRange();H.setStart(T,A),H.setEnd(S,E),V.removeAllRanges(),V.addRange(H)}}else V.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(T){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;if(typeof A=="string"&&(S=A,A=!1),v.info("setRange",T),T!=null){var E=this.rangeToNative(T);this.setNativeRange.apply(this,b(E).concat([A]))}else this.setNativeRange(null);this.update(S)}},{key:"update",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,A=this.lastRange,S=this.getRange(),E=s(S,2),j=E[0],V=E[1];if(this.lastRange=j,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,f.default)(A,this.lastRange)){var z;!this.composing&&V!=null&&V.native.collapsed&&V.start.node!==this.cursor.textNode&&this.cursor.restore();var H=[_.default.events.SELECTION_CHANGE,(0,h.default)(this.lastRange),(0,h.default)(A),T];if((z=this.emitter).emit.apply(z,[_.default.events.EDITOR_CHANGE].concat(H)),T!==_.default.sources.SILENT){var ee;(ee=this.emitter).emit.apply(ee,H)}}}}]),w}();function x(w,P){try{P.parentNode}catch{return!1}return P instanceof Text&&(P=P.parentNode),w.contains(P)}n.Range=O,n.default=R},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var k=Object.getPrototypeOf(g);return k===null?void 0:_(k,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(0),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"insertInto",value:function(m,b){m.children.length===0?o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"insertInto",this).call(this,m,b):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),g}(l.default.Embed);p.blotName="break",p.tagName="BR",n.default=p},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),a=i(30),l=i(1),u=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.build(),_}return f.prototype.appendChild=function(p){this.insertBefore(p)},f.prototype.attach=function(){d.prototype.attach.call(this),this.children.forEach(function(p){p.attach()})},f.prototype.build=function(){var p=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(_){try{var g=h(_);p.insertBefore(g,p.children.head||void 0)}catch(y){if(y instanceof l.ParchmentError)return;throw y}})},f.prototype.deleteAt=function(p,_){if(p===0&&_===this.length())return this.remove();this.children.forEachAt(p,_,function(g,y,m){g.deleteAt(y,m)})},f.prototype.descendant=function(p,_){var g=this.children.find(_),y=g[0],m=g[1];return p.blotName==null&&p(y)||p.blotName!=null&&y instanceof p?[y,m]:y instanceof f?y.descendant(p,m):[null,-1]},f.prototype.descendants=function(p,_,g){_===void 0&&(_=0),g===void 0&&(g=Number.MAX_VALUE);var y=[],m=g;return this.children.forEachAt(_,g,function(b,k,v){(p.blotName==null&&p(b)||p.blotName!=null&&b instanceof p)&&y.push(b),b instanceof f&&(y=y.concat(b.descendants(p,k,m))),m-=v}),y},f.prototype.detach=function(){this.children.forEach(function(p){p.detach()}),d.prototype.detach.call(this)},f.prototype.formatAt=function(p,_,g,y){this.children.forEachAt(p,_,function(m,b,k){m.formatAt(b,k,g,y)})},f.prototype.insertAt=function(p,_,g){var y=this.children.find(p),m=y[0],b=y[1];if(m)m.insertAt(b,_,g);else{var k=g==null?l.create("text",_):l.create(_,g);this.appendChild(k)}},f.prototype.insertBefore=function(p,_){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(g){return p instanceof g}))throw new l.ParchmentError("Cannot insert "+p.statics.blotName+" into "+this.statics.blotName);p.insertInto(this,_)},f.prototype.length=function(){return this.children.reduce(function(p,_){return p+_.length()},0)},f.prototype.moveChildren=function(p,_){this.children.forEach(function(g){p.insertBefore(g,_)})},f.prototype.optimize=function(p){if(d.prototype.optimize.call(this,p),this.children.length===0)if(this.statics.defaultChild!=null){var _=l.create(this.statics.defaultChild);this.appendChild(_),_.optimize(p)}else this.remove()},f.prototype.path=function(p,_){_===void 0&&(_=!1);var g=this.children.find(p,_),y=g[0],m=g[1],b=[[this,p]];return y instanceof f?b.concat(y.path(m,_)):(y!=null&&b.push([y,m]),b)},f.prototype.removeChild=function(p){this.children.remove(p)},f.prototype.replace=function(p){p instanceof f&&p.moveChildren(this),d.prototype.replace.call(this,p)},f.prototype.split=function(p,_){if(_===void 0&&(_=!1),!_){if(p===0)return this;if(p===this.length())return this.next}var g=this.clone();return this.parent.insertBefore(g,this.next),this.children.forEachAt(p,this.length(),function(y,m,b){y=y.split(m,_),g.appendChild(y)}),g},f.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},f.prototype.update=function(p,_){var g=this,y=[],m=[];p.forEach(function(b){b.target===g.domNode&&b.type==="childList"&&(y.push.apply(y,b.addedNodes),m.push.apply(m,b.removedNodes))}),m.forEach(function(b){if(!(b.parentNode!=null&&b.tagName!=="IFRAME"&&document.body.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var k=l.find(b);k!=null&&(k.domNode.parentNode==null||k.domNode.parentNode===g.domNode)&&k.detach()}}),y.filter(function(b){return b.parentNode==g.domNode}).sort(function(b,k){return b===k?0:b.compareDocumentPosition(k)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(b){var k=null;b.nextSibling!=null&&(k=l.find(b.nextSibling));var v=h(b);(v.next!=k||v.next==null)&&(v.parent!=null&&v.parent.removeChild(g),g.insertBefore(v,k||void 0))})},f}(a.default);function h(d){var f=l.find(d);if(f==null)try{f=l.create(d)}catch{f=l.create(l.Scope.INLINE),[].slice.call(d.childNodes).forEach(function(_){f.domNode.appendChild(_)}),d.parentNode&&d.parentNode.replaceChild(f.domNode,d),f.attach()}return f}n.default=u},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),a=i(31),l=i(17),u=i(1),h=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.attributes=new a.default(_.domNode),_}return f.formats=function(p){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return p.tagName.toLowerCase()},f.prototype.format=function(p,_){var g=u.query(p);g instanceof o.default?this.attributes.attribute(g,_):_&&g!=null&&(p!==this.statics.blotName||this.formats()[p]!==_)&&this.replaceWith(p,_)},f.prototype.formats=function(){var p=this.attributes.values(),_=this.statics.formats(this.domNode);return _!=null&&(p[this.statics.blotName]=_),p},f.prototype.replaceWith=function(p,_){var g=d.prototype.replaceWith.call(this,p,_);return this.attributes.copy(g),g},f.prototype.update=function(p,_){var g=this;d.prototype.update.call(this,p,_),p.some(function(y){return y.target===g.domNode&&y.type==="attributes"})&&this.attributes.build()},f.prototype.wrap=function(p,_){var g=d.prototype.wrap.call(this,p,_);return g instanceof f&&g.statics.scope===this.statics.scope&&this.attributes.move(g),g},f}(l.default);n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){u(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),a=i(1),l=function(u){s(h,u);function h(){return u!==null&&u.apply(this,arguments)||this}return h.value=function(d){return!0},h.prototype.index=function(d,f){return this.domNode===d||this.domNode.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(f,1):-1},h.prototype.position=function(d,f){var p=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return d>0&&(p+=1),[this.parent.domNode,p]},h.prototype.value=function(){var d;return d={},d[this.statics.blotName]=this.statics.value(this.domNode)||!0,d},h.scope=a.Scope.INLINE_BLOT,h}(o.default);n.default=l},function(t,n,i){var s=i(11),o=i(3),a={attributes:{compose:function(u,h,d){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});var f=o(!0,{},h);d||(f=Object.keys(f).reduce(function(_,g){return f[g]!=null&&(_[g]=f[g]),_},{}));for(var p in u)u[p]!==void 0&&h[p]===void 0&&(f[p]=u[p]);return Object.keys(f).length>0?f:void 0},diff:function(u,h){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});var d=Object.keys(u).concat(Object.keys(h)).reduce(function(f,p){return s(u[p],h[p])||(f[p]=h[p]===void 0?null:h[p]),f},{});return Object.keys(d).length>0?d:void 0},transform:function(u,h,d){if(typeof u!="object")return h;if(typeof h=="object"){if(!d)return h;var f=Object.keys(h).reduce(function(p,_){return u[_]===void 0&&(p[_]=h[_]),p},{});return Object.keys(f).length>0?f:void 0}}},iterator:function(u){return new l(u)},length:function(u){return typeof u.delete=="number"?u.delete:typeof u.retain=="number"?u.retain:typeof u.insert=="string"?u.insert.length:1}};function l(u){this.ops=u,this.index=0,this.offset=0}l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(u){u||(u=1/0);var h=this.ops[this.index];if(h){var d=this.offset,f=a.length(h);if(u>=f-d?(u=f-d,this.index+=1,this.offset=0):this.offset+=u,typeof h.delete=="number")return{delete:u};var p={};return h.attributes&&(p.attributes=h.attributes),typeof h.retain=="number"?p.retain=u:typeof h.insert=="string"?p.insert=h.insert.substr(d,u):p.insert=h.insert,p}else return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var u=this.offset,h=this.index,d=this.next(),f=this.ops.slice(this.index);return this.offset=u,this.index=h,[d].concat(f)}else return[]},t.exports=a},function(t,n){var i=function(){function s(g,y){return y!=null&&g instanceof y}var o;try{o=Map}catch{o=function(){}}var a;try{a=Set}catch{a=function(){}}var l;try{l=Promise}catch{l=function(){}}function u(g,y,m,b,k){typeof y=="object"&&(m=y.depth,b=y.prototype,k=y.includeNonEnumerable,y=y.circular);var v=[],O=[],R=typeof Buffer<"u";typeof y>"u"&&(y=!0),typeof m>"u"&&(m=1/0);function x(w,P){if(w===null)return null;if(P===0)return w;var T,A;if(typeof w!="object")return w;if(s(w,o))T=new o;else if(s(w,a))T=new a;else if(s(w,l))T=new l(function(q,L){w.then(function($){q(x($,P-1))},function($){L(x($,P-1))})});else if(u.__isArray(w))T=[];else if(u.__isRegExp(w))T=new RegExp(w.source,_(w)),w.lastIndex&&(T.lastIndex=w.lastIndex);else if(u.__isDate(w))T=new Date(w.getTime());else{if(R&&Buffer.isBuffer(w))return Buffer.allocUnsafe?T=Buffer.allocUnsafe(w.length):T=new Buffer(w.length),w.copy(T),T;s(w,Error)?T=Object.create(w):typeof b>"u"?(A=Object.getPrototypeOf(w),T=Object.create(A)):(T=Object.create(b),A=b)}if(y){var S=v.indexOf(w);if(S!=-1)return O[S];v.push(w),O.push(T)}s(w,o)&&w.forEach(function(q,L){var $=x(L,P-1),F=x(q,P-1);T.set($,F)}),s(w,a)&&w.forEach(function(q){var L=x(q,P-1);T.add(L)});for(var E in w){var j;A&&(j=Object.getOwnPropertyDescriptor(A,E)),!(j&&j.set==null)&&(T[E]=x(w[E],P-1))}if(Object.getOwnPropertySymbols)for(var V=Object.getOwnPropertySymbols(w),E=0;E<V.length;E++){var z=V[E],H=Object.getOwnPropertyDescriptor(w,z);H&&!H.enumerable&&!k||(T[z]=x(w[z],P-1),H.enumerable||Object.defineProperty(T,z,{enumerable:!1}))}if(k)for(var ee=Object.getOwnPropertyNames(w),E=0;E<ee.length;E++){var G=ee[E],H=Object.getOwnPropertyDescriptor(w,G);H&&H.enumerable||(T[G]=x(w[G],P-1),Object.defineProperty(T,G,{enumerable:!1}))}return T}return x(g,m)}u.clonePrototype=function(y){if(y===null)return null;var m=function(){};return m.prototype=y,new m};function h(g){return Object.prototype.toString.call(g)}u.__objToStr=h;function d(g){return typeof g=="object"&&h(g)==="[object Date]"}u.__isDate=d;function f(g){return typeof g=="object"&&h(g)==="[object Array]"}u.__isArray=f;function p(g){return typeof g=="object"&&h(g)==="[object RegExp]"}u.__isRegExp=p;function _(g){var y="";return g.global&&(y+="g"),g.ignoreCase&&(y+="i"),g.multiline&&(y+="m"),y}return u.__getRegExpFlags=_,u}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(A,S){var E=[],j=!0,V=!1,z=void 0;try{for(var H=A[Symbol.iterator](),ee;!(j=(ee=H.next()).done)&&(E.push(ee.value),!(S&&E.length===S));j=!0);}catch(G){V=!0,z=G}finally{try{!j&&H.return&&H.return()}finally{if(V)throw z}}return E}return function(A,S){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return T(A,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(A,S){for(var E=0;E<S.length;E++){var j=S[E];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(A,j.key,j)}}return function(A,S,E){return S&&T(A.prototype,S),E&&T(A,E),A}}(),a=function T(A,S,E){A===null&&(A=Function.prototype);var j=Object.getOwnPropertyDescriptor(A,S);if(j===void 0){var V=Object.getPrototypeOf(A);return V===null?void 0:T(V,S,E)}else{if("value"in j)return j.value;var z=j.get;return z===void 0?void 0:z.call(E)}},l=i(0),u=v(l),h=i(8),d=v(h),f=i(4),p=v(f),_=i(16),g=v(_),y=i(13),m=v(y),b=i(25),k=v(b);function v(T){return T&&T.__esModule?T:{default:T}}function O(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}function R(T,A){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:T}function x(T,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);T.prototype=Object.create(A&&A.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(T,A):T.__proto__=A)}function w(T){return T instanceof p.default||T instanceof f.BlockEmbed}var P=function(T){x(A,T);function A(S,E){O(this,A);var j=R(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,S));return j.emitter=E.emitter,Array.isArray(E.whitelist)&&(j.whitelist=E.whitelist.reduce(function(V,z){return V[z]=!0,V},{})),j.domNode.addEventListener("DOMNodeInserted",function(){}),j.optimize(),j.enable(),j}return o(A,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(E,j){var V=this.line(E),z=s(V,2),H=z[0],ee=z[1],G=this.line(E+j),q=s(G,1),L=q[0];if(a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"deleteAt",this).call(this,E,j),L!=null&&H!==L&&ee>0){if(H instanceof f.BlockEmbed||L instanceof f.BlockEmbed){this.optimize();return}if(H instanceof m.default){var $=H.newlineIndex(H.length(),!0);if($>-1&&(H=H.split($+1),H===L)){this.optimize();return}}else if(L instanceof m.default){var F=L.newlineIndex(0);F>-1&&L.split(F+1)}var W=L.children.head instanceof g.default?null:L.children.head;H.moveChildren(L,W),H.remove()}this.optimize()}},{key:"enable",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",E)}},{key:"formatAt",value:function(E,j,V,z){this.whitelist!=null&&!this.whitelist[V]||(a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"formatAt",this).call(this,E,j,V,z),this.optimize())}},{key:"insertAt",value:function(E,j,V){if(!(V!=null&&this.whitelist!=null&&!this.whitelist[j])){if(E>=this.length())if(V==null||u.default.query(j,u.default.Scope.BLOCK)==null){var z=u.default.create(this.statics.defaultChild);this.appendChild(z),V==null&&j.endsWith(`
`)&&(j=j.slice(0,-1)),z.insertAt(0,j,V)}else{var H=u.default.create(j,V);this.appendChild(H)}else a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertAt",this).call(this,E,j,V);this.optimize()}}},{key:"insertBefore",value:function(E,j){if(E.statics.scope===u.default.Scope.INLINE_BLOT){var V=u.default.create(this.statics.defaultChild);V.appendChild(E),E=V}a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"insertBefore",this).call(this,E,j)}},{key:"leaf",value:function(E){return this.path(E).pop()||[null,-1]}},{key:"line",value:function(E){return E===this.length()?this.line(E-1):this.descendant(w,E)}},{key:"lines",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,V=function z(H,ee,G){var q=[],L=G;return H.children.forEachAt(ee,G,function($,F,W){w($)?q.push($):$ instanceof u.default.Container&&(q=q.concat(z($,F,L))),L-=W}),q};return V(this,E,j)}},{key:"optimize",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"optimize",this).call(this,E,j),E.length>0&&this.emitter.emit(d.default.events.SCROLL_OPTIMIZE,E,j))}},{key:"path",value:function(E){return a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"path",this).call(this,E).slice(1)}},{key:"update",value:function(E){if(this.batch!==!0){var j=d.default.sources.USER;typeof E=="string"&&(j=E),Array.isArray(E)||(E=this.observer.takeRecords()),E.length>0&&this.emitter.emit(d.default.events.SCROLL_BEFORE_UPDATE,j,E),a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"update",this).call(this,E.concat([])),E.length>0&&this.emitter.emit(d.default.events.SCROLL_UPDATE,j,E)}}}]),A}(u.default.Scroll);P.blotName="scroll",P.className="ql-editor",P.tagName="DIV",P.defaultChild="block",P.allowedChildren=[p.default,f.BlockEmbed,k.default],n.default=P},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o=function(){function M(B,K){var J=[],re=!0,ce=!1,me=void 0;try{for(var ye=B[Symbol.iterator](),Se;!(re=(Se=ye.next()).done)&&(J.push(Se.value),!(K&&J.length===K));re=!0);}catch(Le){ce=!0,me=Le}finally{try{!re&&ye.return&&ye.return()}finally{if(ce)throw me}}return J}return function(B,K){if(Array.isArray(B))return B;if(Symbol.iterator in Object(B))return M(B,K);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function M(B,K){for(var J=0;J<K.length;J++){var re=K[J];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(B,re.key,re)}}return function(B,K,J){return K&&M(B.prototype,K),J&&M(B,J),B}}(),l=i(21),u=T(l),h=i(11),d=T(h),f=i(3),p=T(f),_=i(2),g=T(_),y=i(20),m=T(y),b=i(0),k=T(b),v=i(5),O=T(v),R=i(10),x=T(R),w=i(9),P=T(w);function T(M){return M&&M.__esModule?M:{default:M}}function A(M,B,K){return B in M?Object.defineProperty(M,B,{value:K,enumerable:!0,configurable:!0,writable:!0}):M[B]=K,M}function S(M,B){if(!(M instanceof B))throw new TypeError("Cannot call a class as a function")}function E(M,B){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:M}function j(M,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);M.prototype=Object.create(B&&B.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(M,B):M.__proto__=B)}var V=(0,x.default)("quill:keyboard"),z=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",H=function(M){j(B,M),a(B,null,[{key:"match",value:function(J,re){return re=U(re),["altKey","ctrlKey","metaKey","shiftKey"].some(function(ce){return!!re[ce]!==J[ce]&&re[ce]!==null})?!1:re.key===(J.which||J.keyCode)}}]);function B(K,J){S(this,B);var re=E(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,K,J));return re.bindings={},Object.keys(re.options.bindings).forEach(function(ce){ce==="list autofill"&&K.scroll.whitelist!=null&&!K.scroll.whitelist.list||re.options.bindings[ce]&&re.addBinding(re.options.bindings[ce])}),re.addBinding({key:B.keys.ENTER,shiftKey:null},$),re.addBinding({key:B.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(re.addBinding({key:B.keys.BACKSPACE},{collapsed:!0},G),re.addBinding({key:B.keys.DELETE},{collapsed:!0},q)):(re.addBinding({key:B.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},G),re.addBinding({key:B.keys.DELETE},{collapsed:!0,suffix:/^.?$/},q)),re.addBinding({key:B.keys.BACKSPACE},{collapsed:!1},L),re.addBinding({key:B.keys.DELETE},{collapsed:!1},L),re.addBinding({key:B.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},G),re.listen(),re}return a(B,[{key:"addBinding",value:function(J){var re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},me=U(J);if(me==null||me.key==null)return V.warn("Attempted to add invalid keyboard binding",me);typeof re=="function"&&(re={handler:re}),typeof ce=="function"&&(ce={handler:ce}),me=(0,p.default)(me,re,ce),this.bindings[me.key]=this.bindings[me.key]||[],this.bindings[me.key].push(me)}},{key:"listen",value:function(){var J=this;this.quill.root.addEventListener("keydown",function(re){if(!re.defaultPrevented){var ce=re.which||re.keyCode,me=(J.bindings[ce]||[]).filter(function(Ke){return B.match(re,Ke)});if(me.length!==0){var ye=J.quill.getSelection();if(!(ye==null||!J.quill.hasFocus())){var Se=J.quill.getLine(ye.index),Le=o(Se,2),lt=Le[0],Ye=Le[1],Z=J.quill.getLeaf(ye.index),te=o(Z,2),le=te[0],ue=te[1],se=ye.length===0?[le,ue]:J.quill.getLeaf(ye.index+ye.length),we=o(se,2),xe=we[0],ke=we[1],Ve=le instanceof k.default.Text?le.value().slice(0,ue):"",Ue=xe instanceof k.default.Text?xe.value().slice(ke):"",$e={collapsed:ye.length===0,empty:ye.length===0&&lt.length()<=1,format:J.quill.getFormat(ye),offset:Ye,prefix:Ve,suffix:Ue},qi=me.some(function(Ke){if(Ke.collapsed!=null&&Ke.collapsed!==$e.collapsed||Ke.empty!=null&&Ke.empty!==$e.empty||Ke.offset!=null&&Ke.offset!==$e.offset)return!1;if(Array.isArray(Ke.format)){if(Ke.format.every(function(qt){return $e.format[qt]==null}))return!1}else if(s(Ke.format)==="object"&&!Object.keys(Ke.format).every(function(qt){return Ke.format[qt]===!0?$e.format[qt]!=null:Ke.format[qt]===!1?$e.format[qt]==null:(0,d.default)(Ke.format[qt],$e.format[qt])}))return!1;return Ke.prefix!=null&&!Ke.prefix.test($e.prefix)||Ke.suffix!=null&&!Ke.suffix.test($e.suffix)?!1:Ke.handler.call(J,ye,$e)!==!0});qi&&re.preventDefault()}}}})}}]),B}(P.default);H.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},H.DEFAULTS={bindings:{bold:W("bold"),italic:W("italic"),underline:W("underline"),indent:{key:H.keys.TAB,format:["blockquote","indent","list"],handler:function(B,K){if(K.collapsed&&K.offset!==0)return!0;this.quill.format("indent","+1",O.default.sources.USER)}},outdent:{key:H.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(B,K){if(K.collapsed&&K.offset!==0)return!0;this.quill.format("indent","-1",O.default.sources.USER)}},"outdent backspace":{key:H.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(B,K){K.format.indent!=null?this.quill.format("indent","-1",O.default.sources.USER):K.format.list!=null&&this.quill.format("list",!1,O.default.sources.USER)}},"indent code-block":F(!0),"outdent code-block":F(!1),"remove tab":{key:H.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(B){this.quill.deleteText(B.index-1,1,O.default.sources.USER)}},tab:{key:H.keys.TAB,handler:function(B){this.quill.history.cutoff();var K=new g.default().retain(B.index).delete(B.length).insert("	");this.quill.updateContents(K,O.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(B.index+1,O.default.sources.SILENT)}},"list empty enter":{key:H.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(B,K){this.quill.format("list",!1,O.default.sources.USER),K.format.indent&&this.quill.format("indent",!1,O.default.sources.USER)}},"checklist enter":{key:H.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(B){var K=this.quill.getLine(B.index),J=o(K,2),re=J[0],ce=J[1],me=(0,p.default)({},re.formats(),{list:"checked"}),ye=new g.default().retain(B.index).insert(`
`,me).retain(re.length()-ce-1).retain(1,{list:"unchecked"});this.quill.updateContents(ye,O.default.sources.USER),this.quill.setSelection(B.index+1,O.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:H.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(B,K){var J=this.quill.getLine(B.index),re=o(J,2),ce=re[0],me=re[1],ye=new g.default().retain(B.index).insert(`
`,K.format).retain(ce.length()-me-1).retain(1,{header:null});this.quill.updateContents(ye,O.default.sources.USER),this.quill.setSelection(B.index+1,O.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(B,K){var J=K.prefix.length,re=this.quill.getLine(B.index),ce=o(re,2),me=ce[0],ye=ce[1];if(ye>J)return!0;var Se=void 0;switch(K.prefix.trim()){case"[]":case"[ ]":Se="unchecked";break;case"[x]":Se="checked";break;case"-":case"*":Se="bullet";break;default:Se="ordered"}this.quill.insertText(B.index," ",O.default.sources.USER),this.quill.history.cutoff();var Le=new g.default().retain(B.index-ye).delete(J+1).retain(me.length()-2-ye).retain(1,{list:Se});this.quill.updateContents(Le,O.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(B.index-J,O.default.sources.SILENT)}},"code exit":{key:H.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(B){var K=this.quill.getLine(B.index),J=o(K,2),re=J[0],ce=J[1],me=new g.default().retain(B.index+re.length()-ce-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(me,O.default.sources.USER)}},"embed left":ee(H.keys.LEFT,!1),"embed left shift":ee(H.keys.LEFT,!0),"embed right":ee(H.keys.RIGHT,!1),"embed right shift":ee(H.keys.RIGHT,!0)}};function ee(M,B){var K,J=M===H.keys.LEFT?"prefix":"suffix";return K={key:M,shiftKey:B,altKey:null},A(K,J,/^$/),A(K,"handler",function(ce){var me=ce.index;M===H.keys.RIGHT&&(me+=ce.length+1);var ye=this.quill.getLeaf(me),Se=o(ye,1),Le=Se[0];return Le instanceof k.default.Embed?(M===H.keys.LEFT?B?this.quill.setSelection(ce.index-1,ce.length+1,O.default.sources.USER):this.quill.setSelection(ce.index-1,O.default.sources.USER):B?this.quill.setSelection(ce.index,ce.length+1,O.default.sources.USER):this.quill.setSelection(ce.index+ce.length+1,O.default.sources.USER),!1):!0}),K}function G(M,B){if(!(M.index===0||this.quill.getLength()<=1)){var K=this.quill.getLine(M.index),J=o(K,1),re=J[0],ce={};if(B.offset===0){var me=this.quill.getLine(M.index-1),ye=o(me,1),Se=ye[0];if(Se!=null&&Se.length()>1){var Le=re.formats(),lt=this.quill.getFormat(M.index-1,1);ce=m.default.attributes.diff(Le,lt)||{}}}var Ye=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(B.prefix)?2:1;this.quill.deleteText(M.index-Ye,Ye,O.default.sources.USER),Object.keys(ce).length>0&&this.quill.formatLine(M.index-Ye,Ye,ce,O.default.sources.USER),this.quill.focus()}}function q(M,B){var K=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(B.suffix)?2:1;if(!(M.index>=this.quill.getLength()-K)){var J={},re=0,ce=this.quill.getLine(M.index),me=o(ce,1),ye=me[0];if(B.offset>=ye.length()-1){var Se=this.quill.getLine(M.index+1),Le=o(Se,1),lt=Le[0];if(lt){var Ye=ye.formats(),Z=this.quill.getFormat(M.index,1);J=m.default.attributes.diff(Ye,Z)||{},re=lt.length()}}this.quill.deleteText(M.index,K,O.default.sources.USER),Object.keys(J).length>0&&this.quill.formatLine(M.index+re-1,K,J,O.default.sources.USER)}}function L(M){var B=this.quill.getLines(M),K={};if(B.length>1){var J=B[0].formats(),re=B[B.length-1].formats();K=m.default.attributes.diff(re,J)||{}}this.quill.deleteText(M,O.default.sources.USER),Object.keys(K).length>0&&this.quill.formatLine(M.index,1,K,O.default.sources.USER),this.quill.setSelection(M.index,O.default.sources.SILENT),this.quill.focus()}function $(M,B){var K=this;M.length>0&&this.quill.scroll.deleteAt(M.index,M.length);var J=Object.keys(B.format).reduce(function(re,ce){return k.default.query(ce,k.default.Scope.BLOCK)&&!Array.isArray(B.format[ce])&&(re[ce]=B.format[ce]),re},{});this.quill.insertText(M.index,`
`,J,O.default.sources.USER),this.quill.setSelection(M.index+1,O.default.sources.SILENT),this.quill.focus(),Object.keys(B.format).forEach(function(re){J[re]==null&&(Array.isArray(B.format[re])||re!=="link"&&K.quill.format(re,B.format[re],O.default.sources.USER))})}function F(M){return{key:H.keys.TAB,shiftKey:!M,format:{"code-block":!0},handler:function(K){var J=k.default.query("code-block"),re=K.index,ce=K.length,me=this.quill.scroll.descendant(J,re),ye=o(me,2),Se=ye[0],Le=ye[1];if(Se!=null){var lt=this.quill.getIndex(Se),Ye=Se.newlineIndex(Le,!0)+1,Z=Se.newlineIndex(lt+Le+ce),te=Se.domNode.textContent.slice(Ye,Z).split(`
`);Le=0,te.forEach(function(le,ue){M?(Se.insertAt(Ye+Le,J.TAB),Le+=J.TAB.length,ue===0?re+=J.TAB.length:ce+=J.TAB.length):le.startsWith(J.TAB)&&(Se.deleteAt(Ye+Le,J.TAB.length),Le-=J.TAB.length,ue===0?re-=J.TAB.length:ce-=J.TAB.length),Le+=le.length+1}),this.quill.update(O.default.sources.USER),this.quill.setSelection(re,ce,O.default.sources.SILENT)}}}}function W(M){return{key:M[0].toUpperCase(),shortKey:!0,handler:function(K,J){this.quill.format(M,!J.format[M],O.default.sources.USER)}}}function U(M){if(typeof M=="string"||typeof M=="number")return U({key:M});if((typeof M>"u"?"undefined":s(M))==="object"&&(M=(0,u.default)(M,!1)),typeof M.key=="string")if(H.keys[M.key.toUpperCase()]!=null)M.key=H.keys[M.key.toUpperCase()];else if(M.key.length===1)M.key=M.key.toUpperCase().charCodeAt(0);else return null;return M.shortKey&&(M[z]=M.shortKey,delete M.shortKey),M}n.default=H,n.SHORTKEY=z},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,k){var v=[],O=!0,R=!1,x=void 0;try{for(var w=b[Symbol.iterator](),P;!(O=(P=w.next()).done)&&(v.push(P.value),!(k&&v.length===k));O=!0);}catch(T){R=!0,x=T}finally{try{!O&&w.return&&w.return()}finally{if(R)throw x}}return v}return function(b,k){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return m(b,k);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function m(b,k,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,k);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,k,v)}else{if("value"in O)return O.value;var x=O.get;return x===void 0?void 0:x.call(v)}},a=function(){function m(b,k){for(var v=0;v<k.length;v++){var O=k[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,k,v){return k&&m(b.prototype,k),v&&m(b,v),b}}(),l=i(0),u=f(l),h=i(7),d=f(h);function f(m){return m&&m.__esModule?m:{default:m}}function p(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function _(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function g(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var y=function(m){g(b,m),a(b,null,[{key:"value",value:function(){}}]);function b(k,v){p(this,b);var O=_(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,k));return O.selection=v,O.textNode=document.createTextNode(b.CONTENTS),O.domNode.appendChild(O.textNode),O._length=0,O}return a(b,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(v,O){if(this._length!==0)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,v,O);for(var R=this,x=0;R!=null&&R.statics.scope!==u.default.Scope.BLOCK_BLOT;)x+=R.offset(R.parent),R=R.parent;R!=null&&(this._length=b.CONTENTS.length,R.optimize(),R.formatAt(x,b.CONTENTS.length,v,O),this._length=0)}},{key:"index",value:function(v,O){return v===this.textNode?0:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,O)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var v=this.textNode,O=this.selection.getNativeRange(),R=void 0,x=void 0,w=void 0;if(O!=null&&O.start.node===v&&O.end.node===v){var P=[v,O.start.offset,O.end.offset];R=P[0],x=P[1],w=P[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==b.CONTENTS){var T=this.textNode.data.split(b.CONTENTS).join("");this.next instanceof d.default?(R=this.next.domNode,this.next.insertAt(0,T),this.textNode.data=b.CONTENTS):(this.textNode.data=T,this.parent.insertBefore(u.default.create(this.textNode),this),this.textNode=document.createTextNode(b.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),x!=null){var A=[x,w].map(function(E){return Math.max(0,Math.min(R.data.length,E-1))}),S=s(A,2);return x=S[0],w=S[1],{startNode:R,startOffset:x,endNode:R,endOffset:w}}}}},{key:"update",value:function(v,O){var R=this;if(v.some(function(w){return w.type==="characterData"&&w.target===R.textNode})){var x=this.restore();x&&(O.range=x)}}},{key:"value",value:function(){return""}}]),b}(u.default.Embed);y.blotName="cursor",y.className="ql-cursor",y.tagName="span",y.CONTENTS="\uFEFF",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=u(s),a=i(4),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(o.default.Container);p.allowedChildren=[l.default,a.BlockEmbed,p],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function y(m,b){for(var k=0;k<b.length;k++){var v=b[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,k){return b&&y(m.prototype,b),k&&y(m,k),m}}(),o=function y(m,b,k){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,k)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(k)}},a=i(0),l=u(a);function u(y){return y&&y.__esModule?y:{default:y}}function h(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function d(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function f(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var p=function(y){f(m,y);function m(){return h(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"value",value:function(k){var v=o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,k);return v.startsWith("rgb(")?(v=v.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+v.split(",").map(function(O){return("00"+parseInt(O).toString(16)).slice(-2)}).join("")):v}}]),m}(l.default.Attributor.Style),_=new l.default.Attributor.Class("color","ql-color",{scope:l.default.Scope.INLINE}),g=new p("color","color",{scope:l.default.Scope.INLINE});n.ColorAttributor=p,n.ColorClass=_,n.ColorStyle=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function g(y,m){for(var b=0;b<m.length;b++){var k=m[b];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(y,k.key,k)}}return function(y,m,b){return m&&g(y.prototype,m),b&&g(y,b),y}}(),o=function g(y,m,b){y===null&&(y=Function.prototype);var k=Object.getOwnPropertyDescriptor(y,m);if(k===void 0){var v=Object.getPrototypeOf(y);return v===null?void 0:g(v,m,b)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(b)}},a=i(6),l=u(a);function u(g){return g&&g.__esModule?g:{default:g}}function h(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function d(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var p=function(g){f(y,g);function y(){return h(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"format",value:function(b,k){if(b!==this.statics.blotName||!k)return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"format",this).call(this,b,k);k=this.constructor.sanitize(k),this.domNode.setAttribute("href",k)}}],[{key:"create",value:function(b){var k=o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,b);return b=this.sanitize(b),k.setAttribute("href",b),k.setAttribute("rel","noopener noreferrer"),k.setAttribute("target","_blank"),k}},{key:"formats",value:function(b){return b.getAttribute("href")}},{key:"sanitize",value:function(b){return _(b,this.PROTOCOL_WHITELIST)?b:this.SANITIZED_URL}}]),y}(l.default);p.blotName="link",p.tagName="A",p.SANITIZED_URL="about:blank",p.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function _(g,y){var m=document.createElement("a");m.href=g;var b=m.href.slice(0,m.href.indexOf(":"));return y.indexOf(b)>-1}n.default=p,n.sanitize=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},o=function(){function y(m,b){for(var k=0;k<b.length;k++){var v=b[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,k){return b&&y(m.prototype,b),k&&y(m,k),m}}(),a=i(23),l=d(a),u=i(107),h=d(u);function d(y){return y&&y.__esModule?y:{default:y}}function f(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}var p=0;function _(y,m){y.setAttribute(m,y.getAttribute(m)!=="true")}var g=function(){function y(m){var b=this;f(this,y),this.select=m,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){b.togglePicker()}),this.label.addEventListener("keydown",function(k){switch(k.keyCode){case l.default.keys.ENTER:b.togglePicker();break;case l.default.keys.ESCAPE:b.escape(),k.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(y,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),_(this.label,"aria-expanded"),_(this.options,"aria-hidden")}},{key:"buildItem",value:function(b){var k=this,v=document.createElement("span");return v.tabIndex="0",v.setAttribute("role","button"),v.classList.add("ql-picker-item"),b.hasAttribute("value")&&v.setAttribute("data-value",b.getAttribute("value")),b.textContent&&v.setAttribute("data-label",b.textContent),v.addEventListener("click",function(){k.selectItem(v,!0)}),v.addEventListener("keydown",function(O){switch(O.keyCode){case l.default.keys.ENTER:k.selectItem(v,!0),O.preventDefault();break;case l.default.keys.ESCAPE:k.escape(),O.preventDefault();break}}),v}},{key:"buildLabel",value:function(){var b=document.createElement("span");return b.classList.add("ql-picker-label"),b.innerHTML=h.default,b.tabIndex="0",b.setAttribute("role","button"),b.setAttribute("aria-expanded","false"),this.container.appendChild(b),b}},{key:"buildOptions",value:function(){var b=this,k=document.createElement("span");k.classList.add("ql-picker-options"),k.setAttribute("aria-hidden","true"),k.tabIndex="-1",k.id="ql-picker-options-"+p,p+=1,this.label.setAttribute("aria-controls",k.id),this.options=k,[].slice.call(this.select.options).forEach(function(v){var O=b.buildItem(v);k.appendChild(O),v.selected===!0&&b.selectItem(O)}),this.container.appendChild(k)}},{key:"buildPicker",value:function(){var b=this;[].slice.call(this.select.attributes).forEach(function(k){b.container.setAttribute(k.name,k.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var b=this;this.close(),setTimeout(function(){return b.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(b){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=this.container.querySelector(".ql-selected");if(b!==v&&(v!=null&&v.classList.remove("ql-selected"),b!=null&&(b.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(b.parentNode.children,b),b.hasAttribute("data-value")?this.label.setAttribute("data-value",b.getAttribute("data-value")):this.label.removeAttribute("data-value"),b.hasAttribute("data-label")?this.label.setAttribute("data-label",b.getAttribute("data-label")):this.label.removeAttribute("data-label"),k))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var O=document.createEvent("Event");O.initEvent("change",!0,!0),this.select.dispatchEvent(O)}this.close()}}},{key:"update",value:function(){var b=void 0;if(this.select.selectedIndex>-1){var k=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];b=this.select.options[this.select.selectedIndex],this.selectItem(k)}else this.selectItem(null);var v=b!=null&&b!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",v)}}]),y}();n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=V(s),a=i(5),l=V(a),u=i(4),h=V(u),d=i(16),f=V(d),p=i(25),_=V(p),g=i(24),y=V(g),m=i(35),b=V(m),k=i(6),v=V(k),O=i(22),R=V(O),x=i(7),w=V(x),P=i(55),T=V(P),A=i(42),S=V(A),E=i(23),j=V(E);function V(z){return z&&z.__esModule?z:{default:z}}l.default.register({"blots/block":h.default,"blots/block/embed":u.BlockEmbed,"blots/break":f.default,"blots/container":_.default,"blots/cursor":y.default,"blots/embed":b.default,"blots/inline":v.default,"blots/scroll":R.default,"blots/text":w.default,"modules/clipboard":T.default,"modules/history":S.default,"modules/keyboard":j.default}),o.default.register(h.default,f.default,y.default,v.default,R.default,w.default),n.default=l.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l){this.domNode=l,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(a.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),a.create=function(l){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var u;return Array.isArray(this.tagName)?(typeof l=="string"&&(l=l.toUpperCase(),parseInt(l).toString()===l&&(l=parseInt(l))),typeof l=="number"?u=document.createElement(this.tagName[l-1]):this.tagName.indexOf(l)>-1?u=document.createElement(l):u=document.createElement(this.tagName[0])):u=document.createElement(this.tagName),this.className&&u.classList.add(this.className),u},a.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},a.prototype.clone=function(){var l=this.domNode.cloneNode(!1);return s.create(l)},a.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},a.prototype.deleteAt=function(l,u){var h=this.isolate(l,u);h.remove()},a.prototype.formatAt=function(l,u,h,d){var f=this.isolate(l,u);if(s.query(h,s.Scope.BLOT)!=null&&d)f.wrap(h,d);else if(s.query(h,s.Scope.ATTRIBUTE)!=null){var p=s.create(this.statics.scope);f.wrap(p),p.format(h,d)}},a.prototype.insertAt=function(l,u,h){var d=h==null?s.create("text",u):s.create(u,h),f=this.split(l);this.parent.insertBefore(d,f)},a.prototype.insertInto=function(l,u){u===void 0&&(u=null),this.parent!=null&&this.parent.children.remove(this);var h=null;l.children.insertBefore(this,u),u!=null&&(h=u.domNode),(this.domNode.parentNode!=l.domNode||this.domNode.nextSibling!=h)&&l.domNode.insertBefore(this.domNode,h),this.parent=l,this.attach()},a.prototype.isolate=function(l,u){var h=this.split(l);return h.split(u),h},a.prototype.length=function(){return 1},a.prototype.offset=function(l){return l===void 0&&(l=this.parent),this.parent==null||this==l?0:this.parent.children.offset(this)+this.parent.offset(l)},a.prototype.optimize=function(l){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},a.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},a.prototype.replace=function(l){l.parent!=null&&(l.parent.insertBefore(this,l.next),l.remove())},a.prototype.replaceWith=function(l,u){var h=typeof l=="string"?s.create(l,u):l;return h.replace(this),h},a.prototype.split=function(l,u){return l===0?this:this.next},a.prototype.update=function(l,u){},a.prototype.wrap=function(l,u){var h=typeof l=="string"?s.create(l,u):l;return this.parent!=null&&this.parent.insertBefore(h,this.next),h.appendChild(this),h},a.blotName="abstract",a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),a=i(33),l=i(1),u=function(){function h(d){this.attributes={},this.domNode=d,this.build()}return h.prototype.attribute=function(d,f){f?d.add(this.domNode,f)&&(d.value(this.domNode)!=null?this.attributes[d.attrName]=d:delete this.attributes[d.attrName]):(d.remove(this.domNode),delete this.attributes[d.attrName])},h.prototype.build=function(){var d=this;this.attributes={};var f=s.default.keys(this.domNode),p=o.default.keys(this.domNode),_=a.default.keys(this.domNode);f.concat(p).concat(_).forEach(function(g){var y=l.query(g,l.Scope.ATTRIBUTE);y instanceof s.default&&(d.attributes[y.attrName]=y)})},h.prototype.copy=function(d){var f=this;Object.keys(this.attributes).forEach(function(p){var _=f.attributes[p].value(f.domNode);d.format(p,_)})},h.prototype.move=function(d){var f=this;this.copy(d),Object.keys(this.attributes).forEach(function(p){f.attributes[p].remove(f.domNode)}),this.attributes={}},h.prototype.values=function(){var d=this;return Object.keys(this.attributes).reduce(function(f,p){return f[p]=d.attributes[p].value(d.domNode),f},{})},h}();n.default=u},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){u(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(u,h){var d=u.getAttribute("class")||"";return d.split(/\s+/).filter(function(f){return f.indexOf(h+"-")===0})}var l=function(u){s(h,u);function h(){return u!==null&&u.apply(this,arguments)||this}return h.keys=function(d){return(d.getAttribute("class")||"").split(/\s+/).map(function(f){return f.split("-").slice(0,-1).join("-")})},h.prototype.add=function(d,f){return this.canAdd(d,f)?(this.remove(d),d.classList.add(this.keyName+"-"+f),!0):!1},h.prototype.remove=function(d){var f=a(d,this.keyName);f.forEach(function(p){d.classList.remove(p)}),d.classList.length===0&&d.removeAttribute("class")},h.prototype.value=function(d){var f=a(d,this.keyName)[0]||"",p=f.slice(this.keyName.length+1);return this.canAdd(d,p)?p:""},h}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){u(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(u){var h=u.split("-"),d=h.slice(1).map(function(f){return f[0].toUpperCase()+f.slice(1)}).join("");return h[0]+d}var l=function(u){s(h,u);function h(){return u!==null&&u.apply(this,arguments)||this}return h.keys=function(d){return(d.getAttribute("style")||"").split(";").map(function(f){var p=f.split(":");return p[0].trim()})},h.prototype.add=function(d,f){return this.canAdd(d,f)?(d.style[a(this.keyName)]=f,!0):!1},h.prototype.remove=function(d){d.style[a(this.keyName)]="",d.getAttribute("style")||d.removeAttribute("style")},h.prototype.value=function(d){var f=d.style[a(this.keyName)];return this.canAdd(d,f)?f:""},h}(o.default);n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(u,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,h,d){return h&&l(u.prototype,h),d&&l(u,d),u}}();function o(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(u,h){o(this,l),this.quill=u,this.options=h,this.modules={}}return s(l,[{key:"init",value:function(){var h=this;Object.keys(this.options.modules).forEach(function(d){h.modules[d]==null&&h.addModule(d)})}},{key:"addModule",value:function(h){var d=this.quill.constructor.import("modules/"+h);return this.modules[h]=new d(this.quill,this.options.modules[h]||{}),this.modules[h]}}]),l}();a.DEFAULTS={modules:{}},a.themes={default:a},n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,k){for(var v=0;v<k.length;v++){var O=k[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,k,v){return k&&m(b.prototype,k),v&&m(b,v),b}}(),o=function m(b,k,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,k);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,k,v)}else{if("value"in O)return O.value;var x=O.get;return x===void 0?void 0:x.call(v)}},a=i(0),l=d(a),u=i(7),h=d(u);function d(m){return m&&m.__esModule?m:{default:m}}function f(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function p(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function _(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var g="\uFEFF",y=function(m){_(b,m);function b(k){f(this,b);var v=p(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,k));return v.contentNode=document.createElement("span"),v.contentNode.setAttribute("contenteditable",!1),[].slice.call(v.domNode.childNodes).forEach(function(O){v.contentNode.appendChild(O)}),v.leftGuard=document.createTextNode(g),v.rightGuard=document.createTextNode(g),v.domNode.appendChild(v.leftGuard),v.domNode.appendChild(v.contentNode),v.domNode.appendChild(v.rightGuard),v}return s(b,[{key:"index",value:function(v,O){return v===this.leftGuard?0:v===this.rightGuard?1:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,O)}},{key:"restore",value:function(v){var O=void 0,R=void 0,x=v.data.split(g).join("");if(v===this.leftGuard)if(this.prev instanceof h.default){var w=this.prev.length();this.prev.insertAt(w,x),O={startNode:this.prev.domNode,startOffset:w+x.length}}else R=document.createTextNode(x),this.parent.insertBefore(l.default.create(R),this),O={startNode:R,startOffset:x.length};else v===this.rightGuard&&(this.next instanceof h.default?(this.next.insertAt(0,x),O={startNode:this.next.domNode,startOffset:x.length}):(R=document.createTextNode(x),this.parent.insertBefore(l.default.create(R),this.next),O={startNode:R,startOffset:x.length}));return v.data=g,O}},{key:"update",value:function(v,O){var R=this;v.forEach(function(x){if(x.type==="characterData"&&(x.target===R.leftGuard||x.target===R.rightGuard)){var w=R.restore(x.target);w&&(O.range=w)}})}}]),b}(l.default.Embed);n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},u=new o.default.Attributor.Attribute("align","align",l),h=new o.default.Attributor.Class("align","ql-align",l),d=new o.default.Attributor.Style("align","text-align",l);n.AlignAttribute=u,n.AlignClass=h,n.AlignStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=l(s),a=i(26);function l(d){return d&&d.__esModule?d:{default:d}}var u=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),h=new a.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=u,n.BackgroundStyle=h},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},u=new o.default.Attributor.Attribute("direction","dir",l),h=new o.default.Attributor.Class("direction","ql-direction",l),d=new o.default.Attributor.Style("direction","direction",l);n.DirectionAttribute=u,n.DirectionClass=h,n.DirectionStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function m(b,k){for(var v=0;v<k.length;v++){var O=k[v];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}return function(b,k,v){return k&&m(b.prototype,k),v&&m(b,v),b}}(),o=function m(b,k,v){b===null&&(b=Function.prototype);var O=Object.getOwnPropertyDescriptor(b,k);if(O===void 0){var R=Object.getPrototypeOf(b);return R===null?void 0:m(R,k,v)}else{if("value"in O)return O.value;var x=O.get;return x===void 0?void 0:x.call(v)}},a=i(0),l=u(a);function u(m){return m&&m.__esModule?m:{default:m}}function h(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function d(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function f(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var p={scope:l.default.Scope.INLINE,whitelist:["serif","monospace"]},_=new l.default.Attributor.Class("font","ql-font",p),g=function(m){f(b,m);function b(){return h(this,b),d(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"value",value:function(v){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,v).replace(/["']/g,"")}}]),b}(l.default.Attributor.Style),y=new g("font","font-family",p);n.FontStyle=y,n.FontClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=a(s);function a(h){return h&&h.__esModule?h:{default:h}}var l=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),u=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=l,n.SizeStyle=u},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function k(v,O){for(var R=0;R<O.length;R++){var x=O[R];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(v,x.key,x)}}return function(v,O,R){return O&&k(v.prototype,O),R&&k(v,R),v}}(),o=i(0),a=f(o),l=i(5),u=f(l),h=i(9),d=f(h);function f(k){return k&&k.__esModule?k:{default:k}}function p(k,v){if(!(k instanceof v))throw new TypeError("Cannot call a class as a function")}function _(k,v){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:k}function g(k,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);k.prototype=Object.create(v&&v.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(k,v):k.__proto__=v)}var y=function(k){g(v,k);function v(O,R){p(this,v);var x=_(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,O,R));return x.lastRecorded=0,x.ignoreChange=!1,x.clear(),x.quill.on(u.default.events.EDITOR_CHANGE,function(w,P,T,A){w!==u.default.events.TEXT_CHANGE||x.ignoreChange||(!x.options.userOnly||A===u.default.sources.USER?x.record(P,T):x.transform(P))}),x.quill.keyboard.addBinding({key:"Z",shortKey:!0},x.undo.bind(x)),x.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},x.redo.bind(x)),/Win/i.test(navigator.platform)&&x.quill.keyboard.addBinding({key:"Y",shortKey:!0},x.redo.bind(x)),x}return s(v,[{key:"change",value:function(R,x){if(this.stack[R].length!==0){var w=this.stack[R].pop();this.stack[x].push(w),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(w[R],u.default.sources.USER),this.ignoreChange=!1;var P=b(w[R]);this.quill.setSelection(P)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(R,x){if(R.ops.length!==0){this.stack.redo=[];var w=this.quill.getContents().diff(x),P=Date.now();if(this.lastRecorded+this.options.delay>P&&this.stack.undo.length>0){var T=this.stack.undo.pop();w=w.compose(T.undo),R=T.redo.compose(R)}else this.lastRecorded=P;this.stack.undo.push({redo:R,undo:w}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(R){this.stack.undo.forEach(function(x){x.undo=R.transform(x.undo,!0),x.redo=R.transform(x.redo,!0)}),this.stack.redo.forEach(function(x){x.undo=R.transform(x.undo,!0),x.redo=R.transform(x.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),v}(d.default);y.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function m(k){var v=k.ops[k.ops.length-1];return v==null?!1:v.insert!=null?typeof v.insert=="string"&&v.insert.endsWith(`
`):v.attributes!=null?Object.keys(v.attributes).some(function(O){return a.default.query(O,a.default.Scope.BLOCK)!=null}):!1}function b(k){var v=k.reduce(function(R,x){return R+=x.delete||0,R},0),O=k.length()-v;return m(k)&&(O-=1),O}n.default=y,n.getLastChangeIndex=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function $(F,W){for(var U=0;U<W.length;U++){var M=W[U];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,W,U){return W&&$(F.prototype,W),U&&$(F,U),F}}(),o=function $(F,W,U){F===null&&(F=Function.prototype);var M=Object.getOwnPropertyDescriptor(F,W);if(M===void 0){var B=Object.getPrototypeOf(F);return B===null?void 0:$(B,W,U)}else{if("value"in M)return M.value;var K=M.get;return K===void 0?void 0:K.call(U)}},a=i(3),l=P(a),u=i(2),h=P(u),d=i(8),f=P(d),p=i(23),_=P(p),g=i(34),y=P(g),m=i(59),b=P(m),k=i(60),v=P(k),O=i(28),R=P(O),x=i(61),w=P(x);function P($){return $&&$.__esModule?$:{default:$}}function T($,F){if(!($ instanceof F))throw new TypeError("Cannot call a class as a function")}function A($,F){if(!$)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:$}function S($,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);$.prototype=Object.create(F&&F.prototype,{constructor:{value:$,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf($,F):$.__proto__=F)}var E=[!1,"center","right","justify"],j=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],V=[!1,"serif","monospace"],z=["1","2","3",!1],H=["small",!1,"large","huge"],ee=function($){S(F,$);function F(W,U){T(this,F);var M=A(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,W,U)),B=function K(J){if(!document.body.contains(W.root))return document.body.removeEventListener("click",K);M.tooltip!=null&&!M.tooltip.root.contains(J.target)&&document.activeElement!==M.tooltip.textbox&&!M.quill.hasFocus()&&M.tooltip.hide(),M.pickers!=null&&M.pickers.forEach(function(re){re.container.contains(J.target)||re.close()})};return W.emitter.listenDOM("click",document.body,B),M}return s(F,[{key:"addModule",value:function(U){var M=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"addModule",this).call(this,U);return U==="toolbar"&&this.extendToolbar(M),M}},{key:"buildButtons",value:function(U,M){U.forEach(function(B){var K=B.getAttribute("class")||"";K.split(/\s+/).forEach(function(J){if(J.startsWith("ql-")&&(J=J.slice(3),M[J]!=null))if(J==="direction")B.innerHTML=M[J][""]+M[J].rtl;else if(typeof M[J]=="string")B.innerHTML=M[J];else{var re=B.value||"";re!=null&&M[J][re]&&(B.innerHTML=M[J][re])}})})}},{key:"buildPickers",value:function(U,M){var B=this;this.pickers=U.map(function(J){if(J.classList.contains("ql-align"))return J.querySelector("option")==null&&L(J,E),new v.default(J,M.align);if(J.classList.contains("ql-background")||J.classList.contains("ql-color")){var re=J.classList.contains("ql-background")?"background":"color";return J.querySelector("option")==null&&L(J,j,re==="background"?"#ffffff":"#000000"),new b.default(J,M[re])}else return J.querySelector("option")==null&&(J.classList.contains("ql-font")?L(J,V):J.classList.contains("ql-header")?L(J,z):J.classList.contains("ql-size")&&L(J,H)),new R.default(J)});var K=function(){B.pickers.forEach(function(re){re.update()})};this.quill.on(f.default.events.EDITOR_CHANGE,K)}}]),F}(y.default);ee.DEFAULTS=(0,l.default)(!0,{},y.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var F=this,W=this.container.querySelector("input.ql-image[type=file]");W==null&&(W=document.createElement("input"),W.setAttribute("type","file"),W.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),W.classList.add("ql-image"),W.addEventListener("change",function(){if(W.files!=null&&W.files[0]!=null){var U=new FileReader;U.onload=function(M){var B=F.quill.getSelection(!0);F.quill.updateContents(new h.default().retain(B.index).delete(B.length).insert({image:M.target.result}),f.default.sources.USER),F.quill.setSelection(B.index+1,f.default.sources.SILENT),W.value=""},U.readAsDataURL(W.files[0])}}),this.container.appendChild(W)),W.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var G=function($){S(F,$);function F(W,U){T(this,F);var M=A(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,W,U));return M.textbox=M.root.querySelector('input[type="text"]'),M.listen(),M}return s(F,[{key:"listen",value:function(){var U=this;this.textbox.addEventListener("keydown",function(M){_.default.match(M,"enter")?(U.save(),M.preventDefault()):_.default.match(M,"escape")&&(U.cancel(),M.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),M!=null?this.textbox.value=M:U!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+U)||""),this.root.setAttribute("data-mode",U)}},{key:"restoreFocus",value:function(){var U=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=U}},{key:"save",value:function(){var U=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var M=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",U,f.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",U,f.default.sources.USER)),this.quill.root.scrollTop=M;break}case"video":U=q(U);case"formula":{if(!U)break;var B=this.quill.getSelection(!0);if(B!=null){var K=B.index+B.length;this.quill.insertEmbed(K,this.root.getAttribute("data-mode"),U,f.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(K+1," ",f.default.sources.USER),this.quill.setSelection(K+2,f.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),F}(w.default);function q($){var F=$.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||$.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return F?(F[1]||"https")+"://www.youtube.com/embed/"+F[2]+"?showinfo=0":(F=$.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(F[1]||"https")+"://player.vimeo.com/video/"+F[2]+"/":$}function L($,F){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;F.forEach(function(U){var M=document.createElement("option");U===W?M.setAttribute("selected","selected"):M.setAttribute("value",U),$.appendChild(M)})}n.BaseTooltip=G,n.default=ee},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];this.insertBefore(a[0],null),a.length>1&&this.append.apply(this,a.slice(1))},o.prototype.contains=function(a){for(var l,u=this.iterator();l=u();)if(l===a)return!0;return!1},o.prototype.insertBefore=function(a,l){a&&(a.next=l,l!=null?(a.prev=l.prev,l.prev!=null&&(l.prev.next=a),l.prev=a,l===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)},o.prototype.offset=function(a){for(var l=0,u=this.head;u!=null;){if(u===a)return l;l+=u.length(),u=u.next}return-1},o.prototype.remove=function(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)},o.prototype.iterator=function(a){return a===void 0&&(a=this.head),function(){var l=a;return a!=null&&(a=a.next),l}},o.prototype.find=function(a,l){l===void 0&&(l=!1);for(var u,h=this.iterator();u=h();){var d=u.length();if(a<d||l&&a===d&&(u.next==null||u.next.length()!==0))return[u,a];a-=d}return[null,0]},o.prototype.forEach=function(a){for(var l,u=this.iterator();l=u();)a(l)},o.prototype.forEachAt=function(a,l,u){if(!(l<=0))for(var h=this.find(a),d=h[0],f=h[1],p,_=a-f,g=this.iterator(d);(p=g())&&_<a+l;){var y=p.length();a>_?u(p,a-_,Math.min(l,_+y-a)):u(p,0,Math.min(y,a+l-_)),_+=y}},o.prototype.map=function(a){return this.reduce(function(l,u){return l.push(a(u)),l},[])},o.prototype.reduce=function(a,l){for(var u,h=this.iterator();u=h();)l=a(l,u);return l},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),a=i(1),l={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},u=100,h=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.scroll=_,_.observer=new MutationObserver(function(g){_.update(g)}),_.observer.observe(_.domNode,l),_.attach(),_}return f.prototype.detach=function(){d.prototype.detach.call(this),this.observer.disconnect()},f.prototype.deleteAt=function(p,_){this.update(),p===0&&_===this.length()?this.children.forEach(function(g){g.remove()}):d.prototype.deleteAt.call(this,p,_)},f.prototype.formatAt=function(p,_,g,y){this.update(),d.prototype.formatAt.call(this,p,_,g,y)},f.prototype.insertAt=function(p,_,g){this.update(),d.prototype.insertAt.call(this,p,_,g)},f.prototype.optimize=function(p,_){var g=this;p===void 0&&(p=[]),_===void 0&&(_={}),d.prototype.optimize.call(this,_);for(var y=[].slice.call(this.observer.takeRecords());y.length>0;)p.push(y.pop());for(var m=function(O,R){R===void 0&&(R=!0),!(O==null||O===g)&&O.domNode.parentNode!=null&&(O.domNode[a.DATA_KEY].mutations==null&&(O.domNode[a.DATA_KEY].mutations=[]),R&&m(O.parent))},b=function(O){O.domNode[a.DATA_KEY]==null||O.domNode[a.DATA_KEY].mutations==null||(O instanceof o.default&&O.children.forEach(b),O.optimize(_))},k=p,v=0;k.length>0;v+=1){if(v>=u)throw new Error("[Parchment] Maximum optimize iterations reached");for(k.forEach(function(O){var R=a.find(O.target,!0);R!=null&&(R.domNode===O.target&&(O.type==="childList"?(m(a.find(O.previousSibling,!1)),[].forEach.call(O.addedNodes,function(x){var w=a.find(x,!1);m(w,!1),w instanceof o.default&&w.children.forEach(function(P){m(P,!1)})})):O.type==="attributes"&&m(R.prev)),m(R))}),this.children.forEach(b),k=[].slice.call(this.observer.takeRecords()),y=k.slice();y.length>0;)p.push(y.pop())}},f.prototype.update=function(p,_){var g=this;_===void 0&&(_={}),p=p||this.observer.takeRecords(),p.map(function(y){var m=a.find(y.target,!0);return m==null?null:m.domNode[a.DATA_KEY].mutations==null?(m.domNode[a.DATA_KEY].mutations=[y],m):(m.domNode[a.DATA_KEY].mutations.push(y),null)}).forEach(function(y){y==null||y===g||y.domNode[a.DATA_KEY]==null||y.update(y.domNode[a.DATA_KEY].mutations||[],_)}),this.domNode[a.DATA_KEY].mutations!=null&&d.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,_),this.optimize(p,_)},f.blotName="scroll",f.defaultChild="block",f.scope=a.Scope.BLOCK_BLOT,f.tagName="DIV",f}(o.default);n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var p in f)f.hasOwnProperty(p)&&(d[p]=f[p])};return function(d,f){h(d,f);function p(){this.constructor=d}d.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1);function l(h,d){if(Object.keys(h).length!==Object.keys(d).length)return!1;for(var f in h)if(h[f]!==d[f])return!1;return!0}var u=function(h){s(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.formats=function(f){if(f.tagName!==d.tagName)return h.formats.call(this,f)},d.prototype.format=function(f,p){var _=this;f===this.statics.blotName&&!p?(this.children.forEach(function(g){g instanceof o.default||(g=g.wrap(d.blotName,!0)),_.attributes.copy(g)}),this.unwrap()):h.prototype.format.call(this,f,p)},d.prototype.formatAt=function(f,p,_,g){if(this.formats()[_]!=null||a.query(_,a.Scope.ATTRIBUTE)){var y=this.isolate(f,p);y.format(_,g)}else h.prototype.formatAt.call(this,f,p,_,g)},d.prototype.optimize=function(f){h.prototype.optimize.call(this,f);var p=this.formats();if(Object.keys(p).length===0)return this.unwrap();var _=this.next;_ instanceof d&&_.prev===this&&l(p,_.formats())&&(_.moveChildren(this),_.remove())},d.blotName="inline",d.scope=a.Scope.INLINE_BLOT,d.tagName="SPAN",d}(o.default);n.default=u},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){u(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1),l=function(u){s(h,u);function h(){return u!==null&&u.apply(this,arguments)||this}return h.formats=function(d){var f=a.query(h.blotName).tagName;if(d.tagName!==f)return u.formats.call(this,d)},h.prototype.format=function(d,f){a.query(d,a.Scope.BLOCK)!=null&&(d===this.statics.blotName&&!f?this.replaceWith(h.blotName):u.prototype.format.call(this,d,f))},h.prototype.formatAt=function(d,f,p,_){a.query(p,a.Scope.BLOCK)!=null?this.format(p,_):u.prototype.formatAt.call(this,d,f,p,_)},h.prototype.insertAt=function(d,f,p){if(p==null||a.query(f,a.Scope.INLINE)!=null)u.prototype.insertAt.call(this,d,f,p);else{var _=this.split(d),g=a.create(f,p);_.parent.insertBefore(g,_)}},h.prototype.update=function(d,f){navigator.userAgent.match(/Trident/)?this.build():u.prototype.update.call(this,d,f)},h.blotName="block",h.scope=a.Scope.BLOCK_BLOT,h.tagName="P",h}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var d in h)h.hasOwnProperty(d)&&(u[d]=h[d])};return function(u,h){l(u,h);function d(){this.constructor=u}u.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=function(l){s(u,l);function u(){return l!==null&&l.apply(this,arguments)||this}return u.formats=function(h){},u.prototype.format=function(h,d){l.prototype.formatAt.call(this,0,this.length(),h,d)},u.prototype.formatAt=function(h,d,f,p){h===0&&d===this.length()?this.format(f,p):l.prototype.formatAt.call(this,h,d,f,p)},u.prototype.formats=function(){return this.statics.formats(this.domNode)},u}(o.default);n.default=a},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var f in d)d.hasOwnProperty(f)&&(h[f]=d[f])};return function(h,d){u(h,d);function f(){this.constructor=h}h.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=i(1),l=function(u){s(h,u);function h(d){var f=u.call(this,d)||this;return f.text=f.statics.value(f.domNode),f}return h.create=function(d){return document.createTextNode(d)},h.value=function(d){var f=d.data;return f.normalize&&(f=f.normalize()),f},h.prototype.deleteAt=function(d,f){this.domNode.data=this.text=this.text.slice(0,d)+this.text.slice(d+f)},h.prototype.index=function(d,f){return this.domNode===d?f:-1},h.prototype.insertAt=function(d,f,p){p==null?(this.text=this.text.slice(0,d)+f+this.text.slice(d),this.domNode.data=this.text):u.prototype.insertAt.call(this,d,f,p)},h.prototype.length=function(){return this.text.length},h.prototype.optimize=function(d){u.prototype.optimize.call(this,d),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof h&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},h.prototype.position=function(d,f){return[this.domNode,d]},h.prototype.split=function(d,f){if(f===void 0&&(f=!1),!f){if(d===0)return this;if(d===this.length())return this.next}var p=a.create(this.domNode.splitText(d));return this.parent.insertBefore(p,this.next),this.text=this.statics.value(this.domNode),p},h.prototype.update=function(d,f){var p=this;d.some(function(_){return _.type==="characterData"&&_.target===p.domNode})&&(this.text=this.statics.value(this.domNode))},h.prototype.value=function(){return this.text},h.blotName="text",h.scope=a.Scope.INLINE_BLOT,h}(o.default);n.default=l},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,l){return arguments.length>1&&!this.contains(a)==!l?l:o.call(this,a)}}String.prototype.startsWith||(String.prototype.startsWith=function(a,l){return l=l||0,this.substr(l,a.length)===a}),String.prototype.endsWith||(String.prototype.endsWith=function(a,l){var u=this.toString();(typeof l!="number"||!isFinite(l)||Math.floor(l)!==l||l>u.length)&&(l=u.length),l-=a.length;var h=u.indexOf(a,l);return h!==-1&&h===l}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("predicate must be a function");for(var u=Object(this),h=u.length>>>0,d=arguments[1],f,p=0;p<h;p++)if(f=u[p],l.call(d,f,p,u))return f}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function a(v,O,R){if(v==O)return v?[[o,v]]:[];(R<0||v.length<R)&&(R=null);var x=d(v,O),w=v.substring(0,x);v=v.substring(x),O=O.substring(x),x=f(v,O);var P=v.substring(v.length-x);v=v.substring(0,v.length-x),O=O.substring(0,O.length-x);var T=l(v,O);return w&&T.unshift([o,w]),P&&T.push([o,P]),_(T),R!=null&&(T=m(T,R)),T=b(T),T}function l(v,O){var R;if(!v)return[[s,O]];if(!O)return[[i,v]];var x=v.length>O.length?v:O,w=v.length>O.length?O:v,P=x.indexOf(w);if(P!=-1)return R=[[s,x.substring(0,P)],[o,w],[s,x.substring(P+w.length)]],v.length>O.length&&(R[0][0]=R[2][0]=i),R;if(w.length==1)return[[i,v],[s,O]];var T=p(v,O);if(T){var A=T[0],S=T[1],E=T[2],j=T[3],V=T[4],z=a(A,E),H=a(S,j);return z.concat([[o,V]],H)}return u(v,O)}function u(v,O){for(var R=v.length,x=O.length,w=Math.ceil((R+x)/2),P=w,T=2*w,A=new Array(T),S=new Array(T),E=0;E<T;E++)A[E]=-1,S[E]=-1;A[P+1]=0,S[P+1]=0;for(var j=R-x,V=j%2!=0,z=0,H=0,ee=0,G=0,q=0;q<w;q++){for(var L=-q+z;L<=q-H;L+=2){var $=P+L,F;L==-q||L!=q&&A[$-1]<A[$+1]?F=A[$+1]:F=A[$-1]+1;for(var W=F-L;F<R&&W<x&&v.charAt(F)==O.charAt(W);)F++,W++;if(A[$]=F,F>R)H+=2;else if(W>x)z+=2;else if(V){var U=P+j-L;if(U>=0&&U<T&&S[U]!=-1){var M=R-S[U];if(F>=M)return h(v,O,F,W)}}}for(var B=-q+ee;B<=q-G;B+=2){var U=P+B,M;B==-q||B!=q&&S[U-1]<S[U+1]?M=S[U+1]:M=S[U-1]+1;for(var K=M-B;M<R&&K<x&&v.charAt(R-M-1)==O.charAt(x-K-1);)M++,K++;if(S[U]=M,M>R)G+=2;else if(K>x)ee+=2;else if(!V){var $=P+j-B;if($>=0&&$<T&&A[$]!=-1){var F=A[$],W=P+F-$;if(M=R-M,F>=M)return h(v,O,F,W)}}}}return[[i,v],[s,O]]}function h(v,O,R,x){var w=v.substring(0,R),P=O.substring(0,x),T=v.substring(R),A=O.substring(x),S=a(w,P),E=a(T,A);return S.concat(E)}function d(v,O){if(!v||!O||v.charAt(0)!=O.charAt(0))return 0;for(var R=0,x=Math.min(v.length,O.length),w=x,P=0;R<w;)v.substring(P,w)==O.substring(P,w)?(R=w,P=R):x=w,w=Math.floor((x-R)/2+R);return w}function f(v,O){if(!v||!O||v.charAt(v.length-1)!=O.charAt(O.length-1))return 0;for(var R=0,x=Math.min(v.length,O.length),w=x,P=0;R<w;)v.substring(v.length-w,v.length-P)==O.substring(O.length-w,O.length-P)?(R=w,P=R):x=w,w=Math.floor((x-R)/2+R);return w}function p(v,O){var R=v.length>O.length?v:O,x=v.length>O.length?O:v;if(R.length<4||x.length*2<R.length)return null;function w(H,ee,G){for(var q=H.substring(G,G+Math.floor(H.length/4)),L=-1,$="",F,W,U,M;(L=ee.indexOf(q,L+1))!=-1;){var B=d(H.substring(G),ee.substring(L)),K=f(H.substring(0,G),ee.substring(0,L));$.length<K+B&&($=ee.substring(L-K,L)+ee.substring(L,L+B),F=H.substring(0,G-K),W=H.substring(G+B),U=ee.substring(0,L-K),M=ee.substring(L+B))}return $.length*2>=H.length?[F,W,U,M,$]:null}var P=w(R,x,Math.ceil(R.length/4)),T=w(R,x,Math.ceil(R.length/2)),A;if(!P&&!T)return null;T?P?A=P[4].length>T[4].length?P:T:A=T:A=P;var S,E,j,V;v.length>O.length?(S=A[0],E=A[1],j=A[2],V=A[3]):(j=A[0],V=A[1],S=A[2],E=A[3]);var z=A[4];return[S,E,j,V,z]}function _(v){v.push([o,""]);for(var O=0,R=0,x=0,w="",P="",T;O<v.length;)switch(v[O][0]){case s:x++,P+=v[O][1],O++;break;case i:R++,w+=v[O][1],O++;break;case o:R+x>1?(R!==0&&x!==0&&(T=d(P,w),T!==0&&(O-R-x>0&&v[O-R-x-1][0]==o?v[O-R-x-1][1]+=P.substring(0,T):(v.splice(0,0,[o,P.substring(0,T)]),O++),P=P.substring(T),w=w.substring(T)),T=f(P,w),T!==0&&(v[O][1]=P.substring(P.length-T)+v[O][1],P=P.substring(0,P.length-T),w=w.substring(0,w.length-T))),R===0?v.splice(O-x,R+x,[s,P]):x===0?v.splice(O-R,R+x,[i,w]):v.splice(O-R-x,R+x,[i,w],[s,P]),O=O-R-x+(R?1:0)+(x?1:0)+1):O!==0&&v[O-1][0]==o?(v[O-1][1]+=v[O][1],v.splice(O,1)):O++,x=0,R=0,w="",P="";break}v[v.length-1][1]===""&&v.pop();var A=!1;for(O=1;O<v.length-1;)v[O-1][0]==o&&v[O+1][0]==o&&(v[O][1].substring(v[O][1].length-v[O-1][1].length)==v[O-1][1]?(v[O][1]=v[O-1][1]+v[O][1].substring(0,v[O][1].length-v[O-1][1].length),v[O+1][1]=v[O-1][1]+v[O+1][1],v.splice(O-1,1),A=!0):v[O][1].substring(0,v[O+1][1].length)==v[O+1][1]&&(v[O-1][1]+=v[O+1][1],v[O][1]=v[O][1].substring(v[O+1][1].length)+v[O+1][1],v.splice(O+1,1),A=!0)),O++;A&&_(v)}var g=a;g.INSERT=s,g.DELETE=i,g.EQUAL=o,t.exports=g;function y(v,O){if(O===0)return[o,v];for(var R=0,x=0;x<v.length;x++){var w=v[x];if(w[0]===i||w[0]===o){var P=R+w[1].length;if(O===P)return[x+1,v];if(O<P){v=v.slice();var T=O-R,A=[w[0],w[1].slice(0,T)],S=[w[0],w[1].slice(T)];return v.splice(x,1,A,S),[x+1,v]}else R=P}}throw new Error("cursor_pos is out of bounds!")}function m(v,O){var R=y(v,O),x=R[1],w=R[0],P=x[w],T=x[w+1];if(P==null)return v;if(P[0]!==o)return v;if(T!=null&&P[1]+T[1]===T[1]+P[1])return x.splice(w,2,T,P),k(x,w,2);if(T!=null&&T[1].indexOf(P[1])===0){x.splice(w,2,[T[0],P[1]],[0,P[1]]);var A=T[1].slice(P[1].length);return A.length>0&&x.splice(w+2,0,[T[0],A]),k(x,w,3)}else return v}function b(v){for(var O=!1,R=function(T){return T.charCodeAt(0)>=56320&&T.charCodeAt(0)<=57343},x=function(T){return T.charCodeAt(T.length-1)>=55296&&T.charCodeAt(T.length-1)<=56319},w=2;w<v.length;w+=1)v[w-2][0]===o&&x(v[w-2][1])&&v[w-1][0]===i&&R(v[w-1][1])&&v[w][0]===s&&R(v[w][1])&&(O=!0,v[w-1][1]=v[w-2][1].slice(-1)+v[w-1][1],v[w][1]=v[w-2][1].slice(-1)+v[w][1],v[w-2][1]=v[w-2][1].slice(0,-1));if(!O)return v;for(var P=[],w=0;w<v.length;w+=1)v[w][1].length>0&&P.push(v[w]);return P}function k(v,O,R){for(var x=O+R-1;x>=0&&x>=O-1;x--)if(x+1<v.length){var w=v[x],P=v[x+1];w[0]===P[1]&&v.splice(x,2,[w[0],w[1]+P[1]])}return v}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var a in s)o.push(a);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(a){return Object.prototype.toString.call(a)=="[object Arguments]"}n.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function a(u,h,d){this.fn=u,this.context=h,this.once=d||!1}function l(){this._events=new o,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],d,f;if(this._eventsCount===0)return h;for(f in d=this._events)i.call(d,f)&&h.push(s?f.slice(1):f);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},l.prototype.listeners=function(h,d){var f=s?s+h:h,p=this._events[f];if(d)return!!p;if(!p)return[];if(p.fn)return[p.fn];for(var _=0,g=p.length,y=new Array(g);_<g;_++)y[_]=p[_].fn;return y},l.prototype.emit=function(h,d,f,p,_,g){var y=s?s+h:h;if(!this._events[y])return!1;var m=this._events[y],b=arguments.length,k,v;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),b){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,f),!0;case 4:return m.fn.call(m.context,d,f,p),!0;case 5:return m.fn.call(m.context,d,f,p,_),!0;case 6:return m.fn.call(m.context,d,f,p,_,g),!0}for(v=1,k=new Array(b-1);v<b;v++)k[v-1]=arguments[v];m.fn.apply(m.context,k)}else{var O=m.length,R;for(v=0;v<O;v++)switch(m[v].once&&this.removeListener(h,m[v].fn,void 0,!0),b){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,d);break;case 3:m[v].fn.call(m[v].context,d,f);break;case 4:m[v].fn.call(m[v].context,d,f,p);break;default:if(!k)for(R=1,k=new Array(b-1);R<b;R++)k[R-1]=arguments[R];m[v].fn.apply(m[v].context,k)}}return!0},l.prototype.on=function(h,d,f){var p=new a(d,f||this),_=s?s+h:h;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.once=function(h,d,f){var p=new a(d,f||this,!0),_=s?s+h:h;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.removeListener=function(h,d,f,p){var _=s?s+h:h;if(!this._events[_])return this;if(!d)return--this._eventsCount===0?this._events=new o:delete this._events[_],this;var g=this._events[_];if(g.fn)g.fn===d&&(!p||g.once)&&(!f||g.context===f)&&(--this._eventsCount===0?this._events=new o:delete this._events[_]);else{for(var y=0,m=[],b=g.length;y<b;y++)(g[y].fn!==d||p&&!g[y].once||f&&g[y].context!==f)&&m.push(g[y]);m.length?this._events[_]=m.length===1?m[0]:m:--this._eventsCount===0?this._events=new o:delete this._events[_]}return this},l.prototype.removeAllListeners=function(h){var d;return h?(d=s?s+h:h,this._events[d]&&(--this._eventsCount===0?this._events=new o:delete this._events[d])):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prototype.setMaxListeners=function(){return this},l.prefixed=s,l.EventEmitter=l,typeof t<"u"&&(t.exports=l)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z},o=function(){function Z(te,le){var ue=[],se=!0,we=!1,xe=void 0;try{for(var ke=te[Symbol.iterator](),Ve;!(se=(Ve=ke.next()).done)&&(ue.push(Ve.value),!(le&&ue.length===le));se=!0);}catch(Ue){we=!0,xe=Ue}finally{try{!se&&ke.return&&ke.return()}finally{if(we)throw xe}}return ue}return function(te,le){if(Array.isArray(te))return te;if(Symbol.iterator in Object(te))return Z(te,le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function Z(te,le){for(var ue=0;ue<le.length;ue++){var se=le[ue];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(te,se.key,se)}}return function(te,le,ue){return le&&Z(te.prototype,le),ue&&Z(te,ue),te}}(),l=i(3),u=S(l),h=i(2),d=S(h),f=i(0),p=S(f),_=i(5),g=S(_),y=i(10),m=S(y),b=i(9),k=S(b),v=i(36),O=i(37),R=i(13),x=S(R),w=i(26),P=i(38),T=i(39),A=i(40);function S(Z){return Z&&Z.__esModule?Z:{default:Z}}function E(Z,te,le){return te in Z?Object.defineProperty(Z,te,{value:le,enumerable:!0,configurable:!0,writable:!0}):Z[te]=le,Z}function j(Z,te){if(!(Z instanceof te))throw new TypeError("Cannot call a class as a function")}function V(Z,te){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return te&&(typeof te=="object"||typeof te=="function")?te:Z}function z(Z,te){if(typeof te!="function"&&te!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof te);Z.prototype=Object.create(te&&te.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),te&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,te):Z.__proto__=te)}var H=(0,m.default)("quill:clipboard"),ee="__ql-matcher",G=[[Node.TEXT_NODE,Ye],[Node.TEXT_NODE,Se],["br",ce],[Node.ELEMENT_NODE,Se],[Node.ELEMENT_NODE,re],[Node.ELEMENT_NODE,Le],[Node.ELEMENT_NODE,J],[Node.ELEMENT_NODE,lt],["li",ye],["b",K.bind(K,"bold")],["i",K.bind(K,"italic")],["style",me]],q=[v.AlignAttribute,P.DirectionAttribute].reduce(function(Z,te){return Z[te.keyName]=te,Z},{}),L=[v.AlignStyle,O.BackgroundStyle,w.ColorStyle,P.DirectionStyle,T.FontStyle,A.SizeStyle].reduce(function(Z,te){return Z[te.keyName]=te,Z},{}),$=function(Z){z(te,Z);function te(le,ue){j(this,te);var se=V(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,le,ue));return se.quill.root.addEventListener("paste",se.onPaste.bind(se)),se.container=se.quill.addContainer("ql-clipboard"),se.container.setAttribute("contenteditable",!0),se.container.setAttribute("tabindex",-1),se.matchers=[],G.concat(se.options.matchers).forEach(function(we){var xe=o(we,2),ke=xe[0],Ve=xe[1];!ue.matchVisual&&Ve===Le||se.addMatcher(ke,Ve)}),se}return a(te,[{key:"addMatcher",value:function(ue,se){this.matchers.push([ue,se])}},{key:"convert",value:function(ue){if(typeof ue=="string")return this.container.innerHTML=ue.replace(/\>\r?\n +\</g,"><"),this.convert();var se=this.quill.getFormat(this.quill.selection.savedRange.index);if(se[x.default.blotName]){var we=this.container.innerText;return this.container.innerHTML="",new d.default().insert(we,E({},x.default.blotName,se[x.default.blotName]))}var xe=this.prepareMatching(),ke=o(xe,2),Ve=ke[0],Ue=ke[1],$e=B(this.container,Ve,Ue);return U($e,`
`)&&$e.ops[$e.ops.length-1].attributes==null&&($e=$e.compose(new d.default().retain($e.length()-1).delete(1))),H.log("convert",this.container.innerHTML,$e),this.container.innerHTML="",$e}},{key:"dangerouslyPasteHTML",value:function(ue,se){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;if(typeof ue=="string")this.quill.setContents(this.convert(ue),se),this.quill.setSelection(0,g.default.sources.SILENT);else{var xe=this.convert(se);this.quill.updateContents(new d.default().retain(ue).concat(xe),we),this.quill.setSelection(ue+xe.length(),g.default.sources.SILENT)}}},{key:"onPaste",value:function(ue){var se=this;if(!(ue.defaultPrevented||!this.quill.isEnabled())){var we=this.quill.getSelection(),xe=new d.default().retain(we.index),ke=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(g.default.sources.SILENT),setTimeout(function(){xe=xe.concat(se.convert()).delete(we.length),se.quill.updateContents(xe,g.default.sources.USER),se.quill.setSelection(xe.length()-we.length,g.default.sources.SILENT),se.quill.scrollingContainer.scrollTop=ke,se.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ue=this,se=[],we=[];return this.matchers.forEach(function(xe){var ke=o(xe,2),Ve=ke[0],Ue=ke[1];switch(Ve){case Node.TEXT_NODE:we.push(Ue);break;case Node.ELEMENT_NODE:se.push(Ue);break;default:[].forEach.call(ue.container.querySelectorAll(Ve),function($e){$e[ee]=$e[ee]||[],$e[ee].push(Ue)});break}}),[se,we]}}]),te}(k.default);$.DEFAULTS={matchers:[],matchVisual:!0};function F(Z,te,le){return(typeof te>"u"?"undefined":s(te))==="object"?Object.keys(te).reduce(function(ue,se){return F(ue,se,te[se])},Z):Z.reduce(function(ue,se){return se.attributes&&se.attributes[te]?ue.push(se):ue.insert(se.insert,(0,u.default)({},E({},te,le),se.attributes))},new d.default)}function W(Z){if(Z.nodeType!==Node.ELEMENT_NODE)return{};var te="__ql-computed-style";return Z[te]||(Z[te]=window.getComputedStyle(Z))}function U(Z,te){for(var le="",ue=Z.ops.length-1;ue>=0&&le.length<te.length;--ue){var se=Z.ops[ue];if(typeof se.insert!="string")break;le=se.insert+le}return le.slice(-1*te.length)===te}function M(Z){if(Z.childNodes.length===0)return!1;var te=W(Z);return["block","list-item"].indexOf(te.display)>-1}function B(Z,te,le){return Z.nodeType===Z.TEXT_NODE?le.reduce(function(ue,se){return se(Z,ue)},new d.default):Z.nodeType===Z.ELEMENT_NODE?[].reduce.call(Z.childNodes||[],function(ue,se){var we=B(se,te,le);return se.nodeType===Z.ELEMENT_NODE&&(we=te.reduce(function(xe,ke){return ke(se,xe)},we),we=(se[ee]||[]).reduce(function(xe,ke){return ke(se,xe)},we)),ue.concat(we)},new d.default):new d.default}function K(Z,te,le){return F(le,Z,!0)}function J(Z,te){var le=p.default.Attributor.Attribute.keys(Z),ue=p.default.Attributor.Class.keys(Z),se=p.default.Attributor.Style.keys(Z),we={};return le.concat(ue).concat(se).forEach(function(xe){var ke=p.default.query(xe,p.default.Scope.ATTRIBUTE);ke!=null&&(we[ke.attrName]=ke.value(Z),we[ke.attrName])||(ke=q[xe],ke!=null&&(ke.attrName===xe||ke.keyName===xe)&&(we[ke.attrName]=ke.value(Z)||void 0),ke=L[xe],ke!=null&&(ke.attrName===xe||ke.keyName===xe)&&(ke=L[xe],we[ke.attrName]=ke.value(Z)||void 0))}),Object.keys(we).length>0&&(te=F(te,we)),te}function re(Z,te){var le=p.default.query(Z);if(le==null)return te;if(le.prototype instanceof p.default.Embed){var ue={},se=le.value(Z);se!=null&&(ue[le.blotName]=se,te=new d.default().insert(ue,le.formats(Z)))}else typeof le.formats=="function"&&(te=F(te,le.blotName,le.formats(Z)));return te}function ce(Z,te){return U(te,`
`)||te.insert(`
`),te}function me(){return new d.default}function ye(Z,te){var le=p.default.query(Z);if(le==null||le.blotName!=="list-item"||!U(te,`
`))return te;for(var ue=-1,se=Z.parentNode;!se.classList.contains("ql-clipboard");)(p.default.query(se)||{}).blotName==="list"&&(ue+=1),se=se.parentNode;return ue<=0?te:te.compose(new d.default().retain(te.length()-1).retain(1,{indent:ue}))}function Se(Z,te){return U(te,`
`)||(M(Z)||te.length()>0&&Z.nextSibling&&M(Z.nextSibling))&&te.insert(`
`),te}function Le(Z,te){if(M(Z)&&Z.nextElementSibling!=null&&!U(te,`

`)){var le=Z.offsetHeight+parseFloat(W(Z).marginTop)+parseFloat(W(Z).marginBottom);Z.nextElementSibling.offsetTop>Z.offsetTop+le*1.5&&te.insert(`
`)}return te}function lt(Z,te){var le={},ue=Z.style||{};return ue.fontStyle&&W(Z).fontStyle==="italic"&&(le.italic=!0),ue.fontWeight&&(W(Z).fontWeight.startsWith("bold")||parseInt(W(Z).fontWeight)>=700)&&(le.bold=!0),Object.keys(le).length>0&&(te=F(te,le)),parseFloat(ue.textIndent||0)>0&&(te=new d.default().insert("	").concat(te)),te}function Ye(Z,te){var le=Z.data;if(Z.parentNode.tagName==="O:P")return te.insert(le.trim());if(le.trim().length===0&&Z.parentNode.classList.contains("ql-clipboard"))return te;if(!W(Z.parentNode).whiteSpace.startsWith("pre")){var ue=function(we,xe){return xe=xe.replace(/[^\u00a0]/g,""),xe.length<1&&we?" ":xe};le=le.replace(/\r\n/g," ").replace(/\n/g," "),le=le.replace(/\s\s+/g,ue.bind(ue,!0)),(Z.previousSibling==null&&M(Z.parentNode)||Z.previousSibling!=null&&M(Z.previousSibling))&&(le=le.replace(/^\s+/,ue.bind(ue,!1))),(Z.nextSibling==null&&M(Z.parentNode)||Z.nextSibling!=null&&M(Z.nextSibling))&&(le=le.replace(/\s+$/,ue.bind(ue,!1)))}return te.insert(le)}n.default=$,n.matchAttributor=J,n.matchBlot=re,n.matchNewline=Se,n.matchSpacing=Le,n.matchText=Ye},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var k=Object.getPrototypeOf(g);return k===null?void 0:_(k,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"optimize",value:function(m){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"optimize",this).call(this,m),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),g}(l.default);p.blotName="bold",p.tagName=["STRONG","B"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function A(S,E){var j=[],V=!0,z=!1,H=void 0;try{for(var ee=S[Symbol.iterator](),G;!(V=(G=ee.next()).done)&&(j.push(G.value),!(E&&j.length===E));V=!0);}catch(q){z=!0,H=q}finally{try{!V&&ee.return&&ee.return()}finally{if(z)throw H}}return j}return function(S,E){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return A(S,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function A(S,E){for(var j=0;j<E.length;j++){var V=E[j];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(S,V.key,V)}}return function(S,E,j){return E&&A(S.prototype,E),j&&A(S,j),S}}(),a=i(2),l=m(a),u=i(0),h=m(u),d=i(5),f=m(d),p=i(10),_=m(p),g=i(9),y=m(g);function m(A){return A&&A.__esModule?A:{default:A}}function b(A,S,E){return S in A?Object.defineProperty(A,S,{value:E,enumerable:!0,configurable:!0,writable:!0}):A[S]=E,A}function k(A,S){if(!(A instanceof S))throw new TypeError("Cannot call a class as a function")}function v(A,S){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:A}function O(A,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);A.prototype=Object.create(S&&S.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(A,S):A.__proto__=S)}var R=(0,_.default)("quill:toolbar"),x=function(A){O(S,A);function S(E,j){k(this,S);var V=v(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,E,j));if(Array.isArray(V.options.container)){var z=document.createElement("div");P(z,V.options.container),E.container.parentNode.insertBefore(z,E.container),V.container=z}else typeof V.options.container=="string"?V.container=document.querySelector(V.options.container):V.container=V.options.container;if(!(V.container instanceof HTMLElement)){var H;return H=R.error("Container required for toolbar",V.options),v(V,H)}return V.container.classList.add("ql-toolbar"),V.controls=[],V.handlers={},Object.keys(V.options.handlers).forEach(function(ee){V.addHandler(ee,V.options.handlers[ee])}),[].forEach.call(V.container.querySelectorAll("button, select"),function(ee){V.attach(ee)}),V.quill.on(f.default.events.EDITOR_CHANGE,function(ee,G){ee===f.default.events.SELECTION_CHANGE&&V.update(G)}),V.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){var ee=V.quill.selection.getRange(),G=s(ee,1),q=G[0];V.update(q)}),V}return o(S,[{key:"addHandler",value:function(j,V){this.handlers[j]=V}},{key:"attach",value:function(j){var V=this,z=[].find.call(j.classList,function(ee){return ee.indexOf("ql-")===0});if(z){if(z=z.slice(3),j.tagName==="BUTTON"&&j.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){R.warn("ignoring attaching to disabled format",z,j);return}if(h.default.query(z)==null){R.warn("ignoring attaching to nonexistent format",z,j);return}}var H=j.tagName==="SELECT"?"change":"click";j.addEventListener(H,function(ee){var G=void 0;if(j.tagName==="SELECT"){if(j.selectedIndex<0)return;var q=j.options[j.selectedIndex];q.hasAttribute("selected")?G=!1:G=q.value||!1}else j.classList.contains("ql-active")?G=!1:G=j.value||!j.hasAttribute("value"),ee.preventDefault();V.quill.focus();var L=V.quill.selection.getRange(),$=s(L,1),F=$[0];if(V.handlers[z]!=null)V.handlers[z].call(V,G);else if(h.default.query(z).prototype instanceof h.default.Embed){if(G=prompt("Enter "+z),!G)return;V.quill.updateContents(new l.default().retain(F.index).delete(F.length).insert(b({},z,G)),f.default.sources.USER)}else V.quill.format(z,G,f.default.sources.USER);V.update(F)}),this.controls.push([z,j])}}},{key:"update",value:function(j){var V=j==null?{}:this.quill.getFormat(j);this.controls.forEach(function(z){var H=s(z,2),ee=H[0],G=H[1];if(G.tagName==="SELECT"){var q=void 0;if(j==null)q=null;else if(V[ee]==null)q=G.querySelector("option[selected]");else if(!Array.isArray(V[ee])){var L=V[ee];typeof L=="string"&&(L=L.replace(/\"/g,'\\"')),q=G.querySelector('option[value="'+L+'"]')}q==null?(G.value="",G.selectedIndex=-1):q.selected=!0}else if(j==null)G.classList.remove("ql-active");else if(G.hasAttribute("value")){var $=V[ee]===G.getAttribute("value")||V[ee]!=null&&V[ee].toString()===G.getAttribute("value")||V[ee]==null&&!G.getAttribute("value");G.classList.toggle("ql-active",$)}else G.classList.toggle("ql-active",V[ee]!=null)})}}]),S}(y.default);x.DEFAULTS={};function w(A,S,E){var j=document.createElement("button");j.setAttribute("type","button"),j.classList.add("ql-"+S),E!=null&&(j.value=E),A.appendChild(j)}function P(A,S){Array.isArray(S[0])||(S=[S]),S.forEach(function(E){var j=document.createElement("span");j.classList.add("ql-formats"),E.forEach(function(V){if(typeof V=="string")w(j,V);else{var z=Object.keys(V)[0],H=V[z];Array.isArray(H)?T(j,z,H):w(j,z,H)}}),A.appendChild(j)})}function T(A,S,E){var j=document.createElement("select");j.classList.add("ql-"+S),E.forEach(function(V){var z=document.createElement("option");V!==!1?z.setAttribute("value",V):z.setAttribute("selected","selected"),j.appendChild(z)}),A.appendChild(j)}x.DEFAULTS={container:null,handlers:{clean:function(){var S=this,E=this.quill.getSelection();if(E!=null)if(E.length==0){var j=this.quill.getFormat();Object.keys(j).forEach(function(V){h.default.query(V,h.default.Scope.INLINE)!=null&&S.quill.format(V,!1)})}else this.quill.removeFormat(E,f.default.sources.USER)},direction:function(S){var E=this.quill.getFormat().align;S==="rtl"&&E==null?this.quill.format("align","right",f.default.sources.USER):!S&&E==="right"&&this.quill.format("align",!1,f.default.sources.USER),this.quill.format("direction",S,f.default.sources.USER)},indent:function(S){var E=this.quill.getSelection(),j=this.quill.getFormat(E),V=parseInt(j.indent||0);if(S==="+1"||S==="-1"){var z=S==="+1"?1:-1;j.direction==="rtl"&&(z*=-1),this.quill.format("indent",V+z,f.default.sources.USER)}},link:function(S){S===!0&&(S=prompt("Enter link URL:")),this.quill.format("link",S,f.default.sources.USER)},list:function(S){var E=this.quill.getSelection(),j=this.quill.getFormat(E);S==="check"?j.list==="checked"||j.list==="unchecked"?this.quill.format("list",!1,f.default.sources.USER):this.quill.format("list","unchecked",f.default.sources.USER):this.quill.format("list",S,f.default.sources.USER)}}},n.default=x,n.addControls=P},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var k=Object.getPrototypeOf(g);return k===null?void 0:_(k,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(y,m){h(this,g);var b=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return b.label.innerHTML=m,b.container.classList.add("ql-color-picker"),[].slice.call(b.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(k){k.classList.add("ql-primary")}),b}return s(g,[{key:"buildItem",value:function(m){var b=o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"buildItem",this).call(this,m);return b.style.backgroundColor=m.getAttribute("value")||"",b}},{key:"selectItem",value:function(m,b){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,m,b);var k=this.label.querySelector(".ql-color-label"),v=m&&m.getAttribute("data-value")||"";k&&(k.tagName==="line"?k.style.stroke=v:k.style.fill=v)}}]),g}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var k=Object.getPrototypeOf(g);return k===null?void 0:_(k,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(y,m){h(this,g);var b=d(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return b.container.classList.add("ql-icon-picker"),[].forEach.call(b.container.querySelectorAll(".ql-picker-item"),function(k){k.innerHTML=m[k.getAttribute("data-value")||""]}),b.defaultItem=b.container.querySelector(".ql-selected"),b.selectItem(b.defaultItem),b}return s(g,[{key:"selectItem",value:function(m,b){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,m,b),m=m||this.defaultItem,this.label.innerHTML=m.innerHTML}}]),g}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(u,h){for(var d=0;d<h.length;d++){var f=h[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(u,f.key,f)}}return function(u,h,d){return h&&l(u.prototype,h),d&&l(u,d),u}}();function o(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(u,h){var d=this;o(this,l),this.quill=u,this.boundsContainer=h||document.body,this.root=u.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){d.root.style.marginTop=-1*d.quill.root.scrollTop+"px"}),this.hide()}return s(l,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(h){var d=h.left+h.width/2-this.root.offsetWidth/2,f=h.bottom+this.quill.root.scrollTop;this.root.style.left=d+"px",this.root.style.top=f+"px",this.root.classList.remove("ql-flip");var p=this.boundsContainer.getBoundingClientRect(),_=this.root.getBoundingClientRect(),g=0;if(_.right>p.right&&(g=p.right-_.right,this.root.style.left=d+g+"px"),_.left<p.left&&(g=p.left-_.left,this.root.style.left=d+g+"px"),_.bottom>p.bottom){var y=_.bottom-_.top,m=h.bottom-h.top+y;this.root.style.top=f-m+"px",this.root.classList.add("ql-flip")}return g}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),l}();n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(A,S){var E=[],j=!0,V=!1,z=void 0;try{for(var H=A[Symbol.iterator](),ee;!(j=(ee=H.next()).done)&&(E.push(ee.value),!(S&&E.length===S));j=!0);}catch(G){V=!0,z=G}finally{try{!j&&H.return&&H.return()}finally{if(V)throw z}}return E}return function(A,S){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return T(A,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function T(A,S,E){A===null&&(A=Function.prototype);var j=Object.getOwnPropertyDescriptor(A,S);if(j===void 0){var V=Object.getPrototypeOf(A);return V===null?void 0:T(V,S,E)}else{if("value"in j)return j.value;var z=j.get;return z===void 0?void 0:z.call(E)}},a=function(){function T(A,S){for(var E=0;E<S.length;E++){var j=S[E];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(A,j.key,j)}}return function(A,S,E){return S&&T(A.prototype,S),E&&T(A,E),A}}(),l=i(3),u=k(l),h=i(8),d=k(h),f=i(43),p=k(f),_=i(27),g=k(_),y=i(15),m=i(41),b=k(m);function k(T){return T&&T.__esModule?T:{default:T}}function v(T,A){if(!(T instanceof A))throw new TypeError("Cannot call a class as a function")}function O(T,A){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:T}function R(T,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);T.prototype=Object.create(A&&A.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(T,A):T.__proto__=A)}var x=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],w=function(T){R(A,T);function A(S,E){v(this,A),E.modules.toolbar!=null&&E.modules.toolbar.container==null&&(E.modules.toolbar.container=x);var j=O(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,S,E));return j.quill.container.classList.add("ql-snow"),j}return a(A,[{key:"extendToolbar",value:function(E){E.container.classList.add("ql-snow"),this.buildButtons([].slice.call(E.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(E.container.querySelectorAll("select")),b.default),this.tooltip=new P(this.quill,this.options.bounds),E.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(j,V){E.handlers.link.call(E,!V.format.link)})}}]),A}(p.default);w.DEFAULTS=(0,u.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(A){if(A){var S=this.quill.getSelection();if(S==null||S.length==0)return;var E=this.quill.getText(S);/^\S+@\S+\.\S+$/.test(E)&&E.indexOf("mailto:")!==0&&(E="mailto:"+E);var j=this.quill.theme.tooltip;j.edit("link",E)}else this.quill.format("link",!1)}}}}});var P=function(T){R(A,T);function A(S,E){v(this,A);var j=O(this,(A.__proto__||Object.getPrototypeOf(A)).call(this,S,E));return j.preview=j.root.querySelector("a.ql-preview"),j}return a(A,[{key:"listen",value:function(){var E=this;o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(j){E.root.classList.contains("ql-editing")?E.save():E.edit("link",E.preview.textContent),j.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(j){if(E.linkRange!=null){var V=E.linkRange;E.restoreFocus(),E.quill.formatText(V,"link",!1,d.default.sources.USER),delete E.linkRange}j.preventDefault(),E.hide()}),this.quill.on(d.default.events.SELECTION_CHANGE,function(j,V,z){if(j!=null){if(j.length===0&&z===d.default.sources.USER){var H=E.quill.scroll.descendant(g.default,j.index),ee=s(H,2),G=ee[0],q=ee[1];if(G!=null){E.linkRange=new y.Range(j.index-q,G.length());var L=g.default.formats(G.domNode);E.preview.textContent=L,E.preview.setAttribute("href",L),E.show(),E.position(E.quill.getBounds(E.linkRange));return}}else delete E.linkRange;E.hide()}})}},{key:"show",value:function(){o(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),A}(f.BaseTooltip);P.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=w},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=se(s),a=i(36),l=i(38),u=i(64),h=i(65),d=se(h),f=i(66),p=se(f),_=i(67),g=se(_),y=i(37),m=i(26),b=i(39),k=i(40),v=i(56),O=se(v),R=i(68),x=se(R),w=i(27),P=se(w),T=i(69),A=se(T),S=i(70),E=se(S),j=i(71),V=se(j),z=i(72),H=se(z),ee=i(73),G=se(ee),q=i(13),L=se(q),$=i(74),F=se($),W=i(75),U=se(W),M=i(57),B=se(M),K=i(41),J=se(K),re=i(28),ce=se(re),me=i(59),ye=se(me),Se=i(60),Le=se(Se),lt=i(61),Ye=se(lt),Z=i(108),te=se(Z),le=i(62),ue=se(le);function se(we){return we&&we.__esModule?we:{default:we}}o.default.register({"attributors/attribute/direction":l.DirectionAttribute,"attributors/class/align":a.AlignClass,"attributors/class/background":y.BackgroundClass,"attributors/class/color":m.ColorClass,"attributors/class/direction":l.DirectionClass,"attributors/class/font":b.FontClass,"attributors/class/size":k.SizeClass,"attributors/style/align":a.AlignStyle,"attributors/style/background":y.BackgroundStyle,"attributors/style/color":m.ColorStyle,"attributors/style/direction":l.DirectionStyle,"attributors/style/font":b.FontStyle,"attributors/style/size":k.SizeStyle},!0),o.default.register({"formats/align":a.AlignClass,"formats/direction":l.DirectionClass,"formats/indent":u.IndentClass,"formats/background":y.BackgroundStyle,"formats/color":m.ColorStyle,"formats/font":b.FontClass,"formats/size":k.SizeClass,"formats/blockquote":d.default,"formats/code-block":L.default,"formats/header":p.default,"formats/list":g.default,"formats/bold":O.default,"formats/code":q.Code,"formats/italic":x.default,"formats/link":P.default,"formats/script":A.default,"formats/strike":E.default,"formats/underline":V.default,"formats/image":H.default,"formats/video":G.default,"formats/list/item":_.ListItem,"modules/formula":F.default,"modules/syntax":U.default,"modules/toolbar":B.default,"themes/bubble":te.default,"themes/snow":ue.default,"ui/icons":J.default,"ui/picker":ce.default,"ui/icon-picker":Le.default,"ui/color-picker":ye.default,"ui/tooltip":Ye.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function g(y,m){for(var b=0;b<m.length;b++){var k=m[b];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(y,k.key,k)}}return function(y,m,b){return m&&g(y.prototype,m),b&&g(y,b),y}}(),o=function g(y,m,b){y===null&&(y=Function.prototype);var k=Object.getOwnPropertyDescriptor(y,m);if(k===void 0){var v=Object.getPrototypeOf(y);return v===null?void 0:g(v,m,b)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(b)}},a=i(0),l=u(a);function u(g){return g&&g.__esModule?g:{default:g}}function h(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function d(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function f(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var p=function(g){f(y,g);function y(){return h(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"add",value:function(b,k){if(k==="+1"||k==="-1"){var v=this.value(b)||0;k=k==="+1"?v+1:v-1}return k===0?(this.remove(b),!0):o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"add",this).call(this,b,k)}},{key:"canAdd",value:function(b,k){return o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,b,k)||o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"canAdd",this).call(this,b,parseInt(k))}},{key:"value",value:function(b){return parseInt(o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"value",this).call(this,b))||void 0}}]),y}(l.default.Attributor.Class),_=new p("indent","ql-indent",{scope:l.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function u(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="blockquote",d.tagName="blockquote",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function p(_,g){for(var y=0;y<g.length;y++){var m=g[y];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(_,m.key,m)}}return function(_,g,y){return g&&p(_.prototype,g),y&&p(_,y),_}}(),o=i(4),a=l(o);function l(p){return p&&p.__esModule?p:{default:p}}function u(p,_){if(!(p instanceof _))throw new TypeError("Cannot call a class as a function")}function h(p,_){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:p}function d(p,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);p.prototype=Object.create(_&&_.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(p,_):p.__proto__=_)}var f=function(p){d(_,p);function _(){return u(this,_),h(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,null,[{key:"formats",value:function(y){return this.tagName.indexOf(y.tagName)+1}}]),_}(a.default);f.blotName="header",f.tagName=["H1","H2","H3","H4","H5","H6"],n.default=f},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function v(O,R){for(var x=0;x<R.length;x++){var w=R[x];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(O,w.key,w)}}return function(O,R,x){return R&&v(O.prototype,R),x&&v(O,x),O}}(),o=function v(O,R,x){O===null&&(O=Function.prototype);var w=Object.getOwnPropertyDescriptor(O,R);if(w===void 0){var P=Object.getPrototypeOf(O);return P===null?void 0:v(P,R,x)}else{if("value"in w)return w.value;var T=w.get;return T===void 0?void 0:T.call(x)}},a=i(0),l=p(a),u=i(4),h=p(u),d=i(25),f=p(d);function p(v){return v&&v.__esModule?v:{default:v}}function _(v,O,R){return O in v?Object.defineProperty(v,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):v[O]=R,v}function g(v,O){if(!(v instanceof O))throw new TypeError("Cannot call a class as a function")}function y(v,O){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:v}function m(v,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);v.prototype=Object.create(O&&O.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(v,O):v.__proto__=O)}var b=function(v){m(O,v);function O(){return g(this,O),y(this,(O.__proto__||Object.getPrototypeOf(O)).apply(this,arguments))}return s(O,[{key:"format",value:function(x,w){x===k.blotName&&!w?this.replaceWith(l.default.create(this.statics.scope)):o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"format",this).call(this,x,w)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(x,w){return this.parent.isolate(this.offset(this.parent),this.length()),x===this.parent.statics.blotName?(this.parent.replaceWith(x,w),this):(this.parent.unwrap(),o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replaceWith",this).call(this,x,w))}}],[{key:"formats",value:function(x){return x.tagName===this.tagName?void 0:o(O.__proto__||Object.getPrototypeOf(O),"formats",this).call(this,x)}}]),O}(h.default);b.blotName="list-item",b.tagName="LI";var k=function(v){m(O,v),s(O,null,[{key:"create",value:function(x){var w=x==="ordered"?"OL":"UL",P=o(O.__proto__||Object.getPrototypeOf(O),"create",this).call(this,w);return(x==="checked"||x==="unchecked")&&P.setAttribute("data-checked",x==="checked"),P}},{key:"formats",value:function(x){if(x.tagName==="OL")return"ordered";if(x.tagName==="UL")return x.hasAttribute("data-checked")?x.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function O(R){g(this,O);var x=y(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,R)),w=function(T){if(T.target.parentNode===R){var A=x.statics.formats(R),S=l.default.find(T.target);A==="checked"?S.format("list","unchecked"):A==="unchecked"&&S.format("list","checked")}};return R.addEventListener("touchstart",w),R.addEventListener("mousedown",w),x}return s(O,[{key:"format",value:function(x,w){this.children.length>0&&this.children.tail.format(x,w)}},{key:"formats",value:function(){return _({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(x,w){if(x instanceof b)o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertBefore",this).call(this,x,w);else{var P=w==null?this.length():w.offset(this),T=this.split(P);T.parent.insertBefore(x,T)}}},{key:"optimize",value:function(x){o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,x);var w=this.next;w!=null&&w.prev===this&&w.statics.blotName===this.statics.blotName&&w.domNode.tagName===this.domNode.tagName&&w.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(w.moveChildren(this),w.remove())}},{key:"replace",value:function(x){if(x.statics.blotName!==this.statics.blotName){var w=l.default.create(this.statics.defaultChild);x.moveChildren(w),this.appendChild(w)}o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"replace",this).call(this,x)}}]),O}(f.default);k.blotName="list",k.scope=l.default.Scope.BLOCK_BLOT,k.tagName=["OL","UL"],k.defaultChild="list-item",k.allowedChildren=[b],n.ListItem=b,n.default=k},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function u(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="italic",d.tagName=["EM","I"],n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(g,y){for(var m=0;m<y.length;m++){var b=y[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}return function(g,y,m){return y&&_(g.prototype,y),m&&_(g,m),g}}(),o=function _(g,y,m){g===null&&(g=Function.prototype);var b=Object.getOwnPropertyDescriptor(g,y);if(b===void 0){var k=Object.getPrototypeOf(g);return k===null?void 0:_(k,y,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=u(a);function u(_){return _&&_.__esModule?_:{default:_}}function h(_,g){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}function d(_,g){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:_}function f(_,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);_.prototype=Object.create(g&&g.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(_,g):_.__proto__=g)}var p=function(_){f(g,_);function g(){return h(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,null,[{key:"create",value:function(m){return m==="super"?document.createElement("sup"):m==="sub"?document.createElement("sub"):o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,m)}},{key:"formats",value:function(m){if(m.tagName==="SUB")return"sub";if(m.tagName==="SUP")return"super"}}]),g}(l.default);p.blotName="script",p.tagName=["SUB","SUP"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function u(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="strike",d.tagName="S",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function u(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function h(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){h(p,f);function p(){return l(this,p),u(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="underline",d.tagName="U",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var k=0;k<b.length;k++){var v=b[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,k){return b&&y(m.prototype,b),k&&y(m,k),m}}(),o=function y(m,b,k){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,k)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(k)}},a=i(0),l=h(a),u=i(27);function h(y){return y&&y.__esModule?y:{default:y}}function d(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function f(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function p(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var _=["alt","height","width"],g=function(y){p(m,y);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(k,v){_.indexOf(k)>-1?v?this.domNode.setAttribute(k,v):this.domNode.removeAttribute(k):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,k,v)}}],[{key:"create",value:function(k){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,k);return typeof k=="string"&&v.setAttribute("src",this.sanitize(k)),v}},{key:"formats",value:function(k){return _.reduce(function(v,O){return k.hasAttribute(O)&&(v[O]=k.getAttribute(O)),v},{})}},{key:"match",value:function(k){return/\.(jpe?g|gif|png)$/.test(k)||/^data:image\/.+;base64/.test(k)}},{key:"sanitize",value:function(k){return(0,u.sanitize)(k,["http","https","data"])?k:"//:0"}},{key:"value",value:function(k){return k.getAttribute("src")}}]),m}(l.default.Embed);g.blotName="image",g.tagName="IMG",n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function y(m,b){for(var k=0;k<b.length;k++){var v=b[k];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,k){return b&&y(m.prototype,b),k&&y(m,k),m}}(),o=function y(m,b,k){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var O=Object.getPrototypeOf(m);return O===null?void 0:y(O,b,k)}else{if("value"in v)return v.value;var R=v.get;return R===void 0?void 0:R.call(k)}},a=i(4),l=i(27),u=h(l);function h(y){return y&&y.__esModule?y:{default:y}}function d(y,m){if(!(y instanceof m))throw new TypeError("Cannot call a class as a function")}function f(y,m){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:y}function p(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);y.prototype=Object.create(m&&m.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(y,m):y.__proto__=m)}var _=["height","width"],g=function(y){p(m,y);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(k,v){_.indexOf(k)>-1?v?this.domNode.setAttribute(k,v):this.domNode.removeAttribute(k):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,k,v)}}],[{key:"create",value:function(k){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,k);return v.setAttribute("frameborder","0"),v.setAttribute("allowfullscreen",!0),v.setAttribute("src",this.sanitize(k)),v}},{key:"formats",value:function(k){return _.reduce(function(v,O){return k.hasAttribute(O)&&(v[O]=k.getAttribute(O)),v},{})}},{key:"sanitize",value:function(k){return u.default.sanitize(k)}},{key:"value",value:function(k){return k.getAttribute("src")}}]),m}(a.BlockEmbed);g.blotName="video",g.className="ql-video",g.tagName="IFRAME",n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function k(v,O){for(var R=0;R<O.length;R++){var x=O[R];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(v,x.key,x)}}return function(v,O,R){return O&&k(v.prototype,O),R&&k(v,R),v}}(),o=function k(v,O,R){v===null&&(v=Function.prototype);var x=Object.getOwnPropertyDescriptor(v,O);if(x===void 0){var w=Object.getPrototypeOf(v);return w===null?void 0:k(w,O,R)}else{if("value"in x)return x.value;var P=x.get;return P===void 0?void 0:P.call(R)}},a=i(35),l=p(a),u=i(5),h=p(u),d=i(9),f=p(d);function p(k){return k&&k.__esModule?k:{default:k}}function _(k,v){if(!(k instanceof v))throw new TypeError("Cannot call a class as a function")}function g(k,v){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:k}function y(k,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);k.prototype=Object.create(v&&v.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(k,v):k.__proto__=v)}var m=function(k){y(v,k);function v(){return _(this,v),g(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,null,[{key:"create",value:function(R){var x=o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,R);return typeof R=="string"&&(window.katex.render(R,x,{throwOnError:!1,errorColor:"#f00"}),x.setAttribute("data-value",R)),x}},{key:"value",value:function(R){return R.getAttribute("data-value")}}]),v}(l.default);m.blotName="formula",m.className="ql-formula",m.tagName="SPAN";var b=function(k){y(v,k),s(v,null,[{key:"register",value:function(){h.default.register(m,!0)}}]);function v(){_(this,v);var O=g(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return O}return v}(f.default);n.FormulaBlot=m,n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function R(x,w){for(var P=0;P<w.length;P++){var T=w[P];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(x,T.key,T)}}return function(x,w,P){return w&&R(x.prototype,w),P&&R(x,P),x}}(),o=function R(x,w,P){x===null&&(x=Function.prototype);var T=Object.getOwnPropertyDescriptor(x,w);if(T===void 0){var A=Object.getPrototypeOf(x);return A===null?void 0:R(A,w,P)}else{if("value"in T)return T.value;var S=T.get;return S===void 0?void 0:S.call(P)}},a=i(0),l=g(a),u=i(5),h=g(u),d=i(9),f=g(d),p=i(13),_=g(p);function g(R){return R&&R.__esModule?R:{default:R}}function y(R,x){if(!(R instanceof x))throw new TypeError("Cannot call a class as a function")}function m(R,x){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:R}function b(R,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);R.prototype=Object.create(x&&x.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(R,x):R.__proto__=x)}var k=function(R){b(x,R);function x(){return y(this,x),m(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"replaceWith",value:function(P){this.domNode.textContent=this.domNode.textContent,this.attach(),o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"replaceWith",this).call(this,P)}},{key:"highlight",value:function(P){var T=this.domNode.textContent;this.cachedText!==T&&((T.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=P(T),this.domNode.normalize(),this.attach()),this.cachedText=T)}}]),x}(_.default);k.className="ql-syntax";var v=new l.default.Attributor.Class("token","hljs",{scope:l.default.Scope.INLINE}),O=function(R){b(x,R),s(x,null,[{key:"register",value:function(){h.default.register(v,!0),h.default.register(k,!0)}}]);function x(w,P){y(this,x);var T=m(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w,P));if(typeof T.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var A=null;return T.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(A),A=setTimeout(function(){T.highlight(),A=null},T.options.interval)}),T.highlight(),T}return s(x,[{key:"highlight",value:function(){var P=this;if(!this.quill.selection.composing){this.quill.update(h.default.sources.USER);var T=this.quill.getSelection();this.quill.scroll.descendants(k).forEach(function(A){A.highlight(P.options.highlight)}),this.quill.update(h.default.sources.SILENT),T!=null&&this.quill.setSelection(T,h.default.sources.SILENT)}}}]),x}(f.default);O.DEFAULTS={highlight:function(){return window.hljs==null?null:function(R){var x=window.hljs.highlightAuto(R);return x.value}}(),interval:1e3},n.CodeBlock=k,n.CodeToken=v,n.default=O},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function x(w,P,T){w===null&&(w=Function.prototype);var A=Object.getOwnPropertyDescriptor(w,P);if(A===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:x(S,P,T)}else{if("value"in A)return A.value;var E=A.get;return E===void 0?void 0:E.call(T)}},o=function(){function x(w,P){for(var T=0;T<P.length;T++){var A=P[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(w,A.key,A)}}return function(w,P,T){return P&&x(w.prototype,P),T&&x(w,T),w}}(),a=i(3),l=y(a),u=i(8),h=y(u),d=i(43),f=y(d),p=i(15),_=i(41),g=y(_);function y(x){return x&&x.__esModule?x:{default:x}}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function b(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function k(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var v=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],O=function(x){k(w,x);function w(P,T){m(this,w),T.modules.toolbar!=null&&T.modules.toolbar.container==null&&(T.modules.toolbar.container=v);var A=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,P,T));return A.quill.container.classList.add("ql-bubble"),A}return o(w,[{key:"extendToolbar",value:function(T){this.tooltip=new R(this.quill,this.options.bounds),this.tooltip.root.appendChild(T.container),this.buildButtons([].slice.call(T.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(T.container.querySelectorAll("select")),g.default)}}]),w}(f.default);O.DEFAULTS=(0,l.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(w){w?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var R=function(x){k(w,x);function w(P,T){m(this,w);var A=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,P,T));return A.quill.on(h.default.events.EDITOR_CHANGE,function(S,E,j,V){if(S===h.default.events.SELECTION_CHANGE)if(E!=null&&E.length>0&&V===h.default.sources.USER){A.show(),A.root.style.left="0px",A.root.style.width="",A.root.style.width=A.root.offsetWidth+"px";var z=A.quill.getLines(E.index,E.length);if(z.length===1)A.position(A.quill.getBounds(E));else{var H=z[z.length-1],ee=A.quill.getIndex(H),G=Math.min(H.length()-1,E.index+E.length-ee),q=A.quill.getBounds(new p.Range(ee,G));A.position(q)}}else document.activeElement!==A.textbox&&A.quill.hasFocus()&&A.hide()}),A}return o(w,[{key:"listen",value:function(){var T=this;s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){T.root.classList.remove("ql-editing")}),this.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!T.root.classList.contains("ql-hidden")){var A=T.quill.getSelection();A!=null&&T.position(T.quill.getBounds(A))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(T){var A=s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"position",this).call(this,T),S=this.root.querySelector(".ql-tooltip-arrow");if(S.style.marginLeft="",A===0)return A;S.style.marginLeft=-1*A-S.offsetWidth/2+"px"}}]),w}(d.BaseTooltip);R.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=R,n.default=O},function(t,n,i){t.exports=i(63)}]).default})})(rm);var Fk=rm.exports,qk=Ge&&Ge.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hs=Ge&&Ge.__assign||function(){return Hs=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Hs.apply(this,arguments)},Uk=Ge&&Ge.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},wo=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},Ut=wo(Y),Bk=wo(df),ri=wo($k),Wh=wo(Fk),zk=function(r){qk(e,r);function e(t){var n=r.call(this,t)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(s,o,a,l){var u,h,d,f;s==="text-change"?(h=(u=n).onEditorChangeText)===null||h===void 0||h.call(u,n.editor.root.innerHTML,o,l,n.unprivilegedEditor):s==="selection-change"&&((f=(d=n).onEditorChangeSelection)===null||f===void 0||f.call(d,o,l,n.unprivilegedEditor))};var i=n.isControlled()?t.value:t.defaultValue;return n.value=i??"",n}return e.prototype.validateProps=function(t){var n;if(Ut.default.Children.count(t.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ut.default.Children.count(t.children)){var i=Ut.default.Children.only(t.children);if(((n=i)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&t.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},e.prototype.shouldComponentUpdate=function(t,n){var i=this,s;if(this.validateProps(t),!this.editor||this.state.generation!==n.generation)return!0;if("value"in t){var o=this.getEditorContents(),a=(s=t.value,s??"");this.isEqualValue(a,o)||this.setEditorContents(this.editor,a)}return t.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,t.readOnly),Uk(this.cleanProps,this.dirtyProps).some(function(l){return!ri.default(t[l],i.props[l])})},e.prototype.shouldComponentRegenerate=function(t){var n=this;return this.dirtyProps.some(function(i){return!ri.default(t[i],n.props[i])})},e.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},e.prototype.componentWillUnmount=function(){this.destroyEditor()},e.prototype.componentDidUpdate=function(t,n){var i=this;if(this.editor&&this.shouldComponentRegenerate(t)){var s=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:s,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var a=this.regenerationSnapshot,s=a.delta,l=a.selection;delete this.regenerationSnapshot,this.instantiateEditor();var u=this.editor;u.setContents(s),Qh(function(){return i.setEditorSelection(u,l)})}},e.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},e.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},e.prototype.isControlled=function(){return"value"in this.props},e.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},e.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},e.prototype.createEditor=function(t,n){var i=new Wh.default(t,n);return n.tabIndex!=null&&this.setEditorTabIndex(i,n.tabIndex),this.hookEditor(i),i},e.prototype.hookEditor=function(t){this.unprivilegedEditor=this.makeUnprivilegedEditor(t),t.on("editor-change",this.onEditorChange)},e.prototype.unhookEditor=function(t){t.off("editor-change",this.onEditorChange)},e.prototype.getEditorContents=function(){return this.value},e.prototype.getEditorSelection=function(){return this.selection},e.prototype.isDelta=function(t){return t&&t.ops},e.prototype.isEqualValue=function(t,n){return this.isDelta(t)&&this.isDelta(n)?ri.default(t.ops,n.ops):ri.default(t,n)},e.prototype.setEditorContents=function(t,n){var i=this;this.value=n;var s=this.getEditorSelection();typeof n=="string"?t.setContents(t.clipboard.convert(n)):t.setContents(n),Qh(function(){return i.setEditorSelection(t,s)})},e.prototype.setEditorSelection=function(t,n){if(this.selection=n,n){var i=t.getLength();n.index=Math.max(0,Math.min(n.index,i-1)),n.length=Math.max(0,Math.min(n.length,i-1-n.index)),t.setSelection(n)}},e.prototype.setEditorTabIndex=function(t,n){var i,s;!((s=(i=t)===null||i===void 0?void 0:i.scroll)===null||s===void 0)&&s.domNode&&(t.scroll.domNode.tabIndex=n)},e.prototype.setEditorReadOnly=function(t,n){n?t.disable():t.enable()},e.prototype.makeUnprivilegedEditor=function(t){var n=t;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},e.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var t=Bk.default.findDOMNode(this.editingArea);if(!t)throw new Error("Cannot find element for editing area");if(t.nodeType===3)throw new Error("Editing area cannot be a text node");return t},e.prototype.renderEditingArea=function(){var t=this,n=this.props,i=n.children,s=n.preserveWhitespace,o=this.state.generation,a={key:o,ref:function(l){t.editingArea=l}};return Ut.default.Children.count(i)?Ut.default.cloneElement(Ut.default.Children.only(i),a):s?Ut.default.createElement("pre",Hs({},a)):Ut.default.createElement("div",Hs({},a))},e.prototype.render=function(){var t;return Ut.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(t=this.props.className,t??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},e.prototype.onEditorChangeText=function(t,n,i,s){var o,a;if(this.editor){var l=this.isDelta(this.value)?s.getContents():s.getHTML();l!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=l,(a=(o=this.props).onChange)===null||a===void 0||a.call(o,t,n,i,s))}},e.prototype.onEditorChangeSelection=function(t,n,i){var s,o,a,l,u,h;if(this.editor){var d=this.getEditorSelection(),f=!d&&t,p=d&&!t;ri.default(t,d)||(this.selection=t,(o=(s=this.props).onChangeSelection)===null||o===void 0||o.call(s,t,n,i),f?(l=(a=this.props).onFocus)===null||l===void 0||l.call(a,t,n,i):p&&((h=(u=this.props).onBlur)===null||h===void 0||h.call(u,d,n,i)))}},e.prototype.focus=function(){this.editor&&this.editor.focus()},e.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},e.displayName="React Quill",e.Quill=Wh.default,e.defaultProps={theme:"snow",modules:{},readOnly:!1},e}(Ut.default.Component);function Qh(r){Promise.resolve().then(r)}var Hk=zk;const Gk=eg(Hk),Kk=100,Wk=800,Qk=200,Yk=({value:r,onChange:e,placeholder:t="Enter content here...",style:n={},className:i="mt-1"})=>{const s=Y.useRef(null),[o,a]=Y.useState(Qk);Y.useEffect(()=>{var g,y;const h=(g=s.current)==null?void 0:g.getEditor(),d=(y=h==null?void 0:h.getModule("toolbar"))==null?void 0:y.container;if(!d)return;let f=0;const p=m=>{m.target.closest(".ql-picker")&&(f=window.scrollY)},_=m=>{m.target.closest(".ql-picker")&&setTimeout(()=>{window.scrollY!==f&&window.scrollTo(window.scrollX,f)},0)};return d.addEventListener("mousedown",p),d.addEventListener("mouseup",_),()=>{d.removeEventListener("mousedown",p),d.removeEventListener("mouseup",_)}},[]);const l=Y.useMemo(()=>({toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{align:[]}],[{color:[]},{background:[]}],["link","image","video"],["clean"]],handlers:{image:function(){var k;const h=(k=s.current)==null?void 0:k.getEditor();if(!h){console.error("Quill editor instance not found.");return}const d=h.getSelection(!0);if(!d)return;const f=h.theme.tooltip,p=f.save,_=f.action;f.edit();const g=f.textbox;if(!g){console.error("Tooltip input element not found."),f.hide();return}g.value="",g.setAttribute("placeholder","Enter image URL"),g.setAttribute("data-mode","image");const y=()=>{var O;const v=g.value;v&&h.insertEmbed(d.index,"image",v,"user"),f.hide(),f.save=p,f.action=_,g.removeEventListener("keydown",m),(O=f.root.querySelector("a.ql-action"))==null||O.removeEventListener("click",y)},m=v=>{var O;v.key==="Enter"?(v.preventDefault(),y()):v.key==="Escape"&&(v.preventDefault(),f.hide(),f.save=p,f.action=_,g.removeEventListener("keydown",m),(O=f.root.querySelector("a.ql-action"))==null||O.removeEventListener("click",y))};f.save=y,g.removeEventListener("keydown",m),g.addEventListener("keydown",m);const b=f.root.querySelector("a.ql-action");b?(b.removeEventListener("click",y),b.addEventListener("click",y)):console.warn("Tooltip save button (a.ql-action) not found."),g.focus()}}}}),[]),u=Y.useMemo(()=>["header","font","size","bold","italic","underline","strike","blockquote","code-block","list","bullet","script","indent","direction","align","color","background","link","image","video"],[]);return N.jsxs("div",{className:`quill-editor-container ${i}`,children:[N.jsx("div",{className:"quill-editor-wrapper border border-gray-300 rounded-md overflow-hidden",style:{...n,height:`${o}px`,display:"flex",flexDirection:"column"},children:N.jsx(Gk,{theme:"snow",value:r,onChange:e,ref:s,modules:l,formats:u,className:"bg-white flex-grow",placeholder:t,style:{height:"calc(100% - 42px)"}})}),N.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-gray-600",children:[N.jsx(N_,{size:16}),N.jsx("input",{type:"range",min:Kk,max:Wk,value:o,onChange:h=>a(Number(h.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700","aria-label":"Adjust editor height"}),N.jsx(T_,{size:16}),N.jsxs("span",{className:"text-xs w-12 text-right",children:[o,"px"]})]})]})},Jk=({initialData:r,onSubmit:e,onCancel:t,isLoading:n})=>{const[i,s]=Y.useState((r==null?void 0:r.title)||""),[o,a]=Y.useState((r==null?void 0:r.slug)||""),[l,u]=Y.useState((r==null?void 0:r.content)||""),{showToast:h}=Yt();Y.useEffect(()=>{s((r==null?void 0:r.title)||""),a((r==null?void 0:r.slug)||""),u((r==null?void 0:r.content)||"")},[r]);const d=p=>{a(p.target.value.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""))},f=p=>{if(p.preventDefault(),!i||!o||!l){h("Title, Slug, and Content are required.","error");return}e({title:i,slug:o,content:l})};return N.jsxs("form",{onSubmit:f,className:"p-4 border rounded shadow-sm bg-white space-y-4",children:[N.jsx("h3",{className:"text-lg font-medium",children:r!=null&&r.id?"Edit Page":"Add New Page"}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"pageTitle",className:"block text-sm font-medium text-gray-700",children:"Title"}),N.jsx("input",{type:"text",id:"pageTitle",value:i,onChange:p=>s(p.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),N.jsxs("div",{children:[N.jsx("label",{htmlFor:"pageSlug",className:"block text-sm font-medium text-gray-700",children:"Slug (URL Path, e.g., 'about-us')"}),N.jsx("input",{type:"text",id:"pageSlug",value:o,onChange:d,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",pattern:"^[a-z0-9-]+$",title:"Slug can only contain lowercase letters, numbers, and hyphens."})]}),N.jsxs("div",{className:"relative quill-editor-wrapper",children:[N.jsx("label",{htmlFor:"pageContent",className:"block text-sm font-medium text-gray-700",children:"Content"}),N.jsx(Yk,{value:l,onChange:u,placeholder:"Enter page content here..."})]}),N.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[(r==null?void 0:r.id)&&t&&N.jsx("button",{type:"button",onClick:t,disabled:n,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Cancel Edit"}),N.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:n?"Saving...":r!=null&&r.id?"Update Page":"Add Page"})]})]})},Xk=({page:r,index:e,pageCount:t,isLoading:n,onEdit:i,onDelete:s,onMoveUp:o,onMoveDown:a})=>N.jsxs("li",{className:"p-4 flex justify-between items-center hover:bg-gray-50",children:[N.jsxs("div",{className:"flex items-center space-x-3",children:[N.jsx("span",{className:"text-xs font-mono text-gray-400 w-6 text-right",children:r.order}),N.jsxs("div",{children:[N.jsx("p",{className:"font-medium text-gray-900",children:r.title}),N.jsxs("p",{className:"text-sm text-gray-500",children:["/",r.slug]})]})]}),N.jsxs("div",{className:"flex items-center space-x-1",children:[N.jsx("button",{onClick:()=>o(e),disabled:n||e===0,className:`p-1 rounded ${n||e===0?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Up",children:N.jsx(Ma,{size:18})}),N.jsx("button",{onClick:()=>a(e),disabled:n||e===t-1,className:`p-1 rounded ${n||e===t-1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Down",children:N.jsx(Da,{size:18})}),N.jsx("button",{onClick:()=>i(r),disabled:n,className:"p-1 rounded text-gray-500 hover:text-indigo-600 hover:bg-indigo-100 disabled:opacity-50",title:"Edit",children:N.jsx(ki,{size:18})}),r.id&&N.jsx("button",{onClick:()=>s(r.id),disabled:n,className:"p-1 rounded text-gray-500 hover:text-red-600 hover:bg-red-100 disabled:opacity-50",title:"Delete",children:N.jsx(wr,{size:18})})]})]},r.id),Zk=()=>{const{pages:r,isLoading:e,isEditing:t,handleFormSubmit:n,handleDelete:i,startEditing:s,resetForm:o,handleMoveUp:a,handleMoveDown:l}=fw();return N.jsxs("div",{className:"space-y-6",children:[N.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Manage Pages"}),N.jsx(Jk,{initialData:t?r.find(u=>u.id===t):void 0,onSubmit:n,onCancel:o,isLoading:e},t||"add"),N.jsxs("div",{className:"mt-6 border rounded shadow-sm bg-white",children:[N.jsx("h3",{className:"text-lg font-medium p-4 border-b",children:"Existing Pages"}),e&&!r.length?N.jsx("p",{className:"p-4 text-gray-500",children:"Loading pages..."}):r.length===0?N.jsx("p",{className:"p-4 text-gray-500",children:"No pages found."}):N.jsx("ul",{className:"divide-y divide-gray-200",children:r.map((u,h)=>N.jsx(Xk,{page:u,index:h,pageCount:r.length,isLoading:e,onEdit:s,onDelete:i,onMoveUp:a,onMoveDown:l},u.id))})]})]})},eS="modulepreload",tS=function(r){return"/"+r},Yh={},cn=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(l=>{if(l=tS(l),l in Yh)return;Yh[l]=!0;const u=l.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":eS,u||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},nS=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>cn(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class sc extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class rS extends sc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class iS extends sc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sS extends sc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ka;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Ka||(Ka={}));var oS=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class aS{constructor(e,{headers:t={},customFetch:n,region:i=Ka.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=nS(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return oS(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:u}).catch(_=>{throw new rS(_)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new iS(h);if(!h.ok)throw new sS(h);let f=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var kt={},oc={},xo={},$i={},Eo={},To={},lS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Tr=lS();const cS=Tr.fetch,im=Tr.fetch.bind(Tr),sm=Tr.Headers,uS=Tr.Request,hS=Tr.Response,Fr=Object.freeze(Object.defineProperty({__proto__:null,Headers:sm,Request:uS,Response:hS,default:im,fetch:cS},Symbol.toStringTag,{value:"Module"})),fS=tg(Fr);var Ao={};Object.defineProperty(Ao,"__esModule",{value:!0});let dS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ao.default=dS;var om=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(To,"__esModule",{value:!0});const pS=om(fS),mS=om(Ao);let gS=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=pS.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let u=null,h=null,d=null,f=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=m:h=JSON.parse(m))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,f=406,p="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(h=[],u=null,f=200,p="OK")}catch{s.status===404&&g===""?(f=204,p="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,f=200,p="OK"),u&&this.shouldThrowOnError)throw new mS.default(u)}return{error:u,data:h,count:d,status:f,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};To.default=gS;var yS=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Eo,"__esModule",{value:!0});const vS=yS(To);let _S=class extends vS.default{select(e){let t=!1;const n=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Eo.default=_S;var bS=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($i,"__esModule",{value:!0});const wS=bS(Eo);let xS=class extends wS.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};$i.default=xS;var ES=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xo,"__esModule",{value:!0});const ii=ES($i);let TS=class{constructor(e,{headers:t={},schema:n,fetch:i}){this.url=e,this.headers=t,this.schema=n,this.fetch=i}select(e,{head:t=!1,count:n}={}){const i=t?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new ii.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new ii.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(l.length>0){const u=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new ii.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new ii.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ii.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};xo.default=TS;var ko={},So={};Object.defineProperty(So,"__esModule",{value:!0});So.version=void 0;So.version="0.0.0-automated";Object.defineProperty(ko,"__esModule",{value:!0});ko.DEFAULT_HEADERS=void 0;const AS=So;ko.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${AS.version}`};var am=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(oc,"__esModule",{value:!0});const kS=am(xo),SS=am($i),IS=ko;let NS=class lm{constructor(e,{headers:t={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},IS.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new kS.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new lm(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:i=!1,count:s}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;n||i?(o=n?"HEAD":"GET",Object.entries(t).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{a.searchParams.append(h,d)})):(o="POST",l=t);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new SS.default({method:o,url:a,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};oc.default=NS;var qr=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(kt,"__esModule",{value:!0});kt.PostgrestError=kt.PostgrestBuilder=kt.PostgrestTransformBuilder=kt.PostgrestFilterBuilder=kt.PostgrestQueryBuilder=kt.PostgrestClient=void 0;const cm=qr(oc);kt.PostgrestClient=cm.default;const um=qr(xo);kt.PostgrestQueryBuilder=um.default;const hm=qr($i);kt.PostgrestFilterBuilder=hm.default;const fm=qr(Eo);kt.PostgrestTransformBuilder=fm.default;const dm=qr(To);kt.PostgrestBuilder=dm.default;const pm=qr(Ao);kt.PostgrestError=pm.default;var PS=kt.default={PostgrestClient:cm.default,PostgrestQueryBuilder:um.default,PostgrestFilterBuilder:hm.default,PostgrestTransformBuilder:fm.default,PostgrestBuilder:dm.default,PostgrestError:pm.default};const{PostgrestClient:OS,PostgrestQueryBuilder:JN,PostgrestFilterBuilder:XN,PostgrestTransformBuilder:ZN,PostgrestBuilder:eP,PostgrestError:tP}=PS,CS="2.11.2",RS={"X-Client-Info":`realtime-js/${CS}`},jS="1.0.0",mm=1e4,LS=1e3;var fr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(fr||(fr={}));var Nt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Nt||(Nt={}));var Dt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Dt||(Dt={}));var Wa;(function(r){r.websocket="websocket"})(Wa||(Wa={}));var qn;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(qn||(qn={}));class DS{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const i=t.getUint8(1),s=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+i));o=o+i;const l=n.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class gm{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var qe;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(qe||(qe={}));const Jh=(r,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,o)=>(s[o]=MS(o,r,e,i),s),{})},MS=(r,e,t,n)=>{const i=e.find(a=>a.name===r),s=i==null?void 0:i.type,o=t[r];return s&&!n.includes(s)?ym(s,o):Qa(o)},ym=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return qS(e,t)}switch(r){case qe.bool:return VS(e);case qe.float4:case qe.float8:case qe.int2:case qe.int4:case qe.int8:case qe.numeric:case qe.oid:return $S(e);case qe.json:case qe.jsonb:return FS(e);case qe.timestamp:return US(e);case qe.abstime:case qe.date:case qe.daterange:case qe.int4range:case qe.int8range:case qe.money:case qe.reltime:case qe.text:case qe.time:case qe.timestamptz:case qe.timetz:case qe.tsrange:case qe.tstzrange:return Qa(e);default:return Qa(e)}},Qa=r=>r,VS=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},$S=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},FS=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},qS=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let s;const o=r.slice(1,t);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>ym(e,a))}return r},US=r=>typeof r=="string"?r.replace(" ","T"):r,vm=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ha{constructor(e,t,n={},i=mm){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Xh;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Xh||(Xh={}));class mi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mi.syncState(this.state,i,s,o),this.pendingDiffs.forEach(l=>{this.state=mi.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=mi.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const s=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(s,(u,h)=>{o[u]||(l[u]=h)}),this.map(o,(u,h)=>{const d=s[u];if(d){const f=h.map(y=>y.presence_ref),p=d.map(y=>y.presence_ref),_=h.filter(y=>p.indexOf(y.presence_ref)<0),g=d.filter(y=>f.indexOf(y.presence_ref)<0);_.length>0&&(a[u]=_),g.length>0&&(l[u]=g)}else a[u]=h}),this.syncDiff(s,{joins:a,leaves:l},n,i)}static syncDiff(e,t,n,i){const{joins:s,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(a,l)=>{var u;const h=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),h.length>0){const d=e[a].map(p=>p.presence_ref),f=h.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...f)}n(a,h,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const h=l.map(d=>d.presence_ref);u=u.filter(d=>h.indexOf(d.presence_ref)<0),e[a]=u,i(a,u,l),u.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Zh;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Zh||(Zh={}));var ef;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(ef||(ef={}));var en;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(en||(en={}));class ac{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ha(this,Dt.join,this.params,this.timeout),this.rejoinTimer=new gm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Dt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new mi(this),this.broadcastEndpointURL=vm(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:a}}=this.params;this._onError(h=>e==null?void 0:e(en.CHANNEL_ERROR,h)),this._onClose(()=>e==null?void 0:e(en.CLOSED));const l={},u={broadcast:s,presence:o,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var d;if(this.socket.setAuth(),h===void 0){e==null||e(en.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,_=[];for(let g=0;g<p;g++){const y=f[g],{filter:{event:m,schema:b,table:k,filter:v}}=y,O=h&&h[g];if(O&&O.event===m&&O.schema===b&&O.table===k&&O.filter===v)_.push(Object.assign(Object.assign({},y),{id:O.id}));else{this.unsubscribe(),e==null||e(en.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(en.SUBSCRIBED);return}}).receive("error",h=>{e==null||e(en.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(en.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Nt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Dt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new ha(this,Dt.leave,{},e);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ha(this,e,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:h}=Dt;if(n&&[a,l,u,h].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var _,g,y;return((_=p.filter)===null||_===void 0?void 0:_.event)==="*"||((y=(g=p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(s=this.bindings[o])===null||s===void 0||s.filter(p=>{var _,g,y,m,b,k;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const v=p.id,O=(_=p.filter)===null||_===void 0?void 0:_.event;return v&&((g=t.ids)===null||g===void 0?void 0:g.includes(v))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const v=(b=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return v==="*"||v===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const _=f.data,{schema:g,table:y,commit_timestamp:m,type:b,errors:k}=_;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:m,eventType:b,new:{},old:{},errors:k}),this._getPayloadRecords(_))}p.callback(f,n)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ac.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Dt.close,{},e)}_onError(e){this._on(Dt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Jh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Jh(e.columns,e.old_record)),t}}const BS=()=>{},zS=typeof WebSocket<"u",HS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GS{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=RS,this.params={},this.timeout=mm,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=BS,this.conn=null,this.sendBuffer=[],this.serializer=new DS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>cn(async()=>{const{default:l}=await Promise.resolve().then(()=>Fr);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Wa.websocket}`,this.httpEndpoint=vm(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,o)=>o(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new gm(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(zS){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new KS(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),cn(async()=>{const{default:e}=await import("./browser-CKC9vik6.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:jS}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case fr.connecting:return qn.Connecting;case fr.open:return qn.Open;case fr.closing:return qn.Closing;default:return qn.Closed}}isConnected(){return this.connectionState()===qn.Open}channel(e,t={config:{}}){const n=new ac(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(Dt.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(LS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:i,payload:s,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${o&&"("+o+")"||""}`,s),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Dt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([HS],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class KS{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=fr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class lc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ot(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class WS extends lc{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ya extends lc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var QS=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const _m=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>cn(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},YS=()=>QS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield cn(()=>Promise.resolve().then(()=>Fr),void 0)).Response:Response}),Ja=r=>{if(Array.isArray(r))return r.map(t=>Ja(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ja(n)}),e};var Wn=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const fa=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),JS=(r,e,t)=>Wn(void 0,void 0,void 0,function*(){const n=yield YS();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{e(new WS(fa(i),r.status||500))}).catch(i=>{e(new Ya(fa(i),i))}):e(new Ya(fa(r),r))}),XS=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function Fi(r,e,t,n,i,s){return Wn(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,XS(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>JS(l,a,n))})})}function Gs(r,e,t,n){return Wn(this,void 0,void 0,function*(){return Fi(r,"GET",e,t,n)})}function yn(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"POST",e,n,i,t)})}function ZS(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"PUT",e,n,i,t)})}function eI(r,e,t,n){return Wn(this,void 0,void 0,function*(){return Fi(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function bm(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return Fi(r,"DELETE",e,n,i,t)})}var Tt=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const tI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nI{constructor(e,t={},n,i){this.url=e,this.headers=t,this.bucketId=n,this.fetch=_m(i)}uploadOrUpdate(e,t,n,i){return Tt(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},tf),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const u=this._removeEmptyFolders(t),h=this._getFinalPath(u),d=yield this.fetch(`${this.url}/object/${h}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(ot(s))return{data:null,error:s};throw s}})}upload(e,t,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return Tt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:tf.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:h}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(ot(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return Tt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=yield yn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new lc("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}update(e,t,n){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Tt(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}copy(e,t,n){return Tt(this,void 0,void 0,function*(){try{return{data:{path:(yield yn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return Tt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield yn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return Tt(this,void 0,void 0,function*(){try{const i=yield yn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}download(e,t){return Tt(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Gs(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ot(a))return{data:null,error:a};throw a}})}info(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Gs(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ja(n),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}exists(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield eI(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ot(n)&&n instanceof Ya){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return Tt(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}list(e,t,n){return Tt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},tI),t),{prefix:e||""});return{data:yield yn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const rI="2.7.1",iI={"X-Client-Info":`storage-js/${rI}`};var rr=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class sI{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},iI),t),this.fetch=_m(n)}listBuckets(){return rr(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}})}getBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Gs(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return rr(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return rr(this,void 0,void 0,function*(){try{return{data:yield ZS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}emptyBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield yn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}}class oI extends sI{constructor(e,t={},n){super(e,t,n)}from(e){return new nI(this.url,this.headers,e,this.fetch)}}const aI="2.49.4";let ui="";typeof Deno<"u"?ui="deno":typeof document<"u"?ui="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ui="react-native":ui="node";const lI={"X-Client-Info":`supabase-js-${ui}/${aI}`},cI={headers:lI},uI={schema:"public"},hI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fI={};var dI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};const pI=r=>{let e;return r?e=r:typeof fetch>"u"?e=im:e=fetch,(...t)=>e(...t)},mI=()=>typeof Headers>"u"?sm:Headers,gI=(r,e,t)=>{const n=pI(t),i=mI();return(s,o)=>dI(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",r),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},o),{headers:u}))})};var yI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};function vI(r){return r.replace(/\/$/,"")}function _I(r,e){const{db:t,auth:n,realtime:i,global:s}=r,{db:o,auth:a,realtime:l,global:u}=e,h={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},u),s),accessToken:()=>yI(this,void 0,void 0,function*(){return""})};return r.accessToken?h.accessToken=r.accessToken:delete h.accessToken,h}const wm="2.69.1",ur=30*1e3,Xa=3,da=Xa*ur,bI="http://localhost:9999",wI="supabase.auth.token",xI={"X-Client-Info":`gotrue-js/${wm}`},Za="X-Supabase-Api-Version",xm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},EI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,TI=6e5;class cc extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Te(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class AI extends cc{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function kI(r){return Te(r)&&r.name==="AuthApiError"}class Em extends cc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Rn extends cc{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class mn extends Rn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function SI(r){return Te(r)&&r.name==="AuthSessionMissingError"}class pa extends Rn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ds extends Rn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ps extends Rn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function II(r){return Te(r)&&r.name==="AuthImplicitGrantRedirectError"}class nf extends Rn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class el extends Rn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ma(r){return Te(r)&&r.name==="AuthRetryableFetchError"}class rf extends Rn{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class gi extends Rn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),of=` 	
\r=`.split(""),NI=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<of.length;e+=1)r[of[e].charCodeAt(0)]=-2;for(let e=0;e<sf.length;e+=1)r[sf[e].charCodeAt(0)]=e;return r})();function Tm(r,e,t){const n=NI[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function af(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{CI(o,n,t)};for(let o=0;o<r.length;o+=1)Tm(r.charCodeAt(o),i,s);return e.join("")}function PI(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function OI(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}PI(n,e)}}function CI(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function RI(r){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)Tm(r.charCodeAt(i),t,n);return new Uint8Array(e)}function jI(r){const e=[];return OI(r,t=>e.push(t)),new Uint8Array(e)}function LI(r){return Math.round(Date.now()/1e3)+r}function DI(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Bt=()=>typeof window<"u"&&typeof document<"u",Vn={tested:!1,writable:!1},yi=()=>{if(!Bt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vn.tested)return Vn.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Vn.tested=!0,Vn.writable=!0}catch{Vn.tested=!0,Vn.writable=!1}return Vn.writable};function MI(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const Am=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>cn(async()=>{const{default:n}=await Promise.resolve().then(()=>Fr);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},VI=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",km=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ms=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},gs=async(r,e)=>{await r.removeItem(e)};class Io{constructor(){this.promise=new Io.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Io.promiseConstructor=Promise;function ga(r){const e=r.split(".");if(e.length!==3)throw new gi("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!EI.test(e[n]))throw new gi("JWT not in base64url format");return{header:JSON.parse(af(e[0])),payload:JSON.parse(af(e[1])),signature:RI(e[2]),raw:{header:e[0],payload:e[1]}}}async function $I(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function FI(r,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await r(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function qI(r){return("0"+r.toString(16)).substr(-2)}function UI(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,qI).join("")}async function BI(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function zI(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await BI(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ir(r,e,t=!1){const n=UI();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await km(r,`${e}-code-verifier`,i);const s=await zI(n);return[s,n===s?"plain":"s256"]}const HI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function GI(r){const e=r.headers.get(Za);if(!e||!e.match(HI))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function KI(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function WI(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var QI=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Fn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),YI=[502,503,504];async function lf(r){var e;if(!VI(r))throw new el(Fn(r),0);if(YI.includes(r.status))throw new el(Fn(r),r.status);let t;try{t=await r.json()}catch(s){throw new Em(Fn(s),s)}let n;const i=GI(r);if(i&&i.getTime()>=xm["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new rf(Fn(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new mn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new rf(Fn(t),r.status,t.weak_password.reasons);throw new AI(Fn(t),r.status||500,n)}const JI=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function Pe(r,e,t,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Za]||(s[Za]=xm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await XI(r,e,t+a,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function XI(r,e,t,n,i,s){const o=JI(e,n,i,s);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new el(Fn(l),0)}if(a.ok||await lf(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await lf(l)}}function gn(r){var e;let t=null;nN(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=LI(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function cf(r){const e=gn(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function vn(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ZI(r){return{data:r,error:null}}function eN(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s}=r,o=QI(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function tN(r){return r}function nN(r){return r.access_token&&r.refresh_token&&r.expires_in}var rN=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class iN{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Am(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await Pe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=rN(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:eN,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Te(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:vn})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,s,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},h=await Pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:tN});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(_=>{const g=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(_.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Te(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await Pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:vn})}catch(t){if(Te(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await Pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:vn})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await Pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}}const sN={getItem:r=>yi()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{yi()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{yi()&&globalThis.localStorage.removeItem(r)}};function uf(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function oN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const sr={debug:!!(globalThis&&yi()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Sm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class aN extends Sm{}async function lN(r,e,t){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),sr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new aN(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(sr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}oN();const cN={url:bI,storageKey:wI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hf(r,e,t){return await t()}class Ii{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ii.nextInstanceID,Ii.nextInstanceID+=1,this.instanceID>0&&Bt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},cN),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new iN({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Am(i.fetch),this.lock=i.lock||hf,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Bt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=lN:this.lock=hf,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:yi()?this.storage=sN:(this.memoryStorage={},this.storage=uf(this.memoryStorage)):(this.memoryStorage={},this.storage=uf(this.memoryStorage)),Bt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wm}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=MI(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Bt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),II(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Te(t)?{error:t}:{error:new Em("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const s=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:gn}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Te(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,n,i;try{let s;if("email"in e){const{email:h,password:d,options:f}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await ir(this.storage,this.storageKey)),s=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:_},xform:gn})}else if("phone"in e){const{phone:h,password:d,options:f}=e;s=await Pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:gn})}else throw new ds("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Te(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:o,options:a}=e;t=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:cf})}else if("phone"in e){const{phone:s,password:o,options:a}=e;t=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:cf})}else throw new ds("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new pa}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await ms(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:s,error:o}=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:gn});if(await gs(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new pa}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Te(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:s,nonce:o}=e,a=await Pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gn}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new pa}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,s,o;try{if("email"in e){const{email:a,options:l}=e;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await ir(this.storage,this.storageKey));const{error:d}=await Pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:h}=await Pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new ds("You must provide either an email or phone number.")}catch(a){if(Te(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await Pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:gn});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(Te(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await ir(this.storage,this.storageKey)),await Pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:ZI})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new mn;const{error:i}=await Pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Te(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await Pe(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:a}=await Pe(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new ds("You must provide either an email or phone number and a type")}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ms(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<da:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,h)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,h))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:vn}):await this._useSession(async t=>{var n,i,s;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new mn}:await Pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:vn})})}catch(t){if(Te(t))return SI(t)&&(await this._removeSession(),await gs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new mn;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await ir(this.storage,this.storageKey));const{data:u,error:h}=await Pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:vn});if(h)throw h;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Te(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new mn;const t=Date.now()/1e3;let n=t,i=!0,s=null;const{payload:o}=ga(e.access_token);if(o.exp&&(n=o.exp,i=n<=t),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Te(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new mn;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Te(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Bt())throw new ps("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ps(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new nf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ps("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nf("No code detected.");const{data:b,error:k}=await this._exchangeCodeForSession(e.code);if(k)throw k;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=e;if(!s||!a||!o||!u)throw new ps("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(a);let f=h+d;l&&(f=parseInt(l));const p=f-h;p*1e3<=ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const _=f-d;h-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,h):h-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,h);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const m={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(Te(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ms(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(kI(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await gs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=DI(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:s},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await ir(this.storage,this.storageKey,!0));try{return await Pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Te(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:i}=await this._useSession(async s=>{var o,a,l,u,h;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Pe(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return Bt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Te(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)throw o;return await Pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await FI(async i=>(i>0&&await $I(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await Pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gn})),(i,s)=>{const o=200*Math.pow(2,i);return s&&ma(s)&&Date.now()+o-n<ur})}catch(n){if(this._debug(t,"error",n),Te(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Bt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ms(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const i=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<da;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${da}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),ma(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new mn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Io;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new mn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Te(s)){const o={session:null,error:s};return ma(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await km(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await gs(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Bt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ur}ms, refresh threshold is ${Xa} ticks`),i<=Xa&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Sm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Bt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await ir(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await Pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await Pe(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Te(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{data:null,error:s};const{data:o,error:a}=await Pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(Te(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await Pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Te(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ga(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const h=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+TI>Date.now()))return n;const{data:i,error:s}=await Pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new gi("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(o=>o.kid===e),!n)throw new gi("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:p,error:_}=await this.getSession();if(_||!p.session)return{data:null,error:_};n=p.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=ga(n);if(KI(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:o},error:null}}const u=WI(i.alg),h=await this.fetchJwk(i.kid,t),d=await crypto.subtle.importKey("jwk",h,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,jI(`${a}.${l}`)))throw new gi("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Te(n))return{data:null,error:n};throw n}}}Ii.nextInstanceID=0;const uN=Ii;class hN extends uN{constructor(e){super(e)}}var fN=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{u(n.next(h))}catch(d){o(d)}}function l(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?s(h.value):i(h.value).then(a,l)}u((n=n.apply(r,e||[])).next())})};class dN{constructor(e,t,n){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=vI(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:uI,realtime:fI,auth:Object.assign(Object.assign({},hI),{storageKey:l}),global:cI},h=_I(n??{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=gI(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new OS(`${a}/rest/v1`,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new aS(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new oI(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return fN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:s,flowType:o,lock:a,debug:l},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hN({url:this.authUrl,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:o,lock:a,debug:l,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new GS(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const pN=(r,e,t)=>new dN(r,e,t),mN="https://dzmecnikrhsdedcagvzs.supabase.co",gN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR6bWVjbmlrcmhzZGVkY2FndnpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTQ2NzcsImV4cCI6MjA1OTEzMDY3N30.JMMQMbVTS7QHDPkFInynQ-MszbrH_mEFl4uEDP9E5pk";let Im=null;try{Im=pN(mN,gN)}catch(r){console.error("Error initializing Supabase client:",r)}const nt=Im,ff="img",yN=({onUploadSuccess:r,onUploadComplete:e})=>{const[t,n]=Y.useState("idle"),[i,s]=Y.useState(null),[o,a]=Y.useState(null),[l,u]=Y.useState(null),[h,d]=Y.useState(null),[f,p]=Y.useState(!1),[_,g]=Y.useState("Copy Link"),y=Y.useRef(null),{showToast:m}=Yt(),b=()=>{n("idle"),s(null),a(null),u(null),d(null),p(!1),g("Copy Link"),y.current&&(y.current.value="")},k=S=>{if(S&&S.type.startsWith("image/")){s(S),d(null),n("idle"),u(null);const E=URL.createObjectURL(S);a(E),P(S)}else s(null),a(null),S&&(d("Please select an image file."),m("Please select an image file.","error"))},v=S=>{var E;k(((E=S.target.files)==null?void 0:E[0])??null),S.target&&(S.target.value="")},O=S=>{var E;S.preventDefault(),S.stopPropagation(),p(!1),k(((E=S.dataTransfer.files)==null?void 0:E[0])??null)},R=S=>{S.preventDefault(),S.stopPropagation(),p(!0)},x=S=>{S.preventDefault(),S.stopPropagation(),S.currentTarget.contains(S.relatedTarget)||p(!1)},w=()=>{var S;(S=y.current)==null||S.click()},P=async S=>{if(!nt){d("Supabase client is not initialized."),n("error"),m("Supabase client not initialized.","error"),e==null||e();return}if(!S){d("No file selected for upload."),n("error"),e==null||e();return}n("uploading"),d(null),g("Copy Link");const j=`public/${Date.now()}_${S.name}`;try{const{error:V}=await nt.storage.from(ff).upload(j,S,{cacheControl:"3600",upsert:!1});if(V)throw V;const{data:z}=nt.storage.from(ff).getPublicUrl(j);if(!z||!z.publicUrl)throw new Error("Failed to retrieve public URL after upload.");const H=z.publicUrl;u(H),n("success"),m("Image uploaded successfully!","success"),r==null||r(H)}catch(V){console.error("Upload process failed:",V);const z=`Upload failed: ${V instanceof Error?V.message:"Unknown error"}`;d(z),n("error"),m(z,"error")}finally{e==null||e()}};return{status:t,selectedFile:i,previewUrl:o,uploadedUrl:l,error:h,isDragging:f,copyButtonText:_,fileInputRef:y,handleInputChange:v,handleDrop:O,handleDragOver:R,handleDragLeave:x,triggerFileInput:w,handleCopyLink:async()=>{if(l)try{await navigator.clipboard.writeText(l),g("Copied!"),setTimeout(()=>g("Copy Link"),2e3)}catch(S){console.error("Failed to copy:",S);const E="Failed to copy link to clipboard.";d(E),m(E,"error")}},resetState:b,handleUrlUpload:async S=>{if(!nt){d("Supabase client is not initialized."),n("error"),m("Supabase client not initialized.","error"),e==null||e();return}n("fetching_url"),d(null),a(null),s(null),u(null),g("Copy Link");try{if(S.startsWith("blob:"))throw new Error("Pasting blob: URLs is not supported. Please upload the original image file directly.");const E=await fetch(S);if(!E.ok)throw new Error(`Failed to fetch image: ${E.status} ${E.statusText}`);const j=E.headers.get("content-type");if(!j||!j.startsWith("image/"))throw new Error("URL does not point to a valid image file.");const V=await E.blob();let z="uploaded_image";try{const L=new URL(S).pathname.split("/");L.length>0&&L[L.length-1]&&(z=L[L.length-1])}catch{console.warn("Could not parse filename from URL, using default.")}const H=j.split("/")[1];H&&!z.includes(".")?z=`${z}.${H}`:z.includes(".")||(z=`${z}.png`);const ee=new File([V],z,{type:j}),G=URL.createObjectURL(ee);a(G),await P(ee)}catch(E){console.error("URL Upload process failed:",E);let j=`URL Upload failed: ${E instanceof Error?E.message:"Unknown error"}`;E instanceof TypeError&&E.message.includes("Failed to fetch")&&(j+=". This might be due to network issues or CORS restrictions on the image server."),d(j),n("error"),m(j,"error"),e==null||e()}}}},si="img",vN=({onFileSelect:r})=>{const[e,t]=Y.useState([]),[n,i]=Y.useState(!0),[s,o]=Y.useState(null),[a,l]=Y.useState(null),[u,h]=Y.useState(null),[d,f]=Y.useState(""),[p,_]=Y.useState(null),[g,y]=Y.useState([]),{showToast:m,requestConfirmation:b}=Yt(),k=Y.useCallback(E=>{if(!nt)return null;const{data:j}=nt.storage.from(si).getPublicUrl(E);return(j==null?void 0:j.publicUrl)??null},[]),v=Y.useCallback(async()=>{if(i(!0),o(null),!nt){o("Supabase client not initialized."),i(!1);return}try{const{data:E,error:j}=await nt.storage.from(si).list("public",{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(j)throw j;if(E){const V=E.filter(z=>z.name!==".emptyFolderPlaceholder");t(V)}}catch(E){console.error("Error fetching file history:",E);const j=`Failed to load history: ${E instanceof Error?E.message:"Unknown error"}`;o(j),m(j,"error")}finally{i(!1)}},[m]);Y.useEffect(()=>{v()},[v]);const O=(E,j)=>{y(V=>j?V.includes(E)?V:[...V,E]:V.filter(z=>z!==E))},R=()=>{if(!r||g.length===0)return;let E=[],j=[];g.forEach(V=>{const z=k(V);z?(r(z),E.push(z)):(j.push(V),console.error("Could not get public URL for selected file:",V))}),j.length>0&&m(`Failed to get URLs for: ${j.map(V=>V.split("/").pop()).join(", ")}`,"error"),E.length>0&&(m(`${E.length} URL(s) selected successfully.`,"success"),y([]))},x=Y.useCallback(async E=>{if(!nt){m("Supabase client not initialized.","error");return}const V=`Are you sure you want to delete ${E.split("/").pop()||"this file"}? This cannot be undone.`;b({message:V,confirmText:"Confirm Delete",onConfirm:async()=>{if(!nt){m("Supabase client not initialized.","error");return}try{const{error:z}=await nt.storage.from(si).remove([E]);if(z)throw z;m("File deleted successfully.","success"),v(),y(H=>H.filter(ee=>ee!==E))}catch(z){console.error("Error deleting file:",z),m(`Failed to delete file: ${z instanceof Error?z.message:"Unknown error"}`,"error")}}})},[nt,m,b,v]),w=Y.useCallback(async()=>{if(!nt||g.length===0)return;const E=g.map(V=>V.split("/").pop()||"unknown file"),j=`Are you sure you want to delete ${g.length} selected file(s)?

- ${E.join(`
- `)}

This cannot be undone.`;b({message:j,confirmText:"Confirm Delete",onConfirm:async()=>{if(!nt){m("Supabase client not initialized.","error");return}try{const{data:V,error:z}=await nt.storage.from(si).remove(g);if(z)throw z;console.log("Successfully deleted files:",V),m(`${g.length} file(s) deleted successfully.`,"success"),y([]),v()}catch(V){console.error("Error deleting selected files:",V),m(`Failed to delete selected files: ${V instanceof Error?V.message:"Unknown error"}`,"error")}}})},[nt,g,m,b,v]),P=Y.useCallback(async E=>{const j=k(E),V=E;if(!j){l({fileId:V,message:"Error!"}),setTimeout(()=>l(null),2e3),m("Could not get public URL.","error");return}try{await navigator.clipboard.writeText(j),l({fileId:V,message:"Copied!"}),setTimeout(()=>l(null),2e3)}catch(z){console.error("Failed to copy history link:",z),l({fileId:V,message:"Failed!"}),setTimeout(()=>l(null),2e3),m("Failed to copy link.","error")}},[k,m]),T=(E,j)=>{h(E);const V=j.substring(0,j.lastIndexOf("."));f(V),_(null)},A=()=>{h(null),f(""),_(null)},S=Y.useCallback(async E=>{if(!nt){_("Supabase client not initialized."),m("Supabase client not initialized.","error");return}const j=E.split("/").pop();if(!j){_("Invalid old file path.");return}const V=d.trim();if(!V||V===j.substring(0,j.lastIndexOf("."))){_("Please enter a valid new name.");return}if(V.includes("/")){_("Filename cannot contain slashes.");return}const z=j.includes(".")?j.substring(j.lastIndexOf(".")):"",H=V+z,ee=`public/${H}`;if(ee===E){_("New name is the same as the old name.");return}_(null);try{const{error:G}=await nt.storage.from(si).move(E,ee);if(G)throw G.message.includes("already exists")?new Error(`A file named '${H}' already exists.`):G;m("File renamed successfully!","success"),A(),v(),y(q=>q.map(L=>L===E?ee:L))}catch(G){console.error("Error renaming file:",G);const q=`Rename failed: ${G instanceof Error?G.message:"Unknown error"}`;_(q),m(q,"error")}},[nt,d,v,m]);return{fileHistory:e,historyLoading:n,historyError:s,historyCopyStatus:a,editingFileId:u,newName:d,renameError:p,selectedHistoryFiles:g,fetchHistory:v,handleHistorySelectionChange:O,handleUseSelected:R,handleDeleteFile:x,handleDeleteSelected:w,handleCopyHistoryLink:P,handleEditClick:T,handleCancelEdit:A,handleSaveRename:S,setNewName:f,getPublicUrl:k}},_N=({isDragging:r,error:e,previewUrl:t,fileInputRef:n,handleDrop:i,handleDragOver:s,handleDragLeave:o,triggerFileInput:a,handleInputChange:l,handleUrlUpload:u})=>{const[h,d]=Y.useState(""),f=()=>{h.trim()&&(u(h.trim()),d(""))};return N.jsxs("div",{className:`w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center transition-all duration-300 ${r?"border-blue-500 border-2":"border-gray-200 border"}`,onDrop:i,onDragOver:s,onDragLeave:o,children:[N.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-2",children:"Upload your image"}),N.jsx("p",{className:"text-xs text-gray-500 mb-6",children:"File should be Jpeg, Png,..."}),N.jsx("div",{className:`relative bg-gray-50 border-2 border-dashed rounded-xl p-4 mb-6 transition-colors duration-300 min-h-[150px] flex flex-col items-center justify-center ${e?"border-red-500":r?"border-blue-400":"border-gray-300"} ${r?"bg-blue-50":""}`,children:t?N.jsx("img",{src:t,alt:"Image preview",className:"max-h-36 max-w-full object-contain rounded"}):N.jsxs(N.Fragment,{children:[N.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:N.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),N.jsx("p",{className:"text-sm text-gray-500",children:"Drag & Drop your image here"})]})}),N.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Or"}),N.jsx("button",{onClick:a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300",children:"Choose a file"}),N.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:l,className:"hidden","aria-label":"File input"}),e&&N.jsx("p",{className:"text-red-500 text-sm mt-4",children:e}),N.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[N.jsx("p",{className:"text-sm text-gray-500 mb-3 text-center",children:"Or paste image URL"}),N.jsxs("div",{className:"flex items-center space-x-2",children:[N.jsx("input",{type:"text",value:h,onChange:p=>d(p.target.value),placeholder:"https://example.com/image.png",className:`flex-grow px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:border-transparent text-sm ${e?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-blue-500"}`,"aria-label":"Image URL input"}),N.jsx("button",{onClick:f,disabled:!h.trim(),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-300 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Upload URL"})]})]})]})},bN=({status:r,previewUrl:e,uploadedUrl:t,error:n,copyButtonText:i,handleCopyLink:s,resetState:o})=>{const a=h=>N.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center relative",children:[e&&N.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-200 opacity-50",children:N.jsx("img",{src:e,alt:"Processing preview",className:"max-w-full max-h-48 object-contain mx-auto"})}),N.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-75 rounded-xl ${e?"":"relative"}`,children:[N.jsxs("svg",{className:"animate-spin mx-auto h-10 w-10 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[N.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),N.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N.jsx("h2",{className:"text-lg font-medium text-gray-700",children:h})]})]}),l=()=>N.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[N.jsx("svg",{className:"mx-auto h-10 w-10 text-green-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),N.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-4",children:"Uploaded Successfully!"}),e&&N.jsx("div",{className:"mb-6 rounded-xl overflow-hidden border border-gray-200",children:N.jsx("img",{src:e,alt:"Uploaded preview",className:"max-w-full max-h-64 object-contain mx-auto"})}),N.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg p-2 bg-gray-50 mb-4",children:[N.jsx("input",{type:"text",value:t??"",readOnly:!0,className:"flex-grow text-xs text-gray-700 bg-transparent border-none focus:ring-0 p-1 truncate","aria-label":"Uploaded image link"}),N.jsx("button",{onClick:s,className:"ml-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors duration-300 flex-shrink-0",children:i})]}),N.jsx("button",{onClick:o,className:"text-sm text-blue-600 hover:underline",children:"Upload another image"})]}),u=()=>N.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[N.jsx("svg",{className:"mx-auto h-10 w-10 text-red-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),N.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-2",children:"Upload Failed"}),N.jsx("p",{className:"text-red-500 text-sm mb-6",children:n||"An unknown error occurred."}),e&&N.jsx("div",{className:"mb-4 rounded-xl overflow-hidden border border-gray-200 opacity-70",children:N.jsx("img",{src:e,alt:"Upload failed preview",className:"max-w-full max-h-48 object-contain mx-auto"})}),N.jsx("button",{onClick:o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300",children:"Try Again"})]});switch(r){case"fetching_url":return a("Fetching image from URL...");case"uploading":return a("Uploading...");case"success":return l();case"error":return u();default:return null}},wN=(r,e=2)=>{if(r===0)return"0 Bytes";const t=1024,n=e<0?0:e,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(r)/Math.log(t));return parseFloat((r/Math.pow(t,s)).toFixed(n))+" "+i[s]},xN=({fileHistory:r,historyLoading:e,historyError:t,selectedHistoryFiles:n,editingFileId:i,newName:s,renameError:o,historyCopyStatus:a,getPublicUrl:l,handleHistorySelectionChange:u,handleUseSelected:h,handleDeleteSelected:d,handleCopyHistoryLink:f,handleEditClick:p,handleCancelEdit:_,handleSaveRename:g,handleDeleteFile:y,setNewName:m})=>{if(e)return N.jsx("div",{className:"text-center p-4",children:"Loading history..."});if(t)return N.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error loading history: ",t]});const b=k=>`public/${k.name}`;return N.jsxs("div",{className:"mt-8 border-t pt-6",children:[N.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Image History"}),n.length>0&&N.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded-md flex items-center justify-between",children:[N.jsxs("span",{className:"text-sm text-gray-700",children:[n.length," file(s) selected"]}),N.jsxs("div",{children:[N.jsx("button",{onClick:h,className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors mr-2",title:"Use selected image URL(s)",children:"Use Selected"}),N.jsx("button",{onClick:d,className:"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors",title:"Delete selected files",children:"Delete Selected"})]})]}),r.length===0?N.jsx("p",{className:"text-gray-500 text-sm text-center",children:"No images uploaded yet."}):N.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 max-h-[500px] overflow-y-auto p-1",children:[r.map(k=>{var P;const v=b(k),O=l(v),R=n.includes(v),x=i===v,w=(a==null?void 0:a.fileId)===v?a.message:"Copy Link";return N.jsxs("div",{className:`relative group bg-white rounded-lg shadow-sm border transition-colors flex flex-col overflow-hidden ${R?"border-blue-500 ring-2 ring-blue-300":"border-gray-200 hover:border-gray-300"}`,children:[N.jsx("input",{type:"checkbox",checked:R,onChange:T=>u(v,T.target.checked),className:"absolute top-2 left-2 z-10 form-checkbox h-4 w-4 text-blue-600 bg-white border-gray-400 rounded focus:ring-blue-500 focus:ring-offset-0 checked:border-transparent","aria-label":`Select ${k.name}`,onClick:T=>T.stopPropagation()}),N.jsx("div",{className:"relative w-full aspect-square bg-gray-100 flex items-center justify-center overflow-hidden",children:O?N.jsx("img",{src:O,alt:k.name,className:"absolute inset-0 h-full w-full object-cover transition-transform group-hover:scale-105"}):N.jsx("div",{className:"h-full w-full bg-gray-200 flex items-center justify-center text-gray-400",children:N.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),N.jsx("div",{className:"p-2 flex flex-col flex-grow",children:x?N.jsxs("div",{className:"flex flex-col space-y-1 flex-grow",children:[N.jsx("input",{type:"text",value:s,onChange:T=>m(T.target.value),className:"text-xs p-1 border border-gray-300 rounded w-full focus:ring-1 focus:ring-blue-500 focus:border-blue-500","aria-label":"New file name",onClick:T=>T.stopPropagation()}),o&&N.jsx("p",{className:"text-red-500 text-xs mt-1",children:o}),N.jsxs("div",{className:"flex justify-end space-x-1 mt-auto pt-1",children:[N.jsx("button",{onClick:T=>{T.stopPropagation(),g(v)},className:"text-xs text-green-600 hover:text-green-800 p-0.5",title:"Save",children:""}),N.jsx("button",{onClick:T=>{T.stopPropagation(),_()},className:"text-xs text-red-600 hover:text-red-800 p-0.5",title:"Cancel",children:""})]})]}):N.jsxs(N.Fragment,{children:[N.jsx("p",{className:"text-xs font-medium text-gray-700 truncate mb-0.5",title:k.name,children:k.name}),N.jsxs("p",{className:"text-xxs text-gray-500 mb-1",children:[" ",wN(((P=k.metadata)==null?void 0:P.size)??0)," - ",k.created_at?new Date(k.created_at).toLocaleDateString():"Invalid Date"]}),N.jsxs("div",{className:"mt-auto pt-1 flex items-center justify-between space-x-1",children:[N.jsxs("button",{onClick:T=>{T.stopPropagation(),f(v)},className:`text-xxs px-1.5 py-0.5 rounded transition-colors flex-grow text-center ${w==="Copied!"?"bg-green-100 text-green-700":w==="Failed!"||w==="Error!"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:w!=="Copy Link",title:"Copy image URL",children:[w==="Copy Link"?"Copy":w," "]}),N.jsx("button",{onClick:T=>{T.stopPropagation(),p(v,k.name)},className:"text-gray-500 hover:text-gray-700 p-0.5",title:"Rename file",children:N.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),N.jsx("button",{onClick:T=>{T.stopPropagation(),y(v)},className:"text-red-500 hover:text-red-700 p-0.5",title:"Delete file",children:N.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})]},v)})," "]})]})},EN=({onUploadSuccess:r})=>{const e=vN({onFileSelect:r}),t=yN({onUploadSuccess:n=>{r==null||r(n),e.fetchHistory()}});return N.jsxs("div",{className:"space-y-6",children:[t.status==="idle"?N.jsx(_N,{isDragging:t.isDragging,error:t.error,previewUrl:t.previewUrl,fileInputRef:t.fileInputRef,handleDrop:t.handleDrop,handleDragOver:t.handleDragOver,handleDragLeave:t.handleDragLeave,triggerFileInput:t.triggerFileInput,handleInputChange:t.handleInputChange,handleUrlUpload:t.handleUrlUpload}):N.jsx(bN,{status:t.status,previewUrl:t.previewUrl,uploadedUrl:t.uploadedUrl,error:t.error,copyButtonText:t.copyButtonText,handleCopyLink:t.handleCopyLink,resetState:t.resetState}),N.jsx(xN,{fileHistory:e.fileHistory,historyLoading:e.historyLoading,historyError:e.historyError,selectedHistoryFiles:e.selectedHistoryFiles,editingFileId:e.editingFileId,newName:e.newName,renameError:e.renameError,historyCopyStatus:e.historyCopyStatus,getPublicUrl:e.getPublicUrl,handleHistorySelectionChange:e.handleHistorySelectionChange,handleUseSelected:e.handleUseSelected,handleDeleteSelected:e.handleDeleteSelected,handleCopyHistoryLink:e.handleCopyHistoryLink,handleEditClick:e.handleEditClick,handleCancelEdit:e.handleCancelEdit,handleSaveRename:e.handleSaveRename,handleDeleteFile:e.handleDeleteFile,setNewName:e.setNewName})]})},Ts=(r,e,t,n,i,s,o)=>e.length===1&&e[0]==="projects"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?N.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[N.jsxs("div",{className:"flex justify-between items-center mb-3",children:[N.jsx("h4",{className:"text-lg font-semibold capitalize",children:String(e[0]).replace(/([A-Z])/g," $1")}),s]}),Object.entries(r).map(([a,l])=>{if(a!=="title"&&typeof l=="object"&&l!==null&&!Array.isArray(l)){const u=[...e,a];return N.jsxs("div",{className:"mb-6 p-4 bg-white border border-gray-200 rounded-lg shadow-sm relative",children:[N.jsxs("div",{className:"flex justify-between items-start mb-3",children:[" ",N.jsxs("h5",{className:"text-lg font-semibold text-gray-700 mr-4",children:["Project: ",N.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:a})]}),o&&N.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete project "${a}"?`)&&o(u)},className:"bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete project ${a}`,children:"Delete Project"})]}),N.jsxs("div",{className:"space-y-4",children:[" ",Ts(l,u,t,n,i,void 0,o)]})]},u.join("."))}else if(a==="title"&&typeof l=="string"){const u=[...e,a],h=u.join("."),d=n===h;return N.jsxs("div",{className:"mb-4",children:[N.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?N.jsx("input",{type:"text",id:h,name:h,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2",value:l,onChange:f=>t(u,f.target.value),onBlur:()=>i(null),autoFocus:!0}):N.jsx("div",{className:"mt-1 block w-full rounded-md border border-transparent p-2 cursor-pointer hover:bg-gray-100 min-h-[38px]",onClick:()=>i(h),children:l||N.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},h)}return null})]},e.join(".")):Object.entries(r).map(([a,l])=>{const u=[...e,a],h=u.map(String).join("."),d=n===h;return typeof l=="string"?N.jsxs("div",{className:"mb-4 px-1 sm:px-0",children:[N.jsx("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?N.jsx("textarea",{id:h,name:h,rows:l.length>100?4:2,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:l,onChange:f=>t(u,f.target.value),onBlur:()=>i(null),autoFocus:!0}):N.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[50px] whitespace-pre-wrap text-gray-800",onClick:()=>i(h),children:l||N.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},h):typeof l=="object"&&l!==null&&!Array.isArray(l)?N.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[N.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize",children:String(a).replace(/([A-Z])/g," $1")}),Ts(l,u,t,n,i,void 0,o)]},h):Array.isArray(l)?N.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-white shadow-sm",children:[N.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize text-gray-700",children:String(a).replace(/([A-Z])/g," $1")}),N.jsxs("div",{className:"space-y-3",children:[" ",l.map((f,p)=>{const _=[...u,p],g=_.map(String).join("."),y=n===g;return typeof f=="string"?N.jsxs("div",{className:"flex items-center space-x-2",children:[y?N.jsx("input",{type:"text",id:g,name:g,className:"flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:f,onChange:m=>t(_,m.target.value),onBlur:()=>i(null),autoFocus:!0}):N.jsx("div",{className:"flex-grow rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[38px] text-gray-800",onClick:()=>i(g),children:f||N.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})}),o&&N.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this item?")&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete item ${p+1}`,children:"Delete"})]},g):typeof f=="object"&&f!==null?N.jsxs("div",{className:"mb-4 p-3 border border-gray-100 rounded relative",children:[" ",N.jsxs("div",{className:"flex justify-between items-center mb-2",children:[" ",N.jsxs("h5",{className:"text-md font-medium",children:["Item ",p+1]}),o&&N.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete Item ${p+1}?`)&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-0.5 px-1.5 rounded focus:outline-none focus:shadow-outline","aria-label":`Delete item ${p+1}`,children:"Delete"})]}),Ts(f,_,t,n,i,void 0,o)]},g):null})]})," "]},h):null}),TN=r=>r===null?!1:r in Ot.en,ys={pageViews:"1,234",totalPages:"12",comments:"45",averageRating:"4.8"},AN=()=>N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[N.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-gray-700 font-semibold",children:"Page Views"}),N.jsx(o_,{className:"text-blue-500",size:20})]}),N.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.pageViews}),N.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Last 30 days"})]}),N.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-gray-700 font-semibold",children:"Total Pages"}),N.jsx(sp,{className:"text-green-500",size:20})]}),N.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.totalPages}),N.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Published content"})]}),N.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-gray-700 font-semibold",children:"Comments"}),N.jsx(S_,{className:"text-purple-500",size:20})]}),N.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.comments}),N.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Awaiting response"})]}),N.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[N.jsxs("div",{className:"flex items-center justify-between mb-4",children:[N.jsx("h3",{className:"text-gray-700 font-semibold",children:"Average Rating"}),N.jsx(V_,{className:"text-yellow-500",size:20})]}),N.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ys.averageRating}),N.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Based on feedback"})]})]}),kN=({activeTab:r,isLoading:e,translations:t,editingPath:n,setEditingPath:i,handleInputChange:s,handleAddNewProject:o,handleAddNewService:a,handleDeleteItem:l})=>{if(e)return N.jsx("div",{className:"flex items-center justify-center py-10",children:N.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});if(!r||r==="dashboard")return AN();if(r==="styleEditor")return N.jsx(aw,{});if(r==="socialLinks")return N.jsx(uw,{});if(r==="pages")return N.jsx(Zk,{});if(r==="media")return N.jsx(EN,{});if(TN(r)){const u=Vs(r);return N.jsxs(N.Fragment,{children:[N.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-700 capitalize",children:u}),r==="projects"?N.jsx(Z_,{data:t.en.projects,path:r?[r]:[],handleChange:s,handleAddProject:o,handleDelete:l}):r==="services"?N.jsx(eb,{data:t.en.services,path:r?[r]:[],handleChange:s,handleAddService:a,handleDelete:l}):r==="generalInfo"?N.jsx(hw,{translations:t,handleInputChange:s,editingPath:n,setEditingPath:i,getStaticSectionName:Vs}):Ts(t.en[r],[r],s,n,i,void 0,l)]})}return N.jsxs("p",{className:"text-red-500",children:["Error: Invalid tab '",r,"' selected."]})},SN=[{icon:N.jsx(g_,{size:20}),label:"Dashboard",tab:"dashboard"},{icon:N.jsx(sp,{size:20}),label:"Pages",tab:"pages"},{icon:N.jsx(c_,{size:20}),label:"Projects",tab:"projects"},{icon:N.jsx(Qv,{size:20}),label:"Services",tab:"services"},{icon:N.jsx(d_,{size:20}),label:"Media",tab:"media"},{icon:N.jsx(up,{size:20}),label:"Appearance",tab:"styleEditor"},{icon:N.jsx(v_,{size:20}),label:"Social Links",tab:"socialLinks"},{icon:N.jsx(L_,{size:20}),label:"Settings",tab:"generalInfo"}],IN=()=>{const r=mf(),[e,t]=Y.useState(!1),[n,i]=Y.useState(()=>{const v=localStorage.getItem("desktopSidebarCollapsed");return v?JSON.parse(v):!1}),[s,o]=Y.useState(window.innerWidth<768);Y.useEffect(()=>{const v=()=>{const O=window.innerWidth<768;o(O),O||t(!1)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]),Y.useEffect(()=>{s||localStorage.setItem("desktopSidebarCollapsed",JSON.stringify(n))},[n,s]);const{translations:a,isLoading:l,saveStatus:u,handleInputChange:h,handleAddNewProject:d,handleAddNewService:f,saveChanges:p,handleDeleteItem:_}=Y_(),[g,y]=Y.useState("dashboard"),[m,b]=Y.useState(null),k=async()=>{if(!Mt){console.error("Firebase auth instance is not available."),alert("Logout service unavailable. Please try again later.");return}try{await wg(Mt),r("/admin/login")}catch(v){console.error("Logout failed:",v),alert("Failed to log out. Please try again.")}};return N.jsx(tp,{children:N.jsxs("div",{className:"min-h-screen bg-gray-100",children:[N.jsx(J_,{isMobile:s,isSidebarOpen:e,isDesktopSidebarCollapsed:n,onToggleMobileSidebar:()=>t(!e),onToggleDesktopSidebar:()=>i(!n),onLogout:k}),N.jsxs("div",{className:"flex pt-16",children:[N.jsx(X_,{isMobile:s,isSidebarOpen:e,isDesktopSidebarCollapsed:n,activeTab:g,navItems:SN,onTabClick:v=>{y(v),s&&t(!1)},onCloseMobileSidebar:()=>t(!1)}),N.jsx("main",{className:`flex-1 transition-all duration-300 ${s?"ml-0":n?"md:ml-20":"md:ml-64"}`,children:N.jsxs("div",{className:"p-4 md:p-8",children:[N.jsxs("div",{className:"mb-4 md:mb-6",children:[N.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:g?Vs(g):"Dashboard"}),N.jsxs("p",{className:"text-sm text-gray-500",children:["Home / ",g?Vs(g):"Dashboard"]})]}),N.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:N.jsx(kN,{activeTab:g,isLoading:l,translations:a,editingPath:m,setEditingPath:b,handleInputChange:h,handleAddNewProject:d,handleAddNewService:f,handleDeleteItem:_})}),g&&g!=="styleEditor"&&g!=="socialLinks"&&g!=="pages"&&N.jsxs("div",{className:"mt-6 flex justify-end items-center gap-4",children:[u&&N.jsx("span",{className:"text-green-600 text-sm",children:u}),N.jsx("button",{onClick:()=>p(),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors",disabled:l,children:"Save Changes"})]})]})})]})]})})},NN=({page:r})=>{const e=ng();return r?N.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen text-center px-4min-h-screen text-text ltr bg-gradient-to-br from-background to-background-secondary",children:N.jsxs("div",{className:"container mx-auto px-4 py-16  backdrop-blur-sm",children:[N.jsx("h1",{className:"text-4xl bg-section font-bold container mx-auto px-4 py-16  backdrop-blur-sm text-title","text-titel":!0,children:r.title}),N.jsxs("div",{className:"p-6 prose bg-section prose-invert max-w-none text-text",children:[" ",N.jsx("div",{className:"ql-snow",children:N.jsx("div",{className:"ql-editor",dangerouslySetInnerHTML:{__html:r.content}})})]}),N.jsx("div",{className:"mt-12 text-center",children:N.jsx(vi,{to:"/",className:"text-secondary hover:text-primary underline",children:" Back to Home"})})]})}):N.jsxs("div",{className:"container mx-auto px-4 py-16 text-center text-text  min-h-screen flex flex-col items-center justify-center",children:[N.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Page Not Found"}),N.jsxs("p",{className:"text-xl",children:["The page you requested (",e.pathname,") could not be found."]}),N.jsx(vi,{to:"/",className:"mt-6 inline-block  hover:bg-secondary text-text font-bold py-2 px-4 ",children:"Go Home"})]})},PN=(r=Ot)=>{const e=r.en,t=e==null?void 0:e.projects,n=t?Object.entries(t).filter(([i,s])=>i!=="title"&&typeof s=="object"&&s!==null).map(([i,s])=>({title:(s==null?void 0:s.title)??`Project ${i}`,description:(s==null?void 0:s.description)??"Description missing.",tags:(s==null?void 0:s.tags)??[],link:(s==null?void 0:s.link)??""})):[];return{title:(t==null?void 0:t.title)??"Featured Projects",projects:n}},ON="/logo.png",CN=({logoUrl:r,altText:e="Site Logo",className:t=""})=>{const n=r||ON,i=`block mx-auto h-[25rem] w-auto mb-6 ${t}`.trim();return N.jsx("img",{src:n,alt:e,className:i})};function RN(r="en"){const[e,t]=Y.useState(Ot[r]),[n,i]=Y.useState(!0),[s,o]=Y.useState(null);return Y.useEffect(()=>{if(!de){console.error("useTranslations: Firestore instance is not available."),o(new Error("Firestore not available")),i(!1),t(Ot[r]);return}i(!0),o(null);const l=rt(de,"translations",r),u=zl(l,h=>{if(h.exists()){const d=h.data();t(()=>({...Ot[r],...d}))}else t(Ot[r]);i(!1)},h=>{console.error(`useTranslations: Firestore snapshot error for ${r}:`,h),o(h),t(Ot[r]),i(!1)});return()=>{u()}},[r]),{t:Y.useMemo(()=>e,[e]),isLoading:n,error:s}}const jN={Github:op,Facebook:ip,Mail:cp,Instagram:ap,Linkedin:lp,Twitter:hp};function LN(){const[r,e]=Y.useState([]),[t,n]=Y.useState(!0),[i,s]=Y.useState(null);return Y.useEffect(()=>{(async()=>{if(!de){console.error("useSocialLinks: Firestore instance is not available."),s(new Error("Firestore not available")),n(!1);return}n(!0),s(null);try{const a=_r(de,"socialLinks"),l=uo(a,ho("order","asc")),h=(await Mi(l)).docs.map(d=>({id:d.id,...d.data()}));e(h)}catch(a){console.error("useSocialLinks: Error fetching social links:",a),s(a instanceof Error?a:new Error(String(a)))}finally{n(!1)}})()},[]),{socialLinks:r,iconComponents:jN,isLoading:t,error:i}}const DN=Y.lazy(()=>cn(()=>import("./ServicesSection-DVpx7NKb.js"),__vite__mapDeps([2,1,3]))),MN=Y.lazy(()=>cn(()=>import("./ProjectsSection-BK8Qby6q.js"),__vite__mapDeps([4,1,3]))),VN=Y.lazy(()=>cn(()=>import("./ContactSection-uIu3QQCT.js"),__vite__mapDeps([5,1,3]))),$N=({dynamicPages:r})=>{const{t:e,isLoading:t,error:n}=RN("en"),[i,s]=Y.useState(!1),{socialLinks:o,iconComponents:a,isLoading:l,error:u}=LN();Y.useEffect(()=>{n&&console.error("MainSite: Error loading translations:",n)},[n]),Y.useEffect(()=>{u&&console.error("MainSite: Error loading social links:",u)},[u]),Y.useEffect(()=>{const f=p=>{p.ctrlKey&&p.altKey&&p.key==="a"&&(p.preventDefault(),s(_=>!_))};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[]);const h=Y.useMemo(()=>PN({en:e}),[e]),d=N.jsx("div",{className:"flex items-center justify-center p-8",children:N.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});return t?N.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:N.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):N.jsxs("div",{className:"min-h-screen text-text ltr bg-gradient-to-br from-background to-background-secondary",children:[N.jsxs("nav",{className:" mb-4 flex justify-center flex-wrap gap-x-4 gap-y-2",children:[N.jsx("a",{className:"text-secondary hover:text-primary transition-colors text-sm",href:"#projects",children:"Featured Projects"}),N.jsx("a",{className:"text-secondary hover:text-primary transition-colors text-sm",href:"#about",children:"About Me"}),N.jsx("a",{className:"text-secondary hover:text-primary transition-colors text-sm",href:"#services",children:"Services"}),N.jsx("a",{className:"text-secondary hover:text-primary transition-colors text-sm",href:"#contact",children:"Contact Me"})]}),N.jsx("header",{className:"container mx-auto px-4 py-16 md:py-0",children:N.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[N.jsx(CN,{logoUrl:e.generalInfo.logoUrl}),N.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6 text-primary pointer-events-none select-none",children:e.generalInfo.siteTitle}),N.jsx("p",{className:"text-xl md:text-2xl text-secondary mb-8",children:e.generalInfo.siteRole}),N.jsx("div",{className:"flex justify-center space-x-6",children:l?N.jsx("div",{className:"text-secondary",children:"Loading links..."}):o.map(f=>{const p=a[f.icon];return p?N.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer","aria-label":f.name,className:"text-primary hover:text-text transition-colors transform hover:scale-110",children:N.jsx(p,{size:24})},f.id):null})})]})}),N.jsx(Y.Suspense,{fallback:d,children:N.jsx(MN,{title:h.title,projects:h.projects})}),r&&r.length>0&&N.jsx("div",{className:"mb-4 flex justify-center flex-wrap gap-x-4 gap-y-2 mt-4",children:r.map(f=>N.jsx(vi,{to:`/${f.slug}`,className:"text-secondary hover:text-primary transition-colors text-sm",children:f.title},f.id))}),N.jsx("section",{id:"about",className:"container mx-auto px-4 py-16 bg-gray-800/50 backdrop-blur-sm",children:N.jsxs("div",{className:"max-w-3xl mx-auto",children:[N.jsx("h2",{className:"text-3xl font-bold text-center mb-8 text-title",children:e.about.title}),N.jsx("p",{className:"text-lg leading-relaxed text-text",children:e.about.description})]})}),N.jsx(Y.Suspense,{fallback:d,children:N.jsx(DN,{title:e.services.title,services:e.services.list})}),N.jsx(Y.Suspense,{fallback:d,children:N.jsx(VN,{t:e.contact})}),N.jsxs("footer",{className:"container mx-auto px-4 py-8 text-center relative",children:[N.jsx("p",{className:"text-secondary mb-4",children:e.generalInfo.footerText}),N.jsx(vi,{to:"/admin/dashboard",className:`absolute bottom-2 left-1/2 -translate-x-1/2 text-sm text-primary hover:text-text underline transition-opacity duration-300 ${i?"opacity-100":"opacity-0 pointer-events-none"}`,children:"Admin Dashboard"})]})]})},FN=()=>N.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center px-4min-h-screen text-text ltr bg-gradient-to-br from-background to-background-secondary",children:[N.jsx("h1",{className:"text-6xl font-bold mb-4 text-primary",children:"404"}),N.jsx("h2",{className:"text-2xl font-semibold mb-6 text-primary",children:"Page Not Found"}),N.jsx("p",{className:"mb-8 max-w-md text-secondary",children:"Sorry, the page you are looking for does not exist. It might have been moved or deleted."}),N.jsx(vi,{to:"/",className:"px-6 py-2 text-secondary bg-primary hover:bg-gradient-to-br from-background to-background-secondary transition",children:"Go Back Home"})]});function qN(){jv();const{dynamicPages:r,loadingPages:e,errorPages:t}=Lv();return e?N.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:N.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):t?N.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-red-100 text-red-800 p-4 text-center",children:[N.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Application Data"}),N.jsx("p",{children:"We encountered an issue fetching necessary data. Please try refreshing the page."}),N.jsxs("p",{className:"text-sm mt-2",children:["Details: ",t.message]})]}):N.jsx(tp,{children:N.jsxs(rg,{children:[N.jsxs(ig,{children:[N.jsx(Zn,{path:"/",element:N.jsx($N,{dynamicPages:r})}),r.map(n=>N.jsx(Zn,{path:`/${n.slug}`,element:N.jsx(NN,{page:n})},n.id)),N.jsx(Zn,{path:"/admin/login",element:N.jsx(qv,{})}),N.jsx(Zn,{path:"/admin/dashboard",element:N.jsx(Vv,{children:N.jsx(IN,{})})}),N.jsx(Zn,{path:"/admin",element:N.jsx(pf,{to:"/admin/login",replace:!0})}),N.jsx(Zn,{path:"*",element:N.jsx(FN,{})})]}),N.jsx($v,{})]})})}_f(document.getElementById("root")).render(N.jsx(qN,{}));export{Ce as c,N as j,Yt as u};
//# sourceMappingURL=index-CVfug0Rk.js.map
