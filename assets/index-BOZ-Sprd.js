const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browser-CKC9vik6.js","./react-vendor-ByTr29QW.js","./ServicesSection-Csd0n1L0.js","./firebase-vendor-CAk-8R_y.js","./ProjectsSection-CPRpL5UG.js","./ContactSection-CZbPmDpJ.js"])))=>i.map(i=>d[i]);
import{r as te,a as mf,u as gf,c as Ge,g as tg,b as ng,d as rg,L as Ts,B as ig,R as sg,e as ti,N as yf}from"./react-vendor-ByTr29QW.js";import{L as og,_ as ag,C as lg,r as tc,F as ug,a as cg,g as hg,b as fg,c as dg,d as nn,e as pg,f as mg,h as Ct,S as gg,i as yg,j as vg,k as _g,l as bg,o as vf,s as wg,m as Eg}from"./firebase-vendor-CAk-8R_y.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var _f={exports:{}},Gs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xg=te,Tg=Symbol.for("react.element"),Ag=Symbol.for("react.fragment"),kg=Object.prototype.hasOwnProperty,Sg=xg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ig={key:!0,ref:!0,__self:!0,__source:!0};function bf(r,e,t){var n,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)kg.call(e,n)&&!Ig.hasOwnProperty(n)&&(i[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:Tg,type:r,key:s,ref:o,props:i,_owner:Sg.current}}Gs.Fragment=Ag;Gs.jsx=bf;Gs.jsxs=bf;_f.exports=Gs;var P=_f.exports,wf,nc=mf;wf=nc.createRoot,nc.hydrateRoot;const Og="modulepreload",Ng=function(r,e){return new URL(r,e).href},rc={},an=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(h=>{if(h=Ng(h,n),h in rc)return;rc[h]=!0;const c=h.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(!!n)for(let _=o.length-1;_>=0;_--){const y=o[_];if(y.href===h&&(!c||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${d}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":Og,c||(p.as="script"),p.crossOrigin="",p.href=h,l&&p.setAttribute("nonce",l),document.head.appendChild(p),c)return new Promise((_,y)=>{p.addEventListener("load",_),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Rg=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),ic=r=>{const e=Rg(r);return e.charAt(0).toUpperCase()+e.slice(1)},Ef=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cg={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=te.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>te.createElement("svg",{ref:l,...Cg,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Ef("lucide",i),...a},[...o.map(([h,c])=>te.createElement(h,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=(r,e)=>{const t=te.forwardRef(({className:n,...i},s)=>te.createElement(jg,{ref:s,iconNode:e,className:Ef(`lucide-${Pg(ic(r))}`,`lucide-${r}`,n),...i}));return t.displayName=ic(r),t};/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],ga=Re("arrow-down",Lg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],ya=Re("arrow-up",Dg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Vg=Re("chevron-down",Mg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],sc=Re("circle-help",$g);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Fg=Re("circle-plus",qg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Bg=Re("circle-x",Ug);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Hg=Re("copy",zg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Gg=Re("download",Kg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Qg=Re("eye",Wg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yg=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],xf=Re("facebook",Yg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],Xg=Re("file-pen",Jg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zg=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],oc=Re("file-text",Zg);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Tf=Re("github",ey);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ny=Re("image",ty);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],Af=Re("instagram",ry);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],sy=Re("layout-dashboard",iy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],ay=Re("link-2",oy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],kf=Re("linkedin",ly);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],cy=Re("log-out",uy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Sf=Re("mail",hy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],dy=Re("maximize-2",fy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const py=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],ac=Re("menu",py);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const my=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],gy=Re("message-square",my);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],vy=Re("minimize-2",yy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],If=Re("palette",_y);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],wy=Re("panels-top-left",by);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],xy=Re("refresh-cw",Ey);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Of=Re("save",Ty);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ay=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ky=Re("settings",Ay);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]],Iy=Re("sliders-vertical",Sy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],va=Re("square-pen",Oy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Py=Re("star",Ny);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],As=Re("trash-2",Ry);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],Nf=Re("twitter",Cy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],Ly=Re("type",jy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dy=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],My=Re("upload",Dy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],$y=Re("user",Vy);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Fy=Re("wand-sparkles",qy),vi={_origin:"https://api.emailjs.com"},Uy=(r,e="https://api.emailjs.com")=>{vi._userID=r,vi._origin=e},Pf=(r,e,t)=>{if(!r)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class lc{constructor(e){this.status=e.status,this.text=e.responseText}}const Rf=(r,e,t={})=>new Promise((n,i)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new lc(o);a.status===200||a.text==="OK"?n(a):i(a)}),s.addEventListener("error",({target:o})=>{i(new lc(o))}),s.open("POST",vi._origin+r,!0),Object.keys(t).forEach(o=>{s.setRequestHeader(o,t[o])}),s.send(e)}),By=(r,e,t,n)=>{const i=n||vi._userID;return Pf(i,r,e),Rf("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:i,service_id:r,template_id:e,template_params:t}),{"Content-type":"application/json"})},zy=r=>{let e;if(typeof r=="string"?e=document.querySelector(r):e=r,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},Hy=(r,e,t,n)=>{const i=n||vi._userID,s=zy(t);Pf(i,r,e);const o=new FormData(s);return o.append("lib_version","3.2.0"),o.append("service_id",r),o.append("template_id",e),o.append("user_id",i),Rf("/api/v1.0/email/send-form",o)},uc={init:Uy,send:By,sendForm:Hy};var cc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _n,Cf;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,w){function A(){}A.prototype=w.prototype,E.D=w.prototype,E.prototype=new A,E.prototype.constructor=E,E.C=function(x,T,S){for(var O=Array(arguments.length-2),D=2;D<arguments.length;D++)O[D-2]=arguments[D];return w.prototype[T].apply(x,O)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,w,A){A||(A=0);var x=Array(16);if(typeof w=="string")for(var T=0;16>T;++T)x[T]=w.charCodeAt(A++)|w.charCodeAt(A++)<<8|w.charCodeAt(A++)<<16|w.charCodeAt(A++)<<24;else for(T=0;16>T;++T)x[T]=w[A++]|w[A++]<<8|w[A++]<<16|w[A++]<<24;w=E.g[0],A=E.g[1],T=E.g[2];var S=E.g[3],O=w+(S^A&(T^S))+x[0]+3614090360&4294967295;w=A+(O<<7&4294967295|O>>>25),O=S+(T^w&(A^T))+x[1]+3905402710&4294967295,S=w+(O<<12&4294967295|O>>>20),O=T+(A^S&(w^A))+x[2]+606105819&4294967295,T=S+(O<<17&4294967295|O>>>15),O=A+(w^T&(S^w))+x[3]+3250441966&4294967295,A=T+(O<<22&4294967295|O>>>10),O=w+(S^A&(T^S))+x[4]+4118548399&4294967295,w=A+(O<<7&4294967295|O>>>25),O=S+(T^w&(A^T))+x[5]+1200080426&4294967295,S=w+(O<<12&4294967295|O>>>20),O=T+(A^S&(w^A))+x[6]+2821735955&4294967295,T=S+(O<<17&4294967295|O>>>15),O=A+(w^T&(S^w))+x[7]+4249261313&4294967295,A=T+(O<<22&4294967295|O>>>10),O=w+(S^A&(T^S))+x[8]+1770035416&4294967295,w=A+(O<<7&4294967295|O>>>25),O=S+(T^w&(A^T))+x[9]+2336552879&4294967295,S=w+(O<<12&4294967295|O>>>20),O=T+(A^S&(w^A))+x[10]+4294925233&4294967295,T=S+(O<<17&4294967295|O>>>15),O=A+(w^T&(S^w))+x[11]+2304563134&4294967295,A=T+(O<<22&4294967295|O>>>10),O=w+(S^A&(T^S))+x[12]+1804603682&4294967295,w=A+(O<<7&4294967295|O>>>25),O=S+(T^w&(A^T))+x[13]+4254626195&4294967295,S=w+(O<<12&4294967295|O>>>20),O=T+(A^S&(w^A))+x[14]+2792965006&4294967295,T=S+(O<<17&4294967295|O>>>15),O=A+(w^T&(S^w))+x[15]+1236535329&4294967295,A=T+(O<<22&4294967295|O>>>10),O=w+(T^S&(A^T))+x[1]+4129170786&4294967295,w=A+(O<<5&4294967295|O>>>27),O=S+(A^T&(w^A))+x[6]+3225465664&4294967295,S=w+(O<<9&4294967295|O>>>23),O=T+(w^A&(S^w))+x[11]+643717713&4294967295,T=S+(O<<14&4294967295|O>>>18),O=A+(S^w&(T^S))+x[0]+3921069994&4294967295,A=T+(O<<20&4294967295|O>>>12),O=w+(T^S&(A^T))+x[5]+3593408605&4294967295,w=A+(O<<5&4294967295|O>>>27),O=S+(A^T&(w^A))+x[10]+38016083&4294967295,S=w+(O<<9&4294967295|O>>>23),O=T+(w^A&(S^w))+x[15]+3634488961&4294967295,T=S+(O<<14&4294967295|O>>>18),O=A+(S^w&(T^S))+x[4]+3889429448&4294967295,A=T+(O<<20&4294967295|O>>>12),O=w+(T^S&(A^T))+x[9]+568446438&4294967295,w=A+(O<<5&4294967295|O>>>27),O=S+(A^T&(w^A))+x[14]+3275163606&4294967295,S=w+(O<<9&4294967295|O>>>23),O=T+(w^A&(S^w))+x[3]+4107603335&4294967295,T=S+(O<<14&4294967295|O>>>18),O=A+(S^w&(T^S))+x[8]+1163531501&4294967295,A=T+(O<<20&4294967295|O>>>12),O=w+(T^S&(A^T))+x[13]+2850285829&4294967295,w=A+(O<<5&4294967295|O>>>27),O=S+(A^T&(w^A))+x[2]+4243563512&4294967295,S=w+(O<<9&4294967295|O>>>23),O=T+(w^A&(S^w))+x[7]+1735328473&4294967295,T=S+(O<<14&4294967295|O>>>18),O=A+(S^w&(T^S))+x[12]+2368359562&4294967295,A=T+(O<<20&4294967295|O>>>12),O=w+(A^T^S)+x[5]+4294588738&4294967295,w=A+(O<<4&4294967295|O>>>28),O=S+(w^A^T)+x[8]+2272392833&4294967295,S=w+(O<<11&4294967295|O>>>21),O=T+(S^w^A)+x[11]+1839030562&4294967295,T=S+(O<<16&4294967295|O>>>16),O=A+(T^S^w)+x[14]+4259657740&4294967295,A=T+(O<<23&4294967295|O>>>9),O=w+(A^T^S)+x[1]+2763975236&4294967295,w=A+(O<<4&4294967295|O>>>28),O=S+(w^A^T)+x[4]+1272893353&4294967295,S=w+(O<<11&4294967295|O>>>21),O=T+(S^w^A)+x[7]+4139469664&4294967295,T=S+(O<<16&4294967295|O>>>16),O=A+(T^S^w)+x[10]+3200236656&4294967295,A=T+(O<<23&4294967295|O>>>9),O=w+(A^T^S)+x[13]+681279174&4294967295,w=A+(O<<4&4294967295|O>>>28),O=S+(w^A^T)+x[0]+3936430074&4294967295,S=w+(O<<11&4294967295|O>>>21),O=T+(S^w^A)+x[3]+3572445317&4294967295,T=S+(O<<16&4294967295|O>>>16),O=A+(T^S^w)+x[6]+76029189&4294967295,A=T+(O<<23&4294967295|O>>>9),O=w+(A^T^S)+x[9]+3654602809&4294967295,w=A+(O<<4&4294967295|O>>>28),O=S+(w^A^T)+x[12]+3873151461&4294967295,S=w+(O<<11&4294967295|O>>>21),O=T+(S^w^A)+x[15]+530742520&4294967295,T=S+(O<<16&4294967295|O>>>16),O=A+(T^S^w)+x[2]+3299628645&4294967295,A=T+(O<<23&4294967295|O>>>9),O=w+(T^(A|~S))+x[0]+4096336452&4294967295,w=A+(O<<6&4294967295|O>>>26),O=S+(A^(w|~T))+x[7]+1126891415&4294967295,S=w+(O<<10&4294967295|O>>>22),O=T+(w^(S|~A))+x[14]+2878612391&4294967295,T=S+(O<<15&4294967295|O>>>17),O=A+(S^(T|~w))+x[5]+4237533241&4294967295,A=T+(O<<21&4294967295|O>>>11),O=w+(T^(A|~S))+x[12]+1700485571&4294967295,w=A+(O<<6&4294967295|O>>>26),O=S+(A^(w|~T))+x[3]+2399980690&4294967295,S=w+(O<<10&4294967295|O>>>22),O=T+(w^(S|~A))+x[10]+4293915773&4294967295,T=S+(O<<15&4294967295|O>>>17),O=A+(S^(T|~w))+x[1]+2240044497&4294967295,A=T+(O<<21&4294967295|O>>>11),O=w+(T^(A|~S))+x[8]+1873313359&4294967295,w=A+(O<<6&4294967295|O>>>26),O=S+(A^(w|~T))+x[15]+4264355552&4294967295,S=w+(O<<10&4294967295|O>>>22),O=T+(w^(S|~A))+x[6]+2734768916&4294967295,T=S+(O<<15&4294967295|O>>>17),O=A+(S^(T|~w))+x[13]+1309151649&4294967295,A=T+(O<<21&4294967295|O>>>11),O=w+(T^(A|~S))+x[4]+4149444226&4294967295,w=A+(O<<6&4294967295|O>>>26),O=S+(A^(w|~T))+x[11]+3174756917&4294967295,S=w+(O<<10&4294967295|O>>>22),O=T+(w^(S|~A))+x[2]+718787259&4294967295,T=S+(O<<15&4294967295|O>>>17),O=A+(S^(T|~w))+x[9]+3951481745&4294967295,E.g[0]=E.g[0]+w&4294967295,E.g[1]=E.g[1]+(T+(O<<21&4294967295|O>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+S&4294967295}n.prototype.u=function(E,w){w===void 0&&(w=E.length);for(var A=w-this.blockSize,x=this.B,T=this.h,S=0;S<w;){if(T==0)for(;S<=A;)i(this,E,S),S+=this.blockSize;if(typeof E=="string"){for(;S<w;)if(x[T++]=E.charCodeAt(S++),T==this.blockSize){i(this,x),T=0;break}}else for(;S<w;)if(x[T++]=E[S++],T==this.blockSize){i(this,x),T=0;break}}this.h=T,this.o+=w},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var w=1;w<E.length-8;++w)E[w]=0;var A=8*this.o;for(w=E.length-8;w<E.length;++w)E[w]=A&255,A/=256;for(this.u(E),E=Array(16),w=A=0;4>w;++w)for(var x=0;32>x;x+=8)E[A++]=this.g[w]>>>x&255;return E};function s(E,w){var A=a;return Object.prototype.hasOwnProperty.call(A,E)?A[E]:A[E]=w(E)}function o(E,w){this.h=w;for(var A=[],x=!0,T=E.length-1;0<=T;T--){var S=E[T]|0;x&&S==w||(A[T]=S,x=!1)}this.g=A}var a={};function l(E){return-128<=E&&128>E?s(E,function(w){return new o([w|0],0>w?-1:0)}):new o([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return g(h(-E));for(var w=[],A=1,x=0;E>=A;x++)w[x]=E/A|0,A*=4294967296;return new o(w,0)}function c(E,w){if(E.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(E.charAt(0)=="-")return g(c(E.substring(1),w));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=h(Math.pow(w,8)),x=d,T=0;T<E.length;T+=8){var S=Math.min(8,E.length-T),O=parseInt(E.substring(T,T+S),w);8>S?(S=h(Math.pow(w,S)),x=x.j(S).add(h(O))):(x=x.j(A),x=x.add(h(O)))}return x}var d=l(0),f=l(1),p=l(16777216);r=o.prototype,r.m=function(){if(y(this))return-g(this).m();for(var E=0,w=1,A=0;A<this.g.length;A++){var x=this.i(A);E+=(0<=x?x:4294967296+x)*w,w*=4294967296}return E},r.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(_(this))return"0";if(y(this))return"-"+g(this).toString(E);for(var w=h(Math.pow(E,6)),A=this,x="";;){var T=v(A,w).g;A=m(A,T.j(w));var S=((0<A.g.length?A.g[0]:A.h)>>>0).toString(E);if(A=T,_(A))return S+x;for(;6>S.length;)S="0"+S;x=S+x}},r.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function _(E){if(E.h!=0)return!1;for(var w=0;w<E.g.length;w++)if(E.g[w]!=0)return!1;return!0}function y(E){return E.h==-1}r.l=function(E){return E=m(this,E),y(E)?-1:_(E)?0:1};function g(E){for(var w=E.g.length,A=[],x=0;x<w;x++)A[x]=~E.g[x];return new o(A,~E.h).add(f)}r.abs=function(){return y(this)?g(this):this},r.add=function(E){for(var w=Math.max(this.g.length,E.g.length),A=[],x=0,T=0;T<=w;T++){var S=x+(this.i(T)&65535)+(E.i(T)&65535),O=(S>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);x=O>>>16,S&=65535,O&=65535,A[T]=O<<16|S}return new o(A,A[A.length-1]&-2147483648?-1:0)};function m(E,w){return E.add(g(w))}r.j=function(E){if(_(this)||_(E))return d;if(y(this))return y(E)?g(this).j(g(E)):g(g(this).j(E));if(y(E))return g(this.j(g(E)));if(0>this.l(p)&&0>E.l(p))return h(this.m()*E.m());for(var w=this.g.length+E.g.length,A=[],x=0;x<2*w;x++)A[x]=0;for(x=0;x<this.g.length;x++)for(var T=0;T<E.g.length;T++){var S=this.i(x)>>>16,O=this.i(x)&65535,D=E.i(T)>>>16,q=E.i(T)&65535;A[2*x+2*T]+=O*q,b(A,2*x+2*T),A[2*x+2*T+1]+=S*q,b(A,2*x+2*T+1),A[2*x+2*T+1]+=O*D,b(A,2*x+2*T+1),A[2*x+2*T+2]+=S*D,b(A,2*x+2*T+2)}for(x=0;x<w;x++)A[x]=A[2*x+1]<<16|A[2*x];for(x=w;x<2*w;x++)A[x]=0;return new o(A,0)};function b(E,w){for(;(E[w]&65535)!=E[w];)E[w+1]+=E[w]>>>16,E[w]&=65535,w++}function I(E,w){this.g=E,this.h=w}function v(E,w){if(_(w))throw Error("division by zero");if(_(E))return new I(d,d);if(y(E))return w=v(g(E),w),new I(g(w.g),g(w.h));if(y(w))return w=v(E,g(w)),new I(g(w.g),w.h);if(30<E.g.length){if(y(E)||y(w))throw Error("slowDivide_ only works with positive integers.");for(var A=f,x=w;0>=x.l(E);)A=N(A),x=N(x);var T=C(A,1),S=C(x,1);for(x=C(x,2),A=C(A,2);!_(x);){var O=S.add(x);0>=O.l(E)&&(T=T.add(A),S=O),x=C(x,1),A=C(A,1)}return w=m(E,T.j(w)),new I(T,w)}for(T=d;0<=E.l(w);){for(A=Math.max(1,Math.floor(E.m()/w.m())),x=Math.ceil(Math.log(A)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),S=h(A),O=S.j(w);y(O)||0<O.l(E);)A-=x,S=h(A),O=S.j(w);_(S)&&(S=f),T=T.add(S),E=m(E,O)}return new I(T,E)}r.A=function(E){return v(this,E).h},r.and=function(E){for(var w=Math.max(this.g.length,E.g.length),A=[],x=0;x<w;x++)A[x]=this.i(x)&E.i(x);return new o(A,this.h&E.h)},r.or=function(E){for(var w=Math.max(this.g.length,E.g.length),A=[],x=0;x<w;x++)A[x]=this.i(x)|E.i(x);return new o(A,this.h|E.h)},r.xor=function(E){for(var w=Math.max(this.g.length,E.g.length),A=[],x=0;x<w;x++)A[x]=this.i(x)^E.i(x);return new o(A,this.h^E.h)};function N(E){for(var w=E.g.length+1,A=[],x=0;x<w;x++)A[x]=E.i(x)<<1|E.i(x-1)>>>31;return new o(A,E.h)}function C(E,w){var A=w>>5;w%=32;for(var x=E.g.length-A,T=[],S=0;S<x;S++)T[S]=0<w?E.i(S+A)>>>w|E.i(S+A+1)<<32-w:E.i(S+A);return new o(T,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Cf=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=c,_n=o}).apply(typeof cc<"u"?cc:typeof self<"u"?self:typeof window<"u"?window:{});var ns=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jf,oi,Lf,vs,_a,Df,Mf,Vf;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,k,R){return u==Array.prototype||u==Object.prototype||(u[k]=R.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof ns=="object"&&ns];for(var k=0;k<u.length;++k){var R=u[k];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var n=t(this);function i(u,k){if(k)e:{var R=n;u=u.split(".");for(var L=0;L<u.length-1;L++){var W=u[L];if(!(W in R))break e;R=R[W]}u=u[u.length-1],L=R[u],k=k(L),k!=L&&k!=null&&e(R,u,{configurable:!0,writable:!0,value:k})}}function s(u,k){u instanceof String&&(u+="");var R=0,L=!1,W={next:function(){if(!L&&R<u.length){var ee=R++;return{value:k(ee,u[ee]),done:!1}}return L=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}i("Array.prototype.values",function(u){return u||function(){return s(this,function(k,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var k=typeof u;return k=k!="object"?k:u?Array.isArray(u)?"array":k:"null",k=="array"||k=="object"&&typeof u.length=="number"}function h(u){var k=typeof u;return k=="object"&&u!=null||k=="function"}function c(u,k,R){return u.call.apply(u.bind,arguments)}function d(u,k,R){if(!u)throw Error();if(2<arguments.length){var L=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,L),u.apply(k,W)}}return function(){return u.apply(k,arguments)}}function f(u,k,R){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:d,f.apply(null,arguments)}function p(u,k){var R=Array.prototype.slice.call(arguments,1);return function(){var L=R.slice();return L.push.apply(L,arguments),u.apply(this,L)}}function _(u,k){function R(){}R.prototype=k.prototype,u.aa=k.prototype,u.prototype=new R,u.prototype.constructor=u,u.Qb=function(L,W,ee){for(var he=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)he[Fe-2]=arguments[Fe];return k.prototype[W].apply(L,he)}}function y(u){const k=u.length;if(0<k){const R=Array(k);for(let L=0;L<k;L++)R[L]=u[L];return R}return[]}function g(u,k){for(let R=1;R<arguments.length;R++){const L=arguments[R];if(l(L)){const W=u.length||0,ee=L.length||0;u.length=W+ee;for(let he=0;he<ee;he++)u[W+he]=L[he]}else u.push(L)}}class m{constructor(k,R){this.i=k,this.j=R,this.h=0,this.g=null}get(){let k;return 0<this.h?(this.h--,k=this.g,this.g=k.next,k.next=null):k=this.i(),k}}function b(u){return/^[\s\xa0]*$/.test(u)}function I(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function v(u){return v[" "](u),u}v[" "]=function(){};var N=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function C(u,k,R){for(const L in u)k.call(R,u[L],L,u)}function E(u,k){for(const R in u)k.call(void 0,u[R],R,u)}function w(u){const k={};for(const R in u)k[R]=u[R];return k}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(u,k){let R,L;for(let W=1;W<arguments.length;W++){L=arguments[W];for(R in L)u[R]=L[R];for(let ee=0;ee<A.length;ee++)R=A[ee],Object.prototype.hasOwnProperty.call(L,R)&&(u[R]=L[R])}}function T(u){var k=1;u=u.split(":");const R=[];for(;0<k&&u.length;)R.push(u.shift()),k--;return u.length&&R.push(u.join(":")),R}function S(u){a.setTimeout(()=>{throw u},0)}function O(){var u=z;let k=null;return u.g&&(k=u.g,u.g=u.g.next,u.g||(u.h=null),k.next=null),k}class D{constructor(){this.h=this.g=null}add(k,R){const L=q.get();L.set(k,R),this.h?this.h.next=L:this.g=L,this.h=L}}var q=new m(()=>new B,u=>u.reset());class B{constructor(){this.next=this.g=this.h=null}set(k,R){this.h=k,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let K,oe=!1,z=new D,F=()=>{const u=a.Promise.resolve(void 0);K=()=>{u.then(j)}};var j=()=>{for(var u;u=O();){try{u.h.call(u.g)}catch(R){S(R)}var k=q;k.j(u),100>k.h&&(k.h++,u.next=k.g,k.g=u)}oe=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(u,k){this.type=u,this.g=this.target=k,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,k=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const R=()=>{};a.addEventListener("test",R,k),a.removeEventListener("test",R,k)}catch{}return u}();function H(u,k){if($.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var R=this.type=u.type,L=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=k,k=u.relatedTarget){if(N){e:{try{v(k.nodeName);var W=!0;break e}catch{}W=!1}W||(k=null)}}else R=="mouseover"?k=u.fromElement:R=="mouseout"&&(k=u.toElement);this.relatedTarget=k,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:M[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}_(H,$);var M={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var U="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(u,k,R,L,W){this.listener=u,this.proxy=null,this.src=k,this.type=R,this.capture=!!L,this.ha=W,this.key=++Y,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function X(u){this.src=u,this.g={},this.h=0}X.prototype.add=function(u,k,R,L,W){var ee=u.toString();u=this.g[ee],u||(u=this.g[ee]=[],this.h++);var he=pe(u,k,L,W);return-1<he?(k=u[he],R||(k.fa=!1)):(k=new Q(k,this.src,ee,!!L,W),k.fa=R,u.push(k)),k};function ue(u,k){var R=k.type;if(R in u.g){var L=u.g[R],W=Array.prototype.indexOf.call(L,k,void 0),ee;(ee=0<=W)&&Array.prototype.splice.call(L,W,1),ee&&(se(k),u.g[R].length==0&&(delete u.g[R],u.h--))}}function pe(u,k,R,L){for(var W=0;W<u.length;++W){var ee=u[W];if(!ee.da&&ee.listener==k&&ee.capture==!!R&&ee.ha==L)return W}return-1}var de="closure_lm_"+(1e6*Math.random()|0),Ae={};function We(u,k,R,L,W){if(Array.isArray(k)){for(var ee=0;ee<k.length;ee++)We(u,k[ee],R,L,W);return null}return R=be(R),u&&u[U]?u.K(k,R,h(L)?!!L.capture:!!L,W):qe(u,k,R,!1,L,W)}function qe(u,k,R,L,W,ee){if(!k)throw Error("Invalid event type");var he=h(W)?!!W.capture:!!W,Fe=ce(u);if(Fe||(u[de]=Fe=new X(u)),R=Fe.add(k,R,L,he,ee),R.proxy)return R;if(L=ne(),R.proxy=L,L.src=u,L.listener=R,u.addEventListener)G||(W=he),W===void 0&&(W=!1),u.addEventListener(k.toString(),L,W);else if(u.attachEvent)u.attachEvent(Z(k.toString()),L);else if(u.addListener&&u.removeListener)u.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return R}function ne(){function u(R){return k.call(u.src,u.listener,R)}const k=J;return u}function re(u,k,R,L,W){if(Array.isArray(k))for(var ee=0;ee<k.length;ee++)re(u,k[ee],R,L,W);else L=h(L)?!!L.capture:!!L,R=be(R),u&&u[U]?(u=u.i,k=String(k).toString(),k in u.g&&(ee=u.g[k],R=pe(ee,R,L,W),-1<R&&(se(ee[R]),Array.prototype.splice.call(ee,R,1),ee.length==0&&(delete u.g[k],u.h--)))):u&&(u=ce(u))&&(k=u.g[k.toString()],u=-1,k&&(u=pe(k,R,L,W)),(R=-1<u?k[u]:null)&&fe(R))}function fe(u){if(typeof u!="number"&&u&&!u.da){var k=u.src;if(k&&k[U])ue(k.i,u);else{var R=u.type,L=u.proxy;k.removeEventListener?k.removeEventListener(R,L,u.capture):k.detachEvent?k.detachEvent(Z(R),L):k.addListener&&k.removeListener&&k.removeListener(L),(R=ce(k))?(ue(R,u),R.h==0&&(R.src=null,k[de]=null)):se(u)}}}function Z(u){return u in Ae?Ae[u]:Ae[u]="on"+u}function J(u,k){if(u.da)u=!0;else{k=new H(k,this);var R=u.listener,L=u.ha||u.src;u.fa&&fe(u),u=R.call(L,k)}return u}function ce(u){return u=u[de],u instanceof X?u:null}var me="__closure_events_fn_"+(1e9*Math.random()>>>0);function be(u){return typeof u=="function"?u:(u[me]||(u[me]=function(k){return u.handleEvent(k)}),u[me])}function xe(){V.call(this),this.i=new X(this),this.M=this,this.F=null}_(xe,V),xe.prototype[U]=!0,xe.prototype.removeEventListener=function(u,k,R,L){re(this,u,k,R,L)};function De(u,k){var R,L=u.F;if(L)for(R=[];L;L=L.F)R.push(L);if(u=u.M,L=k.type||k,typeof k=="string")k=new $(k,u);else if(k instanceof $)k.target=k.target||u;else{var W=k;k=new $(L,u),x(k,W)}if(W=!0,R)for(var ee=R.length-1;0<=ee;ee--){var he=k.g=R[ee];W=Ce(he,L,!0,k)&&W}if(he=k.g=u,W=Ce(he,L,!0,k)&&W,W=Ce(he,L,!1,k)&&W,R)for(ee=0;ee<R.length;ee++)he=k.g=R[ee],W=Ce(he,L,!1,k)&&W}xe.prototype.N=function(){if(xe.aa.N.call(this),this.i){var u=this.i,k;for(k in u.g){for(var R=u.g[k],L=0;L<R.length;L++)se(R[L]);delete u.g[k],u.h--}}this.F=null},xe.prototype.K=function(u,k,R,L){return this.i.add(String(u),k,!1,R,L)},xe.prototype.L=function(u,k,R,L){return this.i.add(String(u),k,!0,R,L)};function Ce(u,k,R,L){if(k=u.i.g[String(k)],!k)return!0;k=k.concat();for(var W=!0,ee=0;ee<k.length;++ee){var he=k[ee];if(he&&!he.da&&he.capture==R){var Fe=he.listener,lt=he.ha||he.src;he.fa&&ue(u.i,he),W=Fe.call(lt,L)!==!1&&W}}return W&&!L.defaultPrevented}function ft(u,k,R){if(typeof u=="function")R&&(u=f(u,R));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(k)?-1:a.setTimeout(u,k||0)}function Qe(u){u.g=ft(()=>{u.g=null,u.i&&(u.i=!1,Qe(u))},u.l);const k=u.h;u.h=null,u.m.apply(null,k)}class Ut extends V{constructor(k,R){super(),this.m=k,this.l=R,this.h=null,this.i=!1,this.g=null}j(k){this.h=arguments,this.g?this.i=!0:Qe(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ur(u){V.call(this),this.h=u,this.g={}}_(Ur,V);var lu=[];function uu(u){C(u.g,function(k,R){this.g.hasOwnProperty(R)&&fe(k)},u),u.g={}}Ur.prototype.N=function(){Ur.aa.N.call(this),uu(this)},Ur.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Io=a.JSON.stringify,Nm=a.JSON.parse,Pm=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Oo(){}Oo.prototype.h=null;function cu(u){return u.h||(u.h=u.i())}function hu(){}var Br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function No(){$.call(this,"d")}_(No,$);function Po(){$.call(this,"c")}_(Po,$);var Cn={},fu=null;function Fi(){return fu=fu||new xe}Cn.La="serverreachability";function du(u){$.call(this,Cn.La,u)}_(du,$);function zr(u){const k=Fi();De(k,new du(k))}Cn.STAT_EVENT="statevent";function pu(u,k){$.call(this,Cn.STAT_EVENT,u),this.stat=k}_(pu,$);function bt(u){const k=Fi();De(k,new pu(k,u))}Cn.Ma="timingevent";function mu(u,k){$.call(this,Cn.Ma,u),this.size=k}_(mu,$);function Hr(u,k){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},k)}function Kr(){this.g=!0}Kr.prototype.xa=function(){this.g=!1};function Rm(u,k,R,L,W,ee){u.info(function(){if(u.g)if(ee)for(var he="",Fe=ee.split("&"),lt=0;lt<Fe.length;lt++){var Ve=Fe[lt].split("=");if(1<Ve.length){var dt=Ve[0];Ve=Ve[1];var pt=dt.split("_");he=2<=pt.length&&pt[1]=="type"?he+(dt+"="+Ve+"&"):he+(dt+"=redacted&")}}else he=null;else he=ee;return"XMLHTTP REQ ("+L+") [attempt "+W+"]: "+k+`
`+R+`
`+he})}function Cm(u,k,R,L,W,ee,he){u.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+W+"]: "+k+`
`+R+`
`+ee+" "+he})}function Qn(u,k,R,L){u.info(function(){return"XMLHTTP TEXT ("+k+"): "+Lm(u,R)+(L?" "+L:"")})}function jm(u,k){u.info(function(){return"TIMEOUT: "+k})}Kr.prototype.info=function(){};function Lm(u,k){if(!u.g)return k;if(!k)return null;try{var R=JSON.parse(k);if(R){for(u=0;u<R.length;u++)if(Array.isArray(R[u])){var L=R[u];if(!(2>L.length)){var W=L[1];if(Array.isArray(W)&&!(1>W.length)){var ee=W[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(var he=1;he<W.length;he++)W[he]=""}}}}return Io(R)}catch{return k}}var Ui={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ro;function Bi(){}_(Bi,Oo),Bi.prototype.g=function(){return new XMLHttpRequest},Bi.prototype.i=function(){return{}},Ro=new Bi;function hn(u,k,R,L){this.j=u,this.i=k,this.l=R,this.R=L||1,this.U=new Ur(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yu}function yu(){this.i=null,this.g="",this.h=!1}var vu={},Co={};function jo(u,k,R){u.L=1,u.v=Gi(Jt(k)),u.m=R,u.P=!0,_u(u,null)}function _u(u,k){u.F=Date.now(),zi(u),u.A=Jt(u.v);var R=u.A,L=u.R;Array.isArray(L)||(L=[String(L)]),Cu(R.i,"t",L),u.C=0,R=u.j.J,u.h=new yu,u.g=Ju(u.j,R?k:null,!u.m),0<u.O&&(u.M=new Ut(f(u.Y,u,u.g),u.O)),k=u.U,R=u.g,L=u.ca;var W="readystatechange";Array.isArray(W)||(W&&(lu[0]=W.toString()),W=lu);for(var ee=0;ee<W.length;ee++){var he=We(R,W[ee],L||k.handleEvent,!1,k.h||k);if(!he)break;k.g[he.key]=he}k=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),k["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,k)):(u.u="GET",u.g.ea(u.A,u.u,null,k)),zr(),Rm(u.i,u.u,u.A,u.l,u.R,u.m)}hn.prototype.ca=function(u){u=u.target;const k=this.M;k&&Xt(u)==3?k.j():this.Y(u)},hn.prototype.Y=function(u){try{if(u==this.g)e:{const pt=Xt(this.g);var k=this.g.Ba();const Xn=this.g.Z();if(!(3>pt)&&(pt!=3||this.g&&(this.h.h||this.g.oa()||qu(this.g)))){this.J||pt!=4||k==7||(k==8||0>=Xn?zr(3):zr(2)),Lo(this);var R=this.g.Z();this.X=R;t:if(bu(this)){var L=qu(this.g);u="";var W=L.length,ee=Xt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jn(this),Gr(this);var he="";break t}this.h.i=new a.TextDecoder}for(k=0;k<W;k++)this.h.h=!0,u+=this.h.i.decode(L[k],{stream:!(ee&&k==W-1)});L.length=0,this.h.g+=u,this.C=0,he=this.h.g}else he=this.g.oa();if(this.o=R==200,Cm(this.i,this.u,this.A,this.l,this.R,pt,R),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,lt=this.g;if((Fe=lt.g?lt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Fe)){var Ve=Fe;break t}}Ve=null}if(R=Ve)Qn(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Do(this,R);else{this.o=!1,this.s=3,bt(12),jn(this),Gr(this);break e}}if(this.P){R=!0;let Lt;for(;!this.J&&this.C<he.length;)if(Lt=Dm(this,he),Lt==Co){pt==4&&(this.s=4,bt(14),R=!1),Qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==vu){this.s=4,bt(15),Qn(this.i,this.l,he,"[Invalid Chunk]"),R=!1;break}else Qn(this.i,this.l,Lt,null),Do(this,Lt);if(bu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pt!=4||he.length!=0||this.h.h||(this.s=1,bt(16),R=!1),this.o=this.o&&R,!R)Qn(this.i,this.l,he,"[Invalid Chunked Response]"),jn(this),Gr(this);else if(0<he.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),Uo(dt),dt.M=!0,bt(11))}}else Qn(this.i,this.l,he,null),Do(this,he);pt==4&&jn(this),this.o&&!this.J&&(pt==4?Gu(this.j,this):(this.o=!1,zi(this)))}else Zm(this.g),R==400&&0<he.indexOf("Unknown SID")?(this.s=3,bt(12)):(this.s=0,bt(13)),jn(this),Gr(this)}}}catch{}finally{}};function bu(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Dm(u,k){var R=u.C,L=k.indexOf(`
`,R);return L==-1?Co:(R=Number(k.substring(R,L)),isNaN(R)?vu:(L+=1,L+R>k.length?Co:(k=k.slice(L,L+R),u.C=L+R,k)))}hn.prototype.cancel=function(){this.J=!0,jn(this)};function zi(u){u.S=Date.now()+u.I,wu(u,u.I)}function wu(u,k){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Hr(f(u.ba,u),k)}function Lo(u){u.B&&(a.clearTimeout(u.B),u.B=null)}hn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(jm(this.i,this.A),this.L!=2&&(zr(),bt(17)),jn(this),this.s=2,Gr(this)):wu(this,this.S-u)};function Gr(u){u.j.G==0||u.J||Gu(u.j,u)}function jn(u){Lo(u);var k=u.M;k&&typeof k.ma=="function"&&k.ma(),u.M=null,uu(u.U),u.g&&(k=u.g,u.g=null,k.abort(),k.ma())}function Do(u,k){try{var R=u.j;if(R.G!=0&&(R.g==u||Mo(R.h,u))){if(!u.K&&Mo(R.h,u)&&R.G==3){try{var L=R.Da.g.parse(k)}catch{L=null}if(Array.isArray(L)&&L.length==3){var W=L;if(W[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<u.F)Zi(R),Ji(R);else break e;Fo(R),bt(18)}}else R.za=W[1],0<R.za-R.T&&37500>W[2]&&R.F&&R.v==0&&!R.C&&(R.C=Hr(f(R.Za,R),6e3));if(1>=Tu(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else Dn(R,11)}else if((u.K||R.g==u)&&Zi(R),!b(k))for(W=R.Da.g.parse(k),k=0;k<W.length;k++){let Ve=W[k];if(R.T=Ve[0],Ve=Ve[1],R.G==2)if(Ve[0]=="c"){R.K=Ve[1],R.ia=Ve[2];const dt=Ve[3];dt!=null&&(R.la=dt,R.j.info("VER="+R.la));const pt=Ve[4];pt!=null&&(R.Aa=pt,R.j.info("SVER="+R.Aa));const Xn=Ve[5];Xn!=null&&typeof Xn=="number"&&0<Xn&&(L=1.5*Xn,R.L=L,R.j.info("backChannelRequestTimeoutMs_="+L)),L=R;const Lt=u.g;if(Lt){const ts=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ts){var ee=L.h;ee.g||ts.indexOf("spdy")==-1&&ts.indexOf("quic")==-1&&ts.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Vo(ee,ee.h),ee.h=null))}if(L.D){const Bo=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;Bo&&(L.ya=Bo,ze(L.I,L.D,Bo))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-u.F,R.j.info("Handshake RTT: "+R.R+"ms")),L=R;var he=u;if(L.qa=Yu(L,L.J?L.ia:null,L.W),he.K){Au(L.h,he);var Fe=he,lt=L.L;lt&&(Fe.I=lt),Fe.B&&(Lo(Fe),zi(Fe)),L.g=he}else Hu(L);0<R.i.length&&Xi(R)}else Ve[0]!="stop"&&Ve[0]!="close"||Dn(R,7);else R.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?Dn(R,7):qo(R):Ve[0]!="noop"&&R.l&&R.l.ta(Ve),R.v=0)}}zr(4)}catch{}}var Mm=class{constructor(u,k){this.g=u,this.map=k}};function Eu(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xu(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Tu(u){return u.h?1:u.g?u.g.size:0}function Mo(u,k){return u.h?u.h==k:u.g?u.g.has(k):!1}function Vo(u,k){u.g?u.g.add(k):u.h=k}function Au(u,k){u.h&&u.h==k?u.h=null:u.g&&u.g.has(k)&&u.g.delete(k)}Eu.prototype.cancel=function(){if(this.i=ku(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function ku(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let k=u.i;for(const R of u.g.values())k=k.concat(R.D);return k}return y(u.i)}function Vm(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var k=[],R=u.length,L=0;L<R;L++)k.push(u[L]);return k}k=[],R=0;for(L in u)k[R++]=u[L];return k}function $m(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var k=[];u=u.length;for(var R=0;R<u;R++)k.push(R);return k}k=[],R=0;for(const L in u)k[R++]=L;return k}}}function Su(u,k){if(u.forEach&&typeof u.forEach=="function")u.forEach(k,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,k,void 0);else for(var R=$m(u),L=Vm(u),W=L.length,ee=0;ee<W;ee++)k.call(void 0,L[ee],R&&R[ee],u)}var Iu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qm(u,k){if(u){u=u.split("&");for(var R=0;R<u.length;R++){var L=u[R].indexOf("="),W=null;if(0<=L){var ee=u[R].substring(0,L);W=u[R].substring(L+1)}else ee=u[R];k(ee,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Ln(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Ln){this.h=u.h,Hi(this,u.j),this.o=u.o,this.g=u.g,Ki(this,u.s),this.l=u.l;var k=u.i,R=new Yr;R.i=k.i,k.g&&(R.g=new Map(k.g),R.h=k.h),Ou(this,R),this.m=u.m}else u&&(k=String(u).match(Iu))?(this.h=!1,Hi(this,k[1]||"",!0),this.o=Wr(k[2]||""),this.g=Wr(k[3]||"",!0),Ki(this,k[4]),this.l=Wr(k[5]||"",!0),Ou(this,k[6]||"",!0),this.m=Wr(k[7]||"")):(this.h=!1,this.i=new Yr(null,this.h))}Ln.prototype.toString=function(){var u=[],k=this.j;k&&u.push(Qr(k,Nu,!0),":");var R=this.g;return(R||k=="file")&&(u.push("//"),(k=this.o)&&u.push(Qr(k,Nu,!0),"@"),u.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&u.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&u.push("/"),u.push(Qr(R,R.charAt(0)=="/"?Bm:Um,!0))),(R=this.i.toString())&&u.push("?",R),(R=this.m)&&u.push("#",Qr(R,Hm)),u.join("")};function Jt(u){return new Ln(u)}function Hi(u,k,R){u.j=R?Wr(k,!0):k,u.j&&(u.j=u.j.replace(/:$/,""))}function Ki(u,k){if(k){if(k=Number(k),isNaN(k)||0>k)throw Error("Bad port number "+k);u.s=k}else u.s=null}function Ou(u,k,R){k instanceof Yr?(u.i=k,Km(u.i,u.h)):(R||(k=Qr(k,zm)),u.i=new Yr(k,u.h))}function ze(u,k,R){u.i.set(k,R)}function Gi(u){return ze(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Wr(u,k){return u?k?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Qr(u,k,R){return typeof u=="string"?(u=encodeURI(u).replace(k,Fm),R&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Fm(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Nu=/[#\/\?@]/g,Um=/[#\?:]/g,Bm=/[#\?]/g,zm=/[#\?@]/g,Hm=/#/g;function Yr(u,k){this.h=this.g=null,this.i=u||null,this.j=!!k}function fn(u){u.g||(u.g=new Map,u.h=0,u.i&&qm(u.i,function(k,R){u.add(decodeURIComponent(k.replace(/\+/g," ")),R)}))}r=Yr.prototype,r.add=function(u,k){fn(this),this.i=null,u=Yn(this,u);var R=this.g.get(u);return R||this.g.set(u,R=[]),R.push(k),this.h+=1,this};function Pu(u,k){fn(u),k=Yn(u,k),u.g.has(k)&&(u.i=null,u.h-=u.g.get(k).length,u.g.delete(k))}function Ru(u,k){return fn(u),k=Yn(u,k),u.g.has(k)}r.forEach=function(u,k){fn(this),this.g.forEach(function(R,L){R.forEach(function(W){u.call(k,W,L,this)},this)},this)},r.na=function(){fn(this);const u=Array.from(this.g.values()),k=Array.from(this.g.keys()),R=[];for(let L=0;L<k.length;L++){const W=u[L];for(let ee=0;ee<W.length;ee++)R.push(k[L])}return R},r.V=function(u){fn(this);let k=[];if(typeof u=="string")Ru(this,u)&&(k=k.concat(this.g.get(Yn(this,u))));else{u=Array.from(this.g.values());for(let R=0;R<u.length;R++)k=k.concat(u[R])}return k},r.set=function(u,k){return fn(this),this.i=null,u=Yn(this,u),Ru(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[k]),this.h+=1,this},r.get=function(u,k){return u?(u=this.V(u),0<u.length?String(u[0]):k):k};function Cu(u,k,R){Pu(u,k),0<R.length&&(u.i=null,u.g.set(Yn(u,k),y(R)),u.h+=R.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],k=Array.from(this.g.keys());for(var R=0;R<k.length;R++){var L=k[R];const ee=encodeURIComponent(String(L)),he=this.V(L);for(L=0;L<he.length;L++){var W=ee;he[L]!==""&&(W+="="+encodeURIComponent(String(he[L]))),u.push(W)}}return this.i=u.join("&")};function Yn(u,k){return k=String(k),u.j&&(k=k.toLowerCase()),k}function Km(u,k){k&&!u.j&&(fn(u),u.i=null,u.g.forEach(function(R,L){var W=L.toLowerCase();L!=W&&(Pu(this,L),Cu(this,W,R))},u)),u.j=k}function Gm(u,k){const R=new Kr;if(a.Image){const L=new Image;L.onload=p(dn,R,"TestLoadImage: loaded",!0,k,L),L.onerror=p(dn,R,"TestLoadImage: error",!1,k,L),L.onabort=p(dn,R,"TestLoadImage: abort",!1,k,L),L.ontimeout=p(dn,R,"TestLoadImage: timeout",!1,k,L),a.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=u}else k(!1)}function Wm(u,k){const R=new Kr,L=new AbortController,W=setTimeout(()=>{L.abort(),dn(R,"TestPingServer: timeout",!1,k)},1e4);fetch(u,{signal:L.signal}).then(ee=>{clearTimeout(W),ee.ok?dn(R,"TestPingServer: ok",!0,k):dn(R,"TestPingServer: server error",!1,k)}).catch(()=>{clearTimeout(W),dn(R,"TestPingServer: error",!1,k)})}function dn(u,k,R,L,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),L(R)}catch{}}function Qm(){this.g=new Pm}function Ym(u,k,R){const L=R||"";try{Su(u,function(W,ee){let he=W;h(W)&&(he=Io(W)),k.push(L+ee+"="+encodeURIComponent(he))})}catch(W){throw k.push(L+"type="+encodeURIComponent("_badmap")),W}}function Wi(u){this.l=u.Ub||null,this.j=u.eb||!1}_(Wi,Oo),Wi.prototype.g=function(){return new Qi(this.l,this.j)},Wi.prototype.i=function(u){return function(){return u}}({});function Qi(u,k){xe.call(this),this.D=u,this.o=k,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Qi,xe),r=Qi.prototype,r.open=function(u,k){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=k,this.readyState=1,Xr(this)},r.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const k={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(k.body=u),(this.D||a).fetch(new Request(this.A,k)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=0},r.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Xr(this)),this.g&&(this.readyState=3,Xr(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ju(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ju(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}r.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var k=u.value?u.value:new Uint8Array(0);(k=this.v.decode(k,{stream:!u.done}))&&(this.response=this.responseText+=k)}u.done?Jr(this):Xr(this),this.readyState==3&&ju(this)}},r.Ra=function(u){this.g&&(this.response=this.responseText=u,Jr(this))},r.Qa=function(u){this.g&&(this.response=u,Jr(this))},r.ga=function(){this.g&&Jr(this)};function Jr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Xr(u)}r.setRequestHeader=function(u,k){this.u.append(u,k)},r.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],k=this.h.entries();for(var R=k.next();!R.done;)R=R.value,u.push(R[0]+": "+R[1]),R=k.next();return u.join(`\r
`)};function Xr(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Qi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Lu(u){let k="";return C(u,function(R,L){k+=L,k+=":",k+=R,k+=`\r
`}),k}function $o(u,k,R){e:{for(L in R){var L=!1;break e}L=!0}L||(R=Lu(R),typeof u=="string"?R!=null&&encodeURIComponent(String(R)):ze(u,k,R))}function Je(u){xe.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(Je,xe);var Jm=/^https?$/i,Xm=["POST","PUT"];r=Je.prototype,r.Ha=function(u){this.J=u},r.ea=function(u,k,R,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);k=k?k.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ro.g(),this.v=this.o?cu(this.o):cu(Ro),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(k,String(u),!0),this.B=!1}catch(ee){Du(this,ee);return}if(u=R||"",R=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var W in L)R.set(W,L[W]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ee of L.keys())R.set(ee,L.get(ee));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(R.keys()).find(ee=>ee.toLowerCase()=="content-type"),W=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Xm,k,void 0))||L||W||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,he]of R)this.g.setRequestHeader(ee,he);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$u(this),this.u=!0,this.g.send(u),this.u=!1}catch(ee){Du(this,ee)}};function Du(u,k){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=k,u.m=5,Mu(u),Yi(u)}function Mu(u){u.A||(u.A=!0,De(u,"complete"),De(u,"error"))}r.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,De(this,"complete"),De(this,"abort"),Yi(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yi(this,!0)),Je.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Vu(this):this.bb())},r.bb=function(){Vu(this)};function Vu(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Xt(u)!=4||u.Z()!=2)){if(u.u&&Xt(u)==4)ft(u.Ea,0,u);else if(De(u,"readystatechange"),Xt(u)==4){u.h=!1;try{const he=u.Z();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var k=!0;break e;default:k=!1}var R;if(!(R=k)){var L;if(L=he===0){var W=String(u.D).match(Iu)[1]||null;!W&&a.self&&a.self.location&&(W=a.self.location.protocol.slice(0,-1)),L=!Jm.test(W?W.toLowerCase():"")}R=L}if(R)De(u,"complete"),De(u,"success");else{u.m=6;try{var ee=2<Xt(u)?u.g.statusText:""}catch{ee=""}u.l=ee+" ["+u.Z()+"]",Mu(u)}}finally{Yi(u)}}}}function Yi(u,k){if(u.g){$u(u);const R=u.g,L=u.v[0]?()=>{}:null;u.g=null,u.v=null,k||De(u,"ready");try{R.onreadystatechange=L}catch{}}}function $u(u){u.I&&(a.clearTimeout(u.I),u.I=null)}r.isActive=function(){return!!this.g};function Xt(u){return u.g?u.g.readyState:0}r.Z=function(){try{return 2<Xt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(u){if(this.g){var k=this.g.responseText;return u&&k.indexOf(u)==0&&(k=k.substring(u.length)),Nm(k)}};function qu(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Zm(u){const k={};u=(u.g&&2<=Xt(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<u.length;L++){if(b(u[L]))continue;var R=T(u[L]);const W=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ee=k[W]||[];k[W]=ee,ee.push(R)}E(k,function(L){return L.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(u,k,R){return R&&R.internalChannelParams&&R.internalChannelParams[u]||k}function Fu(u){this.Aa=0,this.i=[],this.j=new Kr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zr("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zr("baseRetryDelayMs",5e3,u),this.cb=Zr("retryDelaySeedMs",1e4,u),this.Wa=Zr("forwardChannelMaxRetries",2,u),this.wa=Zr("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Eu(u&&u.concurrentRequestLimit),this.Da=new Qm,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Fu.prototype,r.la=8,r.G=1,r.connect=function(u,k,R,L){bt(0),this.W=u,this.H=k||{},R&&L!==void 0&&(this.H.OSID=R,this.H.OAID=L),this.F=this.X,this.I=Yu(this,null,this.W),Xi(this)};function qo(u){if(Uu(u),u.G==3){var k=u.U++,R=Jt(u.I);if(ze(R,"SID",u.K),ze(R,"RID",k),ze(R,"TYPE","terminate"),ei(u,R),k=new hn(u,u.j,k),k.L=2,k.v=Gi(Jt(R)),R=!1,a.navigator&&a.navigator.sendBeacon)try{R=a.navigator.sendBeacon(k.v.toString(),"")}catch{}!R&&a.Image&&(new Image().src=k.v,R=!0),R||(k.g=Ju(k.j,null),k.g.ea(k.v)),k.F=Date.now(),zi(k)}Qu(u)}function Ji(u){u.g&&(Uo(u),u.g.cancel(),u.g=null)}function Uu(u){Ji(u),u.u&&(a.clearTimeout(u.u),u.u=null),Zi(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Xi(u){if(!xu(u.h)&&!u.s){u.s=!0;var k=u.Ga;K||F(),oe||(K(),oe=!0),z.add(k,u),u.B=0}}function eg(u,k){return Tu(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=k.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Hr(f(u.Ga,u,k),Wu(u,u.B)),u.B++,!0)}r.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const W=new hn(this,this.j,u);let ee=this.o;if(this.S&&(ee?(ee=w(ee),x(ee,this.S)):ee=this.S),this.m!==null||this.O||(W.H=ee,ee=null),this.P)e:{for(var k=0,R=0;R<this.i.length;R++){t:{var L=this.i[R];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(k+=L,4096<k){k=R;break e}if(k===4096||R===this.i.length-1){k=R+1;break e}}k=1e3}else k=1e3;k=zu(this,W,k),R=Jt(this.I),ze(R,"RID",u),ze(R,"CVER",22),this.D&&ze(R,"X-HTTP-Session-Id",this.D),ei(this,R),ee&&(this.O?k="headers="+encodeURIComponent(String(Lu(ee)))+"&"+k:this.m&&$o(R,this.m,ee)),Vo(this.h,W),this.Ua&&ze(R,"TYPE","init"),this.P?(ze(R,"$req",k),ze(R,"SID","null"),W.T=!0,jo(W,R,null)):jo(W,R,k),this.G=2}}else this.G==3&&(u?Bu(this,u):this.i.length==0||xu(this.h)||Bu(this))};function Bu(u,k){var R;k?R=k.l:R=u.U++;const L=Jt(u.I);ze(L,"SID",u.K),ze(L,"RID",R),ze(L,"AID",u.T),ei(u,L),u.m&&u.o&&$o(L,u.m,u.o),R=new hn(u,u.j,R,u.B+1),u.m===null&&(R.H=u.o),k&&(u.i=k.D.concat(u.i)),k=zu(u,R,1e3),R.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Vo(u.h,R),jo(R,L,k)}function ei(u,k){u.H&&C(u.H,function(R,L){ze(k,L,R)}),u.l&&Su({},function(R,L){ze(k,L,R)})}function zu(u,k,R){R=Math.min(u.i.length,R);var L=u.l?f(u.l.Na,u.l,u):null;e:{var W=u.i;let ee=-1;for(;;){const he=["count="+R];ee==-1?0<R?(ee=W[0].g,he.push("ofs="+ee)):ee=0:he.push("ofs="+ee);let Fe=!0;for(let lt=0;lt<R;lt++){let Ve=W[lt].g;const dt=W[lt].map;if(Ve-=ee,0>Ve)ee=Math.max(0,W[lt].g-100),Fe=!1;else try{Ym(dt,he,"req"+Ve+"_")}catch{L&&L(dt)}}if(Fe){L=he.join("&");break e}}}return u=u.i.splice(0,R),k.D=u,L}function Hu(u){if(!u.g&&!u.u){u.Y=1;var k=u.Fa;K||F(),oe||(K(),oe=!0),z.add(k,u),u.v=0}}function Fo(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Hr(f(u.Fa,u),Wu(u,u.v)),u.v++,!0)}r.Fa=function(){if(this.u=null,Ku(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Hr(f(this.ab,this),u)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bt(10),Ji(this),Ku(this))};function Uo(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Ku(u){u.g=new hn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var k=Jt(u.qa);ze(k,"RID","rpc"),ze(k,"SID",u.K),ze(k,"AID",u.T),ze(k,"CI",u.F?"0":"1"),!u.F&&u.ja&&ze(k,"TO",u.ja),ze(k,"TYPE","xmlhttp"),ei(u,k),u.m&&u.o&&$o(k,u.m,u.o),u.L&&(u.g.I=u.L);var R=u.g;u=u.ia,R.L=1,R.v=Gi(Jt(k)),R.m=null,R.P=!0,_u(R,u)}r.Za=function(){this.C!=null&&(this.C=null,Ji(this),Fo(this),bt(19))};function Zi(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Gu(u,k){var R=null;if(u.g==k){Zi(u),Uo(u),u.g=null;var L=2}else if(Mo(u.h,k))R=k.D,Au(u.h,k),L=1;else return;if(u.G!=0){if(k.o)if(L==1){R=k.m?k.m.length:0,k=Date.now()-k.F;var W=u.B;L=Fi(),De(L,new mu(L,R)),Xi(u)}else Hu(u);else if(W=k.s,W==3||W==0&&0<k.X||!(L==1&&eg(u,k)||L==2&&Fo(u)))switch(R&&0<R.length&&(k=u.h,k.i=k.i.concat(R)),W){case 1:Dn(u,5);break;case 4:Dn(u,10);break;case 3:Dn(u,6);break;default:Dn(u,2)}}}function Wu(u,k){let R=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(R*=2),R*k}function Dn(u,k){if(u.j.info("Error code "+k),k==2){var R=f(u.fb,u),L=u.Xa;const W=!L;L=new Ln(L||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Hi(L,"https"),Gi(L),W?Gm(L.toString(),R):Wm(L.toString(),R)}else bt(2);u.G=0,u.l&&u.l.sa(k),Qu(u),Uu(u)}r.fb=function(u){u?(this.j.info("Successfully pinged google.com"),bt(2)):(this.j.info("Failed to ping google.com"),bt(1))};function Qu(u){if(u.G=0,u.ka=[],u.l){const k=ku(u.h);(k.length!=0||u.i.length!=0)&&(g(u.ka,k),g(u.ka,u.i),u.h.i.length=0,y(u.i),u.i.length=0),u.l.ra()}}function Yu(u,k,R){var L=R instanceof Ln?Jt(R):new Ln(R);if(L.g!="")k&&(L.g=k+"."+L.g),Ki(L,L.s);else{var W=a.location;L=W.protocol,k=k?k+"."+W.hostname:W.hostname,W=+W.port;var ee=new Ln(null);L&&Hi(ee,L),k&&(ee.g=k),W&&Ki(ee,W),R&&(ee.l=R),L=ee}return R=u.D,k=u.ya,R&&k&&ze(L,R,k),ze(L,"VER",u.la),ei(u,L),L}function Ju(u,k,R){if(k&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return k=u.Ca&&!u.pa?new Je(new Wi({eb:R})):new Je(u.pa),k.Ha(u.J),k}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xu(){}r=Xu.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function es(){}es.prototype.g=function(u,k){return new Ot(u,k)};function Ot(u,k){xe.call(this),this.g=new Fu(k),this.l=u,this.h=k&&k.messageUrlParams||null,u=k&&k.messageHeaders||null,k&&k.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=k&&k.initMessageHeaders||null,k&&k.messageContentType&&(u?u["X-WebChannel-Content-Type"]=k.messageContentType:u={"X-WebChannel-Content-Type":k.messageContentType}),k&&k.va&&(u?u["X-WebChannel-Client-Profile"]=k.va:u={"X-WebChannel-Client-Profile":k.va}),this.g.S=u,(u=k&&k.Sb)&&!b(u)&&(this.g.m=u),this.v=k&&k.supportsCrossDomainXhr||!1,this.u=k&&k.sendRawJson||!1,(k=k&&k.httpSessionIdParam)&&!b(k)&&(this.g.D=k,u=this.h,u!==null&&k in u&&(u=this.h,k in u&&delete u[k])),this.j=new Jn(this)}_(Ot,xe),Ot.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ot.prototype.close=function(){qo(this.g)},Ot.prototype.o=function(u){var k=this.g;if(typeof u=="string"){var R={};R.__data__=u,u=R}else this.u&&(R={},R.__data__=Io(u),u=R);k.i.push(new Mm(k.Ya++,u)),k.G==3&&Xi(k)},Ot.prototype.N=function(){this.g.l=null,delete this.j,qo(this.g),delete this.g,Ot.aa.N.call(this)};function Zu(u){No.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var k=u.__sm__;if(k){e:{for(const R in k){u=R;break e}u=void 0}(this.i=u)&&(u=this.i,k=k!==null&&u in k?k[u]:void 0),this.data=k}else this.data=u}_(Zu,No);function ec(){Po.call(this),this.status=1}_(ec,Po);function Jn(u){this.g=u}_(Jn,Xu),Jn.prototype.ua=function(){De(this.g,"a")},Jn.prototype.ta=function(u){De(this.g,new Zu(u))},Jn.prototype.sa=function(u){De(this.g,new ec)},Jn.prototype.ra=function(){De(this.g,"b")},es.prototype.createWebChannel=es.prototype.g,Ot.prototype.send=Ot.prototype.o,Ot.prototype.open=Ot.prototype.m,Ot.prototype.close=Ot.prototype.close,Vf=function(){return new es},Mf=function(){return Fi()},Df=Cn,_a={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ui.NO_ERROR=0,Ui.TIMEOUT=8,Ui.HTTP_ERROR=6,vs=Ui,gu.COMPLETE="complete",Lf=gu,hu.EventType=Br,Br.OPEN="a",Br.CLOSE="b",Br.ERROR="c",Br.MESSAGE="d",xe.prototype.listen=xe.prototype.K,oi=hu,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,jf=Je}).apply(typeof ns<"u"?ns:typeof self<"u"?self:typeof window<"u"?window:{});const hc="@firebase/firestore",fc="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gt.UNAUTHENTICATED=new gt(null),gt.GOOGLE_CREDENTIALS=new gt("google-credentials-uid"),gt.FIRST_PARTY=new gt("first-party-uid"),gt.MOCK_USER=new gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn=new og("@firebase/firestore");function sr(){return zn.logLevel}function ye(r,...e){if(zn.logLevel<=nn.DEBUG){const t=e.map(tl);zn.debug(`Firestore (${Tr}): ${r}`,...t)}}function ln(r,...e){if(zn.logLevel<=nn.ERROR){const t=e.map(tl);zn.error(`Firestore (${Tr}): ${r}`,...t)}}function dr(r,...e){if(zn.logLevel<=nn.WARN){const t=e.map(tl);zn.warn(`Firestore (${Tr}): ${r}`,...t)}}function tl(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function we(r="Unexpected state"){const e=`FIRESTORE (${Tr}) INTERNAL ASSERTION FAILED: `+r;throw ln(e),new Error(e)}function $e(r,e){r||we()}function Te(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends ug{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ky{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(gt.UNAUTHENTICATED))}shutdown(){}}class Gy{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Wy{constructor(e){this.t=e,this.currentUser=gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$e(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let s=new sn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new sn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new sn)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?($e(typeof n.accessToken=="string"),new $f(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string"),new gt(e)}}class Qy{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=gt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Yy{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Qy(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Jy{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,cg(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){$e(this.o===void 0);const n=s=>{s.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new dc(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?($e(typeof t.token=="string"),this.R=t.token,new dc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=Xy(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function Ne(r,e){return r<e?-1:r>e?1:0}function ba(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return Ne(n,i);{const s=qf(),o=Zy(s.encode(pc(r,t)),s.encode(pc(e,t)));return o!==0?o:Ne(n,i)}}t+=n>65535?2:1}return Ne(r.length,e.length)}function pc(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function Zy(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return Ne(r[t],e[t]);return Ne(r.length,e.length)}function pr(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mc=-62135596800,gc=1e6;class it{static now(){return it.fromMillis(Date.now())}static fromDate(e){return it.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*gc);return new it(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<mc)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gc}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-mc;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{static fromTimestamp(e){return new Ee(e)}static min(){return new Ee(new it(0,0))}static max(){return new Ee(new it(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc="__name__";class Ht{constructor(e,t,n){t===void 0?t=0:t>e.length&&we(),n===void 0?n=e.length-t:n>e.length-t&&we(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Ht.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ht?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Ht.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Ne(e.length,t.length)}static compareSegments(e,t){const n=Ht.isNumericId(e),i=Ht.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Ht.extractNumericId(e).compare(Ht.extractNumericId(t)):ba(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return _n.fromString(e.substring(4,e.length-2))}}class Ke extends Ht{construct(e,t,n){return new Ke(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ge(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Ke(t)}static emptyPath(){return new Ke([])}}const e0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Ht{construct(e,t,n){return new ct(e,t,n)}static isValidIdentifier(e){return e0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yc}static keyField(){return new ct([yc])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ge(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ge(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new ge(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(t)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(Ke.fromString(e))}static fromName(e){return new _e(Ke.fromString(e).popFirst(5))}static empty(){return new _e(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ke.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new Ke(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=-1;function t0(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Ee.fromTimestamp(n===1e9?new it(t+1,0):new it(t,n));return new wn(i,_e.empty(),e)}function n0(r){return new wn(r.readTime,r.key,_i)}class wn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new wn(Ee.min(),_e.empty(),_i)}static max(){return new wn(Ee.max(),_e.empty(),_i)}}function r0(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(r.documentKey,e.documentKey),t!==0?t:Ne(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class s0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ar(r){if(r.code!==ie.FAILED_PRECONDITION||r.message!==i0)throw r;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ae.reject(t)}static resolve(e){return new ae((t,n)=>{t(e)})}static reject(e){return new ae((t,n)=>{n(e)})}static waitFor(e){return new ae((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>n(l))}),o=!0,s===i&&t()})}static or(e){let t=ae.resolve(!1);for(const n of e)t=t.next(i=>i?ae.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ae((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const h=l;t(e[h]).next(c=>{o[h]=c,++a,a===s&&n(o)},c=>i(c))}})}static doWhile(e,t){return new ae((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function o0(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function kr(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Ws.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=-1;function Qs(r){return r==null}function ks(r){return r===0&&1/r==-1/0}function a0(r){return typeof r=="number"&&Number.isInteger(r)&&!ks(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf="";function l0(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=vc(e)),e=u0(r.get(t),e);return vc(e)}function u0(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case Uf:t+="";break;default:t+=s}}return t}function vc(r){return r+Uf+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Sn(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function Bf(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,t){this.comparator=e,this.root=t||ut.EMPTY}insert(e,t){return new Ye(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new Ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rs(this.root,e,this.comparator,!1)}getReverseIterator(){return new rs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rs(this.root,e,this.comparator,!0)}}class rs{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ut{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??ut.RED,this.left=i??ut.EMPTY,this.right=s??ut.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new ut(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ut.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ut.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}}ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,n,i,s){return this}insert(e,t,n){return new ut(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.comparator=e,this.data=new Ye(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bc(this.data.getIterator())}getIteratorFrom(e){return new bc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class bc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Pt([])}unionWith(e){let t=new st(ct.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Pt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pr(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zf("Invalid base64 string: "+s):s}}(e);return new ht(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ht(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ht.EMPTY_BYTE_STRING=new ht("");const c0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function En(r){if($e(!!r),typeof r=="string"){let e=0;const t=c0.exec(r);if($e(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Xe(r.seconds),nanos:Xe(r.nanos)}}function Xe(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function xn(r){return typeof r=="string"?ht.fromBase64String(r):ht.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="server_timestamp",Kf="__type__",Gf="__previous_value__",Wf="__local_write_time__";function rl(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Kf])===null||t===void 0?void 0:t.stringValue)===Hf}function Ys(r){const e=r.mapValue.fields[Gf];return rl(e)?Ys(e):e}function bi(r){const e=En(r.mapValue.fields[Wf].timestampValue);return new it(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,t,n,i,s,o,a,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=h}}const Ss="(default)";class wi{constructor(e,t){this.projectId=e,this.database=t||Ss}static empty(){return new wi("","")}get isDefaultDatabase(){return this.database===Ss}isEqual(e){return e instanceof wi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="__type__",Yf="__max__",is={mapValue:{fields:{__type__:{stringValue:Yf}}}},Jf="__vector__",Is="value";function Tn(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?rl(r)?4:d0(r)?9007199254740991:f0(r)?10:11:we()}function Qt(r,e){if(r===e)return!0;const t=Tn(r);if(t!==Tn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return bi(r).isEqual(bi(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=En(i.timestampValue),a=En(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return xn(i.bytesValue).isEqual(xn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Xe(i.geoPointValue.latitude)===Xe(s.geoPointValue.latitude)&&Xe(i.geoPointValue.longitude)===Xe(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Xe(i.integerValue)===Xe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Xe(i.doubleValue),a=Xe(s.doubleValue);return o===a?ks(o)===ks(a):isNaN(o)&&isNaN(a)}return!1}(r,e);case 9:return pr(r.arrayValue.values||[],e.arrayValue.values||[],Qt);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(_c(o)!==_c(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Qt(o[l],a[l])))return!1;return!0}(r,e);default:return we()}}function Ei(r,e){return(r.values||[]).find(t=>Qt(t,e))!==void 0}function mr(r,e){if(r===e)return 0;const t=Tn(r),n=Tn(e);if(t!==n)return Ne(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ne(r.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Xe(s.integerValue||s.doubleValue),l=Xe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(r,e);case 3:return wc(r.timestampValue,e.timestampValue);case 4:return wc(bi(r),bi(e));case 5:return ba(r.stringValue,e.stringValue);case 6:return function(s,o){const a=xn(s),l=xn(o);return a.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let h=0;h<a.length&&h<l.length;h++){const c=Ne(a[h],l[h]);if(c!==0)return c}return Ne(a.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Ne(Xe(s.latitude),Xe(o.latitude));return a!==0?a:Ne(Xe(s.longitude),Xe(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Ec(r.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,h,c;const d=s.fields||{},f=o.fields||{},p=(a=d[Is])===null||a===void 0?void 0:a.arrayValue,_=(l=f[Is])===null||l===void 0?void 0:l.arrayValue,y=Ne(((h=p==null?void 0:p.values)===null||h===void 0?void 0:h.length)||0,((c=_==null?void 0:_.values)===null||c===void 0?void 0:c.length)||0);return y!==0?y:Ec(p,_)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===is.mapValue&&o===is.mapValue)return 0;if(s===is.mapValue)return 1;if(o===is.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),h=o.fields||{},c=Object.keys(h);l.sort(),c.sort();for(let d=0;d<l.length&&d<c.length;++d){const f=ba(l[d],c[d]);if(f!==0)return f;const p=mr(a[l[d]],h[c[d]]);if(p!==0)return p}return Ne(l.length,c.length)}(r.mapValue,e.mapValue);default:throw we()}}function wc(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ne(r,e);const t=En(r),n=En(e),i=Ne(t.seconds,n.seconds);return i!==0?i:Ne(t.nanos,n.nanos)}function Ec(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=mr(t[i],n[i]);if(s)return s}return Ne(t.length,n.length)}function gr(r){return wa(r)}function wa(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=En(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return xn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return _e.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=wa(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${wa(t.fields[o])}`;return i+"}"}(r.mapValue):we()}function _s(r){switch(Tn(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ys(r);return e?16+_s(e):16;case 5:return 2*r.stringValue.length;case 6:return xn(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+_s(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return Sn(n.fields,(s,o)=>{i+=s.length+_s(o)}),i}(r.mapValue);default:throw we()}}function xc(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Ea(r){return!!r&&"integerValue"in r}function il(r){return!!r&&"arrayValue"in r}function Tc(r){return!!r&&"nullValue"in r}function Ac(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function bs(r){return!!r&&"mapValue"in r}function f0(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Qf])===null||t===void 0?void 0:t.stringValue)===Jf}function hi(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return Sn(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=hi(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hi(r.arrayValue.values[t]);return e}return Object.assign({},r)}function d0(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Yf}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!bs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hi(t)}setAll(e){let t=ct.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=hi(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());bs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Qt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];bs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){Sn(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new It(hi(this.value))}}function Xf(r){const e=[];return Sn(r.fields,(t,n)=>{const i=new ct([t]);if(bs(n)){const s=Xf(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Pt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new yt(e,0,Ee.min(),Ee.min(),Ee.min(),It.empty(),0)}static newFoundDocument(e,t,n,i){return new yt(e,1,t,Ee.min(),n,i,0)}static newNoDocument(e,t){return new yt(e,2,t,Ee.min(),Ee.min(),It.empty(),0)}static newUnknownDocument(e,t){return new yt(e,3,t,Ee.min(),Ee.min(),It.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ee.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ee.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t){this.position=e,this.inclusive=t}}function kc(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=_e.comparator(_e.fromName(o.referenceValue),t.key):n=mr(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Sc(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Qt(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,t="asc"){this.field=e,this.dir=t}}function p0(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{}class rt extends Zf{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new g0(e,t,n):t==="array-contains"?new _0(e,n):t==="in"?new b0(e,n):t==="not-in"?new w0(e,n):t==="array-contains-any"?new E0(e,n):new rt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new y0(e,n):new v0(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(mr(t,this.value)):t!==null&&Tn(this.value)===Tn(t)&&this.matchesComparison(mr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qt extends Zf{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new qt(e,t)}matches(e){return ed(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function ed(r){return r.op==="and"}function td(r){return m0(r)&&ed(r)}function m0(r){for(const e of r.filters)if(e instanceof qt)return!1;return!0}function xa(r){if(r instanceof rt)return r.field.canonicalString()+r.op.toString()+gr(r.value);if(td(r))return r.filters.map(e=>xa(e)).join(",");{const e=r.filters.map(t=>xa(t)).join(",");return`${r.op}(${e})`}}function nd(r,e){return r instanceof rt?function(n,i){return i instanceof rt&&n.op===i.op&&n.field.isEqual(i.field)&&Qt(n.value,i.value)}(r,e):r instanceof qt?function(n,i){return i instanceof qt&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,a)=>s&&nd(o,i.filters[a]),!0):!1}(r,e):void we()}function rd(r){return r instanceof rt?function(t){return`${t.field.canonicalString()} ${t.op} ${gr(t.value)}`}(r):r instanceof qt?function(t){return t.op.toString()+" {"+t.getFilters().map(rd).join(" ,")+"}"}(r):"Filter"}class g0 extends rt{constructor(e,t,n){super(e,t,n),this.key=_e.fromName(n.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class y0 extends rt{constructor(e,t){super(e,"in",t),this.keys=id("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class v0 extends rt{constructor(e,t){super(e,"not-in",t),this.keys=id("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function id(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>_e.fromName(n.referenceValue))}class _0 extends rt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return il(t)&&Ei(t.arrayValue,this.value)}}class b0 extends rt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ei(this.value.arrayValue,t)}}class w0 extends rt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Ei(this.value.arrayValue,t)}}class E0 extends rt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Ei(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.le=null}}function Ic(r,e=null,t=[],n=[],i=null,s=null,o=null){return new x0(r,e,t,n,i,s,o)}function sl(r){const e=Te(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>xa(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Qs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>gr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>gr(n)).join(",")),e.le=t}return e.le}function ol(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!p0(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!nd(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!Sc(r.startAt,e.startAt)&&Sc(r.endAt,e.endAt)}function Ta(r){return _e.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function T0(r,e,t,n,i,s,o,a){return new Sr(r,e,t,n,i,s,o,a)}function Js(r){return new Sr(r)}function Oc(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function sd(r){return r.collectionGroup!==null}function fi(r){const e=Te(r);if(e.he===null){e.he=[];const t=new Set;for(const s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new st(ct.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new xi(s,n))}),t.has(ct.keyField().canonicalString())||e.he.push(new xi(ct.keyField(),n))}return e.he}function Kt(r){const e=Te(r);return e.Pe||(e.Pe=A0(e,fi(r))),e.Pe}function A0(r,e){if(r.limitType==="F")return Ic(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new xi(i.field,s)});const t=r.endAt?new Os(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Os(r.startAt.position,r.startAt.inclusive):null;return Ic(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Aa(r,e){const t=r.filters.concat([e]);return new Sr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function ka(r,e,t){return new Sr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Xs(r,e){return ol(Kt(r),Kt(e))&&r.limitType===e.limitType}function od(r){return`${sl(Kt(r))}|lt:${r.limitType}`}function or(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>rd(i)).join(", ")}]`),Qs(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>gr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>gr(i)).join(",")),`Target(${n})`}(Kt(r))}; limitType=${r.limitType})`}function Zs(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):_e.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of fi(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,a,l){const h=kc(o,a,l);return o.inclusive?h<=0:h<0}(n.startAt,fi(n),i)||n.endAt&&!function(o,a,l){const h=kc(o,a,l);return o.inclusive?h>=0:h>0}(n.endAt,fi(n),i))}(r,e)}function k0(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function ad(r){return(e,t)=>{let n=!1;for(const i of fi(r)){const s=S0(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function S0(r,e,t){const n=r.field.isKeyField()?_e.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),h=a.data.field(s);return l!==null&&h!==null?mr(l,h):we()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return we()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Sn(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Bf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new Ye(_e.comparator);function un(){return I0}const ld=new Ye(_e.comparator);function ai(...r){let e=ld;for(const t of r)e=e.insert(t.key,t);return e}function ud(r){let e=ld;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Un(){return di()}function cd(){return di()}function di(){return new Kn(r=>r.toString(),(r,e)=>r.isEqual(e))}const O0=new Ye(_e.comparator),N0=new st(_e.comparator);function Le(...r){let e=N0;for(const t of r)e=e.add(t);return e}const P0=new st(Ne);function R0(){return P0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ks(e)?"-0":e}}function hd(r){return{integerValue:""+r}}function C0(r,e){return a0(e)?hd(e):al(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(){this._=void 0}}function j0(r,e,t){return r instanceof Ns?function(i,s){const o={fields:{[Kf]:{stringValue:Hf},[Wf]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rl(s)&&(s=Ys(s)),s&&(o.fields[Gf]=s),{mapValue:o}}(t,e):r instanceof Ti?dd(r,e):r instanceof Ai?pd(r,e):function(i,s){const o=fd(i,s),a=Nc(o)+Nc(i.Ie);return Ea(o)&&Ea(i.Ie)?hd(a):al(i.serializer,a)}(r,e)}function L0(r,e,t){return r instanceof Ti?dd(r,e):r instanceof Ai?pd(r,e):t}function fd(r,e){return r instanceof Ps?function(n){return Ea(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Ns extends eo{}class Ti extends eo{constructor(e){super(),this.elements=e}}function dd(r,e){const t=md(e);for(const n of r.elements)t.some(i=>Qt(i,n))||t.push(n);return{arrayValue:{values:t}}}class Ai extends eo{constructor(e){super(),this.elements=e}}function pd(r,e){let t=md(e);for(const n of r.elements)t=t.filter(i=>!Qt(i,n));return{arrayValue:{values:t}}}class Ps extends eo{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Nc(r){return Xe(r.integerValue||r.doubleValue)}function md(r){return il(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function D0(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ti&&i instanceof Ti||n instanceof Ai&&i instanceof Ai?pr(n.elements,i.elements,Qt):n instanceof Ps&&i instanceof Ps?Qt(n.Ie,i.Ie):n instanceof Ns&&i instanceof Ns}(r.transform,e.transform)}class M0{constructor(e,t){this.version=e,this.transformResults=t}}class xt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xt}static exists(e){return new xt(void 0,e)}static updateTime(e){return new xt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ws(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class to{}function gd(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new no(r.key,xt.none()):new Ii(r.key,r.data,xt.none());{const t=r.data,n=It.empty();let i=new st(ct.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new In(r.key,n,new Pt(i.toArray()),xt.none())}}function V0(r,e,t){r instanceof Ii?function(i,s,o){const a=i.value.clone(),l=Rc(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):r instanceof In?function(i,s,o){if(!ws(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Rc(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(yd(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pi(r,e,t,n){return r instanceof Ii?function(s,o,a,l){if(!ws(s.precondition,o))return a;const h=s.value.clone(),c=Cc(s.fieldTransforms,l,o);return h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(r,e,t,n):r instanceof In?function(s,o,a,l){if(!ws(s.precondition,o))return a;const h=Cc(s.fieldTransforms,l,o),c=o.data;return c.setAll(yd(s)),c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(s,o,a){return ws(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(r,e,t)}function $0(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=fd(n.transform,i||null);s!=null&&(t===null&&(t=It.empty()),t.set(n.field,s))}return t||null}function Pc(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&pr(n,i,(s,o)=>D0(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Ii extends to{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class In extends to{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function yd(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Rc(r,e,t){const n=new Map;$e(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,L0(o,a,t[i]))}return n}function Cc(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,j0(s,o,e))}return n}class no extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class q0 extends to{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&V0(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=pi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=cd();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=gd(o,a);l!==null&&n.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(Ee.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Le())}isEqual(e){return this.batchId===e.batchId&&pr(this.mutations,e.mutations,(t,n)=>Pc(t,n))&&pr(this.baseMutations,e.baseMutations,(t,n)=>Pc(t,n))}}class ll{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){$e(e.mutations.length===n.length);let i=function(){return O0}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new ll(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,Me;function z0(r){switch(r){case ie.OK:return we();case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return we()}}function vd(r){if(r===void 0)return ln("GRPC error has no .code"),ie.UNKNOWN;switch(r){case nt.OK:return ie.OK;case nt.CANCELLED:return ie.CANCELLED;case nt.UNKNOWN:return ie.UNKNOWN;case nt.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case nt.INTERNAL:return ie.INTERNAL;case nt.UNAVAILABLE:return ie.UNAVAILABLE;case nt.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case nt.NOT_FOUND:return ie.NOT_FOUND;case nt.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case nt.ABORTED:return ie.ABORTED;case nt.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case nt.DATA_LOSS:return ie.DATA_LOSS;default:return we()}}(Me=nt||(nt={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=new _n([4294967295,4294967295],0);function jc(r){const e=qf().encode(r),t=new Cf;return t.update(e),new Uint8Array(t.digest())}function Lc(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new _n([t,n],0),new _n([i,s],0)]}class ul{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new li(`Invalid padding: ${t}`);if(n<0)throw new li(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new li(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new li(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=_n.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(_n.fromNumber(n)));return i.compare(H0)===1&&(i=new _n([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=jc(e),[n,i]=Lc(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);if(!this.Re(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ul(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=jc(e),[n,i]=Lc(t);for(let s=0;s<this.hashCount;s++){const o=this.Ae(n,i,s);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class li extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Oi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new ro(Ee.min(),i,new Ye(Ne),un(),Le())}}class Oi{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Oi(n,t,Le(),Le(),Le())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}}class _d{constructor(e,t){this.targetId=e,this.ge=t}}class bd{constructor(e,t,n=ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Dc{constructor(){this.pe=0,this.ye=Mc(),this.we=ht.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Le(),t=Le(),n=Le();return this.ye.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:we()}}),new Oi(this.we,this.Se,e,t,n)}Me(){this.be=!1,this.ye=Mc()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,$e(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class K0{constructor(e){this.ke=e,this.qe=new Map,this.Qe=un(),this.$e=ss(),this.Ue=ss(),this.Ke=new Ye(Ne)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:we()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){const s=i.target;if(Ta(s))if(n===0){const o=new _e(s.path);this.ze(t,o,yt.newNoDocument(o,Ee.min()))}else $e(n===1);else{const o=this.et(t);if(o!==n){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,h)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=xn(n).toUint8Array()}catch(l){if(l instanceof zf)return dr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new ul(o,i,s)}catch(l){return dr(l instanceof li?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,s,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((s,o)=>{const a=this.Xe(o);if(a){if(s.current&&Ta(a.target)){const l=new _e(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,yt.newNoDocument(l,e))}s.ve&&(t.set(o,s.Fe()),s.Me())}});let n=Le();this.Ue.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.Xe(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(e));const i=new ro(e,t,this.Ke,this.Qe,n);return this.Qe=un(),this.$e=ss(),this.Ue=ss(),this.Ke=new Ye(Ne),i}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Dc,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new st(Ne),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new st(Ne),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Dc),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function ss(){return new Ye(_e.comparator)}function Mc(){return new Ye(_e.comparator)}const G0={asc:"ASCENDING",desc:"DESCENDING"},W0={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Q0={and:"AND",or:"OR"};class Y0{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sa(r,e){return r.useProto3Json||Qs(e)?e:{value:e}}function Rs(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wd(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function J0(r,e){return Rs(r,e.toTimestamp())}function Gt(r){return $e(!!r),Ee.fromTimestamp(function(t){const n=En(t);return new it(n.seconds,n.nanos)}(r))}function cl(r,e){return Ia(r,e).canonicalString()}function Ia(r,e){const t=function(i){return new Ke(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Ed(r){const e=Ke.fromString(r);return $e(Sd(e)),e}function Oa(r,e){return cl(r.databaseId,e.path)}function zo(r,e){const t=Ed(e);if(t.get(1)!==r.databaseId.projectId)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new ge(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new _e(Td(t))}function xd(r,e){return cl(r.databaseId,e)}function X0(r){const e=Ed(r);return e.length===4?Ke.emptyPath():Td(e)}function Na(r){return new Ke(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Td(r){return $e(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Vc(r,e,t){return{name:Oa(r,e),fields:t.value.mapValue.fields}}function Z0(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:we()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,c){return h.useProto3Json?($e(c===void 0||typeof c=="string"),ht.fromBase64String(c||"")):($e(c===void 0||c instanceof Buffer||c instanceof Uint8Array),ht.fromUint8Array(c||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(h){const c=h.code===void 0?ie.UNKNOWN:vd(h.code);return new ge(c,h.message||"")}(o);t=new bd(n,i,s,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=zo(r,n.document.name),s=Gt(n.document.updateTime),o=n.document.createTime?Gt(n.document.createTime):Ee.min(),a=new It({mapValue:{fields:n.document.fields}}),l=yt.newFoundDocument(i,s,o,a),h=n.targetIds||[],c=n.removedTargetIds||[];t=new Es(h,c,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=zo(r,n.document),s=n.readTime?Gt(n.readTime):Ee.min(),o=yt.newNoDocument(i,s),a=n.removedTargetIds||[];t=new Es([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=zo(r,n.document),s=n.removedTargetIds||[];t=new Es([],s,i,null)}else{if(!("filter"in e))return we();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new B0(i,s),a=n.targetId;t=new _d(a,o)}}return t}function ev(r,e){let t;if(e instanceof Ii)t={update:Vc(r,e.key,e.value)};else if(e instanceof no)t={delete:Oa(r,e.key)};else if(e instanceof In)t={update:Vc(r,e.key,e.data),updateMask:uv(e.fieldMask)};else{if(!(e instanceof q0))return we();t={verify:Oa(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof Ns)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ti)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ps)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw we()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:J0(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:we()}(r,e.precondition)),t}function tv(r,e){return r&&r.length>0?($e(e!==void 0),r.map(t=>function(i,s){let o=i.updateTime?Gt(i.updateTime):Gt(s);return o.isEqual(Ee.min())&&(o=Gt(s)),new M0(o,i.transformResults||[])}(t,e))):[]}function nv(r,e){return{documents:[xd(r,e.path)]}}function rv(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=xd(r,i);const s=function(h){if(h.length!==0)return kd(qt.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(c=>function(f){return{field:ar(f.field),direction:ov(f.dir)}}(c))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Sa(r,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ht:t,parent:i}}function iv(r){let e=X0(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){$e(n===1);const c=t.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];t.where&&(s=function(d){const f=Ad(d);return f instanceof qt&&td(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(_){return new xi(lr(_.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Qs(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,p=d.values||[];return new Os(p,f)}(t.startAt));let h=null;return t.endAt&&(h=function(d){const f=!d.before,p=d.values||[];return new Os(p,f)}(t.endAt)),T0(e,i,o,s,a,"F",l,h)}function sv(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ad(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=lr(t.unaryFilter.field);return rt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=lr(t.unaryFilter.field);return rt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=lr(t.unaryFilter.field);return rt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=lr(t.unaryFilter.field);return rt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return we()}}(r):r.fieldFilter!==void 0?function(t){return rt.create(lr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return qt.create(t.compositeFilter.filters.map(n=>Ad(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return we()}}(t.compositeFilter.op))}(r):we()}function ov(r){return G0[r]}function av(r){return W0[r]}function lv(r){return Q0[r]}function ar(r){return{fieldPath:r.canonicalString()}}function lr(r){return ct.fromServerFormat(r.fieldPath)}function kd(r){return r instanceof rt?function(t){if(t.op==="=="){if(Ac(t.value))return{unaryFilter:{field:ar(t.field),op:"IS_NAN"}};if(Tc(t.value))return{unaryFilter:{field:ar(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ac(t.value))return{unaryFilter:{field:ar(t.field),op:"IS_NOT_NAN"}};if(Tc(t.value))return{unaryFilter:{field:ar(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ar(t.field),op:av(t.op),value:t.value}}}(r):r instanceof qt?function(t){const n=t.getFilters().map(i=>kd(i));return n.length===1?n[0]:{compositeFilter:{op:lv(t.op),filters:n}}}(r):we()}function uv(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Sd(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,t,n,i,s=Ee.min(),o=Ee.min(),a=ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new vn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e){this.Tt=e}}function hv(r){const e=iv({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?ka(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(){this.Tn=new dv}addToCollectionParentIndex(e,t){return this.Tn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(wn.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(wn.min())}updateCollectionGroup(e,t,n){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class dv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new st(Ke.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new st(Ke.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Id=41943040;class kt{static withCacheSize(e){return new kt(e,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kt.DEFAULT_COLLECTION_PERCENTILE=10,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kt.DEFAULT=new kt(Id,kt.DEFAULT_COLLECTION_PERCENTILE,kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kt.DISABLED=new kt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new yr(0)}static Kn(){return new yr(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc="LruGarbageCollector",pv=1048576;function Fc([r,e],[t,n]){const i=Ne(r,t);return i===0?Ne(e,n):i}class mv{constructor(e){this.Hn=e,this.buffer=new st(Fc),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Fc(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class gv{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){ye(qc,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){kr(t)?ye(qc,"Ignoring IndexedDB error during garbage collection: ",t):await Ar(t)}await this.er(3e5)})}}class yv{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Ws.ae);const n=new mv(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve($c)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$c):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,s,o,a,l,h;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(n=d,a=Date.now(),this.removeTargets(e,n,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(h=Date.now(),sr()<=nn.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(h-l)+`ms
Total Duration: ${h-c}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}function vv(r,e){return new yv(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(){this.changes=new Kn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ae.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&pi(n.mutation,i,Pt.empty(),it.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Le()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Le()){const i=Un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=ai();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Un();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Le()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=un();const o=di(),a=function(){return di()}();return t.forEach((l,h)=>{const c=n.get(h.key);i.has(h.key)&&(c===void 0||c.mutation instanceof In)?s=s.insert(h.key,h):c!==void 0?(o.set(h.key,c.mutation.getFieldMask()),pi(c.mutation,h,c.mutation.getFieldMask(),it.now())):o.set(h.key,Pt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,c)=>o.set(h,c)),t.forEach((h,c)=>{var d;return a.set(h,new bv(c,(d=o.get(h))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=di();let i=new Ye((o,a)=>o-a),s=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=t.get(l);if(h===null)return;let c=n.get(l)||Pt.empty();c=a.applyToLocalView(h,c),n.set(l,c);const d=(i.get(a.batchId)||Le()).add(l);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,c=l.value,d=cd();c.forEach(f=>{if(!s.has(f)){const p=gd(t.get(f),n.get(f));p!==null&&d.set(f,p),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,d))}return ae.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return _e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):sd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ae.resolve(Un());let a=_i,l=s;return o.next(h=>ae.forEach(h,(c,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(c)?ae.resolve():this.remoteDocumentCache.getEntry(e,c).next(f=>{l=l.insert(c,f)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,Le())).next(c=>({batchId:a,changes:ud(c)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(n=>{let i=ai();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=ai();return this.indexManager.getCollectionParents(e,s).next(a=>ae.forEach(a,l=>{const h=function(d,f){return new Sr(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(c=>{c.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((l,h)=>{const c=h.getKey();o.get(c)===null&&(o=o.insert(c,yt.newInvalidDocument(c)))});let a=ai();return o.forEach((l,h)=>{const c=s.get(l);c!==void 0&&pi(c.mutation,h,Pt.empty(),it.now()),Zs(t,h)&&(a=a.insert(l,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return ae.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Gt(i.createTime)}}(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:hv(i.bundledQuery),readTime:Gt(i.readTime)}}(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.overlays=new Ye(_e.comparator),this.Rr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Un();return ae.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.Et(e,t,s)}),ae.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(n)),ae.resolve()}getOverlaysForCollection(e,t,n){const i=Un(),s=t.length+1,o=new _e(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Ye((h,c)=>h-c);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let c=s.get(h.largestBatchId);c===null&&(c=Un(),s=s.insert(h.largestBatchId,c)),c.set(h.getKey(),h)}}const a=Un(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,c)=>a.set(h,c)),!(a.size()>=i)););return ae.resolve(a)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new U0(t,n));let s=this.Rr.get(t);s===void 0&&(s=Le(),this.Rr.set(t,s)),this.Rr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.Vr=new st(at.mr),this.gr=new st(at.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new at(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new at(e,t))}Sr(e,t){e.forEach(n=>this.removeReference(n,t))}br(e){const t=new _e(new Ke([])),n=new at(t,e),i=new at(t,e+1),s=[];return this.gr.forEachInRange([n,i],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new _e(new Ke([])),n=new at(t,e),i=new at(t,e+1);let s=Le();return this.gr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new at(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class at{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return _e.comparator(e.key,t.key)||Ne(e.Cr,t.Cr)}static pr(e,t){return Ne(e.Cr,t.Cr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new st(at.mr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new F0(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Mr=this.Mr.add(new at(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ae.resolve(o)}lookupMutationBatch(e,t){return ae.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),s=i<0?0:i;return ae.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?nl:this.Fr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new at(t,0),i=new at(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([n,i],o=>{const a=this.Or(o.Cr);s.push(a)}),ae.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new st(Ne);return t.forEach(i=>{const s=new at(i,0),o=new at(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],a=>{n=n.add(a.Cr)})}),ae.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;_e.isDocumentKey(s)||(s=s.child(""));const o=new at(new _e(s),0);let a=new st(Ne);return this.Mr.forEachWhile(l=>{const h=l.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(a=a.add(l.Cr)),!0)},o),ae.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){$e(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return ae.forEach(t.mutations,i=>{const s=new at(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new at(t,0),i=this.Mr.firstAfterOrEqual(n);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e){this.kr=e,this.docs=function(){return new Ye(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ae.resolve(n?n.document.mutableCopy():yt.newInvalidDocument(t))}getEntries(e,t){let n=un();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),ae.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=un();const o=t.path,a=new _e(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:c}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||r0(n0(c),n)<=0||(i.has(c.key)||Zs(t,c))&&(s=s.insert(c.key,c.mutableCopy()))}return ae.resolve(s)}getAllFromCollectionGroup(e,t,n,i){we()}qr(e,t){return ae.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Sv(this)}getSize(e){return ae.resolve(this.size)}}class Sv extends _v{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),ae.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.persistence=e,this.Qr=new Kn(t=>sl(t),ol),this.lastRemoteSnapshotVersion=Ee.min(),this.highestTargetId=0,this.$r=0,this.Ur=new hl,this.targetCount=0,this.Kr=yr.Un()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),ae.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new yr(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.zn(t),ae.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ae.waitFor(s).next(()=>i)}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return ae.resolve(n)}addMatchingKeys(e,t,n){return this.Ur.yr(t,n),ae.resolve()}removeMatchingKeys(e,t,n){this.Ur.Sr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ae.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ur.vr(t);return ae.resolve(n)}containsKey(e,t){return ae.resolve(this.Ur.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Ws(0),this.zr=!1,this.zr=!0,this.jr=new Tv,this.referenceDelegate=e(this),this.Hr=new Iv(this),this.indexManager=new fv,this.remoteDocumentCache=function(i){return new kv(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new cv(t),this.Yr=new Ev(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Av(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){ye("MemoryPersistence","Starting transaction:",e);const i=new Ov(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return ae.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class Ov extends s0{constructor(e){super(),this.currentSequenceNumber=e}}class fl{constructor(e){this.persistence=e,this.ti=new hl,this.ni=null}static ri(e){return new fl(e)}get ii(){if(this.ni)return this.ni;throw we()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),ae.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),ae.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.ii,n=>{const i=_e.fromPath(n);return this.si(e,i).next(s=>{s||t.removeEntry(i,Ee.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return ae.or([()=>ae.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Cs{constructor(e,t){this.persistence=e,this.oi=new Kn(n=>l0(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=vv(this,t)}static ri(e,t){return new Cs(e,t)}Zr(){}Xr(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return ae.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(s=>s?ae.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,t).next(a=>{a||(n++,s.removeEntry(o,Ee.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),ae.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_s(e.data.value)),t}ar(e,t,n){return ae.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return ae.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=Le(),i=Le();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new dl(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return yg()?8:o0(vg())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Nv;return this._s(e,t,o).next(a=>{if(s.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>s.result)}us(e,t,n,i){return n.documentReadCount<this.es?(sr()<=nn.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",or(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),ae.resolve()):(sr()<=nn.DEBUG&&ye("QueryEngine","Query:",or(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(sr()<=nn.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",or(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kt(t))):ae.resolve())}rs(e,t){if(Oc(t))return ae.resolve(null);let n=Kt(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ka(t,null,"F"),n=Kt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Le(...s);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const h=this.cs(t,a);return this.ls(t,h,o,l.readTime)?this.rs(e,ka(t,null,"F")):this.hs(e,h,t,l)}))})))}ss(e,t,n,i){return Oc(t)||i.isEqual(Ee.min())?ae.resolve(null):this.ns.getDocuments(e,n).next(s=>{const o=this.cs(t,s);return this.ls(t,o,n,i)?ae.resolve(null):(sr()<=nn.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),or(t)),this.hs(e,o,t,t0(i,_i)).next(a=>a))})}cs(e,t){let n=new st(ad(e));return t.forEach((i,s)=>{Zs(e,s)&&(n=n.add(s))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,n){return sr()<=nn.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",or(t)),this.ns.getDocumentsMatchingQuery(e,t,wn.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl="LocalStore",Rv=3e8;class Cv{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new Ye(Ne),this.Is=new Kn(s=>sl(s),ol),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wv(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function jv(r,e,t,n){return new Cv(r,e,t,n)}async function Nd(r,e){const t=Te(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let l=Le();for(const h of i){o.push(h.batchId);for(const c of h.mutations)l=l.add(c.key)}for(const h of s){a.push(h.batchId);for(const c of h.mutations)l=l.add(c.key)}return t.localDocuments.getDocuments(n,l).next(h=>({Rs:h,removedBatchIds:o,addedBatchIds:a}))})})}function Lv(r,e){const t=Te(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,h,c){const d=h.batch,f=d.keys();let p=ae.resolve();return f.forEach(_=>{p=p.next(()=>c.getEntry(l,_)).next(y=>{const g=h.docVersions.get(_);$e(g!==null),y.version.compareTo(g)<0&&(d.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),c.addEntry(y)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let l=Le();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(l=l.add(a.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function Pd(r){const e=Te(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function Dv(r,e){const t=Te(r),n=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const a=[];e.targetChanges.forEach((c,d)=>{const f=i.get(d);if(!f)return;a.push(t.Hr.removeMatchingKeys(s,c.removedDocuments,d).next(()=>t.Hr.addMatchingKeys(s,c.addedDocuments,d)));let p=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(ht.EMPTY_BYTE_STRING,Ee.min()).withLastLimboFreeSnapshotVersion(Ee.min()):c.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(c.resumeToken,n)),i=i.insert(d,p),function(y,g,m){return y.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=Rv?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(f,p,c)&&a.push(t.Hr.updateTargetData(s,p))});let l=un(),h=Le();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,c))}),a.push(Mv(s,o,e.documentUpdates).next(c=>{l=c.Vs,h=c.fs})),!n.isEqual(Ee.min())){const c=t.Hr.getLastRemoteSnapshotVersion(s).next(d=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(c)}return ae.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.Ts=i,s))}function Mv(r,e,t){let n=Le(),i=Le();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=un();return t.forEach((a,l)=>{const h=s.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(Ee.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ye(pl,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{Vs:o,fs:i}})}function Vv(r,e){const t=Te(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=nl),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function $v(r,e){const t=Te(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(s=>s?(i=s,ae.resolve(i)):t.Hr.allocateTargetId(n).next(o=>(i=new vn(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function Pa(r,e,t){const n=Te(r),i=n.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!kr(o))throw o;ye(pl,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Uc(r,e,t){const n=Te(r);let i=Ee.min(),s=Le();return n.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,c){const d=Te(l),f=d.Is.get(c);return f!==void 0?ae.resolve(d.Ts.get(f)):d.Hr.getTargetData(h,c)}(n,o,Kt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>n.Ps.getDocumentsMatchingQuery(o,e,t?i:Ee.min(),t?s:Le())).next(a=>(qv(n,k0(e),a),{documents:a,gs:s})))}function qv(r,e,t){let n=r.Es.get(e)||Ee.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Es.set(e,n)}class Bc{constructor(){this.activeTargetIds=R0()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fv{constructor(){this.ho=new Bc,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Bc,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc="ConnectivityMonitor";class Hc{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){ye(zc,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){ye(zc,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let os=null;function Ra(){return os===null?os=function(){return 268435456+Math.round(2147483648*Math.random())}():os++,"0x"+os.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ho="RestConnection",Bv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class zv{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===Ss?`project_id=${n}`:`project_id=${n}&database_id=${i}`}So(e,t,n,i,s){const o=Ra(),a=this.bo(e,t.toUriEncodedString());ye(Ho,`Sending RPC '${e}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,i,s),this.vo(e,a,l,n).then(h=>(ye(Ho,`Received RPC '${e}' ${o}: `,h),h),h=>{throw dr(Ho,`RPC '${e}' ${o} failed with error: `,h,"url: ",a,"request:",n),h})}Co(e,t,n,i,s,o){return this.So(e,t,n,i,s)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tr}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}bo(e,t){const n=Bv[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt="WebChannelConnection";class Kv extends zv{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const s=Ra();return new Promise((o,a)=>{const l=new jf;l.setWithCredentials(!0),l.listenOnce(Lf.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case vs.NO_ERROR:const c=l.getResponseJson();ye(mt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(c)),o(c);break;case vs.TIMEOUT:ye(mt,`RPC '${e}' ${s} timed out`),a(new ge(ie.DEADLINE_EXCEEDED,"Request time out"));break;case vs.HTTP_ERROR:const d=l.getStatus();if(ye(mt,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const p=f==null?void 0:f.error;if(p&&p.status&&p.message){const _=function(g){const m=g.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(m)>=0?m:ie.UNKNOWN}(p.status);a(new ge(_,p.message))}else a(new ge(ie.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ge(ie.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{ye(mt,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);ye(mt,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,n,15)})}Wo(e,t,n){const i=Ra(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Vf(),a=Mf(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const c=s.join("");ye(mt,`Creating RPC '${e}' stream ${i}: ${c}`,l);const d=o.createWebChannel(c,l);let f=!1,p=!1;const _=new Hv({Fo:g=>{p?ye(mt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(f||(ye(mt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),f=!0),ye(mt,`RPC '${e}' stream ${i} sending:`,g),d.send(g))},Mo:()=>d.close()}),y=(g,m,b)=>{g.listen(m,I=>{try{b(I)}catch(v){setTimeout(()=>{throw v},0)}})};return y(d,oi.EventType.OPEN,()=>{p||(ye(mt,`RPC '${e}' stream ${i} transport opened.`),_.Qo())}),y(d,oi.EventType.CLOSE,()=>{p||(p=!0,ye(mt,`RPC '${e}' stream ${i} transport closed`),_.Uo())}),y(d,oi.EventType.ERROR,g=>{p||(p=!0,dr(mt,`RPC '${e}' stream ${i} transport errored:`,g),_.Uo(new ge(ie.UNAVAILABLE,"The operation could not be completed")))}),y(d,oi.EventType.MESSAGE,g=>{var m;if(!p){const b=g.data[0];$e(!!b);const I=b,v=(I==null?void 0:I.error)||((m=I[0])===null||m===void 0?void 0:m.error);if(v){ye(mt,`RPC '${e}' stream ${i} received error:`,v);const N=v.status;let C=function(A){const x=nt[A];if(x!==void 0)return vd(x)}(N),E=v.message;C===void 0&&(C=ie.INTERNAL,E="Unknown error status: "+N+" with message "+v.message),p=!0,_.Uo(new ge(C,E)),d.close()}else ye(mt,`RPC '${e}' stream ${i} received:`,b),_.Ko(b)}}),y(a,Df.STAT_EVENT,g=>{g.stat===_a.PROXY?ye(mt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===_a.NOPROXY&&ye(mt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.$o()},0),_}}function Ko(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(r){return new Y0(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&ye("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc="PersistentStream";class Cd{constructor(e,t,n,i,s,o,a,l){this.Ti=e,this.n_=n,this.r_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Rd(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(ln(t.toString()),ln("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new ge(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return ye(Kc,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(ye(Kc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Gv extends Cd{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=Z0(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ee.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Ee.min():o.readTime?Gt(o.readTime):Ee.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Na(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=Ta(l)?{documents:nv(s,l)}:{query:rv(s,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=wd(s,o.resumeToken);const h=Sa(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Ee.min())>0){a.readTime=Rs(s,o.snapshotVersion.toTimestamp());const h=Sa(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,e);const n=sv(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Na(this.serializer),t.removeTarget=e,this.I_(t)}}class Wv extends Cd{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return $e(!!e.streamToken),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){$e(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=tv(e.writeResults,e.commitTime),n=Gt(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Na(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>ev(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{}class Yv extends Qv{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,Ia(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ge(ie.UNKNOWN,s.toString())})}Co(e,t,n,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,Ia(t,n),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ge(ie.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class Jv{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(ln(t),this.N_=!1):ye("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hn="RemoteStore";class Xv{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{n.enqueueAndForget(async()=>{Gn(this)&&(ye(Hn,"Restarting streams for network reachability change."),await async function(l){const h=Te(l);h.W_.add(4),await Ni(h),h.j_.set("Unknown"),h.W_.delete(4),await so(h)}(this))})}),this.j_=new Jv(n,i)}}async function so(r){if(Gn(r))for(const e of r.G_)await e(!0)}async function Ni(r){for(const e of r.G_)await e(!1)}function jd(r,e){const t=Te(r);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),vl(t)?yl(t):Ir(t).c_()&&gl(t,e))}function ml(r,e){const t=Te(r),n=Ir(t);t.K_.delete(e),n.c_()&&Ld(t,e),t.K_.size===0&&(n.c_()?n.P_():Gn(t)&&t.j_.set("Unknown"))}function gl(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ee.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ir(r).y_(e)}function Ld(r,e){r.H_.Ne(e),Ir(r).w_(e)}function yl(r){r.H_=new K0({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.K_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),Ir(r).start(),r.j_.B_()}function vl(r){return Gn(r)&&!Ir(r).u_()&&r.K_.size>0}function Gn(r){return Te(r).W_.size===0}function Dd(r){r.H_=void 0}async function Zv(r){r.j_.set("Online")}async function e_(r){r.K_.forEach((e,t)=>{gl(r,e)})}async function t_(r,e){Dd(r),vl(r)?(r.j_.q_(e),yl(r)):r.j_.set("Unknown")}async function n_(r,e,t){if(r.j_.set("Online"),e instanceof bd&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.K_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.K_.delete(a),i.H_.removeTarget(a))}(r,e)}catch(n){ye(Hn,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await js(r,n)}else if(e instanceof Es?r.H_.We(e):e instanceof _d?r.H_.Ze(e):r.H_.je(e),!t.isEqual(Ee.min()))try{const n=await Pd(r.localStore);t.compareTo(n)>=0&&await function(s,o){const a=s.H_.ot(o);return a.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.K_.get(h);c&&s.K_.set(h,c.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,h)=>{const c=s.K_.get(l);if(!c)return;s.K_.set(l,c.withResumeToken(ht.EMPTY_BYTE_STRING,c.snapshotVersion)),Ld(s,l);const d=new vn(c.target,l,h,c.sequenceNumber);gl(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(r,t)}catch(n){ye(Hn,"Failed to raise snapshot:",n),await js(r,n)}}async function js(r,e,t){if(!kr(e))throw e;r.W_.add(1),await Ni(r),r.j_.set("Offline"),t||(t=()=>Pd(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ye(Hn,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await so(r)})}function Md(r,e){return e().catch(t=>js(r,t,e))}async function oo(r){const e=Te(r),t=An(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:nl;for(;r_(e);)try{const i=await Vv(e.localStore,n);if(i===null){e.U_.length===0&&t.P_();break}n=i.batchId,i_(e,i)}catch(i){await js(e,i)}Vd(e)&&$d(e)}function r_(r){return Gn(r)&&r.U_.length<10}function i_(r,e){r.U_.push(e);const t=An(r);t.c_()&&t.S_&&t.b_(e.mutations)}function Vd(r){return Gn(r)&&!An(r).u_()&&r.U_.length>0}function $d(r){An(r).start()}async function s_(r){An(r).C_()}async function o_(r){const e=An(r);for(const t of r.U_)e.b_(t.mutations)}async function a_(r,e,t){const n=r.U_.shift(),i=ll.from(n,e,t);await Md(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await oo(r)}async function l_(r,e){e&&An(r).S_&&await async function(n,i){if(function(o){return z0(o)&&o!==ie.ABORTED}(i.code)){const s=n.U_.shift();An(n).h_(),await Md(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await oo(n)}}(r,e),Vd(r)&&$d(r)}async function Gc(r,e){const t=Te(r);t.asyncQueue.verifyOperationInProgress(),ye(Hn,"RemoteStore received new credentials");const n=Gn(t);t.W_.add(3),await Ni(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await so(t)}async function u_(r,e){const t=Te(r);e?(t.W_.delete(2),await so(t)):e||(t.W_.add(2),await Ni(t),t.j_.set("Unknown"))}function Ir(r){return r.J_||(r.J_=function(t,n,i){const s=Te(t);return s.M_(),new Gv(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:Zv.bind(null,r),No:e_.bind(null,r),Lo:t_.bind(null,r),p_:n_.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),vl(r)?yl(r):r.j_.set("Unknown")):(await r.J_.stop(),Dd(r))})),r.J_}function An(r){return r.Y_||(r.Y_=function(t,n,i){const s=Te(t);return s.M_(),new Wv(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:s_.bind(null,r),Lo:l_.bind(null,r),D_:o_.bind(null,r),v_:a_.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await oo(r)):(await r.Y_.stop(),r.U_.length>0&&(ye(Hn,`Stopping write stream with ${r.U_.length} pending writes`),r.U_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new _l(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bl(r,e){if(ln("AsyncQueue",`${e}: ${r}`),kr(r))return new ge(ie.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{static emptySet(e){return new cr(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_e.comparator(t.key,n.key):(t,n)=>_e.comparator(t.key,n.key),this.keyedMap=ai(),this.sortedSet=new Ye(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof cr)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new cr;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){this.Z_=new Ye(_e.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):we():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class vr{constructor(e,t,n,i,s,o,a,l,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new vr(e,t,cr.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class h_{constructor(){this.queries=Qc(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=Te(t),s=i.queries;i.queries=Qc(),s.forEach((o,a)=>{for(const l of a.ta)l.onError(n)})})(this,new ge(ie.ABORTED,"Firestore shutting down"))}}function Qc(){return new Kn(r=>od(r),Xs)}async function wl(r,e){const t=Te(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.na()&&e.ra()&&(n=2):(s=new c_,n=e.ra()?0:1);try{switch(n){case 0:s.ea=await t.onListen(i,!0);break;case 1:s.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=bl(o,`Initialization of query '${or(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&xl(t)}async function El(r,e){const t=Te(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.ta.indexOf(e);o>=0&&(s.ta.splice(o,1),s.ta.length===0?i=e.ra()?0:1:!s.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function f_(r,e){const t=Te(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.ta)a.oa(i)&&(n=!0);o.ea=i}}n&&xl(t)}function d_(r,e,t){const n=Te(r),i=n.queries.get(e);if(i)for(const s of i.ta)s.onError(t);n.queries.delete(e)}function xl(r){r.ia.forEach(e=>{e.next()})}var Ca,Yc;(Yc=Ca||(Ca={}))._a="default",Yc.Cache="cache";class Tl{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new vr(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=vr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Ca.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(e){this.key=e}}class Fd{constructor(e){this.key=e}}class p_{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Le(),this.mutatedKeys=Le(),this.ya=ad(e),this.wa=new cr(this.ya)}get Sa(){return this.fa}ba(e,t){const n=t?t.Da:new Wc,i=t?t.wa:this.wa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,d)=>{const f=i.get(c),p=Zs(this.query,d)?d:null,_=!!f&&this.mutatedKeys.has(f.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;f&&p?f.data.isEqual(p.data)?_!==y&&(n.track({type:3,doc:p}),g=!0):this.va(f,p)||(n.track({type:2,doc:p}),g=!0,(l&&this.ya(p,l)>0||h&&this.ya(p,h)<0)&&(a=!0)):!f&&p?(n.track({type:0,doc:p}),g=!0):f&&!p&&(n.track({type:1,doc:f}),g=!0,(l||h)&&(a=!0)),g&&(p?(o=o.add(p),s=y?s.add(c):s.delete(c)):(o=o.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),n.track({type:1,doc:c})}return{wa:o,Da:n,ls:a,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((c,d)=>function(p,_){const y=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return y(p)-y(_)}(c.type,d.type)||this.ya(c.doc,d.doc)),this.Ca(n),i=i!=null&&i;const a=t&&!i?this.Fa():[],l=this.pa.size===0&&this.current&&!i?1:0,h=l!==this.ga;return this.ga=l,o.length!==0||h?{snapshot:new vr(this.query,e.wa,s,o,e.mutatedKeys,l===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Wc,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Le(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new Fd(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new qd(n))}),t}Oa(e){this.fa=e.gs,this.pa=Le();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return vr.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Al="SyncEngine";class m_{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class g_{constructor(e){this.key=e,this.Ba=!1}}class y_{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Kn(a=>od(a),Xs),this.qa=new Map,this.Qa=new Set,this.$a=new Ye(_e.comparator),this.Ua=new Map,this.Ka=new hl,this.Wa={},this.Ga=new Map,this.za=yr.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function v_(r,e,t=!0){const n=Gd(r);let i;const s=n.ka.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Na()):i=await Ud(n,e,t,!0),i}async function __(r,e){const t=Gd(r);await Ud(t,e,!0,!1)}async function Ud(r,e,t,n){const i=await $v(r.localStore,Kt(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let a;return n&&(a=await b_(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&jd(r.remoteStore,i),a}async function b_(r,e,t,n,i){r.Ha=(d,f,p)=>async function(y,g,m,b){let I=g.view.ba(m);I.ls&&(I=await Uc(y.localStore,g.query,!1).then(({documents:E})=>g.view.ba(E,I)));const v=b&&b.targetChanges.get(g.targetId),N=b&&b.targetMismatches.get(g.targetId)!=null,C=g.view.applyChanges(I,y.isPrimaryClient,v,N);return Xc(y,g.targetId,C.Ma),C.snapshot}(r,d,f,p);const s=await Uc(r.localStore,e,!0),o=new p_(e,s.gs),a=o.ba(s.documents),l=Oi.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),h=o.applyChanges(a,r.isPrimaryClient,l);Xc(r,t,h.Ma);const c=new m_(e,t,o);return r.ka.set(e,c),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),h.snapshot}async function w_(r,e,t){const n=Te(r),i=n.ka.get(e),s=n.qa.get(i.targetId);if(s.length>1)return n.qa.set(i.targetId,s.filter(o=>!Xs(o,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Pa(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&ml(n.remoteStore,i.targetId),ja(n,i.targetId)}).catch(Ar)):(ja(n,i.targetId),await Pa(n.localStore,i.targetId,!0))}async function E_(r,e){const t=Te(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),ml(t.remoteStore,n.targetId))}async function x_(r,e,t){const n=N_(r);try{const i=await function(o,a){const l=Te(o),h=it.now(),c=a.reduce((p,_)=>p.add(_.key),Le());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let _=un(),y=Le();return l.ds.getEntries(p,c).next(g=>{_=g,_.forEach((m,b)=>{b.isValidDocument()||(y=y.add(m))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,_)).next(g=>{d=g;const m=[];for(const b of a){const I=$0(b,d.get(b.key).overlayedDocument);I!=null&&m.push(new In(b.key,I,Xf(I.value.mapValue),xt.exists(!0)))}return l.mutationQueue.addMutationBatch(p,h,m,a)}).next(g=>{f=g;const m=g.applyToLocalDocumentSet(d,y);return l.documentOverlayCache.saveOverlays(p,g.batchId,m)})}).then(()=>({batchId:f.batchId,changes:ud(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let h=o.Wa[o.currentUser.toKey()];h||(h=new Ye(Ne)),h=h.insert(a,l),o.Wa[o.currentUser.toKey()]=h}(n,i.batchId,t),await Pi(n,i.changes),await oo(n.remoteStore)}catch(i){const s=bl(i,"Failed to persist write");t.reject(s)}}async function Bd(r,e){const t=Te(r);try{const n=await Dv(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Ua.get(s);o&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?$e(o.Ba):i.removedDocuments.size>0&&($e(o.Ba),o.Ba=!1))}),await Pi(t,n,e)}catch(n){await Ar(n)}}function Jc(r,e,t){const n=Te(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((s,o)=>{const a=o.view.sa(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Te(o);l.onlineState=a;let h=!1;l.queries.forEach((c,d)=>{for(const f of d.ta)f.sa(a)&&(h=!0)}),h&&xl(l)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function T_(r,e,t){const n=Te(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Ua.get(e),s=i&&i.key;if(s){let o=new Ye(_e.comparator);o=o.insert(s,yt.newNoDocument(s,Ee.min()));const a=Le().add(s),l=new ro(Ee.min(),new Map,new Ye(Ne),o,a);await Bd(n,l),n.$a=n.$a.remove(s),n.Ua.delete(e),kl(n)}else await Pa(n.localStore,e,!1).then(()=>ja(n,e,t)).catch(Ar)}async function A_(r,e){const t=Te(r),n=e.batch.batchId;try{const i=await Lv(t.localStore,e);Hd(t,n,null),zd(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Pi(t,i)}catch(i){await Ar(i)}}async function k_(r,e,t){const n=Te(r);try{const i=await function(o,a){const l=Te(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let c;return l.mutationQueue.lookupMutationBatch(h,a).next(d=>($e(d!==null),c=d.keys(),l.mutationQueue.removeMutationBatch(h,d))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,c,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,c)).next(()=>l.localDocuments.getDocuments(h,c))})}(n.localStore,e);Hd(n,e,t),zd(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Pi(n,i)}catch(i){await Ar(i)}}function zd(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Hd(r,e,t){const n=Te(r);let i=n.Wa[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function ja(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ka.br(e).forEach(n=>{r.Ka.containsKey(n)||Kd(r,n)})}function Kd(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(ml(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ua.delete(t),kl(r))}function Xc(r,e,t){for(const n of t)n instanceof qd?(r.Ka.addReference(n.key,e),S_(r,n)):n instanceof Fd?(ye(Al,"Document no longer in limbo: "+n.key),r.Ka.removeReference(n.key,e),r.Ka.containsKey(n.key)||Kd(r,n.key)):we()}function S_(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(ye(Al,"New document in limbo: "+t),r.Qa.add(n),kl(r))}function kl(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new _e(Ke.fromString(e)),n=r.za.next();r.Ua.set(n,new g_(t)),r.$a=r.$a.insert(t,n),jd(r.remoteStore,new vn(Kt(Js(t.path)),n,"TargetPurposeLimboResolution",Ws.ae))}}async function Pi(r,e,t){const n=Te(r),i=[],s=[],o=[];n.ka.isEmpty()||(n.ka.forEach((a,l)=>{o.push(n.Ha(l,e,t).then(h=>{var c;if((h||t)&&n.isPrimaryClient){const d=h?!h.fromCache:(c=t==null?void 0:t.targetChanges.get(l.targetId))===null||c===void 0?void 0:c.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){i.push(h);const d=dl.Yi(l.targetId,h);s.push(d)}}))}),await Promise.all(o),n.La.p_(i),await async function(l,h){const c=Te(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ae.forEach(h,f=>ae.forEach(f.Hi,p=>c.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>ae.forEach(f.Ji,p=>c.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!kr(d))throw d;ye(pl,"Failed to update sequence numbers: "+d)}for(const d of h){const f=d.targetId;if(!d.fromCache){const p=c.Ts.get(f),_=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(_);c.Ts=c.Ts.insert(f,y)}}}(n.localStore,s))}async function I_(r,e){const t=Te(r);if(!t.currentUser.isEqual(e)){ye(Al,"User change. New user:",e.toKey());const n=await Nd(t.localStore,e);t.currentUser=e,function(s,o){s.Ga.forEach(a=>{a.forEach(l=>{l.reject(new ge(ie.CANCELLED,o))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Pi(t,n.Rs)}}function O_(r,e){const t=Te(r),n=t.Ua.get(e);if(n&&n.Ba)return Le().add(n.key);{let i=Le();const s=t.qa.get(e);if(!s)return i;for(const o of s){const a=t.ka.get(o);i=i.unionWith(a.view.Sa)}return i}}function Gd(r){const e=Te(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=O_.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=T_.bind(null,e),e.La.p_=f_.bind(null,e.eventManager),e.La.Ja=d_.bind(null,e.eventManager),e}function N_(r){const e=Te(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=A_.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=k_.bind(null,e),e}class Ls{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=io(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return jv(this.persistence,new Pv,e.initialUser,this.serializer)}Xa(e){return new Od(fl.ri,this.serializer)}Za(e){return new Fv}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ls.provider={build:()=>new Ls};class P_ extends Ls{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){$e(this.persistence.referenceDelegate instanceof Cs);const n=this.persistence.referenceDelegate.garbageCollector;return new gv(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?kt.withCacheSize(this.cacheSizeBytes):kt.DEFAULT;return new Od(n=>Cs.ri(n,t),this.serializer)}}class La{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Jc(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=I_.bind(null,this.syncEngine),await u_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new h_}()}createDatastore(e){const t=io(e.databaseInfo.databaseId),n=function(s){return new Kv(s)}(e.databaseInfo);return function(s,o,a,l){return new Yv(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,a){return new Xv(n,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Jc(this.syncEngine,t,0),function(){return Hc.D()?new Hc:new Uv}())}createSyncEngine(e,t){return function(i,s,o,a,l,h,c){const d=new y_(i,s,o,a,l,h);return c&&(d.ja=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Te(i);ye(Hn,"RemoteStore shutting down."),s.W_.add(5),await Ni(s),s.z_.shutdown(),s.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}La.provider={build:()=>new La};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):ln("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="FirestoreClient";class R_{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=gt.UNAUTHENTICATED,this.clientId=Ff.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{ye(kn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(ye(kn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=bl(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Go(r,e){r.asyncQueue.verifyOperationInProgress(),ye(kn,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Nd(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Zc(r,e){r.asyncQueue.verifyOperationInProgress();const t=await C_(r);ye(kn,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>Gc(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>Gc(e.remoteStore,i)),r._onlineComponents=e}async function C_(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ye(kn,"Using user provided OfflineComponentProvider");try{await Go(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;dr("Error using user provided cache. Falling back to memory cache: "+t),await Go(r,new Ls)}}else ye(kn,"Using default OfflineComponentProvider"),await Go(r,new P_(void 0));return r._offlineComponents}async function Wd(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ye(kn,"Using user provided OnlineComponentProvider"),await Zc(r,r._uninitializedComponentsProvider._online)):(ye(kn,"Using default OnlineComponentProvider"),await Zc(r,new La))),r._onlineComponents}function j_(r){return Wd(r).then(e=>e.syncEngine)}async function Ds(r){const e=await Wd(r),t=e.eventManager;return t.onListen=v_.bind(null,e.syncEngine),t.onUnlisten=w_.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=__.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=E_.bind(null,e.syncEngine),t}function L_(r,e,t={}){const n=new sn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,h){const c=new Sl({next:f=>{c.su(),o.enqueueAndForget(()=>El(s,d));const p=f.docs.has(a);!p&&f.fromCache?h.reject(new ge(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?h.reject(new ge(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new Tl(Js(a.path),c,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await Ds(r),r.asyncQueue,e,t,n)),n.promise}function D_(r,e,t={}){const n=new sn;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,h){const c=new Sl({next:f=>{c.su(),o.enqueueAndForget(()=>El(s,d)),f.fromCache&&l.source==="server"?h.reject(new ge(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(f)},error:f=>h.reject(f)}),d=new Tl(a,c,{includeMetadataChanges:!0,Ta:!0});return wl(s,d)}(await Ds(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qd(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(r,e,t){if(!t)throw new ge(ie.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function M_(r,e,t,n){if(e===!0&&n===!0)throw new ge(ie.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function th(r){if(!_e.isDocumentKey(r))throw new ge(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function nh(r){if(_e.isDocumentKey(r))throw new ge(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function ao(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":we()}function Tt(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new ge(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ao(r);throw new ge(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="firestore.googleapis.com",rh=!0;class ih{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ge(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Jd,this.ssl=rh}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:rh;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Id;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pv)throw new ge(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}M_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Qd((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ge(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lo{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ih({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ih(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Ky;switch(n.type){case"firstParty":return new Yy(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ge(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=eh.get(t);n&&(ye("ComponentProvider","Removing Datastore"),eh.delete(t),n.terminate())}(this),Promise.resolve()}}function V_(r,e,t,n={}){var i;const s=(r=Tt(r,lo))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:r._getEmulatorOptions()}),a=`${e}:${t}`;s.host!==Jd&&s.host!==a&&dr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},s),{host:a,ssl:!1,emulatorOptions:n});if(!pg(l,o)&&(r._setSettings(l),n.mockUserToken)){let h,c;if(typeof n.mockUserToken=="string")h=n.mockUserToken,c=gt.MOCK_USER;else{h=mg(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new ge(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new gt(d)}r._authCredentials=new Gy(new $f(h,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new On(this.firestore,e,this._query)}}class _t{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _t(this.firestore,e,this._key)}}class bn extends On{constructor(e,t,n){super(e,t,Js(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _t(this.firestore,null,new _e(e))}withConverter(e){return new bn(this.firestore,e,this._path)}}function _r(r,e,...t){if(r=Ct(r),Yd("collection","path",e),r instanceof lo){const n=Ke.fromString(e,...t);return nh(n),new bn(r,null,n)}{if(!(r instanceof _t||r instanceof bn))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ke.fromString(e,...t));return nh(n),new bn(r.firestore,null,n)}}function Ze(r,e,...t){if(r=Ct(r),arguments.length===1&&(e=Ff.newId()),Yd("doc","path",e),r instanceof lo){const n=Ke.fromString(e,...t);return th(n),new _t(r,null,new _e(n))}{if(!(r instanceof _t||r instanceof bn))throw new ge(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ke.fromString(e,...t));return th(n),new _t(r.firestore,r instanceof bn?r.converter:null,new _e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sh="AsyncQueue";class oh{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Rd(this,"async_queue_retry"),this.Su=()=>{const n=Ko();n&&ye(sh,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const t=Ko();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=Ko();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new sn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!kr(e))throw e;ye(sh,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(n);throw ln("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.bu=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=_l.createAndSchedule(this,e,t,n,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&we()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function ah(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Yt extends lo{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new oh,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oh(e),this._firestoreClient=void 0,await e}}}function $_(r,e){const t=typeof r=="object"?r:hg(),n=typeof r=="string"?r:Ss,i=fg(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=dg("firestore");s&&V_(i,...s)}return i}function Ri(r){if(r._terminated)throw new ge(ie.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||q_(r),r._firestoreClient}function q_(r){var e,t,n;const i=r._freezeSettings(),s=function(a,l,h,c){return new h0(a,l,h,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Qd(c.experimentalLongPollingOptions),c.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new R_(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new br(ht.fromBase64String(e))}catch(t){throw new ge(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new br(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=/^__.*__$/;class U_{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new In(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ii(e,this.data,t,this.fieldTransforms)}}class Xd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new In(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Zd(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class Pl{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Pl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.$u(e),i}Uu(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:n,Qu:!1});return i.Bu(),i}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Ms(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(Zd(this.Lu)&&F_.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class B_{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||io(e)}ju(e,t,n,i=!1){return new Pl({Lu:e,methodName:t,zu:n,path:ct.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ji(r){const e=r._freezeSettings(),t=io(r._databaseId);return new B_(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Rl(r,e,t,n,i,s={}){const o=r.ju(s.merge||s.mergeFields?2:0,e,t,i);Cl("Data must be an object, but it was:",o,n);const a=np(n,o);let l,h;if(s.merge)l=new Pt(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const c=[];for(const d of s.mergeFields){const f=Da(e,d,t);if(!o.contains(f))throw new ge(ie.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);ip(c,f)||c.push(f)}l=new Pt(c),h=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,h=o.fieldTransforms;return new U_(new It(a),l,h)}class Li extends Il{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Li}}function ep(r,e,t,n){const i=r.ju(1,e,t);Cl("Data must be an object, but it was:",i,n);const s=[],o=It.empty();Sn(n,(l,h)=>{const c=jl(e,l,t);h=Ct(h);const d=i.Uu(c);if(h instanceof Li)s.push(c);else{const f=Di(h,d);f!=null&&(s.push(c),o.set(c,f))}});const a=new Pt(s);return new Xd(o,a,i.fieldTransforms)}function tp(r,e,t,n,i,s){const o=r.ju(1,e,t),a=[Da(e,n,t)],l=[i];if(s.length%2!=0)throw new ge(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)a.push(Da(e,s[f])),l.push(s[f+1]);const h=[],c=It.empty();for(let f=a.length-1;f>=0;--f)if(!ip(h,a[f])){const p=a[f];let _=l[f];_=Ct(_);const y=o.Uu(p);if(_ instanceof Li)h.push(p);else{const g=Di(_,y);g!=null&&(h.push(p),c.set(p,g))}}const d=new Pt(h);return new Xd(c,d,o.fieldTransforms)}function z_(r,e,t,n=!1){return Di(t,r.ju(n?4:3,e))}function Di(r,e){if(rp(r=Ct(r)))return Cl("Unsupported field value:",e,r),np(r,e);if(r instanceof Il)return function(n,i){if(!Zd(i.Lu))throw i.Wu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const a of n){let l=Di(a,i.Ku(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Ct(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return C0(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=it.fromDate(n);return{timestampValue:Rs(i.serializer,s)}}if(n instanceof it){const s=new it(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Rs(i.serializer,s)}}if(n instanceof Ol)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof br)return{bytesValue:wd(i.serializer,n._byteString)};if(n instanceof _t){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:cl(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Nl)return function(o,a){return{mapValue:{fields:{[Qf]:{stringValue:Jf},[Is]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw a.Wu("VectorValues must only contain numeric values.");return al(a.serializer,h)})}}}}}}(n,i);throw i.Wu(`Unsupported field value: ${ao(n)}`)}(r,e)}function np(r,e){const t={};return Bf(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sn(r,(n,i)=>{const s=Di(i,e.qu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function rp(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof it||r instanceof Ol||r instanceof br||r instanceof _t||r instanceof Il||r instanceof Nl)}function Cl(r,e,t){if(!rp(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=ao(t);throw n==="an object"?e.Wu(r+" a custom object"):e.Wu(r+" "+n)}}function Da(r,e,t){if((e=Ct(e))instanceof Ci)return e._internalPath;if(typeof e=="string")return jl(r,e);throw Ms("Field path arguments must be of type string or ",r,!1,void 0,t)}const H_=new RegExp("[~\\*/\\[\\]]");function jl(r,e,t){if(e.search(H_)>=0)throw Ms(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Ci(...e.split("."))._internalPath}catch{throw Ms(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Ms(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${i}`),l+=")"),new ge(ie.INVALID_ARGUMENT,a+r+l)}function ip(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _t(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new K_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ll("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class K_ extends sp{data(){return super.data()}}function Ll(r,e){return typeof e=="string"?jl(r,e):e instanceof Ci?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new ge(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Dl{}class ap extends Dl{}function uo(r,e,...t){let n=[];e instanceof Dl&&n.push(e),n=n.concat(t),function(s){const o=s.filter(l=>l instanceof Vl).length,a=s.filter(l=>l instanceof Ml).length;if(o>1||o>0&&a>0)throw new ge(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Ml extends ap{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ml(e,t,n)}_apply(e){const t=this._parse(e);return lp(e._query,t),new On(e.firestore,e.converter,Aa(e._query,t))}_parse(e){const t=ji(e.firestore);return function(s,o,a,l,h,c,d){let f;if(h.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){uh(d,c);const _=[];for(const y of d)_.push(lh(l,s,y));f={arrayValue:{values:_}}}else f=lh(l,s,d)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||uh(d,c),f=z_(a,o,d,c==="in"||c==="not-in");return rt.create(h,c,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Vl extends Dl{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vl(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:qt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)lp(o,l),o=Aa(o,l)}(e._query,t),new On(e.firestore,e.converter,Aa(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class $l extends ap{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new $l(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new ge(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xi(s,o)}(e._query,this._field,this._direction);return new On(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Sr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function co(r,e="asc"){const t=e,n=Ll("orderBy",r);return $l._create(n,t)}function lh(r,e,t){if(typeof(t=Ct(t))=="string"){if(t==="")throw new ge(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sd(e)&&t.indexOf("/")!==-1)throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Ke.fromString(t));if(!_e.isDocumentKey(n))throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return xc(r,new _e(n))}if(t instanceof _t)return xc(r,t._key);throw new ge(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ao(t)}.`)}function uh(r,e){if(!Array.isArray(r)||r.length===0)throw new ge(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lp(r,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class G_{convertValue(e,t="none"){switch(Tn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Sn(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Is].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Xe(o.doubleValue));return new Nl(s)}convertGeoPoint(e){return new Ol(Xe(e.latitude),Xe(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ys(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(bi(e));default:return null}}convertTimestamp(e){const t=En(e);return new it(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ke.fromString(e);$e(Sd(n));const i=new wi(n.get(1),n.get(3)),s=new _e(n.popFirst(5));return i.isEqual(t)||ln(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class up extends sp{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xs(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ll("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class xs extends up{data(e={}){return super.data(e)}}class cp{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ui(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new xs(this._firestore,this._userDataWriter,n.key,n,new ui(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new xs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ui(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new xs(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ui(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,c=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),c=o.indexOf(a.doc.key)),{type:W_(a.type),doc:l,oldIndex:h,newIndex:c}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function W_(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(r){r=Tt(r,_t);const e=Tt(r.firestore,Yt);return L_(Ri(e),r._key).then(t=>hp(e,r,t))}class Fl extends G_{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _t(this.firestore,null,t)}}function Mi(r){r=Tt(r,On);const e=Tt(r.firestore,Yt),t=Ri(e),n=new Fl(e);return op(r._query),D_(t,r._query).then(i=>new cp(e,n,r,i))}function Ma(r,e,t){r=Tt(r,_t);const n=Tt(r.firestore,Yt),i=ql(r.converter,e,t);return Vi(n,[Rl(ji(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,xt.none())])}function Vs(r,e,t,...n){r=Tt(r,_t);const i=Tt(r.firestore,Yt),s=ji(i);let o;return o=typeof(e=Ct(e))=="string"||e instanceof Ci?tp(s,"updateDoc",r._key,e,t,n):ep(s,"updateDoc",r._key,e),Vi(i,[o.toMutation(r._key,xt.exists(!0))])}function Ul(r){return Vi(Tt(r.firestore,Yt),[new no(r._key,xt.none())])}function Bl(r,e){const t=Tt(r.firestore,Yt),n=Ze(r),i=ql(r.converter,e);return Vi(t,[Rl(ji(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,xt.exists(!1))]).then(()=>n)}function zl(r,...e){var t,n,i;r=Ct(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||ah(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ah(e[o])){const d=e[o];e[o]=(t=d.next)===null||t===void 0?void 0:t.bind(d),e[o+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let l,h,c;if(r instanceof _t)h=Tt(r.firestore,Yt),c=Js(r._key.path),l={next:d=>{e[o]&&e[o](hp(h,r,d))},error:e[o+1],complete:e[o+2]};else{const d=Tt(r,On);h=Tt(d.firestore,Yt),c=d._query;const f=new Fl(h);l={next:p=>{e[o]&&e[o](new cp(h,f,d,p))},error:e[o+1],complete:e[o+2]},op(r._query)}return function(f,p,_,y){const g=new Sl(y),m=new Tl(p,g,_);return f.asyncQueue.enqueueAndForget(async()=>wl(await Ds(f),m)),()=>{g.su(),f.asyncQueue.enqueueAndForget(async()=>El(await Ds(f),m))}}(Ri(h),c,a,l)}function Vi(r,e){return function(n,i){const s=new sn;return n.asyncQueue.enqueueAndForget(async()=>x_(await j_(n),i,s)),s.promise}(Ri(r),e)}function hp(r,e,t){const n=t.docs.get(e._key),i=new Fl(r);return new up(r,i,e._key,n,new ui(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ji(e)}set(e,t,n){this._verifyNotCommitted();const i=Wo(e,this._firestore),s=ql(i.converter,t,n),o=Rl(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,xt.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Wo(e,this._firestore);let o;return o=typeof(t=Ct(t))=="string"||t instanceof Ci?tp(this._dataReader,"WriteBatch.update",s._key,t,n,i):ep(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,xt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Wo(e,this._firestore);return this._mutations=this._mutations.concat(new no(t._key,xt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Wo(r,e){if((r=Ct(r)).firestore!==e)throw new ge(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(){return new Li("deleteField")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(r){return Ri(r=Tt(r,Yt)),new Y_(r,e=>Vi(r,e))}(function(e,t=!0){(function(i){Tr=i})(gg),ag(new lg("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),a=new Yt(new Wy(n.getProvider("auth-internal")),new Jy(o,n.getProvider("app-check-internal")),function(h,c){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ge(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wi(h.options.projectId,c)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),tc(hc,fc,e),tc(hc,fc,"esm2017")})();const X_={apiKey:"AIzaSyAsGrtbRSjz77iShv4tB0vQ33A23ie9JM8",authDomain:"tiger3homs-f3a5f-d60da.firebaseapp.com",projectId:"tiger3homs-f3a5f-d60da",storageBucket:"tiger3homs-f3a5f-d60da.firebasestorage.app",messagingSenderId:"509990310606",appId:"1:509990310606:web:e36d91ea748c4cd64d369f",measurementId:"G-DDZTZ6MR6S"};let Qo=null,Mt=null,ve=null;try{Qo=_g(X_),Mt=bg(Qo),ve=$_(Qo)}catch(r){throw console.error("Firebase initialization error:",r),new Error(`Firebase initialization failed: ${r instanceof Error?r.message:String(r)}`)}if(!ve)throw new Error("Firestore failed to initialize and is null.");const Vt={en:{generalInfo:{title:"General Information",siteTitle:"Tiger3Homs",siteRole:"Website Developer & Tech Enthusiast",logoUrl:"https://raw.githubusercontent.com/tiger3homs/home/refs/heads/main/public/logo.png",footerText:"© 2025. Built and designed by Tiger3homs"},about:{title:"About Me",description:"I'm a passionate software developer with expertise in web development and system architecture. I love building efficient, scalable solutions and contributing to open-source projects. When I'm not coding, you can find me exploring new technologies and sharing knowledge with the developer community."},projects:{title:"Featured Projects",project1:{title:"OS Design v1",description:"The website offers a sleek, intuitive design with straightforward navigation and professional fonts. It highlights the company's services and expertise, making it easy for visitors to get in touch. Simple visuals and effective calls-to-action ensure a smooth and engaging experience. For more information, explore the site.",tags:["Modern","User-friendly","Professional"],link:""},project2:{title:"Project 2",description:"Coming soon.",tags:["Wait","For","It"],link:""},project3:{title:"New Project",description:"This is a new project description.",tags:["New","Exciting","Innovative"],link:""}},contact:{title:"Contact Me",nameLabel:"Name",namePlaceholder:"Enter your name",emailLabel:"Email",emailPlaceholder:"Enter your email",messageLabel:"Message",messagePlaceholder:"Enter your message",submitButton:"Send Message"},services:{title:"Services",list:[{title:"Web Development",description:"Building modern, responsive websites tailored to your needs."},{title:"UI/UX Design",description:"Crafting user-friendly and visually appealing designs."},{title:"SEO Optimization",description:"Improving your website's visibility on search engines."},{title:"Consulting",description:"Providing expert advice to help you achieve your goals."}]}}},Z_=r=>{const t=/[A-Z]/.test(r),n=/[a-z]/.test(r),i=/\d/.test(r),s=/[!@#$%^&*(),.?":{}|<>]/.test(r);return r.length>=8&&t&&n&&i&&s},e1=()=>{const[r,e]=te.useState(""),[t,n]=te.useState(""),[i,s]=te.useState(""),[o,a]=te.useState(!1),l=gf();te.useEffect(()=>{const c=setTimeout(()=>{Mt&&Mt.signOut()},18e5);return()=>clearTimeout(c)},[]),te.useEffect(()=>{if(!Mt)return;const c=vf(Mt,d=>{d&&l("/admin/dashboard",{replace:!0})});return()=>c()},[l]);const h=async c=>{if(c.preventDefault(),s(""),a(!0),!r.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)){s("Please enter a valid email address"),a(!1);return}if(!Z_(t)){s("Password must be at least 8 characters long and contain uppercase, lowercase, numbers, and special characters"),a(!1);return}if(!Mt){s("Authentication service is not available."),a(!1);return}try{await wg(Mt,r,t)}catch(d){let f="Failed to log in. Please check your credentials.";if(d.code)switch(d.code){case"auth/user-not-found":case"auth/wrong-password":case"auth/invalid-credential":f="Invalid email or password.";break;case"auth/invalid-email":f="Invalid email format.";break;case"auth/too-many-requests":f="Too many failed attempts. Please try again later.";break;default:console.error("Firebase Login error:",d)}s(f)}finally{a(!1)}};return P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:P.jsxs("div",{className:"p-8 bg-white rounded shadow-md w-full max-w-sm",children:[P.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Admin Login"}),P.jsxs("form",{onSubmit:h,children:[P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),P.jsx("input",{type:"email",id:"email",value:r,onChange:c=>e(c.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"password",children:"Password"}),P.jsx("input",{type:"password",id:"password",value:t,onChange:c=>n(c.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,disabled:o})]}),i&&P.jsx("p",{className:"text-red-500 text-xs italic mb-4",children:i}),P.jsx("div",{className:"flex items-center justify-between",children:P.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full disabled:opacity-50",disabled:o,children:o?"Logging in...":"Login"})})]})]})})},t1=({message:r,type:e})=>{if(!r||!e)return null;const t=e==="success"?"bg-green-500":"bg-red-500",n=e==="success"?P.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):P.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});return P.jsxs("div",{className:`fixed bottom-5 right-5 ${t} text-white px-4 py-2 rounded-md shadow-lg flex items-center z-[100] transition-opacity duration-300 animate-fade-in-out max-w-sm`,children:[n,P.jsx("span",{children:r})]})},n1=({isOpen:r,message:e,onConfirm:t,onCancel:n,confirmText:i="Confirm",cancelText:s="Cancel",title:o="Confirm Action"})=>r?P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4",children:P.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-sm w-full",children:[P.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:o}),P.jsx("p",{className:"text-sm text-gray-600 mb-6 whitespace-pre-wrap",children:e}),P.jsxs("div",{className:"flex justify-end space-x-3",children:[P.jsx("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors text-sm",children:s}),P.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:i})]})]})}):null,fp=te.createContext(void 0),Or=()=>{const r=te.useContext(fp);if(!r)throw new Error("useNotifications must be used within a NotificationProvider");return r},dp=({children:r})=>{const[e,t]=te.useState(null),[n,i]=te.useState(null),s=te.useRef(null),[o,a]=te.useState(null),[l,h]=te.useState(!1),c=te.useCallback((y,g="success",m=3e3)=>{s.current&&clearTimeout(s.current),t(y),i(g),s.current=setTimeout(()=>{t(null),i(null),s.current=null},m)},[]);te.useEffect(()=>()=>{s.current&&clearTimeout(s.current)},[]);const d=te.useCallback(y=>{a(y),h(!0)},[]),f=()=>{o!=null&&o.onConfirm&&o.onConfirm(),h(!1),a(null)},p=()=>{h(!1),a(null)},_={showToast:c,requestConfirmation:d};return P.jsxs(fp.Provider,{value:_,children:[r,P.jsx(t1,{message:e,type:n}),o&&P.jsx(n1,{isOpen:l,message:o.message,onConfirm:f,onCancel:p,confirmText:o.confirmText||"Confirm Delete",cancelText:o.cancelText,title:o.title})]})},r1={title:"New Project Title",description:"New project description.",tags:["Tag1","Tag2"],link:""},hr=(r,e,t,n,i,s,o)=>e.length===1&&e[0]==="projects"&&typeof r=="object"&&r!==null&&!Array.isArray(r)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsxs("div",{className:"flex justify-between items-center mb-3",children:[P.jsx("h4",{className:"text-lg font-semibold capitalize",children:String(e[0]).replace(/([A-Z])/g," $1")}),s&&P.jsx("button",{onClick:s,className:"bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded focus:outline-none focus:shadow-outline",children:"+ Add Project"})]}),Object.entries(r).map(([a,l])=>{if(a!=="title"&&typeof l=="object"&&l!==null&&!Array.isArray(l)){const h=[...e,a];return P.jsxs("div",{className:"mb-6 p-4 bg-white border border-gray-200 rounded-lg shadow-sm relative",children:[P.jsxs("div",{className:"flex justify-between items-start mb-3",children:[" ",P.jsxs("h5",{className:"text-lg font-semibold text-gray-700 mr-4",children:["Project: ",P.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:a})]}),o&&P.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete project "${a}"?`)&&o(h)},className:"bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete project ${a}`,children:"Delete Project"})]}),P.jsxs("div",{className:"space-y-4",children:[" ",hr(l,h,t,n,i,void 0,void 0)]})]},h.join("."))}else if(a==="title"&&typeof l=="string"){const h=[...e,a],c=h.join("."),d=n===c;return P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?P.jsx("input",{type:"text",id:c,name:c,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2",value:l,onChange:f=>t(h,f.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"mt-1 block w-full rounded-md border border-transparent p-2 cursor-pointer hover:bg-gray-100 min-h-[38px]",onClick:()=>i(c),children:l||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},c)}return null})]},e.join(".")):Object.entries(r).map(([a,l])=>{const h=[...e,a],c=h.map(String).join("."),d=n===c;return typeof l=="string"?P.jsxs("div",{className:"mb-4 px-1 sm:px-0",children:[P.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:a.replace(/([A-Z])/g," $1")}),d?P.jsx("textarea",{id:c,name:c,rows:l.length>100?4:2,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:l,onChange:f=>t(h,f.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[50px] whitespace-pre-wrap text-gray-800",onClick:()=>i(c),children:l||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},c):typeof l=="object"&&l!==null&&!Array.isArray(l)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize",children:String(a).replace(/([A-Z])/g," $1")}),hr(l,h,t,n,i)]},c):Array.isArray(l)?P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-white shadow-sm",children:[P.jsx("h4",{className:"text-lg font-semibold mb-3 capitalize text-gray-700",children:String(a).replace(/([A-Z])/g," $1")}),P.jsxs("div",{className:"space-y-3",children:[" ",l.map((f,p)=>{const _=[...h,p],y=_.map(String).join("."),g=n===y;return typeof f=="string"?P.jsxs("div",{className:"flex items-center space-x-2",children:[g?P.jsx("input",{type:"text",id:y,name:y,className:"flex-grow rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white",value:f,onChange:m=>t(_,m.target.value),onBlur:()=>i(null),autoFocus:!0}):P.jsx("div",{className:"flex-grow rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[38px] text-gray-800",onClick:()=>i(y),children:f||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})}),o&&P.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to delete this item?")&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete item ${p+1}`,children:"Delete"})]},y):typeof f=="object"&&f!==null?P.jsxs("div",{className:"mb-4 p-3 border border-gray-100 rounded relative",children:[" ",P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[" ",P.jsxs("h5",{className:"text-md font-medium",children:["Item ",p+1]}),o&&P.jsx("button",{onClick:()=>{window.confirm(`Are you sure you want to delete Item ${p+1}?`)&&o(_)},className:"bg-red-400 hover:bg-red-600 text-white text-xs font-bold py-0.5 px-1.5 rounded focus:outline-none focus:shadow-outline","aria-label":`Delete item ${p+1}`,children:"Delete"})]}),hr(f,_,t,n,i,void 0,o)]},y):null})]})," "]},c):null}),i1=(r,e,t)=>{if(!e||e.length===0)return r;const n=JSON.parse(JSON.stringify(r));let i=n;for(let o=0;o<e.length-1;o++){const a=e[o];if(i[a]===void 0||i[a]===null){const l=typeof e[o+1]=="number";i[a]=l?[]:{}}if(Array.isArray(i)&&typeof a=="number")for(;i.length<=a;)i.push(null);i=i[a]}const s=e[e.length-1];return typeof i!="object"||i===null?(console.error("Cannot set property on non-object:",i,"at path",e),r):(i[s]=t,n)},as=r=>r.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()),s1=r=>r===null?!1:r in Vt.en,ni="translations/en",o1={title:"New Service Title",description:"New service description."},a1=()=>{var _;const[r,e]=te.useState(Vt),[t,n]=te.useState(!0),[i,s]=te.useState(""),{showToast:o}=Or();te.useEffect(()=>{if(!ve){console.error("Firestore instance is not available."),s("Error: Firestore connection failed."),n(!1);return}const y=Ze(ve,ni);n(!0);const g=zl(y,m=>{if(m.exists()){const b=m.data();e(I=>({...I,en:b}))}else e(Vt),console.log("No translations document found in Firestore, using defaults.");n(!1)},m=>{console.error("Firestore snapshot error:",m),s("Error fetching data from Firestore."),n(!1)});return()=>g()},[]);const a=te.useCallback((y,g)=>{e(m=>{const b="en";if(!y||y.length===0)return m;const I=i1(m[b],y,g);return{...m,[b]:I}}),s("")},[]),l=te.useCallback(()=>{e(y=>{const g=`project_${Date.now()}`,m={...y.en};return(typeof m.projects!="object"||m.projects===null)&&(m.projects={title:Vt.en.projects.title}),m.projects[g]={...r1},{...y,en:m}}),s("New project added. Edit details and save.")},[]),h=te.useCallback(()=>{e(y=>{var v;const g=(v=y.en)==null?void 0:v.services,b=[...Array.isArray(g==null?void 0:g.list)?g.list:[],{...o1}],I={...y.en,services:{...g||{title:Vt.en.services.title||"Services",list:[]},list:b}};return{...y,en:I}}),s("New service added. Edit details and save.")},[]),c=async y=>{const g=y||r.en;if(!ve){s("Error: Firestore connection failed.");return}s("Saving...");try{const m=Ze(ve,ni);await Ma(m,g,{merge:!0}),o("Content changes saved successfully!","success"),s("")}catch(m){console.error("Failed to save translations to Firestore:",m),o("Error saving content changes.","error"),s("")}finally{}},d=async y=>{if(!ve){s("Error: Firestore connection failed.");return}s("Deleting item...");const g=Ze(ve,ni);try{await Vs(g,{[y]:J_()}),o("Item deleted successfully!","success"),s("")}catch(m){console.error("Failed to delete item from Firestore:",m),o("Error deleting item.","error"),s("")}},f=te.useCallback(async y=>{var g;if(!y||y.length<1){console.error("Invalid path for deletion:",y),s("Error: Invalid deletion path.");return}if(y[0]==="services"&&y[1]==="list"&&typeof y[2]=="number"){const m=y[2],b=(g=r.en.services)==null?void 0:g.list;if(!Array.isArray(b)){console.error("Cannot delete service item: services.list is not an array or is missing.",b),s("Error: Services data structure issue.");return}const I=b.filter((N,C)=>C!==m);if(!ve){s("Error: Firestore connection failed.");return}s("Deleting service item...");const v=Ze(ve,ni);try{await Vs(v,{"services.list":I}),o("Service item deleted.","success"),s("")}catch(N){console.error("Failed to update services list in Firestore:",N),o("Error deleting service item.","error"),s("")}}else{const m=y.join(".");if(!m){console.error("Generated empty field path for deletion:",y),s("Error: Could not determine field to delete.");return}await d(m)}},[(_=r.en.services)==null?void 0:_.list]);return{translations:r,isLoading:t,saveStatus:i,setSaveStatus:s,setTranslations:e,handleInputChange:a,handleAddNewProject:l,handleAddNewService:h,saveChanges:c,handleDeleteItem:f,resetToDefaults:async()=>{if(!ve){s("Error: Firestore connection failed.");return}if(window.confirm("Are you sure you want to reset the English text content (About, Contact, Services, General Info) to the default values? This cannot be undone and does not affect Projects, Styles, or Social Links.")){s("Resetting...");const y={...Vt.en,projects:r.en.projects};try{const g=Ze(ve,ni);await Ma(g,y),o("Text content sections reset to defaults.","success"),s("")}catch(g){console.error("Failed to reset translations in Firestore:",g),o("Error resetting content.","error"),s("")}}}}},l1=({data:r,path:e,handleChange:t,editingPath:n,setEditingPath:i,handleAddProject:s,handleDelete:o,renderFields:a})=>{const{requestConfirmation:l}=Or();return P.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded",children:[P.jsxs("div",{className:"flex justify-between items-center mb-3",children:[P.jsx("h4",{className:"text-lg font-semibold capitalize",children:(r==null?void 0:r.title)||String(e[0]).replace(/([A-Z])/g," $1")}),P.jsx("button",{onClick:s,className:"bg-blue-500 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded focus:outline-none focus:shadow-outline",children:"+ Add Project"})]}),(r==null?void 0:r.title)!==void 0&&typeof r.title=="string"&&a({title:r.title},e,t,n,i,void 0,void 0),Object.entries(r).map(([h,c])=>{if(h!=="title"&&typeof c=="object"&&c!==null&&!Array.isArray(c)){const d=[...e,h];return P.jsxs("div",{className:"mb-6 p-4 bg-white border border-gray-200 rounded-lg shadow-sm relative",children:[P.jsxs("div",{className:"flex justify-between items-start mb-3",children:[P.jsxs("h5",{className:"text-lg font-semibold text-gray-700 mr-4",children:["Project: ",P.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:h})]}),P.jsx("button",{onClick:()=>{l({message:`Are you sure you want to delete project "${h}"?
This action cannot be undone.`,onConfirm:()=>o(d),confirmText:"Delete Project",title:"Confirm Deletion"})},className:"bg-red-500 hover:bg-red-600 text-white text-xs font-bold py-1 px-2 rounded focus:outline-none focus:shadow-outline transition-colors duration-150","aria-label":`Delete project ${h}`,children:"Delete Project"})]}),P.jsx("div",{className:"space-y-4",children:a(c,d,t,n,i,void 0,o)})]},d.join("."))}return null})]},e.join("."))},u1=({data:r,path:e,handleChange:t,editingPath:n,setEditingPath:i,handleDelete:s,handleAddService:o,renderFields:a})=>!r||typeof r!="object"?P.jsx("p",{children:"Error: Services data is missing or invalid."}):(Array.isArray(r.list)||console.warn("Services data is missing 'list' array."),P.jsxs(P.Fragment,{children:[P.jsx("button",{onClick:o,className:"mb-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-700 focus:ring-opacity-50","aria-label":"Add new service item",children:"Add New Service Item"}),a(r,e,t,n,i,void 0,s)]})),{min:c1,max:h1}=Math,Bn=(r,e=0,t=1)=>c1(h1(e,r),t),Hl=r=>{r._clipped=!1,r._unclipped=r.slice(0);for(let e=0;e<=3;e++)e<3?((r[e]<0||r[e]>255)&&(r._clipped=!0),r[e]=Bn(r[e],0,255)):e===3&&(r[e]=Bn(r[e],0,1));return r},pp={};for(let r of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])pp[`[object ${r}]`]=r.toLowerCase();function Pe(r){return pp[Object.prototype.toString.call(r)]||"object"}const Se=(r,e=null)=>r.length>=3?Array.prototype.slice.call(r):Pe(r[0])=="object"&&e?e.split("").filter(t=>r[0][t]!==void 0).map(t=>r[0][t]):r[0].slice(0),Nr=r=>{if(r.length<2)return null;const e=r.length-1;return Pe(r[e])=="string"?r[e].toLowerCase():null},{PI:ho,min:mp,max:gp}=Math,Rt=r=>Math.round(r*100)/100,$a=r=>Math.round(r*100)/100,tn=ho*2,Yo=ho/3,f1=ho/180,d1=180/ho;function yp(r){return[...r.slice(0,3).reverse(),...r.slice(3)]}const ke={format:{},autodetect:[]};class le{constructor(...e){const t=this;if(Pe(e[0])==="object"&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];let n=Nr(e),i=!1;if(!n){i=!0,ke.sorted||(ke.autodetect=ke.autodetect.sort((s,o)=>o.p-s.p),ke.sorted=!0);for(let s of ke.autodetect)if(n=s.test(...e),n)break}if(ke.format[n]){const s=ke.format[n].apply(null,i?e:e.slice(0,-1));t._rgb=Hl(s)}else throw new Error("unknown format: "+e);t._rgb.length===3&&t._rgb.push(1)}toString(){return Pe(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const p1="3.1.2",Oe=(...r)=>new le(...r);Oe.version=p1;const wr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},m1=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,g1=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,vp=r=>{if(r.match(m1)){(r.length===4||r.length===7)&&(r=r.substr(1)),r.length===3&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]);const e=parseInt(r,16),t=e>>16,n=e>>8&255,i=e&255;return[t,n,i,1]}if(r.match(g1)){(r.length===5||r.length===9)&&(r=r.substr(1)),r.length===4&&(r=r.split(""),r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]);const e=parseInt(r,16),t=e>>24&255,n=e>>16&255,i=e>>8&255,s=Math.round((e&255)/255*100)/100;return[t,n,i,s]}throw new Error(`unknown hex color: ${r}`)},{round:ls}=Math,_p=(...r)=>{let[e,t,n,i]=Se(r,"rgba"),s=Nr(r)||"auto";i===void 0&&(i=1),s==="auto"&&(s=i<1?"rgba":"rgb"),e=ls(e),t=ls(t),n=ls(n);let a="000000"+(e<<16|t<<8|n).toString(16);a=a.substr(a.length-6);let l="0"+ls(i*255).toString(16);switch(l=l.substr(l.length-2),s.toLowerCase()){case"rgba":return`#${a}${l}`;case"argb":return`#${l}${a}`;default:return`#${a}`}};le.prototype.name=function(){const r=_p(this._rgb,"rgb");for(let e of Object.keys(wr))if(wr[e]===r)return e.toLowerCase();return r};ke.format.named=r=>{if(r=r.toLowerCase(),wr[r])return vp(wr[r]);throw new Error("unknown color name: "+r)};ke.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Pe(r)==="string"&&wr[r.toLowerCase()])return"named"}});le.prototype.alpha=function(r,e=!1){return r!==void 0&&Pe(r)==="number"?e?(this._rgb[3]=r,this):new le([this._rgb[0],this._rgb[1],this._rgb[2],r],"rgb"):this._rgb[3]};le.prototype.clipped=function(){return this._rgb._clipped||!1};const Wt={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},y1=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function rn(r){const e=y1.get(String(r).toLowerCase());if(!e)throw new Error("unknown Lab illuminant "+r);Wt.labWhitePoint=r,Wt.Xn=e[0],Wt.Zn=e[1]}function ki(){return Wt.labWhitePoint}const Kl=(...r)=>{r=Se(r,"lab");const[e,t,n]=r,[i,s,o]=v1(e,t,n),[a,l,h]=bp(i,s,o);return[a,l,h,r.length>3?r[3]:1]},v1=(r,e,t)=>{const{kE:n,kK:i,kKE:s,Xn:o,Yn:a,Zn:l}=Wt,h=(r+16)/116,c=.002*e+h,d=h-.005*t,f=c*c*c,p=d*d*d,_=f>n?f:(116*c-16)/i,y=r>s?Math.pow((r+16)/116,3):r/i,g=p>n?p:(116*d-16)/i,m=_*o,b=y*a,I=g*l;return[m,b,I]},Jo=r=>{const e=Math.sign(r);return r=Math.abs(r),(r<=.0031308?r*12.92:1.055*Math.pow(r,1/2.4)-.055)*e},bp=(r,e,t)=>{const{MtxAdaptMa:n,MtxAdaptMaI:i,MtxXYZ2RGB:s,RefWhiteRGB:o,Xn:a,Yn:l,Zn:h}=Wt,c=a*n.m00+l*n.m10+h*n.m20,d=a*n.m01+l*n.m11+h*n.m21,f=a*n.m02+l*n.m12+h*n.m22,p=o.X*n.m00+o.Y*n.m10+o.Z*n.m20,_=o.X*n.m01+o.Y*n.m11+o.Z*n.m21,y=o.X*n.m02+o.Y*n.m12+o.Z*n.m22,g=(r*n.m00+e*n.m10+t*n.m20)*(p/c),m=(r*n.m01+e*n.m11+t*n.m21)*(_/d),b=(r*n.m02+e*n.m12+t*n.m22)*(y/f),I=g*i.m00+m*i.m10+b*i.m20,v=g*i.m01+m*i.m11+b*i.m21,N=g*i.m02+m*i.m12+b*i.m22,C=Jo(I*s.m00+v*s.m10+N*s.m20),E=Jo(I*s.m01+v*s.m11+N*s.m21),w=Jo(I*s.m02+v*s.m12+N*s.m22);return[C*255,E*255,w*255]},Gl=(...r)=>{const[e,t,n,...i]=Se(r,"rgb"),[s,o,a]=wp(e,t,n),[l,h,c]=_1(s,o,a);return[l,h,c,...i.length>0&&i[0]<1?[i[0]]:[]]};function _1(r,e,t){const{Xn:n,Yn:i,Zn:s,kE:o,kK:a}=Wt,l=r/n,h=e/i,c=t/s,d=l>o?Math.pow(l,1/3):(a*l+16)/116,f=h>o?Math.pow(h,1/3):(a*h+16)/116,p=c>o?Math.pow(c,1/3):(a*c+16)/116;return[116*f-16,500*(d-f),200*(f-p)]}function Xo(r){const e=Math.sign(r);return r=Math.abs(r),(r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4))*e}const wp=(r,e,t)=>{r=Xo(r/255),e=Xo(e/255),t=Xo(t/255);const{MtxRGB2XYZ:n,MtxAdaptMa:i,MtxAdaptMaI:s,Xn:o,Yn:a,Zn:l,As:h,Bs:c,Cs:d}=Wt;let f=r*n.m00+e*n.m10+t*n.m20,p=r*n.m01+e*n.m11+t*n.m21,_=r*n.m02+e*n.m12+t*n.m22;const y=o*i.m00+a*i.m10+l*i.m20,g=o*i.m01+a*i.m11+l*i.m21,m=o*i.m02+a*i.m12+l*i.m22;let b=f*i.m00+p*i.m10+_*i.m20,I=f*i.m01+p*i.m11+_*i.m21,v=f*i.m02+p*i.m12+_*i.m22;return b*=y/h,I*=g/c,v*=m/d,f=b*s.m00+I*s.m10+v*s.m20,p=b*s.m01+I*s.m11+v*s.m21,_=b*s.m02+I*s.m12+v*s.m22,[f,p,_]};le.prototype.lab=function(){return Gl(this._rgb)};const b1=(...r)=>new le(...r,"lab");Object.assign(Oe,{lab:b1,getLabWhitePoint:ki,setLabWhitePoint:rn});ke.format.lab=Kl;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"lab"),Pe(r)==="array"&&r.length===3)return"lab"}});le.prototype.darken=function(r=1){const e=this,t=e.lab();return t[0]-=Wt.Kn*r,new le(t,"lab").alpha(e.alpha(),!0)};le.prototype.brighten=function(r=1){return this.darken(-r)};le.prototype.darker=le.prototype.darken;le.prototype.brighter=le.prototype.brighten;le.prototype.get=function(r){const[e,t]=r.split("."),n=this[e]();if(t){const i=e.indexOf(t)-(e.substr(0,2)==="ok"?2:0);if(i>-1)return n[i];throw new Error(`unknown channel ${t} in mode ${e}`)}else return n};const{pow:w1}=Math,E1=1e-7,x1=20;le.prototype.luminance=function(r,e="rgb"){if(r!==void 0&&Pe(r)==="number"){if(r===0)return new le([0,0,0,this._rgb[3]],"rgb");if(r===1)return new le([255,255,255,this._rgb[3]],"rgb");let t=this.luminance(),n=x1;const i=(o,a)=>{const l=o.interpolate(a,.5,e),h=l.luminance();return Math.abs(r-h)<E1||!n--?l:h>r?i(o,l):i(l,a)},s=(t>r?i(new le([0,0,0]),this):i(this,new le([255,255,255]))).rgb();return new le([...s,this._rgb[3]])}return T1(...this._rgb.slice(0,3))};const T1=(r,e,t)=>(r=Zo(r),e=Zo(e),t=Zo(t),.2126*r+.7152*e+.0722*t),Zo=r=>(r/=255,r<=.03928?r/12.92:w1((r+.055)/1.055,2.4)),vt={},Er=(r,e,t=.5,...n)=>{let i=n[0]||"lrgb";if(!vt[i]&&!n.length&&(i=Object.keys(vt)[0]),!vt[i])throw new Error(`interpolation mode ${i} is not defined`);return Pe(r)!=="object"&&(r=new le(r)),Pe(e)!=="object"&&(e=new le(e)),vt[i](r,e,t).alpha(r.alpha()+t*(e.alpha()-r.alpha()))};le.prototype.mix=le.prototype.interpolate=function(r,e=.5,...t){return Er(this,r,e,...t)};le.prototype.premultiply=function(r=!1){const e=this._rgb,t=e[3];return r?(this._rgb=[e[0]*t,e[1]*t,e[2]*t,t],this):new le([e[0]*t,e[1]*t,e[2]*t,t],"rgb")};const{sin:A1,cos:k1}=Math,Ep=(...r)=>{let[e,t,n]=Se(r,"lch");return isNaN(n)&&(n=0),n=n*f1,[e,k1(n)*t,A1(n)*t]},Wl=(...r)=>{r=Se(r,"lch");const[e,t,n]=r,[i,s,o]=Ep(e,t,n),[a,l,h]=Kl(i,s,o);return[a,l,h,r.length>3?r[3]:1]},S1=(...r)=>{const e=yp(Se(r,"hcl"));return Wl(...e)},{sqrt:I1,atan2:O1,round:N1}=Math,xp=(...r)=>{const[e,t,n]=Se(r,"lab"),i=I1(t*t+n*n);let s=(O1(n,t)*d1+360)%360;return N1(i*1e4)===0&&(s=Number.NaN),[e,i,s]},Ql=(...r)=>{const[e,t,n,...i]=Se(r,"rgb"),[s,o,a]=Gl(e,t,n),[l,h,c]=xp(s,o,a);return[l,h,c,...i.length>0&&i[0]<1?[i[0]]:[]]};le.prototype.lch=function(){return Ql(this._rgb)};le.prototype.hcl=function(){return yp(Ql(this._rgb))};const P1=(...r)=>new le(...r,"lch"),R1=(...r)=>new le(...r,"hcl");Object.assign(Oe,{lch:P1,hcl:R1});ke.format.lch=Wl;ke.format.hcl=S1;["lch","hcl"].forEach(r=>ke.autodetect.push({p:2,test:(...e)=>{if(e=Se(e,r),Pe(e)==="array"&&e.length===3)return r}}));le.prototype.saturate=function(r=1){const e=this,t=e.lch();return t[1]+=Wt.Kn*r,t[1]<0&&(t[1]=0),new le(t,"lch").alpha(e.alpha(),!0)};le.prototype.desaturate=function(r=1){return this.saturate(-r)};le.prototype.set=function(r,e,t=!1){const[n,i]=r.split("."),s=this[n]();if(i){const o=n.indexOf(i)-(n.substr(0,2)==="ok"?2:0);if(o>-1){if(Pe(e)=="string")switch(e.charAt(0)){case"+":s[o]+=+e;break;case"-":s[o]+=+e;break;case"*":s[o]*=+e.substr(1);break;case"/":s[o]/=+e.substr(1);break;default:s[o]=+e}else if(Pe(e)==="number")s[o]=e;else throw new Error("unsupported value for Color.set");const a=new le(s,n);return t?(this._rgb=a._rgb,this):a}throw new Error(`unknown channel ${i} in mode ${n}`)}else return s};le.prototype.tint=function(r=.5,...e){return Er(this,"white",r,...e)};le.prototype.shade=function(r=.5,...e){return Er(this,"black",r,...e)};const C1=(r,e,t)=>{const n=r._rgb,i=e._rgb;return new le(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"rgb")};vt.rgb=C1;const{sqrt:ea,pow:Zn}=Math,j1=(r,e,t)=>{const[n,i,s]=r._rgb,[o,a,l]=e._rgb;return new le(ea(Zn(n,2)*(1-t)+Zn(o,2)*t),ea(Zn(i,2)*(1-t)+Zn(a,2)*t),ea(Zn(s,2)*(1-t)+Zn(l,2)*t),"rgb")};vt.lrgb=j1;const L1=(r,e,t)=>{const n=r.lab(),i=e.lab();return new le(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"lab")};vt.lab=L1;const Pr=(r,e,t,n)=>{let i,s;n==="hsl"?(i=r.hsl(),s=e.hsl()):n==="hsv"?(i=r.hsv(),s=e.hsv()):n==="hcg"?(i=r.hcg(),s=e.hcg()):n==="hsi"?(i=r.hsi(),s=e.hsi()):n==="lch"||n==="hcl"?(n="hcl",i=r.hcl(),s=e.hcl()):n==="oklch"&&(i=r.oklch().reverse(),s=e.oklch().reverse());let o,a,l,h,c,d;(n.substr(0,1)==="h"||n==="oklch")&&([o,l,c]=i,[a,h,d]=s);let f,p,_,y;return!isNaN(o)&&!isNaN(a)?(a>o&&a-o>180?y=a-(o+360):a<o&&o-a>180?y=a+360-o:y=a-o,p=o+t*y):isNaN(o)?isNaN(a)?p=Number.NaN:(p=a,(c==1||c==0)&&n!="hsv"&&(f=h)):(p=o,(d==1||d==0)&&n!="hsv"&&(f=l)),f===void 0&&(f=l+t*(h-l)),_=c+t*(d-c),n==="oklch"?new le([_,f,p],n):new le([p,f,_],n)},Tp=(r,e,t)=>Pr(r,e,t,"lch");vt.lch=Tp;vt.hcl=Tp;const D1=r=>{if(Pe(r)=="number"&&r>=0&&r<=16777215){const e=r>>16,t=r>>8&255,n=r&255;return[e,t,n,1]}throw new Error("unknown num color: "+r)},M1=(...r)=>{const[e,t,n]=Se(r,"rgb");return(e<<16)+(t<<8)+n};le.prototype.num=function(){return M1(this._rgb)};const V1=(...r)=>new le(...r,"num");Object.assign(Oe,{num:V1});ke.format.num=D1;ke.autodetect.push({p:5,test:(...r)=>{if(r.length===1&&Pe(r[0])==="number"&&r[0]>=0&&r[0]<=16777215)return"num"}});const $1=(r,e,t)=>{const n=r.num(),i=e.num();return new le(n+t*(i-n),"num")};vt.num=$1;const{floor:q1}=Math,F1=(...r)=>{r=Se(r,"hcg");let[e,t,n]=r,i,s,o;n=n*255;const a=t*255;if(t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const l=q1(e),h=e-l,c=n*(1-t),d=c+a*(1-h),f=c+a*h,p=c+a;switch(l){case 0:[i,s,o]=[p,f,c];break;case 1:[i,s,o]=[d,p,c];break;case 2:[i,s,o]=[c,p,f];break;case 3:[i,s,o]=[c,d,p];break;case 4:[i,s,o]=[f,c,p];break;case 5:[i,s,o]=[p,c,d];break}}return[i,s,o,r.length>3?r[3]:1]},U1=(...r)=>{const[e,t,n]=Se(r,"rgb"),i=mp(e,t,n),s=gp(e,t,n),o=s-i,a=o*100/255,l=i/(255-o)*100;let h;return o===0?h=Number.NaN:(e===s&&(h=(t-n)/o),t===s&&(h=2+(n-e)/o),n===s&&(h=4+(e-t)/o),h*=60,h<0&&(h+=360)),[h,a,l]};le.prototype.hcg=function(){return U1(this._rgb)};const B1=(...r)=>new le(...r,"hcg");Oe.hcg=B1;ke.format.hcg=F1;ke.autodetect.push({p:1,test:(...r)=>{if(r=Se(r,"hcg"),Pe(r)==="array"&&r.length===3)return"hcg"}});const z1=(r,e,t)=>Pr(r,e,t,"hcg");vt.hcg=z1;const{cos:er}=Math,H1=(...r)=>{r=Se(r,"hsi");let[e,t,n]=r,i,s,o;return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e>360&&(e-=360),e<0&&(e+=360),e/=360,e<1/3?(o=(1-t)/3,i=(1+t*er(tn*e)/er(Yo-tn*e))/3,s=1-(o+i)):e<2/3?(e-=1/3,i=(1-t)/3,s=(1+t*er(tn*e)/er(Yo-tn*e))/3,o=1-(i+s)):(e-=2/3,s=(1-t)/3,o=(1+t*er(tn*e)/er(Yo-tn*e))/3,i=1-(s+o)),i=Bn(n*i*3),s=Bn(n*s*3),o=Bn(n*o*3),[i*255,s*255,o*255,r.length>3?r[3]:1]},{min:K1,sqrt:G1,acos:W1}=Math,Q1=(...r)=>{let[e,t,n]=Se(r,"rgb");e/=255,t/=255,n/=255;let i;const s=K1(e,t,n),o=(e+t+n)/3,a=o>0?1-s/o:0;return a===0?i=NaN:(i=(e-t+(e-n))/2,i/=G1((e-t)*(e-t)+(e-n)*(t-n)),i=W1(i),n>t&&(i=tn-i),i/=tn),[i*360,a,o]};le.prototype.hsi=function(){return Q1(this._rgb)};const Y1=(...r)=>new le(...r,"hsi");Oe.hsi=Y1;ke.format.hsi=H1;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"hsi"),Pe(r)==="array"&&r.length===3)return"hsi"}});const J1=(r,e,t)=>Pr(r,e,t,"hsi");vt.hsi=J1;const qa=(...r)=>{r=Se(r,"hsl");const[e,t,n]=r;let i,s,o;if(t===0)i=s=o=n*255;else{const a=[0,0,0],l=[0,0,0],h=n<.5?n*(1+t):n+t-n*t,c=2*n-h,d=e/360;a[0]=d+1/3,a[1]=d,a[2]=d-1/3;for(let f=0;f<3;f++)a[f]<0&&(a[f]+=1),a[f]>1&&(a[f]-=1),6*a[f]<1?l[f]=c+(h-c)*6*a[f]:2*a[f]<1?l[f]=h:3*a[f]<2?l[f]=c+(h-c)*(2/3-a[f])*6:l[f]=c;[i,s,o]=[l[0]*255,l[1]*255,l[2]*255]}return r.length>3?[i,s,o,r[3]]:[i,s,o,1]},Ap=(...r)=>{r=Se(r,"rgba");let[e,t,n]=r;e/=255,t/=255,n/=255;const i=mp(e,t,n),s=gp(e,t,n),o=(s+i)/2;let a,l;return s===i?(a=0,l=Number.NaN):a=o<.5?(s-i)/(s+i):(s-i)/(2-s-i),e==s?l=(t-n)/(s-i):t==s?l=2+(n-e)/(s-i):n==s&&(l=4+(e-t)/(s-i)),l*=60,l<0&&(l+=360),r.length>3&&r[3]!==void 0?[l,a,o,r[3]]:[l,a,o]};le.prototype.hsl=function(){return Ap(this._rgb)};const X1=(...r)=>new le(...r,"hsl");Oe.hsl=X1;ke.format.hsl=qa;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"hsl"),Pe(r)==="array"&&r.length===3)return"hsl"}});const Z1=(r,e,t)=>Pr(r,e,t,"hsl");vt.hsl=Z1;const{floor:eb}=Math,tb=(...r)=>{r=Se(r,"hsv");let[e,t,n]=r,i,s,o;if(n*=255,t===0)i=s=o=n;else{e===360&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60;const a=eb(e),l=e-a,h=n*(1-t),c=n*(1-t*l),d=n*(1-t*(1-l));switch(a){case 0:[i,s,o]=[n,d,h];break;case 1:[i,s,o]=[c,n,h];break;case 2:[i,s,o]=[h,n,d];break;case 3:[i,s,o]=[h,c,n];break;case 4:[i,s,o]=[d,h,n];break;case 5:[i,s,o]=[n,h,c];break}}return[i,s,o,r.length>3?r[3]:1]},{min:nb,max:rb}=Math,ib=(...r)=>{r=Se(r,"rgb");let[e,t,n]=r;const i=nb(e,t,n),s=rb(e,t,n),o=s-i;let a,l,h;return h=s/255,s===0?(a=Number.NaN,l=0):(l=o/s,e===s&&(a=(t-n)/o),t===s&&(a=2+(n-e)/o),n===s&&(a=4+(e-t)/o),a*=60,a<0&&(a+=360)),[a,l,h]};le.prototype.hsv=function(){return ib(this._rgb)};const sb=(...r)=>new le(...r,"hsv");Oe.hsv=sb;ke.format.hsv=tb;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"hsv"),Pe(r)==="array"&&r.length===3)return"hsv"}});const ob=(r,e,t)=>Pr(r,e,t,"hsv");vt.hsv=ob;function $s(r,e){let t=r.length;Array.isArray(r[0])||(r=[r]),Array.isArray(e[0])||(e=e.map(o=>[o]));let n=e[0].length,i=e[0].map((o,a)=>e.map(l=>l[a])),s=r.map(o=>i.map(a=>Array.isArray(o)?o.reduce((l,h,c)=>l+h*(a[c]||0),0):a.reduce((l,h)=>l+h*o,0)));return t===1&&(s=s[0]),n===1?s.map(o=>o[0]):s}const Yl=(...r)=>{r=Se(r,"lab");const[e,t,n,...i]=r,[s,o,a]=ab([e,t,n]),[l,h,c]=bp(s,o,a);return[l,h,c,...i.length>0&&i[0]<1?[i[0]]:[]]};function ab(r){var e=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],t=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],n=$s(t,r);return $s(e,n.map(i=>i**3))}const Jl=(...r)=>{const[e,t,n,...i]=Se(r,"rgb"),s=wp(e,t,n);return[...lb(s),...i.length>0&&i[0]<1?[i[0]]:[]]};function lb(r){const e=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],t=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],n=$s(e,r);return $s(t,n.map(i=>Math.cbrt(i)))}le.prototype.oklab=function(){return Jl(this._rgb)};const ub=(...r)=>new le(...r,"oklab");Object.assign(Oe,{oklab:ub});ke.format.oklab=Yl;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"oklab"),Pe(r)==="array"&&r.length===3)return"oklab"}});const cb=(r,e,t)=>{const n=r.oklab(),i=e.oklab();return new le(n[0]+t*(i[0]-n[0]),n[1]+t*(i[1]-n[1]),n[2]+t*(i[2]-n[2]),"oklab")};vt.oklab=cb;const hb=(r,e,t)=>Pr(r,e,t,"oklch");vt.oklch=hb;const{pow:ta,sqrt:na,PI:ra,cos:ch,sin:hh,atan2:fb}=Math,db=(r,e="lrgb",t=null)=>{const n=r.length;t||(t=Array.from(new Array(n)).map(()=>1));const i=n/t.reduce(function(d,f){return d+f});if(t.forEach((d,f)=>{t[f]*=i}),r=r.map(d=>new le(d)),e==="lrgb")return pb(r,t);const s=r.shift(),o=s.get(e),a=[];let l=0,h=0;for(let d=0;d<o.length;d++)if(o[d]=(o[d]||0)*t[0],a.push(isNaN(o[d])?0:t[0]),e.charAt(d)==="h"&&!isNaN(o[d])){const f=o[d]/180*ra;l+=ch(f)*t[0],h+=hh(f)*t[0]}let c=s.alpha()*t[0];r.forEach((d,f)=>{const p=d.get(e);c+=d.alpha()*t[f+1];for(let _=0;_<o.length;_++)if(!isNaN(p[_]))if(a[_]+=t[f+1],e.charAt(_)==="h"){const y=p[_]/180*ra;l+=ch(y)*t[f+1],h+=hh(y)*t[f+1]}else o[_]+=p[_]*t[f+1]});for(let d=0;d<o.length;d++)if(e.charAt(d)==="h"){let f=fb(h/a[d],l/a[d])/ra*180;for(;f<0;)f+=360;for(;f>=360;)f-=360;o[d]=f}else o[d]=o[d]/a[d];return c/=n,new le(o,e).alpha(c>.99999?1:c,!0)},pb=(r,e)=>{const t=r.length,n=[0,0,0,0];for(let i=0;i<r.length;i++){const s=r[i],o=e[i]/t,a=s._rgb;n[0]+=ta(a[0],2)*o,n[1]+=ta(a[1],2)*o,n[2]+=ta(a[2],2)*o,n[3]+=a[3]*o}return n[0]=na(n[0]),n[1]=na(n[1]),n[2]=na(n[2]),n[3]>.9999999&&(n[3]=1),new le(Hl(n))},{pow:mb}=Math;function qs(r){let e="rgb",t=Oe("#ccc"),n=0,i=[0,1],s=[],o=[0,0],a=!1,l=[],h=!1,c=0,d=1,f=!1,p={},_=!0,y=1;const g=function(E){if(E=E||["#fff","#000"],E&&Pe(E)==="string"&&Oe.brewer&&Oe.brewer[E.toLowerCase()]&&(E=Oe.brewer[E.toLowerCase()]),Pe(E)==="array"){E.length===1&&(E=[E[0],E[0]]),E=E.slice(0);for(let w=0;w<E.length;w++)E[w]=Oe(E[w]);s.length=0;for(let w=0;w<E.length;w++)s.push(w/(E.length-1))}return N(),l=E},m=function(E){if(a!=null){const w=a.length-1;let A=0;for(;A<w&&E>=a[A];)A++;return A-1}return 0};let b=E=>E,I=E=>E;const v=function(E,w){let A,x;if(w==null&&(w=!1),isNaN(E)||E===null)return t;w?x=E:a&&a.length>2?x=m(E)/(a.length-2):d!==c?x=(E-c)/(d-c):x=1,x=I(x),w||(x=b(x)),y!==1&&(x=mb(x,y)),x=o[0]+x*(1-o[0]-o[1]),x=Bn(x,0,1);const T=Math.floor(x*1e4);if(_&&p[T])A=p[T];else{if(Pe(l)==="array")for(let S=0;S<s.length;S++){const O=s[S];if(x<=O){A=l[S];break}if(x>=O&&S===s.length-1){A=l[S];break}if(x>O&&x<s[S+1]){x=(x-O)/(s[S+1]-O),A=Oe.interpolate(l[S],l[S+1],x,e);break}}else Pe(l)==="function"&&(A=l(x));_&&(p[T]=A)}return A};var N=()=>p={};g(r);const C=function(E){const w=Oe(v(E));return h&&w[h]?w[h]():w};return C.classes=function(E){if(E!=null){if(Pe(E)==="array")a=E,i=[E[0],E[E.length-1]];else{const w=Oe.analyze(i);E===0?a=[w.min,w.max]:a=Oe.limits(w,"e",E)}return C}return a},C.domain=function(E){if(!arguments.length)return i;c=E[0],d=E[E.length-1],s=[];const w=l.length;if(E.length===w&&c!==d)for(let A of Array.from(E))s.push((A-c)/(d-c));else{for(let A=0;A<w;A++)s.push(A/(w-1));if(E.length>2){const A=E.map((T,S)=>S/(E.length-1)),x=E.map(T=>(T-c)/(d-c));x.every((T,S)=>A[S]===T)||(I=T=>{if(T<=0||T>=1)return T;let S=0;for(;T>=x[S+1];)S++;const O=(T-x[S])/(x[S+1]-x[S]);return A[S]+O*(A[S+1]-A[S])})}}return i=[c,d],C},C.mode=function(E){return arguments.length?(e=E,N(),C):e},C.range=function(E,w){return g(E),C},C.out=function(E){return h=E,C},C.spread=function(E){return arguments.length?(n=E,C):n},C.correctLightness=function(E){return E==null&&(E=!0),f=E,N(),f?b=function(w){const A=v(0,!0).lab()[0],x=v(1,!0).lab()[0],T=A>x;let S=v(w,!0).lab()[0];const O=A+(x-A)*w;let D=S-O,q=0,B=1,K=20;for(;Math.abs(D)>.01&&K-- >0;)(function(){return T&&(D*=-1),D<0?(q=w,w+=(B-w)*.5):(B=w,w+=(q-w)*.5),S=v(w,!0).lab()[0],D=S-O})();return w}:b=w=>w,C},C.padding=function(E){return E!=null?(Pe(E)==="number"&&(E=[E,E]),o=E,C):o},C.colors=function(E,w){arguments.length<2&&(w="hex");let A=[];if(arguments.length===0)A=l.slice(0);else if(E===1)A=[C(.5)];else if(E>1){const x=i[0],T=i[1]-x;A=gb(0,E).map(S=>C(x+S/(E-1)*T))}else{r=[];let x=[];if(a&&a.length>2)for(let T=1,S=a.length,O=1<=S;O?T<S:T>S;O?T++:T--)x.push((a[T-1]+a[T])*.5);else x=i;A=x.map(T=>C(T))}return Oe[w]&&(A=A.map(x=>x[w]())),A},C.cache=function(E){return E!=null?(_=E,C):_},C.gamma=function(E){return E!=null?(y=E,C):y},C.nodata=function(E){return E!=null?(t=Oe(E),C):t},C}function gb(r,e,t){let n=[],i=r<e,s=e;for(let o=r;i?o<s:o>s;i?o++:o--)n.push(o);return n}const yb=function(r){let e=[1,1];for(let t=1;t<r;t++){let n=[1];for(let i=1;i<=e.length;i++)n[i]=(e[i]||0)+e[i-1];e=n}return e},vb=function(r){let e,t,n,i;if(r=r.map(s=>new le(s)),r.length===2)[t,n]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>t[a]+s*(n[a]-t[a]));return new le(o,"lab")};else if(r.length===3)[t,n,i]=r.map(s=>s.lab()),e=function(s){const o=[0,1,2].map(a=>(1-s)*(1-s)*t[a]+2*(1-s)*s*n[a]+s*s*i[a]);return new le(o,"lab")};else if(r.length===4){let s;[t,n,i,s]=r.map(o=>o.lab()),e=function(o){const a=[0,1,2].map(l=>(1-o)*(1-o)*(1-o)*t[l]+3*(1-o)*(1-o)*o*n[l]+3*(1-o)*o*o*i[l]+o*o*o*s[l]);return new le(a,"lab")}}else if(r.length>=5){let s,o,a;s=r.map(l=>l.lab()),a=r.length-1,o=yb(a),e=function(l){const h=1-l,c=[0,1,2].map(d=>s.reduce((f,p,_)=>f+o[_]*h**(a-_)*l**_*p[d],0));return new le(c,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return e},_b=r=>{const e=vb(r);return e.scale=()=>qs(e),e},{round:kp}=Math;le.prototype.rgb=function(r=!0){return r===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(kp)};le.prototype.rgba=function(r=!0){return this._rgb.slice(0,4).map((e,t)=>t<3?r===!1?e:kp(e):e)};const bb=(...r)=>new le(...r,"rgb");Object.assign(Oe,{rgb:bb});ke.format.rgb=(...r)=>{const e=Se(r,"rgba");return e[3]===void 0&&(e[3]=1),e};ke.autodetect.push({p:3,test:(...r)=>{if(r=Se(r,"rgba"),Pe(r)==="array"&&(r.length===3||r.length===4&&Pe(r[3])=="number"&&r[3]>=0&&r[3]<=1))return"rgb"}});const Ft=(r,e,t)=>{if(!Ft[t])throw new Error("unknown blend mode "+t);return Ft[t](r,e)},Nn=r=>(e,t)=>{const n=Oe(t).rgb(),i=Oe(e).rgb();return Oe.rgb(r(n,i))},Pn=r=>(e,t)=>{const n=[];return n[0]=r(e[0],t[0]),n[1]=r(e[1],t[1]),n[2]=r(e[2],t[2]),n},wb=r=>r,Eb=(r,e)=>r*e/255,xb=(r,e)=>r>e?e:r,Tb=(r,e)=>r>e?r:e,Ab=(r,e)=>255*(1-(1-r/255)*(1-e/255)),kb=(r,e)=>e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255)),Sb=(r,e)=>255*(1-(1-e/255)/(r/255)),Ib=(r,e)=>r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r);Ft.normal=Nn(Pn(wb));Ft.multiply=Nn(Pn(Eb));Ft.screen=Nn(Pn(Ab));Ft.overlay=Nn(Pn(kb));Ft.darken=Nn(Pn(xb));Ft.lighten=Nn(Pn(Tb));Ft.dodge=Nn(Pn(Ib));Ft.burn=Nn(Pn(Sb));const{pow:Ob,sin:Nb,cos:Pb}=Math;function Rb(r=300,e=-1.5,t=1,n=1,i=[0,1]){let s=0,o;Pe(i)==="array"?o=i[1]-i[0]:(o=0,i=[i,i]);const a=function(l){const h=tn*((r+120)/360+e*l),c=Ob(i[0]+o*l,n),f=(s!==0?t[0]+l*s:t)*c*(1-c)/2,p=Pb(h),_=Nb(h),y=c+f*(-.14861*p+1.78277*_),g=c+f*(-.29227*p-.90649*_),m=c+f*(1.97294*p);return Oe(Hl([y*255,g*255,m*255,1]))};return a.start=function(l){return l==null?r:(r=l,a)},a.rotations=function(l){return l==null?e:(e=l,a)},a.gamma=function(l){return l==null?n:(n=l,a)},a.hue=function(l){return l==null?t:(t=l,Pe(t)==="array"?(s=t[1]-t[0],s===0&&(t=t[1])):s=0,a)},a.lightness=function(l){return l==null?i:(Pe(l)==="array"?(i=l,o=l[1]-l[0]):(i=[l,l],o=0),a)},a.scale=()=>Oe.scale(a),a.hue(t),a}const Cb="0123456789abcdef",{floor:jb,random:Lb}=Math,Db=()=>{let r="#";for(let e=0;e<6;e++)r+=Cb.charAt(jb(Lb()*16));return new le(r,"hex")},{log:fh,pow:Mb,floor:Vb,abs:$b}=Math;function Sp(r,e=null){const t={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Pe(r)==="object"&&(r=Object.values(r)),r.forEach(n=>{e&&Pe(n)==="object"&&(n=n[e]),n!=null&&!isNaN(n)&&(t.values.push(n),t.sum+=n,n<t.min&&(t.min=n),n>t.max&&(t.max=n),t.count+=1)}),t.domain=[t.min,t.max],t.limits=(n,i)=>Ip(t,n,i),t}function Ip(r,e="equal",t=7){Pe(r)=="array"&&(r=Sp(r));const{min:n,max:i}=r,s=r.values.sort((a,l)=>a-l);if(t===1)return[n,i];const o=[];if(e.substr(0,1)==="c"&&(o.push(n),o.push(i)),e.substr(0,1)==="e"){o.push(n);for(let a=1;a<t;a++)o.push(n+a/t*(i-n));o.push(i)}else if(e.substr(0,1)==="l"){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");const a=Math.LOG10E*fh(n),l=Math.LOG10E*fh(i);o.push(n);for(let h=1;h<t;h++)o.push(Mb(10,a+h/t*(l-a)));o.push(i)}else if(e.substr(0,1)==="q"){o.push(n);for(let a=1;a<t;a++){const l=(s.length-1)*a/t,h=Vb(l);if(h===l)o.push(s[h]);else{const c=l-h;o.push(s[h]*(1-c)+s[h+1]*c)}}o.push(i)}else if(e.substr(0,1)==="k"){let a;const l=s.length,h=new Array(l),c=new Array(t);let d=!0,f=0,p=null;p=[],p.push(n);for(let g=1;g<t;g++)p.push(n+g/t*(i-n));for(p.push(i);d;){for(let m=0;m<t;m++)c[m]=0;for(let m=0;m<l;m++){const b=s[m];let I=Number.MAX_VALUE,v;for(let N=0;N<t;N++){const C=$b(p[N]-b);C<I&&(I=C,v=N),c[v]++,h[m]=v}}const g=new Array(t);for(let m=0;m<t;m++)g[m]=null;for(let m=0;m<l;m++)a=h[m],g[a]===null?g[a]=s[m]:g[a]+=s[m];for(let m=0;m<t;m++)g[m]*=1/c[m];d=!1;for(let m=0;m<t;m++)if(g[m]!==p[m]){d=!0;break}p=g,f++,f>200&&(d=!1)}const _={};for(let g=0;g<t;g++)_[g]=[];for(let g=0;g<l;g++)a=h[g],_[a].push(s[g]);let y=[];for(let g=0;g<t;g++)y.push(_[g][0]),y.push(_[g][_[g].length-1]);y=y.sort((g,m)=>g-m),o.push(y[0]);for(let g=1;g<y.length;g+=2){const m=y[g];!isNaN(m)&&o.indexOf(m)===-1&&o.push(m)}}return o}const qb=(r,e)=>{r=new le(r),e=new le(e);const t=r.luminance(),n=e.luminance();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const dh=.027,Fb=5e-4,Ub=.1,ph=1.14,us=.022,mh=1.414,Bb=(r,e)=>{r=new le(r),e=new le(e),r.alpha()<1&&(r=Er(e,r,r.alpha(),"rgb"));const t=gh(...r.rgb()),n=gh(...e.rgb()),i=t>=us?t:t+Math.pow(us-t,mh),s=n>=us?n:n+Math.pow(us-n,mh),o=Math.pow(s,.56)-Math.pow(i,.57),a=Math.pow(s,.65)-Math.pow(i,.62),l=Math.abs(s-i)<Fb?0:i<s?o*ph:a*ph;return(Math.abs(l)<Ub?0:l>0?l-dh:l+dh)*100};function gh(r,e,t){return .2126729*Math.pow(r/255,2.4)+.7151522*Math.pow(e/255,2.4)+.072175*Math.pow(t/255,2.4)}const{sqrt:Zt,pow:et,min:zb,max:Hb,atan2:yh,abs:vh,cos:cs,sin:_h,exp:Kb,PI:bh}=Math;function Gb(r,e,t=1,n=1,i=1){var s=function($){return 360*$/(2*bh)},o=function($){return 2*bh*$/360};r=new le(r),e=new le(e);const[a,l,h]=Array.from(r.lab()),[c,d,f]=Array.from(e.lab()),p=(a+c)/2,_=Zt(et(l,2)+et(h,2)),y=Zt(et(d,2)+et(f,2)),g=(_+y)/2,m=.5*(1-Zt(et(g,7)/(et(g,7)+et(25,7)))),b=l*(1+m),I=d*(1+m),v=Zt(et(b,2)+et(h,2)),N=Zt(et(I,2)+et(f,2)),C=(v+N)/2,E=s(yh(h,b)),w=s(yh(f,I)),A=E>=0?E:E+360,x=w>=0?w:w+360,T=vh(A-x)>180?(A+x+360)/2:(A+x)/2,S=1-.17*cs(o(T-30))+.24*cs(o(2*T))+.32*cs(o(3*T+6))-.2*cs(o(4*T-63));let O=x-A;O=vh(O)<=180?O:x<=A?O+360:O-360,O=2*Zt(v*N)*_h(o(O)/2);const D=c-a,q=N-v,B=1+.015*et(p-50,2)/Zt(20+et(p-50,2)),K=1+.045*C,oe=1+.015*C*S,z=30*Kb(-et((T-275)/25,2)),j=-(2*Zt(et(C,7)/(et(C,7)+et(25,7))))*_h(2*o(z)),V=Zt(et(D/(t*B),2)+et(q/(n*K),2)+et(O/(i*oe),2)+j*(q/(n*K))*(O/(i*oe)));return Hb(0,zb(100,V))}function Wb(r,e,t="lab"){r=new le(r),e=new le(e);const n=r.get(t),i=e.get(t);let s=0;for(let o in n){const a=(n[o]||0)-(i[o]||0);s+=a*a}return Math.sqrt(s)}const Qb=(...r)=>{try{return new le(...r),!0}catch{return!1}},Yb={cool(){return qs([Oe.hsl(180,1,.9),Oe.hsl(250,.7,.4)])},hot(){return qs(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Fa={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Op=Object.keys(Fa),wh=new Map(Op.map(r=>[r.toLowerCase(),r])),Jb=typeof Proxy=="function"?new Proxy(Fa,{get(r,e){const t=e.toLowerCase();if(wh.has(t))return r[wh.get(t)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(Op)}}):Fa,Xb=(...r)=>{r=Se(r,"cmyk");const[e,t,n,i]=r,s=r.length>4?r[4]:1;return i===1?[0,0,0,s]:[e>=1?0:255*(1-e)*(1-i),t>=1?0:255*(1-t)*(1-i),n>=1?0:255*(1-n)*(1-i),s]},{max:Eh}=Math,Zb=(...r)=>{let[e,t,n]=Se(r,"rgb");e=e/255,t=t/255,n=n/255;const i=1-Eh(e,Eh(t,n)),s=i<1?1/(1-i):0,o=(1-e-i)*s,a=(1-t-i)*s,l=(1-n-i)*s;return[o,a,l,i]};le.prototype.cmyk=function(){return Zb(this._rgb)};const ew=(...r)=>new le(...r,"cmyk");Object.assign(Oe,{cmyk:ew});ke.format.cmyk=Xb;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"cmyk"),Pe(r)==="array"&&r.length===4)return"cmyk"}});const tw=(...r)=>{const e=Se(r,"hsla");let t=Nr(r)||"lsa";return e[0]=Rt(e[0]||0)+"deg",e[1]=Rt(e[1]*100)+"%",e[2]=Rt(e[2]*100)+"%",t==="hsla"||e.length>3&&e[3]<1?(e[3]="/ "+(e.length>3?e[3]:1),t="hsla"):e.length=3,`${t.substr(0,3)}(${e.join(" ")})`},nw=(...r)=>{const e=Se(r,"lab");let t=Nr(r)||"lab";return e[0]=Rt(e[0])+"%",e[1]=Rt(e[1]),e[2]=Rt(e[2]),t==="laba"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lab(${e.join(" ")})`},rw=(...r)=>{const e=Se(r,"lch");let t=Nr(r)||"lab";return e[0]=Rt(e[0])+"%",e[1]=Rt(e[1]),e[2]=isNaN(e[2])?"none":Rt(e[2])+"deg",t==="lcha"||e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`lch(${e.join(" ")})`},iw=(...r)=>{const e=Se(r,"lab");return e[0]=Rt(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=$a(e[2]),e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklab(${e.join(" ")})`},Np=(...r)=>{const[e,t,n,...i]=Se(r,"rgb"),[s,o,a]=Jl(e,t,n),[l,h,c]=xp(s,o,a);return[l,h,c,...i.length>0&&i[0]<1?[i[0]]:[]]},sw=(...r)=>{const e=Se(r,"lch");return e[0]=Rt(e[0]*100)+"%",e[1]=$a(e[1]),e[2]=isNaN(e[2])?"none":Rt(e[2])+"deg",e.length>3&&e[3]<1?e[3]="/ "+(e.length>3?e[3]:1):e.length=3,`oklch(${e.join(" ")})`},{round:ia}=Math,ow=(...r)=>{const e=Se(r,"rgba");let t=Nr(r)||"rgb";if(t.substr(0,3)==="hsl")return tw(Ap(e),t);if(t.substr(0,3)==="lab"){const n=ki();rn("d50");const i=nw(Gl(e),t);return rn(n),i}if(t.substr(0,3)==="lch"){const n=ki();rn("d50");const i=rw(Ql(e),t);return rn(n),i}return t.substr(0,5)==="oklab"?iw(Jl(e)):t.substr(0,5)==="oklch"?sw(Np(e)):(e[0]=ia(e[0]),e[1]=ia(e[1]),e[2]=ia(e[2]),(t==="rgba"||e.length>3&&e[3]<1)&&(e[3]="/ "+(e.length>3?e[3]:1),t="rgba"),`${t.substr(0,3)}(${e.slice(0,t==="rgb"?3:4).join(" ")})`)},Pp=(...r)=>{r=Se(r,"lch");const[e,t,n,...i]=r,[s,o,a]=Ep(e,t,n),[l,h,c]=Yl(s,o,a);return[l,h,c,...i.length>0&&i[0]<1?[i[0]]:[]]},on=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,$t=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,Fs=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,jt=/\s*/.source,Rr=/\s+/.source,Xl=/\s*,\s*/.source,fo=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,Cr=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,Rp=new RegExp("^rgba?\\("+jt+[on,on,on].join(Rr)+Cr+"\\)$"),Cp=new RegExp("^rgb\\("+jt+[on,on,on].join(Xl)+jt+"\\)$"),jp=new RegExp("^rgba\\("+jt+[on,on,on,$t].join(Xl)+jt+"\\)$"),Lp=new RegExp("^hsla?\\("+jt+[fo,Fs,Fs].join(Rr)+Cr+"\\)$"),Dp=new RegExp("^hsl?\\("+jt+[fo,Fs,Fs].join(Xl)+jt+"\\)$"),Mp=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,Vp=new RegExp("^lab\\("+jt+[$t,$t,$t].join(Rr)+Cr+"\\)$"),$p=new RegExp("^lch\\("+jt+[$t,$t,fo].join(Rr)+Cr+"\\)$"),qp=new RegExp("^oklab\\("+jt+[$t,$t,$t].join(Rr)+Cr+"\\)$"),Fp=new RegExp("^oklch\\("+jt+[$t,$t,fo].join(Rr)+Cr+"\\)$"),{round:Up}=Math,tr=r=>r.map((e,t)=>t<=2?Bn(Up(e),0,255):e),tt=(r,e=0,t=100,n=!1)=>(typeof r=="string"&&r.endsWith("%")&&(r=parseFloat(r.substring(0,r.length-1))/100,n?r=e+(r+1)*.5*(t-e):r=e+r*(t-e)),+r),wt=(r,e)=>r==="none"?e:r,Zl=r=>{if(r=r.toLowerCase().trim(),r==="transparent")return[0,0,0,0];let e;if(ke.format.named)try{return ke.format.named(r)}catch{}if((e=r.match(Rp))||(e=r.match(Cp))){let t=e.slice(1,4);for(let i=0;i<3;i++)t[i]=+tt(wt(t[i],0),0,255);t=tr(t);const n=e[4]!==void 0?+tt(e[4],0,1):1;return t[3]=n,t}if(e=r.match(jp)){const t=e.slice(1,5);for(let n=0;n<4;n++)t[n]=+tt(t[n],0,255);return t}if((e=r.match(Lp))||(e=r.match(Dp))){const t=e.slice(1,4);t[0]=+wt(t[0].replace("deg",""),0),t[1]=+tt(wt(t[1],0),0,100)*.01,t[2]=+tt(wt(t[2],0),0,100)*.01;const n=tr(qa(t)),i=e[4]!==void 0?+tt(e[4],0,1):1;return n[3]=i,n}if(e=r.match(Mp)){const t=e.slice(1,4);t[1]*=.01,t[2]*=.01;const n=qa(t);for(let i=0;i<3;i++)n[i]=Up(n[i]);return n[3]=+e[4],n}if(e=r.match(Vp)){const t=e.slice(1,4);t[0]=tt(wt(t[0],0),0,100),t[1]=tt(wt(t[1],0),-125,125,!0),t[2]=tt(wt(t[2],0),-125,125,!0);const n=ki();rn("d50");const i=tr(Kl(t));rn(n);const s=e[4]!==void 0?+tt(e[4],0,1):1;return i[3]=s,i}if(e=r.match($p)){const t=e.slice(1,4);t[0]=tt(t[0],0,100),t[1]=tt(wt(t[1],0),0,150,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=ki();rn("d50");const i=tr(Wl(t));rn(n);const s=e[4]!==void 0?+tt(e[4],0,1):1;return i[3]=s,i}if(e=r.match(qp)){const t=e.slice(1,4);t[0]=tt(wt(t[0],0),0,1),t[1]=tt(wt(t[1],0),-.4,.4,!0),t[2]=tt(wt(t[2],0),-.4,.4,!0);const n=tr(Yl(t)),i=e[4]!==void 0?+tt(e[4],0,1):1;return n[3]=i,n}if(e=r.match(Fp)){const t=e.slice(1,4);t[0]=tt(wt(t[0],0),0,1),t[1]=tt(wt(t[1],0),0,.4,!1),t[2]=+wt(t[2].replace("deg",""),0);const n=tr(Pp(t)),i=e[4]!==void 0?+tt(e[4],0,1):1;return n[3]=i,n}};Zl.test=r=>Rp.test(r)||Lp.test(r)||Vp.test(r)||$p.test(r)||qp.test(r)||Fp.test(r)||Cp.test(r)||jp.test(r)||Dp.test(r)||Mp.test(r)||r==="transparent";le.prototype.css=function(r){return ow(this._rgb,r)};const aw=(...r)=>new le(...r,"css");Oe.css=aw;ke.format.css=Zl;ke.autodetect.push({p:5,test:(r,...e)=>{if(!e.length&&Pe(r)==="string"&&Zl.test(r))return"css"}});ke.format.gl=(...r)=>{const e=Se(r,"rgba");return e[0]*=255,e[1]*=255,e[2]*=255,e};const lw=(...r)=>new le(...r,"gl");Oe.gl=lw;le.prototype.gl=function(){const r=this._rgb;return[r[0]/255,r[1]/255,r[2]/255,r[3]]};le.prototype.hex=function(r){return _p(this._rgb,r)};const uw=(...r)=>new le(...r,"hex");Oe.hex=uw;ke.format.hex=vp;ke.autodetect.push({p:4,test:(r,...e)=>{if(!e.length&&Pe(r)==="string"&&[3,4,5,6,7,8,9].indexOf(r.length)>=0)return"hex"}});const{log:hs}=Math,Bp=r=>{const e=r/100;let t,n,i;return e<66?(t=255,n=e<6?0:-155.25485562709179-.44596950469579133*(n=e-2)+104.49216199393888*hs(n),i=e<20?0:-254.76935184120902+.8274096064007395*(i=e-10)+115.67994401066147*hs(i)):(t=351.97690566805693+.114206453784165*(t=e-55)-40.25366309332127*hs(t),n=325.4494125711974+.07943456536662342*(n=e-50)-28.0852963507957*hs(n),i=255),[t,n,i,1]},{round:cw}=Math,hw=(...r)=>{const e=Se(r,"rgb"),t=e[0],n=e[2];let i=1e3,s=4e4;const o=.4;let a;for(;s-i>o;){a=(s+i)*.5;const l=Bp(a);l[2]/l[0]>=n/t?s=a:i=a}return cw(a)};le.prototype.temp=le.prototype.kelvin=le.prototype.temperature=function(){return hw(this._rgb)};const sa=(...r)=>new le(...r,"temp");Object.assign(Oe,{temp:sa,kelvin:sa,temperature:sa});ke.format.temp=ke.format.kelvin=ke.format.temperature=Bp;le.prototype.oklch=function(){return Np(this._rgb)};const fw=(...r)=>new le(...r,"oklch");Object.assign(Oe,{oklch:fw});ke.format.oklch=Pp;ke.autodetect.push({p:2,test:(...r)=>{if(r=Se(r,"oklch"),Pe(r)==="array"&&r.length===3)return"oklch"}});Object.assign(Oe,{analyze:Sp,average:db,bezier:_b,blend:Ft,brewer:Jb,Color:le,colors:wr,contrast:qb,contrastAPCA:Bb,cubehelix:Rb,deltaE:Gb,distance:Wb,input:ke,interpolate:Er,limits:Ip,mix:Er,random:Db,scale:qs,scales:Yb,valid:Qb});const oa={light:{primaryColor:"#3b82f6",secondaryColor:"#6b7280",titleColor:"#1f2937",h3TitleColor:"#1f2937",textColor:"#1f2937",backgroundFromColor:"#ffffff",backgroundToColor:"#f3f4f6",sectionBgColor:"#f3f4f6"},dark:{primaryColor:"#60a5fa",secondaryColor:"#9ca3af",titleColor:"#f9fafb",h3TitleColor:"#f9fafb",textColor:"#f9fafb",backgroundFromColor:"#111827",backgroundToColor:"#1f2937",sectionBgColor:"#111827"},forest:{primaryColor:"#34d399",secondaryColor:"#6b7280",titleColor:"#064e3b",h3TitleColor:"#064e3b",textColor:"#064e3b",backgroundFromColor:"#d1fae5",backgroundToColor:"#ecfdf5",sectionBgColor:"#d1fae5"},ocean:{primaryColor:"#38bdf8",secondaryColor:"#94a3b8",titleColor:"#0c4a6e",h3TitleColor:"#0c4a6e",textColor:"#0c4a6e",backgroundFromColor:"#e0f2fe",backgroundToColor:"#f0f9ff",sectionBgColor:"#e0f2fe"},sunset:{primaryColor:"#fb7185",secondaryColor:"#f97316",titleColor:"#881337",h3TitleColor:"#881337",textColor:"#881337",backgroundFromColor:"#ffe4e6",backgroundToColor:"#fff1f2",sectionBgColor:"#ffe4e6"}},dw=({onThemeSelect:r})=>{const e=[{name:"Light",value:"light",icon:"☀️"},{name:"Dark",value:"dark",icon:"🌙"},{name:"Forest",value:"forest",icon:"🌲"},{name:"Ocean",value:"ocean",icon:"🌊"},{name:"Sunset",value:"sunset",icon:"🌅"}],[t,n]=te.useState(()=>{if(typeof window<"u"){const s=localStorage.getItem("theme");return s&&oa[s]?s:"light"}return"light"});te.useEffect(()=>{if(typeof window<"u"){const s=Object.keys(oa);document.documentElement.classList.remove(...s),document.documentElement.classList.add(t),localStorage.setItem("theme",t)}},[t]);const i=s=>{const o=oa[s];o?(n(s),r(o)):console.warn(`Theme data not found for: ${s}`)};return P.jsx("div",{className:"theme-switcher",children:P.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2 p-1 sm:p-2 bg-[var(--color-background-secondary)] rounded-lg border border-gray-300 dark:border-gray-700",children:P.jsx("div",{className:"flex space-x-1",children:e.map(s=>P.jsx("button",{onClick:()=>i(s.value),className:`p-1 sm:p-2 rounded-md text-xs sm:text-sm transition-colors duration-150 ${t===s.value?"bg-[var(--color-primary)] text-white shadow-md":"bg-[var(--color-background-secondary)] text-[var(--color-text)] hover:bg-[var(--color-secondary)] hover:text-white"}`,title:s.name,children:P.jsx("span",{className:"flex items-center",children:P.jsx("span",{className:"mr-1",children:s.icon})})},s.value))})})})},Ue={primaryColor:"#377dc8",secondaryColor:"#0f3257",fontFamily:"'Noto Sans', sans-serif",titleColor:"#d7e3ee",h3TitleColor:"#d7e3ee",textColor:"#c6d3e2",backgroundFromColor:"#111827",backgroundToColor:"#1F2937",sectionBgColor:"#374151"},pw=()=>{const[r,e]=te.useState(Ue.primaryColor),[t,n]=te.useState(Ue.secondaryColor),[i,s]=te.useState(Ue.fontFamily),[o,a]=te.useState(Ue.titleColor??"#ffffff"),[l,h]=te.useState(Ue.h3TitleColor??"#d7e3ee"),[c,d]=te.useState(Ue.textColor??"#c6d3e2"),[f,p]=te.useState(Ue.backgroundFromColor??"#111827"),[_,y]=te.useState(Ue.backgroundToColor??"#1F2937"),[g,m]=te.useState(Ue.sectionBgColor??"#374151"),[b,I]=te.useState(!0),[v,N]=te.useState(!1),[C,E]=te.useState(0),[w,A]=te.useState([]),[x,T]=te.useState(""),[S,O]=te.useState(!0),[D,q]=te.useState("colors");te.useState(!1),te.useState(null);const{showToast:B,requestConfirmation:K}=Or();te.useEffect(()=>{j()},[]),te.useEffect(()=>{b||oe()},[r,t,i,o,l,c,f,_,g,b]);const oe=()=>{const X=document.documentElement,ue=z({primaryColor:r,secondaryColor:t,titleColor:o,h3TitleColor:l,textColor:c,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:g});Object.entries(ue).forEach(([pe,de])=>{X.style.setProperty(`--${pe.replace(/([A-Z])/g,"-$1").toLowerCase()}`,de)}),X.style.setProperty("--font-family",i)},z=X=>{const ue={};return Object.entries(X).forEach(([pe,de])=>{ue[pe]=de.match(/^#[0-9A-F]{6}$/i)?de:Ue[pe]||"#000000"}),ue},F=X=>{e(X.primaryColor),n(X.secondaryColor),a(X.titleColor),h(X.h3TitleColor),d(X.textColor),p(X.backgroundFromColor),y(X.backgroundToColor),m(X.sectionBgColor)},j=async()=>{if(!ve){console.error("Firestore not available"),I(!1);return}try{const X=await Q_(Ze(ve,"settings","styles"));if(X.exists()){const de=X.data();e(de.primaryColor||Ue.primaryColor),n(de.secondaryColor||Ue.secondaryColor),s(de.fontFamily||Ue.fontFamily),a(de.titleColor||Ue.titleColor||"#ffffff"),h(de.h3TitleColor||Ue.h3TitleColor||"#d7e3ee"),d(de.textColor||Ue.textColor||"#c6d3e2"),p(de.backgroundFromColor||Ue.backgroundFromColor||"#111827"),y(de.backgroundToColor||Ue.backgroundToColor||"#1F2937"),m(de.sectionBgColor||Ue.sectionBgColor||"#374151")}const pe=(await Mi(_r(ve,"themes"))).docs.map(de=>({id:de.id,...de.data()}));A(pe)}catch(X){console.error("Error loading data:",X)}finally{I(!1),O(!1)}},V=async()=>{if(!ve){console.error("Firestore not available");return}N(!0);try{const X={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:c,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:g};await Ma(Ze(ve,"settings","styles"),X),B("Styles saved successfully!","success")}catch(X){console.error("Error saving styles:",X),B("Failed to save styles. Check console.","error")}finally{N(!1)}},$=async()=>{if(!(!ve||!x.trim())){N(!0);try{const X={name:x.trim(),style:{primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:c,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:g}};await Bl(_r(ve,"themes"),X),j(),T(""),B("Theme saved successfully!","success")}catch(X){console.error("Error saving theme:",X),B("Failed to save theme. Check console.","error")}finally{N(!1)}}},G=async X=>{const ue=w.find(pe=>pe.id===X);!ve||!ue||K({message:`Are you sure you want to delete the theme "${ue.name}"?`,onConfirm:async()=>{if(!ve){B("Error: Firestore connection lost.","error");return}try{await Ul(Ze(ve,"themes",X)),A(pe=>pe.filter(de=>de.id!==X)),B("Theme deleted successfully!","success")}catch(pe){console.error("Error deleting theme:",pe),B("Failed to delete theme. Check console.","error")}},confirmText:"Delete Theme",title:"Confirm Deletion"})},H=X=>{const{style:ue}=X;e(ue.primaryColor),n(ue.secondaryColor),s(ue.fontFamily),a(ue.titleColor||Ue.titleColor||"#ffffff"),h(ue.h3TitleColor||Ue.h3TitleColor||"#d7e3ee"),d(ue.textColor||Ue.textColor||"#c6d3e2"),p(ue.backgroundFromColor||Ue.backgroundFromColor||"#111827"),y(ue.backgroundToColor||Ue.backgroundToColor||"#1F2937"),m(ue.sectionBgColor||Ue.sectionBgColor||"#374151")},M=()=>{try{const X=Oe.valid(r)?Oe(r):Oe(Ue.primaryColor),ue=C%3;let pe,de;switch(ue){case 1:pe=X.set("hsl.h","+30").hex(),de=X.set("hsl.h","-30").hex();break;case 2:pe=X.set("hsl.h","+120").hex(),de=X.set("hsl.h","-120").hex();break;default:pe=X.set("hsl.h","+180").hex(),de=X.set("hsl.h","+150").hex();break}n(pe);const Ae=Oe.mix(X.brighten(1.5),"#ffffff",.1).hex(),We=Oe.mix(X.brighten(1),"#ffffff",.05).hex(),qe=Oe.mix(X.brighten(2.5).desaturate(.5),"#ffffff",.2).hex();a(Ae),h(We),d(qe),p(X.darken(2.2).desaturate(.5).hex()),y(X.darken(1.8).desaturate(.3).hex()),m(X.darken(1.5).desaturate(.4).hex()),E(ne=>ne+1),B("AI colors generated!","success")}catch(X){console.error("Error generating AI colors:",X),B("Failed to generate colors. Check console.","error")}},U=()=>{const X={primaryColor:r,secondaryColor:t,fontFamily:i,titleColor:o,h3TitleColor:l,textColor:c,backgroundFromColor:f,backgroundToColor:_,sectionBgColor:g},ue=new Blob([JSON.stringify(X,null,2)],{type:"application/json"}),pe=URL.createObjectURL(ue),de=document.createElement("a");de.href=pe,de.download="theme.json",document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(pe),B("Theme exported successfully!","success")},Y=X=>{var de;const ue=(de=X.target.files)==null?void 0:de[0];if(!ue)return;const pe=new FileReader;pe.onload=Ae=>{var We;try{const qe=JSON.parse((We=Ae.target)==null?void 0:We.result);F(qe),B("Theme imported successfully!","success")}catch(qe){console.error("Error importing theme:",qe),B("Invalid theme file or format.","error")}},pe.readAsText(ue)},Q=(X,ue,pe,de)=>P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:X}),P.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-2 space-y-2 sm:space-y-0",children:[P.jsx("input",{type:"color",value:ue,onChange:Ae=>pe(Ae.target.value),className:"h-10 w-10 p-1 border border-gray-300 rounded cursor-pointer self-start sm:self-center"}),P.jsx("input",{type:"text",value:ue,onChange:Ae=>pe(Ae.target.value),className:"w-full sm:flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxLength:7}),P.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ue),B("Color code copied!","success")},className:"p-2 text-gray-500 hover:text-gray-700 self-start sm:self-center",title:"Copy color code",children:P.jsx(Hg,{size:20})})]}),de&&P.jsx("p",{className:"mt-1 text-sm text-gray-500",children:de})]}),se=[{id:"colors",label:"Colors",icon:P.jsx(If,{size:20})},{id:"typography",label:"Typography",icon:P.jsx(Ly,{size:20})},{id:"layout",label:"Layout",icon:P.jsx(wy,{size:20})},{id:"advanced",label:"Advanced",icon:P.jsx(Iy,{size:20})}];return b?P.jsx("div",{className:"flex items-center justify-center h-64",children:P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):P.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[P.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[P.jsxs("div",{className:"border-b border-gray-200 overflow-x-auto",children:[" ",P.jsxs("nav",{className:"-mb-px flex space-x-8 whitespace-nowrap",children:[" ",se.map(X=>P.jsxs("button",{onClick:()=>q(X.id),className:`
                  flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm
                  ${D===X.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[X.icon,P.jsx("span",{children:X.label})]},X.id))]})]}),P.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[D==="colors"&&P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-4 sm:space-y-0",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Color Settings"}),P.jsxs("button",{onClick:M,className:"flex items-center justify-center sm:justify-start space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors w-full sm:w-auto",children:[P.jsx(Fy,{size:16}),P.jsx("span",{children:"Generate AI Colors"})]})]}),Q("Primary Color",r,e,"Main brand color used for buttons and important elements"),Q("Secondary Color",t,n,"Supporting color for secondary elements"),Q("Title Color",o,a,"Color for main headings"),Q("Subtitle Color",l,h,"Color for subheadings"),Q("Text Color",c,d,"Color for body text"),P.jsxs("div",{className:"border-t border-gray-200 pt-6 mt-6",children:[P.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Background Colors"}),Q("Background Start",f,p,"Starting color for background gradient"),Q("Background End",_,y,"Ending color for background gradient"),Q("Section Background",g,m,"Background color for content sections")]})]}),D==="typography"&&P.jsxs("div",{className:"space-y-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Typography Settings"}),P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Font Family"}),P.jsxs("select",{value:i,onChange:X=>s(X.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[P.jsx("option",{value:"'Noto Sans', sans-serif",children:"Noto Sans"}),P.jsx("option",{value:"'Arial', sans-serif",children:"Arial"}),P.jsx("option",{value:"'Helvetica', sans-serif",children:"Helvetica"}),P.jsx("option",{value:"'Georgia', serif",children:"Georgia"}),P.jsx("option",{value:"'Times New Roman', serif",children:"Times New Roman"})]})]}),P.jsxs("div",{className:"mt-6 p-6 bg-gray-50 rounded-lg",children:[P.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Preview"}),P.jsxs("div",{style:{fontFamily:i},children:[P.jsx("h1",{style:{color:o},className:"text-4xl font-bold mb-4",children:"Heading 1"}),P.jsx("h2",{style:{color:l},className:"text-3xl font-semibold mb-4",children:"Heading 2"}),P.jsx("h3",{style:{color:l},className:"text-2xl font-medium mb-4",children:"Heading 3"}),P.jsx("p",{style:{color:c},className:"mb-4",children:"This is a paragraph of text that shows how your typography settings will look in the actual content. The quick brown fox jumps over the lazy dog."})]})]})]}),D==="layout"&&P.jsxs("div",{className:"space-y-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Layout Settings"}),P.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[P.jsxs("div",{className:"p-4 rounded",style:{backgroundColor:g},children:[P.jsx("h4",{style:{color:l},className:"text-lg font-medium mb-2",children:"Section Preview"}),P.jsx("p",{style:{color:c},className:"text-sm",children:"Preview of section background and spacing"})]}),P.jsxs("div",{className:"p-4 rounded",style:{backgroundColor:g},children:[P.jsx("h4",{style:{color:l},className:"text-lg font-medium mb-2",children:"Content Area"}),P.jsx("p",{style:{color:c},className:"text-sm",children:"Sample content area layout"})]})]})})]}),D==="advanced"&&P.jsxs("div",{className:"space-y-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Advanced Settings"}),P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:P.jsxs("div",{className:"space-y-4",children:[P.jsxs("button",{onClick:U,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors",children:[P.jsx(Gg,{size:16}),P.jsx("span",{children:"Export Theme"})]}),P.jsxs("label",{className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors cursor-pointer",children:[P.jsx(My,{size:16}),P.jsx("span",{children:"Import Theme"}),P.jsx("input",{type:"file",accept:".json",onChange:Y,className:"hidden"})]})]})})]})]}),P.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0",children:[P.jsxs("button",{onClick:()=>F(Ue),className:"w-full sm:w-auto flex items-center justify-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[P.jsx(xy,{size:16}),P.jsx("span",{children:"Reset to Defaults"})]}),P.jsxs("button",{onClick:V,disabled:v,className:"w-full sm:w-auto flex items-center justify-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[P.jsx(Of,{size:16}),P.jsx("span",{children:v?"Saving...":"Save Changes"})]})]})]}),P.jsxs("div",{className:"space-y-6",children:[P.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Global Theme"}),P.jsx(dw,{onThemeSelect:F})]}),P.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Saved Themes"}),P.jsx("div",{className:"mb-4",children:P.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[P.jsx("input",{type:"text",value:x,onChange:X=>T(X.target.value),placeholder:"Enter theme name",className:"w-full sm:flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),P.jsx("button",{onClick:$,disabled:!x.trim()||v,className:"w-full sm:w-auto px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex-shrink-0",children:"Save"})]})}),P.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:w.map(X=>P.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[P.jsx("span",{className:"font-medium text-gray-700",children:X.name}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("button",{onClick:()=>H(X),className:"text-blue-600 hover:text-blue-800",children:"Apply"}),P.jsx("button",{onClick:()=>G(X.id),className:"text-red-600 hover:text-red-800",children:P.jsx(As,{size:16})})]})]},X.id))})]})]})]})},fs=["Github","Facebook","Mail","Instagram","Linkedin","Twitter"],xh={Github:Tf,Facebook:xf,Mail:Sf,Instagram:Af,Linkedin:kf,Twitter:Nf},mw=()=>{const{showToast:r,requestConfirmation:e}=Or(),[t,n]=te.useState([]),[i,s]=te.useState(!0),[o,a]=te.useState(!1),[l,h]=te.useState(null),[c,d]=te.useState({name:"",url:"",icon:fs[0],order:0}),f=te.useMemo(()=>ve?_r(ve,"socialLinks"):null,[]),p=te.useCallback(async()=>{if(!ve||!f){r("Error: Firestore is not initialized.","error"),s(!1);return}s(!0);try{const C=uo(f,co("order","asc")),w=(await Mi(C)).docs.map(A=>({...A.data(),id:A.id}));n(w)}catch(C){console.error("Error fetching social links:",C),r("Failed to load social links. Please try again.","error")}finally{s(!1)}},[f,r]);te.useEffect(()=>{p()},[p]);const _=C=>{const{name:E,value:w}=C.target;d(A=>({...A,[E]:E==="order"?parseInt(w,10)||0:w}))},y=()=>{a(!1),h(null),d({name:"",url:"",icon:fs[0],order:0})},g=async C=>{if(C.preventDefault(),!c.name||!c.url||!c.icon){r("Name, URL, and Icon are required.","error");return}if(!ve||!f){r("Error: Firestore is not initialized.","error");return}try{const E=t.length>0?Math.max(...t.map(w=>w.order))+1:0;await Bl(f,{...c,order:E}),r("Link added successfully!","success"),y(),p()}catch(E){console.error("Error adding link:",E),r("Failed to add link. Please try again.","error")}},m=async C=>{if(C.preventDefault(),!l||!c.name||!c.url||!c.icon){r("Name, URL, and Icon are required.","error");return}if(!ve){r("Error: Firestore is not initialized.","error");return}try{const E=Ze(ve,"socialLinks",l);await Vs(E,{name:c.name,url:c.url,icon:c.icon,order:c.order}),r("Link updated successfully!","success"),y(),p()}catch(E){console.error("Error updating link:",E),r("Failed to update link. Please try again.","error")}},b=async C=>{if(C===0||!ve)return;const E=t[C],w=t[C-1],A=Va(ve),x=Ze(ve,"socialLinks",E.id),T=Ze(ve,"socialLinks",w.id);A.update(x,{order:w.order}),A.update(T,{order:E.order});try{await A.commit(),r("Link moved up successfully.","success"),p()}catch(S){console.error("Error moving link up:",S),r("Failed to reorder link. Please try again.","error")}},I=async C=>{if(C===t.length-1||!ve)return;const E=t[C],w=t[C+1],A=Va(ve),x=Ze(ve,"socialLinks",E.id),T=Ze(ve,"socialLinks",w.id);A.update(x,{order:w.order}),A.update(T,{order:E.order});try{await A.commit(),r("Link moved down successfully.","success"),p()}catch(S){console.error("Error moving link down:",S),r("Failed to reorder link. Please try again.","error")}},v=async C=>{const E=t.find(w=>w.id===C);E&&e({message:`Are you sure you want to delete the link "${E.name}"?`,onConfirm:async()=>{if(!ve){r("Error: Firestore is not initialized.","error");return}try{const w=Ze(ve,"socialLinks",C);await Ul(w),r("Link deleted successfully!","success"),p()}catch(w){console.error("Error deleting link:",w),r("Failed to delete link. Please try again.","error")}},confirmText:"Delete Link",title:"Confirm Deletion"})},N=C=>{h(C.id),d({name:C.name,url:C.url,icon:C.icon,order:C.order}),a(!1)};return P.jsxs("div",{className:"p-4 md:p-6 bg-gray-800 rounded-lg shadow-lg text-gray-200",children:[P.jsx("h2",{className:"text-2xl font-semibold mb-6 text-white",children:"Manage Social Links"})," ",i&&P.jsx("p",{className:"text-center text-gray-400",children:"Loading links..."}),(o||l)&&P.jsxs("form",{onSubmit:l?m:g,className:"mb-6 p-4 bg-gray-700 rounded-lg shadow-md",children:[P.jsx("h3",{className:"text-xl font-medium mb-4 text-white",children:l?"Edit Link":"Add New Link"}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-name",className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),P.jsx("input",{id:"link-name",type:"text",name:"name",placeholder:"Link Name (e.g., GitHub)",value:c.name,onChange:_,className:"w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:border-blue-400 focus:ring focus:ring-blue-400 focus:ring-opacity-50",required:!0})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-url",className:"block text-sm font-medium text-gray-300 mb-1",children:"URL"}),P.jsx("input",{id:"link-url",type:"url",name:"url",placeholder:"Full URL (e.g., https://github.com/user)",value:c.url,onChange:_,className:"w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:border-blue-400 focus:ring focus:ring-blue-400 focus:ring-opacity-50",required:!0})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-icon",className:"block text-sm font-medium text-gray-300 mb-1",children:"Icon"}),P.jsxs("div",{className:"flex items-center gap-2",children:[" ",P.jsxs("select",{id:"link-icon",name:"icon",value:c.icon,onChange:_,className:"flex-grow p-2 rounded bg-gray-600 text-white border border-gray-500 focus:border-blue-400 focus:ring focus:ring-blue-400 focus:ring-opacity-50",required:!0,children:[P.jsx("option",{value:"",disabled:!0,children:"Select Icon"}),fs.map(C=>P.jsx("option",{value:C,children:C},C))]}),(()=>{const C=xh[c.icon]||sc;return P.jsx(C,{size:24,className:"text-gray-400 flex-shrink-0"})})()]})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"link-order",className:"block text-sm font-medium text-gray-300 mb-1",children:"Order"}),P.jsx("input",{id:"link-order",type:"number",name:"order",placeholder:"Order (e.g., 1)",value:c.order,onChange:_,className:"w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:border-blue-400 focus:ring focus:ring-blue-400 focus:ring-opacity-50",required:!0,min:"0"})]})]}),P.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[P.jsxs("button",{type:"submit",className:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[P.jsx(Of,{size:18})," ",l?"Save Changes":"Add Link"]}),P.jsxs("button",{type:"button",onClick:y,className:"flex items-center gap-1.5 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[P.jsx(Bg,{size:18})," Cancel"]})]})]}),!o&&!l&&!i&&P.jsxs("button",{onClick:()=>{a(!0),d({name:"",url:"",icon:fs[0],order:t.length>0?Math.max(...t.map(C=>C.order))+1:0})},className:"mb-6 flex items-center gap-1.5 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition duration-150 ease-in-out shadow hover:shadow-md",children:[P.jsx(Fg,{size:18})," Add New Link"]}),!i&&t.length>0&&P.jsxs("div",{className:"space-y-3",children:[P.jsxs("div",{className:"hidden md:grid md:grid-cols-12 gap-4 bg-gray-600/80 rounded-t-lg p-3 font-semibold text-white items-center sticky top-0 z-10",children:[" ",P.jsx("div",{className:"col-span-1 text-center",children:"Order"})," ",P.jsx("div",{className:"col-span-1 text-center",children:"Icon"})," ",P.jsx("div",{className:"col-span-3",children:"Name"}),P.jsx("div",{className:"col-span-4",children:"URL"}),P.jsx("div",{className:"col-span-3 text-right pr-2",children:"Actions"})," "]}),t.map((C,E)=>{const w=xh[C.icon]||sc,A=E===0,x=E===t.length-1;return P.jsxs("div",{className:"bg-gray-700 rounded-lg shadow p-4 md:grid md:grid-cols-12 md:gap-4 md:items-center md:bg-transparent md:hover:bg-gray-600/30 md:shadow-none md:rounded-none md:border-b md:border-gray-600 md:last:border-b-0 md:py-3 md:px-3 transition-colors duration-150",children:[P.jsxs("div",{className:"md:hidden space-y-3",children:[P.jsxs("div",{className:"flex justify-between items-start gap-2",children:[P.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[" ",P.jsx(w,{size:20,className:"text-gray-300 flex-shrink-0"}),P.jsx("span",{className:"font-semibold text-lg text-white truncate",children:C.name})," "]}),P.jsxs("span",{className:"text-sm text-gray-400 flex-shrink-0",children:["(Order: ",C.order,")"]})]}),P.jsxs("div",{className:"text-sm break-words",children:[" ",P.jsx("span",{className:"font-medium text-gray-400",children:"URL: "}),P.jsx("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:C.url})]}),P.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-gray-600 mt-3",children:[P.jsx("button",{onClick:()=>b(E),disabled:A,className:`p-1 rounded ${A?"text-gray-500 cursor-not-allowed opacity-50":"text-blue-400 hover:text-blue-300 hover:bg-gray-600/50"}`,title:"Move Up",children:P.jsx(ya,{size:18})}),P.jsx("button",{onClick:()=>I(E),disabled:x,className:`p-1 rounded ${x?"text-gray-500 cursor-not-allowed opacity-50":"text-blue-400 hover:text-blue-300 hover:bg-gray-600/50"}`,title:"Move Down",children:P.jsx(ga,{size:18})}),P.jsx("button",{onClick:()=>N(C),className:"text-yellow-400 hover:text-yellow-300 hover:bg-gray-600/50 p-1 rounded",title:"Edit",children:P.jsx(va,{size:18})}),P.jsx("button",{onClick:()=>v(C.id),className:"text-red-500 hover:text-red-400 hover:bg-gray-600/50 p-1 rounded",title:"Delete",children:P.jsx(As,{size:18})})]})]})," ",P.jsxs("div",{className:"hidden md:contents",children:[" ",P.jsx("div",{className:"col-span-1 text-center",children:C.order}),P.jsxs("div",{className:"col-span-1 flex items-center justify-center",children:[" ",P.jsx(w,{size:20,className:"text-gray-300"})," "]}),P.jsx("div",{className:"col-span-3 truncate pr-2",children:C.name})," ",P.jsxs("div",{className:"col-span-4 truncate pr-2",children:[" ",P.jsx("a",{href:C.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:C.url})]}),P.jsxs("div",{className:"col-span-3 flex items-center justify-end gap-1 pr-2",children:[" ",P.jsx("button",{onClick:()=>b(E),disabled:A,className:`p-1 rounded ${A?"text-gray-500 cursor-not-allowed opacity-50":"text-blue-400 hover:text-blue-300 hover:bg-gray-600/50"}`,title:"Move Up",children:P.jsx(ya,{size:18})}),P.jsx("button",{onClick:()=>I(E),disabled:x,className:`p-1 rounded ${x?"text-gray-500 cursor-not-allowed opacity-50":"text-blue-400 hover:text-blue-300 hover:bg-gray-600/50"}`,title:"Move Down",children:P.jsx(ga,{size:18})}),P.jsx("button",{onClick:()=>N(C),className:"text-yellow-400 hover:text-yellow-300 hover:bg-gray-600/50 p-1 rounded",title:"Edit",children:P.jsx(va,{size:18})}),P.jsx("button",{onClick:()=>v(C.id),className:"text-red-500 hover:text-red-400 hover:bg-gray-600/50 p-1 rounded",title:"Delete",children:P.jsx(As,{size:18})})]})," "]})," "]},C.id)})," "]})," ",!i&&t.length===0&&!o&&P.jsxs("div",{className:"text-center text-gray-400 mt-6 p-6 border border-dashed border-gray-600 rounded-lg bg-gray-700/30",children:[P.jsx("p",{className:"font-medium",children:"No social links found."}),P.jsx("p",{className:"text-sm mt-1",children:'Click "Add New Link" above to get started.'})]})," "]})},Th=({fieldKey:r,value:e,path:t,handleChange:n,editingPath:i,setEditingPath:s})=>{const o=t.join("."),a=i===o,l=r.replace(/([A-Z])/g," $1").replace(/^./,c=>c.toUpperCase()),h=/url|link/i.test(r);return P.jsxs("div",{className:"mb-4",children:[P.jsx("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700 capitalize mb-1",children:l}),a?h?P.jsx("input",{type:"url",id:o,name:o,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:c=>n(t,c.target.value),onBlur:()=>s(null),autoFocus:!0}):P.jsx("textarea",{id:o,name:o,rows:e.length>100?5:3,className:"block w-full flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-white transition-shadow duration-150 ease-in-out",value:e,onChange:c=>n(t,c.target.value),onBlur:()=>s(null),autoFocus:!0}):P.jsx("div",{className:"block w-full flex-1 rounded-md border border-gray-200 bg-gray-50 p-2 cursor-pointer hover:bg-gray-100 min-h-[40px] whitespace-pre-wrap text-gray-800 transition-colors duration-150 ease-in-out break-words",onClick:()=>s(o),children:e||P.jsx("span",{className:"text-gray-400 italic",children:"Click to edit..."})})]},o)},gw=({translations:r,handleInputChange:e,editingPath:t,setEditingPath:n,getStaticSectionName:i})=>{const s=r.en.generalInfo,o=r.en.about;return P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[P.jsxs("div",{className:"space-y-4",children:[" ",s?Object.entries(s).map(([a,l])=>typeof l=="string"?P.jsx(Th,{fieldKey:a,value:l,path:["generalInfo",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):P.jsx("p",{className:"text-gray-500 italic",children:"General Info data not available."})]}),P.jsxs("div",{className:"space-y-4",children:[" ",P.jsx("h3",{className:"text-xl font-semibold text-gray-800 capitalize border-b border-gray-300 pb-2 mb-4",children:i("about")}),o?Object.entries(o).map(([a,l])=>typeof l=="string"?P.jsx(Th,{fieldKey:a,value:l,path:["about",a],handleChange:e,editingPath:t,setEditingPath:n},a):null):P.jsx("p",{className:"text-gray-500 italic",children:"About section data not available."})]})]})};function yw(){this.__data__=[],this.size=0}var vw=yw;function _w(r,e){return r===e||r!==r&&e!==e}var zp=_w,bw=zp;function ww(r,e){for(var t=r.length;t--;)if(bw(r[t][0],e))return t;return-1}var po=ww,Ew=po,xw=Array.prototype,Tw=xw.splice;function Aw(r){var e=this.__data__,t=Ew(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Tw.call(e,t,1),--this.size,!0}var kw=Aw,Sw=po;function Iw(r){var e=this.__data__,t=Sw(e,r);return t<0?void 0:e[t][1]}var Ow=Iw,Nw=po;function Pw(r){return Nw(this.__data__,r)>-1}var Rw=Pw,Cw=po;function jw(r,e){var t=this.__data__,n=Cw(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var Lw=jw,Dw=vw,Mw=kw,Vw=Ow,$w=Rw,qw=Lw;function jr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}jr.prototype.clear=Dw;jr.prototype.delete=Mw;jr.prototype.get=Vw;jr.prototype.has=$w;jr.prototype.set=qw;var mo=jr,Fw=mo;function Uw(){this.__data__=new Fw,this.size=0}var Bw=Uw;function zw(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var Hw=zw;function Kw(r){return this.__data__.get(r)}var Gw=Kw;function Ww(r){return this.__data__.has(r)}var Qw=Ww,Yw=typeof Ge=="object"&&Ge&&Ge.Object===Object&&Ge,Hp=Yw,Jw=Hp,Xw=typeof self=="object"&&self&&self.Object===Object&&self,Zw=Jw||Xw||Function("return this")(),cn=Zw,e2=cn,t2=e2.Symbol,eu=t2,Ah=eu,Kp=Object.prototype,n2=Kp.hasOwnProperty,r2=Kp.toString,ri=Ah?Ah.toStringTag:void 0;function i2(r){var e=n2.call(r,ri),t=r[ri];try{r[ri]=void 0;var n=!0}catch{}var i=r2.call(r);return n&&(e?r[ri]=t:delete r[ri]),i}var s2=i2,o2=Object.prototype,a2=o2.toString;function l2(r){return a2.call(r)}var u2=l2,kh=eu,c2=s2,h2=u2,f2="[object Null]",d2="[object Undefined]",Sh=kh?kh.toStringTag:void 0;function p2(r){return r==null?r===void 0?d2:f2:Sh&&Sh in Object(r)?c2(r):h2(r)}var go=p2;function m2(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Gp=m2,g2=go,y2=Gp,v2="[object AsyncFunction]",_2="[object Function]",b2="[object GeneratorFunction]",w2="[object Proxy]";function E2(r){if(!y2(r))return!1;var e=g2(r);return e==_2||e==b2||e==v2||e==w2}var Wp=E2,x2=cn,T2=x2["__core-js_shared__"],A2=T2,aa=A2,Ih=function(){var r=/[^.]+$/.exec(aa&&aa.keys&&aa.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function k2(r){return!!Ih&&Ih in r}var S2=k2,I2=Function.prototype,O2=I2.toString;function N2(r){if(r!=null){try{return O2.call(r)}catch{}try{return r+""}catch{}}return""}var Qp=N2,P2=Wp,R2=S2,C2=Gp,j2=Qp,L2=/[\\^$.*+?()[\]{}|]/g,D2=/^\[object .+?Constructor\]$/,M2=Function.prototype,V2=Object.prototype,$2=M2.toString,q2=V2.hasOwnProperty,F2=RegExp("^"+$2.call(q2).replace(L2,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U2(r){if(!C2(r)||R2(r))return!1;var e=P2(r)?F2:D2;return e.test(j2(r))}var B2=U2;function z2(r,e){return r==null?void 0:r[e]}var H2=z2,K2=B2,G2=H2;function W2(r,e){var t=G2(r,e);return K2(t)?t:void 0}var Lr=W2,Q2=Lr,Y2=cn,J2=Q2(Y2,"Map"),tu=J2,X2=Lr,Z2=X2(Object,"create"),yo=Z2,Oh=yo;function eE(){this.__data__=Oh?Oh(null):{},this.size=0}var tE=eE;function nE(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var rE=nE,iE=yo,sE="__lodash_hash_undefined__",oE=Object.prototype,aE=oE.hasOwnProperty;function lE(r){var e=this.__data__;if(iE){var t=e[r];return t===sE?void 0:t}return aE.call(e,r)?e[r]:void 0}var uE=lE,cE=yo,hE=Object.prototype,fE=hE.hasOwnProperty;function dE(r){var e=this.__data__;return cE?e[r]!==void 0:fE.call(e,r)}var pE=dE,mE=yo,gE="__lodash_hash_undefined__";function yE(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=mE&&e===void 0?gE:e,this}var vE=yE,_E=tE,bE=rE,wE=uE,EE=pE,xE=vE;function Dr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Dr.prototype.clear=_E;Dr.prototype.delete=bE;Dr.prototype.get=wE;Dr.prototype.has=EE;Dr.prototype.set=xE;var TE=Dr,Nh=TE,AE=mo,kE=tu;function SE(){this.size=0,this.__data__={hash:new Nh,map:new(kE||AE),string:new Nh}}var IE=SE;function OE(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var NE=OE,PE=NE;function RE(r,e){var t=r.__data__;return PE(e)?t[typeof e=="string"?"string":"hash"]:t.map}var vo=RE,CE=vo;function jE(r){var e=CE(this,r).delete(r);return this.size-=e?1:0,e}var LE=jE,DE=vo;function ME(r){return DE(this,r).get(r)}var VE=ME,$E=vo;function qE(r){return $E(this,r).has(r)}var FE=qE,UE=vo;function BE(r,e){var t=UE(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var zE=BE,HE=IE,KE=LE,GE=VE,WE=FE,QE=zE;function Mr(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Mr.prototype.clear=HE;Mr.prototype.delete=KE;Mr.prototype.get=GE;Mr.prototype.has=WE;Mr.prototype.set=QE;var Yp=Mr,YE=mo,JE=tu,XE=Yp,ZE=200;function ex(r,e){var t=this.__data__;if(t instanceof YE){var n=t.__data__;if(!JE||n.length<ZE-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new XE(n)}return t.set(r,e),this.size=t.size,this}var tx=ex,nx=mo,rx=Bw,ix=Hw,sx=Gw,ox=Qw,ax=tx;function Vr(r){var e=this.__data__=new nx(r);this.size=e.size}Vr.prototype.clear=rx;Vr.prototype.delete=ix;Vr.prototype.get=sx;Vr.prototype.has=ox;Vr.prototype.set=ax;var lx=Vr,ux="__lodash_hash_undefined__";function cx(r){return this.__data__.set(r,ux),this}var hx=cx;function fx(r){return this.__data__.has(r)}var dx=fx,px=Yp,mx=hx,gx=dx;function Us(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new px;++e<t;)this.add(r[e])}Us.prototype.add=Us.prototype.push=mx;Us.prototype.has=gx;var yx=Us;function vx(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var _x=vx;function bx(r,e){return r.has(e)}var wx=bx,Ex=yx,xx=_x,Tx=wx,Ax=1,kx=2;function Sx(r,e,t,n,i,s){var o=t&Ax,a=r.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var h=s.get(r),c=s.get(e);if(h&&c)return h==e&&c==r;var d=-1,f=!0,p=t&kx?new Ex:void 0;for(s.set(r,e),s.set(e,r);++d<a;){var _=r[d],y=e[d];if(n)var g=o?n(y,_,d,e,r,s):n(_,y,d,r,e,s);if(g!==void 0){if(g)continue;f=!1;break}if(p){if(!xx(e,function(m,b){if(!Tx(p,b)&&(_===m||i(_,m,t,n,s)))return p.push(b)})){f=!1;break}}else if(!(_===y||i(_,y,t,n,s))){f=!1;break}}return s.delete(r),s.delete(e),f}var Jp=Sx,Ix=cn,Ox=Ix.Uint8Array,Nx=Ox;function Px(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var Rx=Px;function Cx(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var jx=Cx,Ph=eu,Rh=Nx,Lx=zp,Dx=Jp,Mx=Rx,Vx=jx,$x=1,qx=2,Fx="[object Boolean]",Ux="[object Date]",Bx="[object Error]",zx="[object Map]",Hx="[object Number]",Kx="[object RegExp]",Gx="[object Set]",Wx="[object String]",Qx="[object Symbol]",Yx="[object ArrayBuffer]",Jx="[object DataView]",Ch=Ph?Ph.prototype:void 0,la=Ch?Ch.valueOf:void 0;function Xx(r,e,t,n,i,s,o){switch(t){case Jx:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case Yx:return!(r.byteLength!=e.byteLength||!s(new Rh(r),new Rh(e)));case Fx:case Ux:case Hx:return Lx(+r,+e);case Bx:return r.name==e.name&&r.message==e.message;case Kx:case Wx:return r==e+"";case zx:var a=Mx;case Gx:var l=n&$x;if(a||(a=Vx),r.size!=e.size&&!l)return!1;var h=o.get(r);if(h)return h==e;n|=qx,o.set(r,e);var c=Dx(a(r),a(e),n,i,s,o);return o.delete(r),c;case Qx:if(la)return la.call(r)==la.call(e)}return!1}var Zx=Xx;function eT(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var tT=eT,nT=Array.isArray,nu=nT,rT=tT,iT=nu;function sT(r,e,t){var n=e(r);return iT(r)?n:rT(n,t(r))}var oT=sT;function aT(r,e){for(var t=-1,n=r==null?0:r.length,i=0,s=[];++t<n;){var o=r[t];e(o,t,r)&&(s[i++]=o)}return s}var lT=aT;function uT(){return[]}var cT=uT,hT=lT,fT=cT,dT=Object.prototype,pT=dT.propertyIsEnumerable,jh=Object.getOwnPropertySymbols,mT=jh?function(r){return r==null?[]:(r=Object(r),hT(jh(r),function(e){return pT.call(r,e)}))}:fT,gT=mT;function yT(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var vT=yT;function _T(r){return r!=null&&typeof r=="object"}var _o=_T,bT=go,wT=_o,ET="[object Arguments]";function xT(r){return wT(r)&&bT(r)==ET}var TT=xT,Lh=TT,AT=_o,Xp=Object.prototype,kT=Xp.hasOwnProperty,ST=Xp.propertyIsEnumerable,IT=Lh(function(){return arguments}())?Lh:function(r){return AT(r)&&kT.call(r,"callee")&&!ST.call(r,"callee")},OT=IT,Bs={exports:{}};function NT(){return!1}var PT=NT;Bs.exports;(function(r,e){var t=cn,n=PT,i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,a=o?t.Buffer:void 0,l=a?a.isBuffer:void 0,h=l||n;r.exports=h})(Bs,Bs.exports);var Zp=Bs.exports,RT=9007199254740991,CT=/^(?:0|[1-9]\d*)$/;function jT(r,e){var t=typeof r;return e=e??RT,!!e&&(t=="number"||t!="symbol"&&CT.test(r))&&r>-1&&r%1==0&&r<e}var LT=jT,DT=9007199254740991;function MT(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=DT}var em=MT,VT=go,$T=em,qT=_o,FT="[object Arguments]",UT="[object Array]",BT="[object Boolean]",zT="[object Date]",HT="[object Error]",KT="[object Function]",GT="[object Map]",WT="[object Number]",QT="[object Object]",YT="[object RegExp]",JT="[object Set]",XT="[object String]",ZT="[object WeakMap]",eA="[object ArrayBuffer]",tA="[object DataView]",nA="[object Float32Array]",rA="[object Float64Array]",iA="[object Int8Array]",sA="[object Int16Array]",oA="[object Int32Array]",aA="[object Uint8Array]",lA="[object Uint8ClampedArray]",uA="[object Uint16Array]",cA="[object Uint32Array]",He={};He[nA]=He[rA]=He[iA]=He[sA]=He[oA]=He[aA]=He[lA]=He[uA]=He[cA]=!0;He[FT]=He[UT]=He[eA]=He[BT]=He[tA]=He[zT]=He[HT]=He[KT]=He[GT]=He[WT]=He[QT]=He[YT]=He[JT]=He[XT]=He[ZT]=!1;function hA(r){return qT(r)&&$T(r.length)&&!!He[VT(r)]}var fA=hA;function dA(r){return function(e){return r(e)}}var pA=dA,zs={exports:{}};zs.exports;(function(r,e){var t=Hp,n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();r.exports=a})(zs,zs.exports);var mA=zs.exports,gA=fA,yA=pA,Dh=mA,Mh=Dh&&Dh.isTypedArray,vA=Mh?yA(Mh):gA,tm=vA,_A=vT,bA=OT,wA=nu,EA=Zp,xA=LT,TA=tm,AA=Object.prototype,kA=AA.hasOwnProperty;function SA(r,e){var t=wA(r),n=!t&&bA(r),i=!t&&!n&&EA(r),s=!t&&!n&&!i&&TA(r),o=t||n||i||s,a=o?_A(r.length,String):[],l=a.length;for(var h in r)(e||kA.call(r,h))&&!(o&&(h=="length"||i&&(h=="offset"||h=="parent")||s&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||xA(h,l)))&&a.push(h);return a}var IA=SA,OA=Object.prototype;function NA(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||OA;return r===t}var PA=NA;function RA(r,e){return function(t){return r(e(t))}}var CA=RA,jA=CA,LA=jA(Object.keys,Object),DA=LA,MA=PA,VA=DA,$A=Object.prototype,qA=$A.hasOwnProperty;function FA(r){if(!MA(r))return VA(r);var e=[];for(var t in Object(r))qA.call(r,t)&&t!="constructor"&&e.push(t);return e}var UA=FA,BA=Wp,zA=em;function HA(r){return r!=null&&zA(r.length)&&!BA(r)}var KA=HA,GA=IA,WA=UA,QA=KA;function YA(r){return QA(r)?GA(r):WA(r)}var JA=YA,XA=oT,ZA=gT,ek=JA;function tk(r){return XA(r,ek,ZA)}var nk=tk,Vh=nk,rk=1,ik=Object.prototype,sk=ik.hasOwnProperty;function ok(r,e,t,n,i,s){var o=t&rk,a=Vh(r),l=a.length,h=Vh(e),c=h.length;if(l!=c&&!o)return!1;for(var d=l;d--;){var f=a[d];if(!(o?f in e:sk.call(e,f)))return!1}var p=s.get(r),_=s.get(e);if(p&&_)return p==e&&_==r;var y=!0;s.set(r,e),s.set(e,r);for(var g=o;++d<l;){f=a[d];var m=r[f],b=e[f];if(n)var I=o?n(b,m,f,e,r,s):n(m,b,f,r,e,s);if(!(I===void 0?m===b||i(m,b,t,n,s):I)){y=!1;break}g||(g=f=="constructor")}if(y&&!g){var v=r.constructor,N=e.constructor;v!=N&&"constructor"in r&&"constructor"in e&&!(typeof v=="function"&&v instanceof v&&typeof N=="function"&&N instanceof N)&&(y=!1)}return s.delete(r),s.delete(e),y}var ak=ok,lk=Lr,uk=cn,ck=lk(uk,"DataView"),hk=ck,fk=Lr,dk=cn,pk=fk(dk,"Promise"),mk=pk,gk=Lr,yk=cn,vk=gk(yk,"Set"),_k=vk,bk=Lr,wk=cn,Ek=bk(wk,"WeakMap"),xk=Ek,Ua=hk,Ba=tu,za=mk,Ha=_k,Ka=xk,nm=go,$r=Qp,$h="[object Map]",Tk="[object Object]",qh="[object Promise]",Fh="[object Set]",Uh="[object WeakMap]",Bh="[object DataView]",Ak=$r(Ua),kk=$r(Ba),Sk=$r(za),Ik=$r(Ha),Ok=$r(Ka),$n=nm;(Ua&&$n(new Ua(new ArrayBuffer(1)))!=Bh||Ba&&$n(new Ba)!=$h||za&&$n(za.resolve())!=qh||Ha&&$n(new Ha)!=Fh||Ka&&$n(new Ka)!=Uh)&&($n=function(r){var e=nm(r),t=e==Tk?r.constructor:void 0,n=t?$r(t):"";if(n)switch(n){case Ak:return Bh;case kk:return $h;case Sk:return qh;case Ik:return Fh;case Ok:return Uh}return e});var Nk=$n,ua=lx,Pk=Jp,Rk=Zx,Ck=ak,zh=Nk,Hh=nu,Kh=Zp,jk=tm,Lk=1,Gh="[object Arguments]",Wh="[object Array]",ds="[object Object]",Dk=Object.prototype,Qh=Dk.hasOwnProperty;function Mk(r,e,t,n,i,s){var o=Hh(r),a=Hh(e),l=o?Wh:zh(r),h=a?Wh:zh(e);l=l==Gh?ds:l,h=h==Gh?ds:h;var c=l==ds,d=h==ds,f=l==h;if(f&&Kh(r)){if(!Kh(e))return!1;o=!0,c=!1}if(f&&!c)return s||(s=new ua),o||jk(r)?Pk(r,e,t,n,i,s):Rk(r,e,l,t,n,i,s);if(!(t&Lk)){var p=c&&Qh.call(r,"__wrapped__"),_=d&&Qh.call(e,"__wrapped__");if(p||_){var y=p?r.value():r,g=_?e.value():e;return s||(s=new ua),i(y,g,t,n,s)}}return f?(s||(s=new ua),Ck(r,e,t,n,i,s)):!1}var Vk=Mk,$k=Vk,Yh=_o;function rm(r,e,t,n,i){return r===e?!0:r==null||e==null||!Yh(r)&&!Yh(e)?r!==r&&e!==e:$k(r,e,t,n,rm,i)}var qk=rm,Fk=qk;function Uk(r,e){return Fk(r,e)}var Bk=Uk,im={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:Ge,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:a})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),a=i(19),l=i(45),h=i(46),c=i(47),d=i(48),f=i(49),p=i(12),_=i(32),y=i(33),g=i(31),m=i(1),b={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:s.default,Format:o.default,Leaf:a.default,Embed:d.default,Scroll:l.default,Block:c.default,Inline:h.default,Text:f.default,Attributor:{Attribute:p.default,Class:_.default,Style:y.default,Store:g.default}};n.default=b},function(t,n,i){var s=this&&this.__extends||function(){var g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,b){m.__proto__=b}||function(m,b){for(var I in b)b.hasOwnProperty(I)&&(m[I]=b[I])};return function(m,b){g(m,b);function I(){this.constructor=m}m.prototype=b===null?Object.create(b):(I.prototype=b.prototype,new I)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(g){s(m,g);function m(b){var I=this;return b="[Parchment] "+b,I=g.call(this,b)||this,I.message=b,I.name=I.constructor.name,I}return m}(Error);n.ParchmentError=o;var a={},l={},h={},c={};n.DATA_KEY="__blot";var d;(function(g){g[g.TYPE=3]="TYPE",g[g.LEVEL=12]="LEVEL",g[g.ATTRIBUTE=13]="ATTRIBUTE",g[g.BLOT=14]="BLOT",g[g.INLINE=7]="INLINE",g[g.BLOCK=11]="BLOCK",g[g.BLOCK_BLOT=10]="BLOCK_BLOT",g[g.INLINE_BLOT=6]="INLINE_BLOT",g[g.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",g[g.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",g[g.ANY=15]="ANY"})(d=n.Scope||(n.Scope={}));function f(g,m){var b=_(g);if(b==null)throw new o("Unable to create "+g+" blot");var I=b,v=g instanceof Node||g.nodeType===Node.TEXT_NODE?g:I.create(m);return new I(v,m)}n.create=f;function p(g,m){return m===void 0&&(m=!1),g==null?null:g[n.DATA_KEY]!=null?g[n.DATA_KEY].blot:m?p(g.parentNode,m):null}n.find=p;function _(g,m){m===void 0&&(m=d.ANY);var b;if(typeof g=="string")b=c[g]||a[g];else if(g instanceof Text||g.nodeType===Node.TEXT_NODE)b=c.text;else if(typeof g=="number")g&d.LEVEL&d.BLOCK?b=c.block:g&d.LEVEL&d.INLINE&&(b=c.inline);else if(g instanceof HTMLElement){var I=(g.getAttribute("class")||"").split(/\s+/);for(var v in I)if(b=l[I[v]],b)break;b=b||h[g.tagName]}return b==null?null:m&d.LEVEL&b.scope&&m&d.TYPE&b.scope?b:null}n.query=_;function y(){for(var g=[],m=0;m<arguments.length;m++)g[m]=arguments[m];if(g.length>1)return g.map(function(v){return y(v)});var b=g[0];if(typeof b.blotName!="string"&&typeof b.attrName!="string")throw new o("Invalid definition");if(b.blotName==="abstract")throw new o("Cannot register abstract class");if(c[b.blotName||b.attrName]=b,typeof b.keyName=="string")a[b.keyName]=b;else if(b.className!=null&&(l[b.className]=b),b.tagName!=null){Array.isArray(b.tagName)?b.tagName=b.tagName.map(function(v){return v.toUpperCase()}):b.tagName=b.tagName.toUpperCase();var I=Array.isArray(b.tagName)?b.tagName:[b.tagName];I.forEach(function(v){(h[v]==null||b.className==null)&&(h[v]=b)})}return b}n.register=y},function(t,n,i){var s=i(51),o=i(11),a=i(3),l=i(20),h="\0",c=function(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]};c.prototype.insert=function(d,f){var p={};return d.length===0?this:(p.insert=d,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p))},c.prototype.delete=function(d){return d<=0?this:this.push({delete:d})},c.prototype.retain=function(d,f){if(d<=0)return this;var p={retain:d};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(p.attributes=f),this.push(p)},c.prototype.push=function(d){var f=this.ops.length,p=this.ops[f-1];if(d=a(!0,{},d),typeof p=="object"){if(typeof d.delete=="number"&&typeof p.delete=="number")return this.ops[f-1]={delete:p.delete+d.delete},this;if(typeof p.delete=="number"&&d.insert!=null&&(f-=1,p=this.ops[f-1],typeof p!="object"))return this.ops.unshift(d),this;if(o(d.attributes,p.attributes)){if(typeof d.insert=="string"&&typeof p.insert=="string")return this.ops[f-1]={insert:p.insert+d.insert},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof p.retain=="number")return this.ops[f-1]={retain:p.retain+d.retain},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this}}return f===this.ops.length?this.ops.push(d):this.ops.splice(f,0,d),this},c.prototype.chop=function(){var d=this.ops[this.ops.length-1];return d&&d.retain&&!d.attributes&&this.ops.pop(),this},c.prototype.filter=function(d){return this.ops.filter(d)},c.prototype.forEach=function(d){this.ops.forEach(d)},c.prototype.map=function(d){return this.ops.map(d)},c.prototype.partition=function(d){var f=[],p=[];return this.forEach(function(_){var y=d(_)?f:p;y.push(_)}),[f,p]},c.prototype.reduce=function(d,f){return this.ops.reduce(d,f)},c.prototype.changeLength=function(){return this.reduce(function(d,f){return f.insert?d+l.length(f):f.delete?d-f.delete:d},0)},c.prototype.length=function(){return this.reduce(function(d,f){return d+l.length(f)},0)},c.prototype.slice=function(d,f){d=d||0,typeof f!="number"&&(f=1/0);for(var p=[],_=l.iterator(this.ops),y=0;y<f&&_.hasNext();){var g;y<d?g=_.next(d-y):(g=_.next(f-y),p.push(g)),y+=l.length(g)}return new c(p)},c.prototype.compose=function(d){var f=l.iterator(this.ops),p=l.iterator(d.ops),_=[],y=p.peek();if(y!=null&&typeof y.retain=="number"&&y.attributes==null){for(var g=y.retain;f.peekType()==="insert"&&f.peekLength()<=g;)g-=f.peekLength(),_.push(f.next());y.retain-g>0&&p.next(y.retain-g)}for(var m=new c(_);f.hasNext()||p.hasNext();)if(p.peekType()==="insert")m.push(p.next());else if(f.peekType()==="delete")m.push(f.next());else{var b=Math.min(f.peekLength(),p.peekLength()),I=f.next(b),v=p.next(b);if(typeof v.retain=="number"){var N={};typeof I.retain=="number"?N.retain=b:N.insert=I.insert;var C=l.attributes.compose(I.attributes,v.attributes,typeof I.retain=="number");if(C&&(N.attributes=C),m.push(N),!p.hasNext()&&o(m.ops[m.ops.length-1],N)){var E=new c(f.rest());return m.concat(E).chop()}}else typeof v.delete=="number"&&typeof I.retain=="number"&&m.push(v)}return m.chop()},c.prototype.concat=function(d){var f=new c(this.ops.slice());return d.ops.length>0&&(f.push(d.ops[0]),f.ops=f.ops.concat(d.ops.slice(1))),f},c.prototype.diff=function(d,f){if(this.ops===d.ops)return new c;var p=[this,d].map(function(b){return b.map(function(I){if(I.insert!=null)return typeof I.insert=="string"?I.insert:h;var v=b===d?"on":"with";throw new Error("diff() called "+v+" non-document")}).join("")}),_=new c,y=s(p[0],p[1],f),g=l.iterator(this.ops),m=l.iterator(d.ops);return y.forEach(function(b){for(var I=b[1].length;I>0;){var v=0;switch(b[0]){case s.INSERT:v=Math.min(m.peekLength(),I),_.push(m.next(v));break;case s.DELETE:v=Math.min(I,g.peekLength()),g.next(v),_.delete(v);break;case s.EQUAL:v=Math.min(g.peekLength(),m.peekLength(),I);var N=g.next(v),C=m.next(v);o(N.insert,C.insert)?_.retain(v,l.attributes.diff(N.attributes,C.attributes)):_.push(C).delete(v);break}I-=v}}),_.chop()},c.prototype.eachLine=function(d,f){f=f||`
`;for(var p=l.iterator(this.ops),_=new c,y=0;p.hasNext();){if(p.peekType()!=="insert")return;var g=p.peek(),m=l.length(g)-p.peekLength(),b=typeof g.insert=="string"?g.insert.indexOf(f,m)-m:-1;if(b<0)_.push(p.next());else if(b>0)_.push(p.next(b));else{if(d(_,p.next(1).attributes||{},y)===!1)return;y+=1,_=new c}}_.length()>0&&d(_,{},y)},c.prototype.transform=function(d,f){if(f=!!f,typeof d=="number")return this.transformPosition(d,f);for(var p=l.iterator(this.ops),_=l.iterator(d.ops),y=new c;p.hasNext()||_.hasNext();)if(p.peekType()==="insert"&&(f||_.peekType()!=="insert"))y.retain(l.length(p.next()));else if(_.peekType()==="insert")y.push(_.next());else{var g=Math.min(p.peekLength(),_.peekLength()),m=p.next(g),b=_.next(g);if(m.delete)continue;b.delete?y.push(b):y.retain(g,l.attributes.transform(m.attributes,b.attributes,f))}return y.chop()},c.prototype.transformPosition=function(d,f){f=!!f;for(var p=l.iterator(this.ops),_=0;p.hasNext()&&_<=d;){var y=p.peekLength(),g=p.peekType();if(p.next(),g==="delete"){d-=Math.min(y,d-_);continue}else g==="insert"&&(_<d||!f)&&(d+=y);_+=y}return d},t.exports=c},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l=function(p){return typeof Array.isArray=="function"?Array.isArray(p):s.call(p)==="[object Array]"},h=function(p){if(!p||s.call(p)!=="[object Object]")return!1;var _=i.call(p,"constructor"),y=p.constructor&&p.constructor.prototype&&i.call(p.constructor.prototype,"isPrototypeOf");if(p.constructor&&!_&&!y)return!1;var g;for(g in p);return typeof g>"u"||i.call(p,g)},c=function(p,_){o&&_.name==="__proto__"?o(p,_.name,{enumerable:!0,configurable:!0,value:_.newValue,writable:!0}):p[_.name]=_.newValue},d=function(p,_){if(_==="__proto__")if(i.call(p,_)){if(a)return a(p,_).value}else return;return p[_]};t.exports=function f(){var p,_,y,g,m,b,I=arguments[0],v=1,N=arguments.length,C=!1;for(typeof I=="boolean"&&(C=I,I=arguments[1]||{},v=2),(I==null||typeof I!="object"&&typeof I!="function")&&(I={});v<N;++v)if(p=arguments[v],p!=null)for(_ in p)y=d(I,_),g=d(p,_),I!==g&&(C&&g&&(h(g)||(m=l(g)))?(m?(m=!1,b=y&&l(y)?y:[]):b=y&&h(y)?y:{},c(I,{name:_,newValue:f(C,b,g)})):typeof g<"u"&&c(I,{name:_,newValue:g}));return I}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function T(S,O){for(var D=0;D<O.length;D++){var q=O[D];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(S,q.key,q)}}return function(S,O,D){return O&&T(S.prototype,O),D&&T(S,D),S}}(),o=function T(S,O,D){S===null&&(S=Function.prototype);var q=Object.getOwnPropertyDescriptor(S,O);if(q===void 0){var B=Object.getPrototypeOf(S);return B===null?void 0:T(B,O,D)}else{if("value"in q)return q.value;var K=q.get;return K===void 0?void 0:K.call(D)}},a=i(3),l=I(a),h=i(2),c=I(h),d=i(0),f=I(d),p=i(16),_=I(p),y=i(6),g=I(y),m=i(7),b=I(m);function I(T){return T&&T.__esModule?T:{default:T}}function v(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")}function N(T,S){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:T}function C(T,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);T.prototype=Object.create(S&&S.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(T,S):T.__proto__=S)}var E=1,w=function(T){C(S,T);function S(){return v(this,S),N(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"attach",value:function(){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"attach",this).call(this),this.attributes=new f.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new c.default().insert(this.value(),(0,l.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(D,q){var B=f.default.query(D,f.default.Scope.BLOCK_ATTRIBUTE);B!=null&&this.attributes.attribute(B,q)}},{key:"formatAt",value:function(D,q,B,K){this.format(B,K)}},{key:"insertAt",value:function(D,q,B){if(typeof q=="string"&&q.endsWith(`
`)){var K=f.default.create(A.blotName);this.parent.insertBefore(K,D===0?this:this.next),K.insertAt(0,q.slice(0,-1))}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,D,q,B)}}]),S}(f.default.Embed);w.scope=f.default.Scope.BLOCK_BLOT;var A=function(T){C(S,T);function S(O){v(this,S);var D=N(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,O));return D.cache={},D}return s(S,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(f.default.Leaf).reduce(function(D,q){return q.length()===0?D:D.insert(q.value(),x(q))},new c.default).insert(`
`,x(this))),this.cache.delta}},{key:"deleteAt",value:function(D,q){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"deleteAt",this).call(this,D,q),this.cache={}}},{key:"formatAt",value:function(D,q,B,K){q<=0||(f.default.query(B,f.default.Scope.BLOCK)?D+q===this.length()&&this.format(B,K):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,D,Math.min(q,this.length()-D-1),B,K),this.cache={})}},{key:"insertAt",value:function(D,q,B){if(B!=null)return o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,D,q,B);if(q.length!==0){var K=q.split(`
`),oe=K.shift();oe.length>0&&(D<this.length()-1||this.children.tail==null?o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,Math.min(D,this.length()-1),oe):this.children.tail.insertAt(this.children.tail.length(),oe),this.cache={});var z=this;K.reduce(function(F,j){return z=z.split(F,!0),z.insertAt(0,j),j.length},D+oe.length)}}},{key:"insertBefore",value:function(D,q){var B=this.children.head;o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertBefore",this).call(this,D,q),B instanceof _.default&&B.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"length",this).call(this)+E),this.cache.length}},{key:"moveChildren",value:function(D,q){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"moveChildren",this).call(this,D,q),this.cache={}}},{key:"optimize",value:function(D){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,D),this.cache={}}},{key:"path",value:function(D){return o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"path",this).call(this,D,!0)}},{key:"removeChild",value:function(D){o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"removeChild",this).call(this,D),this.cache={}}},{key:"split",value:function(D){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(q&&(D===0||D>=this.length()-E)){var B=this.clone();return D===0?(this.parent.insertBefore(B,this),this):(this.parent.insertBefore(B,this.next),B)}else{var K=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"split",this).call(this,D,q);return this.cache={},K}}}]),S}(f.default.Block);A.blotName="block",A.tagName="P",A.defaultChild="break",A.allowedChildren=[g.default,f.default.Embed,b.default];function x(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return T==null||(typeof T.formats=="function"&&(S=(0,l.default)(S,T.formats())),T.parent==null||T.parent.blotName=="scroll"||T.parent.statics.scope!==T.statics.scope)?S:x(T.parent,S)}n.bubbleFormats=x,n.BlockEmbed=w,n.default=A},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},o=function(){function z(F,j){var V=[],$=!0,G=!1,H=void 0;try{for(var M=F[Symbol.iterator](),U;!($=(U=M.next()).done)&&(V.push(U.value),!(j&&V.length===j));$=!0);}catch(Y){G=!0,H=Y}finally{try{!$&&M.return&&M.return()}finally{if(G)throw H}}return V}return function(F,j){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return z(F,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function z(F,j){for(var V=0;V<j.length;V++){var $=j[V];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(F,$.key,$)}}return function(F,j,V){return j&&z(F.prototype,j),V&&z(F,V),F}}();i(50);var l=i(2),h=x(l),c=i(14),d=x(c),f=i(8),p=x(f),_=i(9),y=x(_),g=i(0),m=x(g),b=i(15),I=x(b),v=i(3),N=x(v),C=i(10),E=x(C),w=i(34),A=x(w);function x(z){return z&&z.__esModule?z:{default:z}}function T(z,F,j){return F in z?Object.defineProperty(z,F,{value:j,enumerable:!0,configurable:!0,writable:!0}):z[F]=j,z}function S(z,F){if(!(z instanceof F))throw new TypeError("Cannot call a class as a function")}var O=(0,E.default)("quill"),D=function(){a(z,null,[{key:"debug",value:function(j){j===!0&&(j="log"),E.default.level(j)}},{key:"find",value:function(j){return j.__quill||m.default.find(j)}},{key:"import",value:function(j){return this.imports[j]==null&&O.error("Cannot import "+j+". Are you sure it was registered?"),this.imports[j]}},{key:"register",value:function(j,V){var $=this,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof j!="string"){var H=j.attrName||j.blotName;typeof H=="string"?this.register("formats/"+H,j,V):Object.keys(j).forEach(function(M){$.register(M,j[M],V)})}else this.imports[j]!=null&&!G&&O.warn("Overwriting "+j+" with",V),this.imports[j]=V,(j.startsWith("blots/")||j.startsWith("formats/"))&&V.blotName!=="abstract"?m.default.register(V):j.startsWith("modules")&&typeof V.register=="function"&&V.register()}}]);function z(F){var j=this,V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(S(this,z),this.options=q(F,V),this.container=this.options.container,this.container==null)return O.error("Invalid Quill container",F);this.options.debug&&z.debug(this.options.debug);var $=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new p.default,this.scroll=m.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new d.default(this.scroll),this.selection=new I.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(p.default.events.EDITOR_CHANGE,function(H){H===p.default.events.TEXT_CHANGE&&j.root.classList.toggle("ql-blank",j.editor.isBlank())}),this.emitter.on(p.default.events.SCROLL_UPDATE,function(H,M){var U=j.selection.lastRange,Y=U&&U.length===0?U.index:void 0;B.call(j,function(){return j.editor.update(null,M,Y)},H)});var G=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+$+"<p><br></p></div>");this.setContents(G),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return a(z,[{key:"addContainer",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof j=="string"){var $=j;j=document.createElement("div"),j.classList.add($)}return this.container.insertBefore(j,V),j}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(j,V,$){var G=this,H=K(j,V,$),M=o(H,4);return j=M[0],V=M[1],$=M[3],B.call(this,function(){return G.editor.deleteText(j,V)},$,j,-1*V)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(j),this.container.classList.toggle("ql-disabled",!j)}},{key:"focus",value:function(){var j=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=j,this.scrollIntoView()}},{key:"format",value:function(j,V){var $=this,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:p.default.sources.API;return B.call(this,function(){var H=$.getSelection(!0),M=new h.default;if(H==null)return M;if(m.default.query(j,m.default.Scope.BLOCK))M=$.editor.formatLine(H.index,H.length,T({},j,V));else{if(H.length===0)return $.selection.format(j,V),M;M=$.editor.formatText(H.index,H.length,T({},j,V))}return $.setSelection(H,p.default.sources.SILENT),M},G)}},{key:"formatLine",value:function(j,V,$,G,H){var M=this,U=void 0,Y=K(j,V,$,G,H),Q=o(Y,4);return j=Q[0],V=Q[1],U=Q[2],H=Q[3],B.call(this,function(){return M.editor.formatLine(j,V,U)},H,j,0)}},{key:"formatText",value:function(j,V,$,G,H){var M=this,U=void 0,Y=K(j,V,$,G,H),Q=o(Y,4);return j=Q[0],V=Q[1],U=Q[2],H=Q[3],B.call(this,function(){return M.editor.formatText(j,V,U)},H,j,0)}},{key:"getBounds",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=void 0;typeof j=="number"?$=this.selection.getBounds(j,V):$=this.selection.getBounds(j.index,j.length);var G=this.container.getBoundingClientRect();return{bottom:$.bottom-G.top,height:$.height,left:$.left-G.left,right:$.right-G.left,top:$.top-G.top,width:$.width}}},{key:"getContents",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-j,$=K(j,V),G=o($,2);return j=G[0],V=G[1],this.editor.getContents(j,V)}},{key:"getFormat",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof j=="number"?this.editor.getFormat(j,V):this.editor.getFormat(j.index,j.length)}},{key:"getIndex",value:function(j){return j.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(j){return this.scroll.leaf(j)}},{key:"getLine",value:function(j){return this.scroll.line(j)}},{key:"getLines",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof j!="number"?this.scroll.lines(j.index,j.length):this.scroll.lines(j,V)}},{key:"getModule",value:function(j){return this.theme.modules[j]}},{key:"getSelection",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return j&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-j,$=K(j,V),G=o($,2);return j=G[0],V=G[1],this.editor.getText(j,V)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(j,V,$){var G=this,H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:z.sources.API;return B.call(this,function(){return G.editor.insertEmbed(j,V,$)},H,j)}},{key:"insertText",value:function(j,V,$,G,H){var M=this,U=void 0,Y=K(j,0,$,G,H),Q=o(Y,4);return j=Q[0],U=Q[2],H=Q[3],B.call(this,function(){return M.editor.insertText(j,V,U)},H,j,V.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(j,V,$){this.clipboard.dangerouslyPasteHTML(j,V,$)}},{key:"removeFormat",value:function(j,V,$){var G=this,H=K(j,V,$),M=o(H,4);return j=M[0],V=M[1],$=M[3],B.call(this,function(){return G.editor.removeFormat(j,V)},$,j)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(j){var V=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return B.call(this,function(){j=new h.default(j);var G=V.getLength(),H=V.editor.deleteText(0,G),M=V.editor.applyDelta(j),U=M.ops[M.ops.length-1];U!=null&&typeof U.insert=="string"&&U.insert[U.insert.length-1]===`
`&&(V.editor.deleteText(V.getLength()-1,1),M.delete(1));var Y=H.compose(M);return Y},$)}},{key:"setSelection",value:function(j,V,$){if(j==null)this.selection.setRange(null,V||z.sources.API);else{var G=K(j,V,$),H=o(G,4);j=H[0],V=H[1],$=H[3],this.selection.setRange(new b.Range(j,V),$),$!==p.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API,$=new h.default().insert(j);return this.setContents($,V)}},{key:"update",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p.default.sources.USER,V=this.scroll.update(j);return this.selection.update(j),V}},{key:"updateContents",value:function(j){var V=this,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.default.sources.API;return B.call(this,function(){return j=new h.default(j),V.editor.applyDelta(j,$)},$,!0)}}]),z}();D.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},D.events=p.default.events,D.sources=p.default.sources,D.version="1.3.7",D.imports={delta:h.default,parchment:m.default,"core/module":y.default,"core/theme":A.default};function q(z,F){if(F=(0,N.default)(!0,{container:z,modules:{clipboard:!0,keyboard:!0,history:!0}},F),!F.theme||F.theme===D.DEFAULTS.theme)F.theme=A.default;else if(F.theme=D.import("themes/"+F.theme),F.theme==null)throw new Error("Invalid theme "+F.theme+". Did you register it?");var j=(0,N.default)(!0,{},F.theme.DEFAULTS);[j,F].forEach(function(G){G.modules=G.modules||{},Object.keys(G.modules).forEach(function(H){G.modules[H]===!0&&(G.modules[H]={})})});var V=Object.keys(j.modules).concat(Object.keys(F.modules)),$=V.reduce(function(G,H){var M=D.import("modules/"+H);return M==null?O.error("Cannot load "+H+" module. Are you sure you registered it?"):G[H]=M.DEFAULTS||{},G},{});return F.modules!=null&&F.modules.toolbar&&F.modules.toolbar.constructor!==Object&&(F.modules.toolbar={container:F.modules.toolbar}),F=(0,N.default)(!0,{},D.DEFAULTS,{modules:$},j,F),["bounds","container","scrollingContainer"].forEach(function(G){typeof F[G]=="string"&&(F[G]=document.querySelector(F[G]))}),F.modules=Object.keys(F.modules).reduce(function(G,H){return F.modules[H]&&(G[H]=F.modules[H]),G},{}),F}function B(z,F,j,V){if(this.options.strict&&!this.isEnabled()&&F===p.default.sources.USER)return new h.default;var $=j==null?null:this.getSelection(),G=this.editor.delta,H=z();if($!=null&&(j===!0&&(j=$.index),V==null?$=oe($,H,F):V!==0&&($=oe($,j,V,F)),this.setSelection($,p.default.sources.SILENT)),H.length()>0){var M,U=[p.default.events.TEXT_CHANGE,H,G,F];if((M=this.emitter).emit.apply(M,[p.default.events.EDITOR_CHANGE].concat(U)),F!==p.default.sources.SILENT){var Y;(Y=this.emitter).emit.apply(Y,U)}}return H}function K(z,F,j,V,$){var G={};return typeof z.index=="number"&&typeof z.length=="number"?typeof F!="number"?($=V,V=j,j=F,F=z.length,z=z.index):(F=z.length,z=z.index):typeof F!="number"&&($=V,V=j,j=F,F=0),(typeof j>"u"?"undefined":s(j))==="object"?(G=j,$=V):typeof j=="string"&&(V!=null?G[j]=V:$=j),$=$||p.default.sources.API,[z,F,G,$]}function oe(z,F,j,V){if(z==null)return null;var $=void 0,G=void 0;if(F instanceof h.default){var H=[z.index,z.index+z.length].map(function(Q){return F.transformPosition(Q,V!==p.default.sources.USER)}),M=o(H,2);$=M[0],G=M[1]}else{var U=[z.index,z.index+z.length].map(function(Q){return Q<F||Q===F&&V===p.default.sources.USER?Q:j>=0?Q+j:Math.max(F,Q+j)}),Y=o(U,2);$=Y[0],G=Y[1]}return new b.Range($,G-$)}n.expandConfig=q,n.overload=K,n.default=D},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function g(m,b){for(var I=0;I<b.length;I++){var v=b[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,I){return b&&g(m.prototype,b),I&&g(m,I),m}}(),o=function g(m,b,I){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var N=Object.getPrototypeOf(m);return N===null?void 0:g(N,b,I)}else{if("value"in v)return v.value;var C=v.get;return C===void 0?void 0:C.call(I)}},a=i(7),l=d(a),h=i(0),c=d(h);function d(g){return g&&g.__esModule?g:{default:g}}function f(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function p(g,m){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:g}function _(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(g,m):g.__proto__=m)}var y=function(g){_(m,g);function m(){return f(this,m),p(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"formatAt",value:function(I,v,N,C){if(m.compare(this.statics.blotName,N)<0&&c.default.query(N,c.default.Scope.BLOT)){var E=this.isolate(I,v);C&&E.wrap(N,C)}else o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"formatAt",this).call(this,I,v,N,C)}},{key:"optimize",value:function(I){if(o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,I),this.parent instanceof m&&m.compare(this.statics.blotName,this.parent.statics.blotName)>0){var v=this.parent.isolate(this.offset(),this.length());this.moveChildren(v),v.wrap(this)}}}],[{key:"compare",value:function(I,v){var N=m.order.indexOf(I),C=m.order.indexOf(v);return N>=0||C>=0?N-C:I===v?0:I<v?-1:1}}]),m}(c.default.Inline);y.allowedChildren=[y,c.default.Embed,l.default],y.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function h(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){c(p,f);function p(){return l(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default.Text);n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(I,v){for(var N=0;N<v.length;N++){var C=v[N];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(I,C.key,C)}}return function(I,v,N){return v&&b(I.prototype,v),N&&b(I,N),I}}(),o=function b(I,v,N){I===null&&(I=Function.prototype);var C=Object.getOwnPropertyDescriptor(I,v);if(C===void 0){var E=Object.getPrototypeOf(I);return E===null?void 0:b(E,v,N)}else{if("value"in C)return C.value;var w=C.get;return w===void 0?void 0:w.call(N)}},a=i(54),l=d(a),h=i(10),c=d(h);function d(b){return b&&b.__esModule?b:{default:b}}function f(b,I){if(!(b instanceof I))throw new TypeError("Cannot call a class as a function")}function p(b,I){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:b}function _(b,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);b.prototype=Object.create(I&&I.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(b,I):b.__proto__=I)}var y=(0,c.default)("quill:events"),g=["selectionchange","mousedown","mouseup","click"];g.forEach(function(b){document.addEventListener(b,function(){for(var I=arguments.length,v=Array(I),N=0;N<I;N++)v[N]=arguments[N];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(C){if(C.__quill&&C.__quill.emitter){var E;(E=C.__quill.emitter).handleDOM.apply(E,v)}})})});var m=function(b){_(I,b);function I(){f(this,I);var v=p(this,(I.__proto__||Object.getPrototypeOf(I)).call(this));return v.listeners={},v.on("error",y.error),v}return s(I,[{key:"emit",value:function(){y.log.apply(y,arguments),o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(N){for(var C=arguments.length,E=Array(C>1?C-1:0),w=1;w<C;w++)E[w-1]=arguments[w];(this.listeners[N.type]||[]).forEach(function(A){var x=A.node,T=A.handler;(N.target===x||x.contains(N.target))&&T.apply(void 0,[N].concat(E))})}},{key:"listenDOM",value:function(N,C,E){this.listeners[N]||(this.listeners[N]=[]),this.listeners[N].push({node:C,handler:E})}}]),I}(l.default);m.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},m.sources={API:"api",SILENT:"silent",USER:"user"},n.default=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}var o=function a(l){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,a),this.quill=l,this.options=h};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function a(h){if(s.indexOf(h)<=s.indexOf(o)){for(var c,d=arguments.length,f=Array(d>1?d-1:0),p=1;p<d;p++)f[p-1]=arguments[p];(c=console)[h].apply(c,f)}}function l(h){return s.reduce(function(c,d){return c[d]=a.bind(console,d,h),c},{})}a.level=l.level=function(h){o=h},n.default=l},function(t,n,i){var s=Array.prototype.slice,o=i(52),a=i(53),l=t.exports=function(f,p,_){return _||(_={}),f===p?!0:f instanceof Date&&p instanceof Date?f.getTime()===p.getTime():!f||!p||typeof f!="object"&&typeof p!="object"?_.strict?f===p:f==p:d(f,p,_)};function h(f){return f==null}function c(f){return!(!f||typeof f!="object"||typeof f.length!="number"||typeof f.copy!="function"||typeof f.slice!="function"||f.length>0&&typeof f[0]!="number")}function d(f,p,_){var y,g;if(h(f)||h(p)||f.prototype!==p.prototype)return!1;if(a(f))return a(p)?(f=s.call(f),p=s.call(p),l(f,p,_)):!1;if(c(f)){if(!c(p)||f.length!==p.length)return!1;for(y=0;y<f.length;y++)if(f[y]!==p[y])return!1;return!0}try{var m=o(f),b=o(p)}catch{return!1}if(m.length!=b.length)return!1;for(m.sort(),b.sort(),y=m.length-1;y>=0;y--)if(m[y]!=b[y])return!1;for(y=m.length-1;y>=0;y--)if(g=m[y],!l(f[g],p[g],_))return!1;return typeof f==typeof p}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l,h,c){c===void 0&&(c={}),this.attrName=l,this.keyName=h;var d=s.Scope.TYPE&s.Scope.ATTRIBUTE;c.scope!=null?this.scope=c.scope&s.Scope.LEVEL|d:this.scope=s.Scope.ATTRIBUTE,c.whitelist!=null&&(this.whitelist=c.whitelist)}return a.keys=function(l){return[].map.call(l.attributes,function(h){return h.name})},a.prototype.add=function(l,h){return this.canAdd(l,h)?(l.setAttribute(this.keyName,h),!0):!1},a.prototype.canAdd=function(l,h){var c=s.query(l,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return c==null?!1:this.whitelist==null?!0:typeof h=="string"?this.whitelist.indexOf(h.replace(/["']/g,""))>-1:this.whitelist.indexOf(h)>-1},a.prototype.remove=function(l){l.removeAttribute(this.keyName)},a.prototype.value=function(l){var h=l.getAttribute(this.keyName);return this.canAdd(l,h)&&h?h:""},a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function w(A,x){var T=[],S=!0,O=!1,D=void 0;try{for(var q=A[Symbol.iterator](),B;!(S=(B=q.next()).done)&&(T.push(B.value),!(x&&T.length===x));S=!0);}catch(K){O=!0,D=K}finally{try{!S&&q.return&&q.return()}finally{if(O)throw D}}return T}return function(A,x){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return w(A,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(A,x){for(var T=0;T<x.length;T++){var S=x[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(A,S.key,S)}}return function(A,x,T){return x&&w(A.prototype,x),T&&w(A,T),A}}(),a=function w(A,x,T){A===null&&(A=Function.prototype);var S=Object.getOwnPropertyDescriptor(A,x);if(S===void 0){var O=Object.getPrototypeOf(A);return O===null?void 0:w(O,x,T)}else{if("value"in S)return S.value;var D=S.get;return D===void 0?void 0:D.call(T)}},l=i(2),h=b(l),c=i(0),d=b(c),f=i(4),p=b(f),_=i(6),y=b(_),g=i(7),m=b(g);function b(w){return w&&w.__esModule?w:{default:w}}function I(w,A){if(!(w instanceof A))throw new TypeError("Cannot call a class as a function")}function v(w,A){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:w}function N(w,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);w.prototype=Object.create(A&&A.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(w,A):w.__proto__=A)}var C=function(w){N(A,w);function A(){return I(this,A),v(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(y.default);C.blotName="code",C.tagName="CODE";var E=function(w){N(A,w);function A(){return I(this,A),v(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return o(A,[{key:"delta",value:function(){var T=this,S=this.domNode.textContent;return S.endsWith(`
`)&&(S=S.slice(0,-1)),S.split(`
`).reduce(function(O,D){return O.insert(D).insert(`
`,T.formats())},new h.default)}},{key:"format",value:function(T,S){if(!(T===this.statics.blotName&&S)){var O=this.descendant(m.default,this.length()-1),D=s(O,1),q=D[0];q!=null&&q.deleteAt(q.length()-1,1),a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"format",this).call(this,T,S)}}},{key:"formatAt",value:function(T,S,O,D){if(S!==0&&!(d.default.query(O,d.default.Scope.BLOCK)==null||O===this.statics.blotName&&D===this.statics.formats(this.domNode))){var q=this.newlineIndex(T);if(!(q<0||q>=T+S)){var B=this.newlineIndex(T,!0)+1,K=q-B+1,oe=this.isolate(B,K),z=oe.next;oe.format(O,D),z instanceof A&&z.formatAt(0,T-B+S-K,O,D)}}}},{key:"insertAt",value:function(T,S,O){if(O==null){var D=this.descendant(m.default,T),q=s(D,2),B=q[0],K=q[1];B.insertAt(K,S)}}},{key:"length",value:function(){var T=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?T:T+1}},{key:"newlineIndex",value:function(T){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(S)return this.domNode.textContent.slice(0,T).lastIndexOf(`
`);var O=this.domNode.textContent.slice(T).indexOf(`
`);return O>-1?T+O:-1}},{key:"optimize",value:function(T){this.domNode.textContent.endsWith(`
`)||this.appendChild(d.default.create("text",`
`)),a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"optimize",this).call(this,T);var S=this.next;S!=null&&S.prev===this&&S.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===S.statics.formats(S.domNode)&&(S.optimize(T),S.moveChildren(this),S.remove())}},{key:"replace",value:function(T){a(A.prototype.__proto__||Object.getPrototypeOf(A.prototype),"replace",this).call(this,T),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(S){var O=d.default.find(S);O==null?S.parentNode.removeChild(S):O instanceof d.default.Embed?O.remove():O.unwrap()})}}],[{key:"create",value:function(T){var S=a(A.__proto__||Object.getPrototypeOf(A),"create",this).call(this,T);return S.setAttribute("spellcheck",!1),S}},{key:"formats",value:function(){return!0}}]),A}(p.default);E.blotName="code-block",E.tagName="PRE",E.TAB="  ",n.Code=C,n.default=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},o=function(){function z(F,j){var V=[],$=!0,G=!1,H=void 0;try{for(var M=F[Symbol.iterator](),U;!($=(U=M.next()).done)&&(V.push(U.value),!(j&&V.length===j));$=!0);}catch(Y){G=!0,H=Y}finally{try{!$&&M.return&&M.return()}finally{if(G)throw H}}return V}return function(F,j){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return z(F,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function z(F,j){for(var V=0;V<j.length;V++){var $=j[V];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(F,$.key,$)}}return function(F,j,V){return j&&z(F.prototype,j),V&&z(F,V),F}}(),l=i(2),h=S(l),c=i(20),d=S(c),f=i(0),p=S(f),_=i(13),y=S(_),g=i(24),m=S(g),b=i(4),I=S(b),v=i(16),N=S(v),C=i(21),E=S(C),w=i(11),A=S(w),x=i(3),T=S(x);function S(z){return z&&z.__esModule?z:{default:z}}function O(z,F,j){return F in z?Object.defineProperty(z,F,{value:j,enumerable:!0,configurable:!0,writable:!0}):z[F]=j,z}function D(z,F){if(!(z instanceof F))throw new TypeError("Cannot call a class as a function")}var q=/^[ -~]*$/,B=function(){function z(F){D(this,z),this.scroll=F,this.delta=this.getDelta()}return a(z,[{key:"applyDelta",value:function(j){var V=this,$=!1;this.scroll.update();var G=this.scroll.length();return this.scroll.batchStart(),j=oe(j),j.reduce(function(H,M){var U=M.retain||M.delete||M.insert.length||1,Y=M.attributes||{};if(M.insert!=null){if(typeof M.insert=="string"){var Q=M.insert;Q.endsWith(`
`)&&$&&($=!1,Q=Q.slice(0,-1)),H>=G&&!Q.endsWith(`
`)&&($=!0),V.scroll.insertAt(H,Q);var se=V.scroll.line(H),X=o(se,2),ue=X[0],pe=X[1],de=(0,T.default)({},(0,b.bubbleFormats)(ue));if(ue instanceof I.default){var Ae=ue.descendant(p.default.Leaf,pe),We=o(Ae,1),qe=We[0];de=(0,T.default)(de,(0,b.bubbleFormats)(qe))}Y=d.default.attributes.diff(de,Y)||{}}else if(s(M.insert)==="object"){var ne=Object.keys(M.insert)[0];if(ne==null)return H;V.scroll.insertAt(H,ne,M.insert[ne])}G+=U}return Object.keys(Y).forEach(function(re){V.scroll.formatAt(H,U,re,Y[re])}),H+U},0),j.reduce(function(H,M){return typeof M.delete=="number"?(V.scroll.deleteAt(H,M.delete),H):H+(M.retain||M.insert.length||1)},0),this.scroll.batchEnd(),this.update(j)}},{key:"deleteText",value:function(j,V){return this.scroll.deleteAt(j,V),this.update(new h.default().retain(j).delete(V))}},{key:"formatLine",value:function(j,V){var $=this,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(G).forEach(function(H){if(!($.scroll.whitelist!=null&&!$.scroll.whitelist[H])){var M=$.scroll.lines(j,Math.max(V,1)),U=V;M.forEach(function(Y){var Q=Y.length();if(!(Y instanceof y.default))Y.format(H,G[H]);else{var se=j-Y.offset($.scroll),X=Y.newlineIndex(se+U)-se+1;Y.formatAt(se,X,H,G[H])}U-=Q})}}),this.scroll.optimize(),this.update(new h.default().retain(j).retain(V,(0,E.default)(G)))}},{key:"formatText",value:function(j,V){var $=this,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(G).forEach(function(H){$.scroll.formatAt(j,V,H,G[H])}),this.update(new h.default().retain(j).retain(V,(0,E.default)(G)))}},{key:"getContents",value:function(j,V){return this.delta.slice(j,j+V)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(j,V){return j.concat(V.delta())},new h.default)}},{key:"getFormat",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,$=[],G=[];V===0?this.scroll.path(j).forEach(function(M){var U=o(M,1),Y=U[0];Y instanceof I.default?$.push(Y):Y instanceof p.default.Leaf&&G.push(Y)}):($=this.scroll.lines(j,V),G=this.scroll.descendants(p.default.Leaf,j,V));var H=[$,G].map(function(M){if(M.length===0)return{};for(var U=(0,b.bubbleFormats)(M.shift());Object.keys(U).length>0;){var Y=M.shift();if(Y==null)return U;U=K((0,b.bubbleFormats)(Y),U)}return U});return T.default.apply(T.default,H)}},{key:"getText",value:function(j,V){return this.getContents(j,V).filter(function($){return typeof $.insert=="string"}).map(function($){return $.insert}).join("")}},{key:"insertEmbed",value:function(j,V,$){return this.scroll.insertAt(j,V,$),this.update(new h.default().retain(j).insert(O({},V,$)))}},{key:"insertText",value:function(j,V){var $=this,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return V=V.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(j,V),Object.keys(G).forEach(function(H){$.scroll.formatAt(j,V.length,H,G[H])}),this.update(new h.default().retain(j).insert(V,(0,E.default)(G)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var j=this.scroll.children.head;return j.statics.blotName!==I.default.blotName||j.children.length>1?!1:j.children.head instanceof N.default}},{key:"removeFormat",value:function(j,V){var $=this.getText(j,V),G=this.scroll.line(j+V),H=o(G,2),M=H[0],U=H[1],Y=0,Q=new h.default;M!=null&&(M instanceof y.default?Y=M.newlineIndex(U)-U+1:Y=M.length()-U,Q=M.delta().slice(U,U+Y-1).insert(`
`));var se=this.getContents(j,V+Y),X=se.diff(new h.default().insert($).concat(Q)),ue=new h.default().retain(j).concat(X);return this.applyDelta(ue)}},{key:"update",value:function(j){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],$=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,G=this.delta;if(V.length===1&&V[0].type==="characterData"&&V[0].target.data.match(q)&&p.default.find(V[0].target)){var H=p.default.find(V[0].target),M=(0,b.bubbleFormats)(H),U=H.offset(this.scroll),Y=V[0].oldValue.replace(m.default.CONTENTS,""),Q=new h.default().insert(Y),se=new h.default().insert(H.value()),X=new h.default().retain(U).concat(Q.diff(se,$));j=X.reduce(function(ue,pe){return pe.insert?ue.insert(pe.insert,M):ue.push(pe)},new h.default),this.delta=G.compose(j)}else this.delta=this.getDelta(),(!j||!(0,A.default)(G.compose(j),this.delta))&&(j=G.diff(this.delta,$));return j}}]),z}();function K(z,F){return Object.keys(F).reduce(function(j,V){return z[V]==null||(F[V]===z[V]?j[V]=F[V]:Array.isArray(F[V])?F[V].indexOf(z[V])<0&&(j[V]=F[V].concat([z[V]])):j[V]=[F[V],z[V]]),j},{})}function oe(z){return z.reduce(function(F,j){if(j.insert===1){var V=(0,E.default)(j.attributes);return delete V.image,F.insert({image:j.attributes.image},V)}if(j.attributes!=null&&(j.attributes.list===!0||j.attributes.bullet===!0)&&(j=(0,E.default)(j),j.attributes.list?j.attributes.list="ordered":(j.attributes.list="bullet",delete j.attributes.bullet)),typeof j.insert=="string"){var $=j.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return F.insert($,j.attributes)}return F.push(j)},new h.default)}n.default=B},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function w(A,x){var T=[],S=!0,O=!1,D=void 0;try{for(var q=A[Symbol.iterator](),B;!(S=(B=q.next()).done)&&(T.push(B.value),!(x&&T.length===x));S=!0);}catch(K){O=!0,D=K}finally{try{!S&&q.return&&q.return()}finally{if(O)throw D}}return T}return function(A,x){if(Array.isArray(A))return A;if(Symbol.iterator in Object(A))return w(A,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function w(A,x){for(var T=0;T<x.length;T++){var S=x[T];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(A,S.key,S)}}return function(A,x,T){return x&&w(A.prototype,x),T&&w(A,T),A}}(),a=i(0),l=m(a),h=i(21),c=m(h),d=i(11),f=m(d),p=i(8),_=m(p),y=i(10),g=m(y);function m(w){return w&&w.__esModule?w:{default:w}}function b(w){if(Array.isArray(w)){for(var A=0,x=Array(w.length);A<w.length;A++)x[A]=w[A];return x}else return Array.from(w)}function I(w,A){if(!(w instanceof A))throw new TypeError("Cannot call a class as a function")}var v=(0,g.default)("quill:selection"),N=function w(A){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;I(this,w),this.index=A,this.length=x},C=function(){function w(A,x){var T=this;I(this,w),this.emitter=x,this.scroll=A,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=l.default.create("cursor",this),this.lastRange=this.savedRange=new N(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){T.mouseDown||setTimeout(T.update.bind(T,_.default.sources.USER),1)}),this.emitter.on(_.default.events.EDITOR_CHANGE,function(S,O){S===_.default.events.TEXT_CHANGE&&O.length()>0&&T.update(_.default.sources.SILENT)}),this.emitter.on(_.default.events.SCROLL_BEFORE_UPDATE,function(){if(T.hasFocus()){var S=T.getNativeRange();S!=null&&S.start.node!==T.cursor.textNode&&T.emitter.once(_.default.events.SCROLL_UPDATE,function(){try{T.setNativeRange(S.start.node,S.start.offset,S.end.node,S.end.offset)}catch{}})}}),this.emitter.on(_.default.events.SCROLL_OPTIMIZE,function(S,O){if(O.range){var D=O.range,q=D.startNode,B=D.startOffset,K=D.endNode,oe=D.endOffset;T.setNativeRange(q,B,K,oe)}}),this.update(_.default.sources.SILENT)}return o(w,[{key:"handleComposition",value:function(){var x=this;this.root.addEventListener("compositionstart",function(){x.composing=!0}),this.root.addEventListener("compositionend",function(){if(x.composing=!1,x.cursor.parent){var T=x.cursor.restore();if(!T)return;setTimeout(function(){x.setNativeRange(T.startNode,T.startOffset,T.endNode,T.endOffset)},1)}})}},{key:"handleDragging",value:function(){var x=this;this.emitter.listenDOM("mousedown",document.body,function(){x.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){x.mouseDown=!1,x.update(_.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(x,T){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[x])){this.scroll.update();var S=this.getNativeRange();if(!(S==null||!S.native.collapsed||l.default.query(x,l.default.Scope.BLOCK))){if(S.start.node!==this.cursor.textNode){var O=l.default.find(S.start.node,!1);if(O==null)return;if(O instanceof l.default.Leaf){var D=O.split(S.start.offset);O.parent.insertBefore(this.cursor,D)}else O.insertBefore(this.cursor,S.start.node);this.cursor.attach()}this.cursor.format(x,T),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=this.scroll.length();x=Math.min(x,S-1),T=Math.min(x+T,S-1)-x;var O=void 0,D=this.scroll.leaf(x),q=s(D,2),B=q[0],K=q[1];if(B==null)return null;var oe=B.position(K,!0),z=s(oe,2);O=z[0],K=z[1];var F=document.createRange();if(T>0){F.setStart(O,K);var j=this.scroll.leaf(x+T),V=s(j,2);if(B=V[0],K=V[1],B==null)return null;var $=B.position(K,!0),G=s($,2);return O=G[0],K=G[1],F.setEnd(O,K),F.getBoundingClientRect()}else{var H="left",M=void 0;return O instanceof Text?(K<O.data.length?(F.setStart(O,K),F.setEnd(O,K+1)):(F.setStart(O,K-1),F.setEnd(O,K),H="right"),M=F.getBoundingClientRect()):(M=B.domNode.getBoundingClientRect(),K>0&&(H="right")),{bottom:M.top+M.height,height:M.height,left:M[H],right:M[H],top:M.top,width:0}}}},{key:"getNativeRange",value:function(){var x=document.getSelection();if(x==null||x.rangeCount<=0)return null;var T=x.getRangeAt(0);if(T==null)return null;var S=this.normalizeNative(T);return v.info("getNativeRange",S),S}},{key:"getRange",value:function(){var x=this.getNativeRange();if(x==null)return[null,null];var T=this.normalizedToRange(x);return[T,x]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(x){var T=this,S=[[x.start.node,x.start.offset]];x.native.collapsed||S.push([x.end.node,x.end.offset]);var O=S.map(function(B){var K=s(B,2),oe=K[0],z=K[1],F=l.default.find(oe,!0),j=F.offset(T.scroll);return z===0?j:F instanceof l.default.Container?j+F.length():j+F.index(oe,z)}),D=Math.min(Math.max.apply(Math,b(O)),this.scroll.length()-1),q=Math.min.apply(Math,[D].concat(b(O)));return new N(q,D-q)}},{key:"normalizeNative",value:function(x){if(!E(this.root,x.startContainer)||!x.collapsed&&!E(this.root,x.endContainer))return null;var T={start:{node:x.startContainer,offset:x.startOffset},end:{node:x.endContainer,offset:x.endOffset},native:x};return[T.start,T.end].forEach(function(S){for(var O=S.node,D=S.offset;!(O instanceof Text)&&O.childNodes.length>0;)if(O.childNodes.length>D)O=O.childNodes[D],D=0;else if(O.childNodes.length===D)O=O.lastChild,D=O instanceof Text?O.data.length:O.childNodes.length+1;else break;S.node=O,S.offset=D}),T}},{key:"rangeToNative",value:function(x){var T=this,S=x.collapsed?[x.index]:[x.index,x.index+x.length],O=[],D=this.scroll.length();return S.forEach(function(q,B){q=Math.min(D-1,q);var K=void 0,oe=T.scroll.leaf(q),z=s(oe,2),F=z[0],j=z[1],V=F.position(j,B!==0),$=s(V,2);K=$[0],j=$[1],O.push(K,j)}),O.length<2&&(O=O.concat(O)),O}},{key:"scrollIntoView",value:function(x){var T=this.lastRange;if(T!=null){var S=this.getBounds(T.index,T.length);if(S!=null){var O=this.scroll.length()-1,D=this.scroll.line(Math.min(T.index,O)),q=s(D,1),B=q[0],K=B;if(T.length>0){var oe=this.scroll.line(Math.min(T.index+T.length,O)),z=s(oe,1);K=z[0]}if(!(B==null||K==null)){var F=x.getBoundingClientRect();S.top<F.top?x.scrollTop-=F.top-S.top:S.bottom>F.bottom&&(x.scrollTop+=S.bottom-F.bottom)}}}}},{key:"setNativeRange",value:function(x,T){var S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:T,D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(v.info("setNativeRange",x,T,S,O),!(x!=null&&(this.root.parentNode==null||x.parentNode==null||S.parentNode==null))){var q=document.getSelection();if(q!=null)if(x!=null){this.hasFocus()||this.root.focus();var B=(this.getNativeRange()||{}).native;if(B==null||D||x!==B.startContainer||T!==B.startOffset||S!==B.endContainer||O!==B.endOffset){x.tagName=="BR"&&(T=[].indexOf.call(x.parentNode.childNodes,x),x=x.parentNode),S.tagName=="BR"&&(O=[].indexOf.call(S.parentNode.childNodes,S),S=S.parentNode);var K=document.createRange();K.setStart(x,T),K.setEnd(S,O),q.removeAllRanges(),q.addRange(K)}}else q.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;if(typeof T=="string"&&(S=T,T=!1),v.info("setRange",x),x!=null){var O=this.rangeToNative(x);this.setNativeRange.apply(this,b(O).concat([T]))}else this.setNativeRange(null);this.update(S)}},{key:"update",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,T=this.lastRange,S=this.getRange(),O=s(S,2),D=O[0],q=O[1];if(this.lastRange=D,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,f.default)(T,this.lastRange)){var B;!this.composing&&q!=null&&q.native.collapsed&&q.start.node!==this.cursor.textNode&&this.cursor.restore();var K=[_.default.events.SELECTION_CHANGE,(0,c.default)(this.lastRange),(0,c.default)(T),x];if((B=this.emitter).emit.apply(B,[_.default.events.EDITOR_CHANGE].concat(K)),x!==_.default.sources.SILENT){var oe;(oe=this.emitter).emit.apply(oe,K)}}}}]),w}();function E(w,A){try{A.parentNode}catch{return!1}return A instanceof Text&&(A=A.parentNode),w.contains(A)}n.Range=N,n.default=C},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(y,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}return function(y,g,m){return g&&_(y.prototype,g),m&&_(y,m),y}}(),o=function _(y,g,m){y===null&&(y=Function.prototype);var b=Object.getOwnPropertyDescriptor(y,g);if(b===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:_(I,g,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(0),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(){return c(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"insertInto",value:function(m,b){m.children.length===0?o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"insertInto",this).call(this,m,b):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),y}(l.default.Embed);p.blotName="break",p.tagName="BR",n.default=p},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),a=i(30),l=i(1),h=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.build(),_}return f.prototype.appendChild=function(p){this.insertBefore(p)},f.prototype.attach=function(){d.prototype.attach.call(this),this.children.forEach(function(p){p.attach()})},f.prototype.build=function(){var p=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(_){try{var y=c(_);p.insertBefore(y,p.children.head||void 0)}catch(g){if(g instanceof l.ParchmentError)return;throw g}})},f.prototype.deleteAt=function(p,_){if(p===0&&_===this.length())return this.remove();this.children.forEachAt(p,_,function(y,g,m){y.deleteAt(g,m)})},f.prototype.descendant=function(p,_){var y=this.children.find(_),g=y[0],m=y[1];return p.blotName==null&&p(g)||p.blotName!=null&&g instanceof p?[g,m]:g instanceof f?g.descendant(p,m):[null,-1]},f.prototype.descendants=function(p,_,y){_===void 0&&(_=0),y===void 0&&(y=Number.MAX_VALUE);var g=[],m=y;return this.children.forEachAt(_,y,function(b,I,v){(p.blotName==null&&p(b)||p.blotName!=null&&b instanceof p)&&g.push(b),b instanceof f&&(g=g.concat(b.descendants(p,I,m))),m-=v}),g},f.prototype.detach=function(){this.children.forEach(function(p){p.detach()}),d.prototype.detach.call(this)},f.prototype.formatAt=function(p,_,y,g){this.children.forEachAt(p,_,function(m,b,I){m.formatAt(b,I,y,g)})},f.prototype.insertAt=function(p,_,y){var g=this.children.find(p),m=g[0],b=g[1];if(m)m.insertAt(b,_,y);else{var I=y==null?l.create("text",_):l.create(_,y);this.appendChild(I)}},f.prototype.insertBefore=function(p,_){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(y){return p instanceof y}))throw new l.ParchmentError("Cannot insert "+p.statics.blotName+" into "+this.statics.blotName);p.insertInto(this,_)},f.prototype.length=function(){return this.children.reduce(function(p,_){return p+_.length()},0)},f.prototype.moveChildren=function(p,_){this.children.forEach(function(y){p.insertBefore(y,_)})},f.prototype.optimize=function(p){if(d.prototype.optimize.call(this,p),this.children.length===0)if(this.statics.defaultChild!=null){var _=l.create(this.statics.defaultChild);this.appendChild(_),_.optimize(p)}else this.remove()},f.prototype.path=function(p,_){_===void 0&&(_=!1);var y=this.children.find(p,_),g=y[0],m=y[1],b=[[this,p]];return g instanceof f?b.concat(g.path(m,_)):(g!=null&&b.push([g,m]),b)},f.prototype.removeChild=function(p){this.children.remove(p)},f.prototype.replace=function(p){p instanceof f&&p.moveChildren(this),d.prototype.replace.call(this,p)},f.prototype.split=function(p,_){if(_===void 0&&(_=!1),!_){if(p===0)return this;if(p===this.length())return this.next}var y=this.clone();return this.parent.insertBefore(y,this.next),this.children.forEachAt(p,this.length(),function(g,m,b){g=g.split(m,_),y.appendChild(g)}),y},f.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},f.prototype.update=function(p,_){var y=this,g=[],m=[];p.forEach(function(b){b.target===y.domNode&&b.type==="childList"&&(g.push.apply(g,b.addedNodes),m.push.apply(m,b.removedNodes))}),m.forEach(function(b){if(!(b.parentNode!=null&&b.tagName!=="IFRAME"&&document.body.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var I=l.find(b);I!=null&&(I.domNode.parentNode==null||I.domNode.parentNode===y.domNode)&&I.detach()}}),g.filter(function(b){return b.parentNode==y.domNode}).sort(function(b,I){return b===I?0:b.compareDocumentPosition(I)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(b){var I=null;b.nextSibling!=null&&(I=l.find(b.nextSibling));var v=c(b);(v.next!=I||v.next==null)&&(v.parent!=null&&v.parent.removeChild(y),y.insertBefore(v,I||void 0))})},f}(a.default);function c(d){var f=l.find(d);if(f==null)try{f=l.create(d)}catch{f=l.create(l.Scope.INLINE),[].slice.call(d.childNodes).forEach(function(_){f.domNode.appendChild(_)}),d.parentNode&&d.parentNode.replaceChild(f.domNode,d),f.attach()}return f}n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),a=i(31),l=i(17),h=i(1),c=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.attributes=new a.default(_.domNode),_}return f.formats=function(p){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return p.tagName.toLowerCase()},f.prototype.format=function(p,_){var y=h.query(p);y instanceof o.default?this.attributes.attribute(y,_):_&&y!=null&&(p!==this.statics.blotName||this.formats()[p]!==_)&&this.replaceWith(p,_)},f.prototype.formats=function(){var p=this.attributes.values(),_=this.statics.formats(this.domNode);return _!=null&&(p[this.statics.blotName]=_),p},f.prototype.replaceWith=function(p,_){var y=d.prototype.replaceWith.call(this,p,_);return this.attributes.copy(y),y},f.prototype.update=function(p,_){var y=this;d.prototype.update.call(this,p,_),p.some(function(g){return g.target===y.domNode&&g.type==="attributes"})&&this.attributes.build()},f.prototype.wrap=function(p,_){var y=d.prototype.wrap.call(this,p,_);return y instanceof f&&y.statics.scope===this.statics.scope&&this.attributes.move(y),y},f}(l.default);n.default=c},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])};return function(c,d){h(c,d);function f(){this.constructor=c}c.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),a=i(1),l=function(h){s(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.value=function(d){return!0},c.prototype.index=function(d,f){return this.domNode===d||this.domNode.compareDocumentPosition(d)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(f,1):-1},c.prototype.position=function(d,f){var p=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return d>0&&(p+=1),[this.parent.domNode,p]},c.prototype.value=function(){var d;return d={},d[this.statics.blotName]=this.statics.value(this.domNode)||!0,d},c.scope=a.Scope.INLINE_BLOT,c}(o.default);n.default=l},function(t,n,i){var s=i(11),o=i(3),a={attributes:{compose:function(h,c,d){typeof h!="object"&&(h={}),typeof c!="object"&&(c={});var f=o(!0,{},c);d||(f=Object.keys(f).reduce(function(_,y){return f[y]!=null&&(_[y]=f[y]),_},{}));for(var p in h)h[p]!==void 0&&c[p]===void 0&&(f[p]=h[p]);return Object.keys(f).length>0?f:void 0},diff:function(h,c){typeof h!="object"&&(h={}),typeof c!="object"&&(c={});var d=Object.keys(h).concat(Object.keys(c)).reduce(function(f,p){return s(h[p],c[p])||(f[p]=c[p]===void 0?null:c[p]),f},{});return Object.keys(d).length>0?d:void 0},transform:function(h,c,d){if(typeof h!="object")return c;if(typeof c=="object"){if(!d)return c;var f=Object.keys(c).reduce(function(p,_){return h[_]===void 0&&(p[_]=c[_]),p},{});return Object.keys(f).length>0?f:void 0}}},iterator:function(h){return new l(h)},length:function(h){return typeof h.delete=="number"?h.delete:typeof h.retain=="number"?h.retain:typeof h.insert=="string"?h.insert.length:1}};function l(h){this.ops=h,this.index=0,this.offset=0}l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(h){h||(h=1/0);var c=this.ops[this.index];if(c){var d=this.offset,f=a.length(c);if(h>=f-d?(h=f-d,this.index+=1,this.offset=0):this.offset+=h,typeof c.delete=="number")return{delete:h};var p={};return c.attributes&&(p.attributes=c.attributes),typeof c.retain=="number"?p.retain=h:typeof c.insert=="string"?p.insert=c.insert.substr(d,h):p.insert=c.insert,p}else return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var h=this.offset,c=this.index,d=this.next(),f=this.ops.slice(this.index);return this.offset=h,this.index=c,[d].concat(f)}else return[]},t.exports=a},function(t,n){var i=function(){function s(y,g){return g!=null&&y instanceof g}var o;try{o=Map}catch{o=function(){}}var a;try{a=Set}catch{a=function(){}}var l;try{l=Promise}catch{l=function(){}}function h(y,g,m,b,I){typeof g=="object"&&(m=g.depth,b=g.prototype,I=g.includeNonEnumerable,g=g.circular);var v=[],N=[],C=typeof Buffer<"u";typeof g>"u"&&(g=!0),typeof m>"u"&&(m=1/0);function E(w,A){if(w===null)return null;if(A===0)return w;var x,T;if(typeof w!="object")return w;if(s(w,o))x=new o;else if(s(w,a))x=new a;else if(s(w,l))x=new l(function(F,j){w.then(function(V){F(E(V,A-1))},function(V){j(E(V,A-1))})});else if(h.__isArray(w))x=[];else if(h.__isRegExp(w))x=new RegExp(w.source,_(w)),w.lastIndex&&(x.lastIndex=w.lastIndex);else if(h.__isDate(w))x=new Date(w.getTime());else{if(C&&Buffer.isBuffer(w))return Buffer.allocUnsafe?x=Buffer.allocUnsafe(w.length):x=new Buffer(w.length),w.copy(x),x;s(w,Error)?x=Object.create(w):typeof b>"u"?(T=Object.getPrototypeOf(w),x=Object.create(T)):(x=Object.create(b),T=b)}if(g){var S=v.indexOf(w);if(S!=-1)return N[S];v.push(w),N.push(x)}s(w,o)&&w.forEach(function(F,j){var V=E(j,A-1),$=E(F,A-1);x.set(V,$)}),s(w,a)&&w.forEach(function(F){var j=E(F,A-1);x.add(j)});for(var O in w){var D;T&&(D=Object.getOwnPropertyDescriptor(T,O)),!(D&&D.set==null)&&(x[O]=E(w[O],A-1))}if(Object.getOwnPropertySymbols)for(var q=Object.getOwnPropertySymbols(w),O=0;O<q.length;O++){var B=q[O],K=Object.getOwnPropertyDescriptor(w,B);K&&!K.enumerable&&!I||(x[B]=E(w[B],A-1),K.enumerable||Object.defineProperty(x,B,{enumerable:!1}))}if(I)for(var oe=Object.getOwnPropertyNames(w),O=0;O<oe.length;O++){var z=oe[O],K=Object.getOwnPropertyDescriptor(w,z);K&&K.enumerable||(x[z]=E(w[z],A-1),Object.defineProperty(x,z,{enumerable:!1}))}return x}return E(y,m)}h.clonePrototype=function(g){if(g===null)return null;var m=function(){};return m.prototype=g,new m};function c(y){return Object.prototype.toString.call(y)}h.__objToStr=c;function d(y){return typeof y=="object"&&c(y)==="[object Date]"}h.__isDate=d;function f(y){return typeof y=="object"&&c(y)==="[object Array]"}h.__isArray=f;function p(y){return typeof y=="object"&&c(y)==="[object RegExp]"}h.__isRegExp=p;function _(y){var g="";return y.global&&(g+="g"),y.ignoreCase&&(g+="i"),y.multiline&&(g+="m"),g}return h.__getRegExpFlags=_,h}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(T,S){var O=[],D=!0,q=!1,B=void 0;try{for(var K=T[Symbol.iterator](),oe;!(D=(oe=K.next()).done)&&(O.push(oe.value),!(S&&O.length===S));D=!0);}catch(z){q=!0,B=z}finally{try{!D&&K.return&&K.return()}finally{if(q)throw B}}return O}return function(T,S){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return x(T,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function x(T,S){for(var O=0;O<S.length;O++){var D=S[O];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(T,D.key,D)}}return function(T,S,O){return S&&x(T.prototype,S),O&&x(T,O),T}}(),a=function x(T,S,O){T===null&&(T=Function.prototype);var D=Object.getOwnPropertyDescriptor(T,S);if(D===void 0){var q=Object.getPrototypeOf(T);return q===null?void 0:x(q,S,O)}else{if("value"in D)return D.value;var B=D.get;return B===void 0?void 0:B.call(O)}},l=i(0),h=v(l),c=i(8),d=v(c),f=i(4),p=v(f),_=i(16),y=v(_),g=i(13),m=v(g),b=i(25),I=v(b);function v(x){return x&&x.__esModule?x:{default:x}}function N(x,T){if(!(x instanceof T))throw new TypeError("Cannot call a class as a function")}function C(x,T){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:x}function E(x,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);x.prototype=Object.create(T&&T.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(x,T):x.__proto__=T)}function w(x){return x instanceof p.default||x instanceof f.BlockEmbed}var A=function(x){E(T,x);function T(S,O){N(this,T);var D=C(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,S));return D.emitter=O.emitter,Array.isArray(O.whitelist)&&(D.whitelist=O.whitelist.reduce(function(q,B){return q[B]=!0,q},{})),D.domNode.addEventListener("DOMNodeInserted",function(){}),D.optimize(),D.enable(),D}return o(T,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(O,D){var q=this.line(O),B=s(q,2),K=B[0],oe=B[1],z=this.line(O+D),F=s(z,1),j=F[0];if(a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"deleteAt",this).call(this,O,D),j!=null&&K!==j&&oe>0){if(K instanceof f.BlockEmbed||j instanceof f.BlockEmbed){this.optimize();return}if(K instanceof m.default){var V=K.newlineIndex(K.length(),!0);if(V>-1&&(K=K.split(V+1),K===j)){this.optimize();return}}else if(j instanceof m.default){var $=j.newlineIndex(0);$>-1&&j.split($+1)}var G=j.children.head instanceof y.default?null:j.children.head;K.moveChildren(j,G),K.remove()}this.optimize()}},{key:"enable",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",O)}},{key:"formatAt",value:function(O,D,q,B){this.whitelist!=null&&!this.whitelist[q]||(a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"formatAt",this).call(this,O,D,q,B),this.optimize())}},{key:"insertAt",value:function(O,D,q){if(!(q!=null&&this.whitelist!=null&&!this.whitelist[D])){if(O>=this.length())if(q==null||h.default.query(D,h.default.Scope.BLOCK)==null){var B=h.default.create(this.statics.defaultChild);this.appendChild(B),q==null&&D.endsWith(`
`)&&(D=D.slice(0,-1)),B.insertAt(0,D,q)}else{var K=h.default.create(D,q);this.appendChild(K)}else a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertAt",this).call(this,O,D,q);this.optimize()}}},{key:"insertBefore",value:function(O,D){if(O.statics.scope===h.default.Scope.INLINE_BLOT){var q=h.default.create(this.statics.defaultChild);q.appendChild(O),O=q}a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"insertBefore",this).call(this,O,D)}},{key:"leaf",value:function(O){return this.path(O).pop()||[null,-1]}},{key:"line",value:function(O){return O===this.length()?this.line(O-1):this.descendant(w,O)}},{key:"lines",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,q=function B(K,oe,z){var F=[],j=z;return K.children.forEachAt(oe,z,function(V,$,G){w(V)?F.push(V):V instanceof h.default.Container&&(F=F.concat(B(V,$,j))),j-=G}),F};return q(this,O,D)}},{key:"optimize",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,O,D),O.length>0&&this.emitter.emit(d.default.events.SCROLL_OPTIMIZE,O,D))}},{key:"path",value:function(O){return a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"path",this).call(this,O).slice(1)}},{key:"update",value:function(O){if(this.batch!==!0){var D=d.default.sources.USER;typeof O=="string"&&(D=O),Array.isArray(O)||(O=this.observer.takeRecords()),O.length>0&&this.emitter.emit(d.default.events.SCROLL_BEFORE_UPDATE,D,O),a(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"update",this).call(this,O.concat([])),O.length>0&&this.emitter.emit(d.default.events.SCROLL_UPDATE,D,O)}}}]),T}(h.default.Scroll);A.blotName="scroll",A.className="ql-editor",A.tagName="DIV",A.defaultChild="block",A.allowedChildren=[p.default,f.BlockEmbed,I.default],n.default=A},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},o=function(){function M(U,Y){var Q=[],se=!0,X=!1,ue=void 0;try{for(var pe=U[Symbol.iterator](),de;!(se=(de=pe.next()).done)&&(Q.push(de.value),!(Y&&Q.length===Y));se=!0);}catch(Ae){X=!0,ue=Ae}finally{try{!se&&pe.return&&pe.return()}finally{if(X)throw ue}}return Q}return function(U,Y){if(Array.isArray(U))return U;if(Symbol.iterator in Object(U))return M(U,Y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function M(U,Y){for(var Q=0;Q<Y.length;Q++){var se=Y[Q];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(U,se.key,se)}}return function(U,Y,Q){return Y&&M(U.prototype,Y),Q&&M(U,Q),U}}(),l=i(21),h=x(l),c=i(11),d=x(c),f=i(3),p=x(f),_=i(2),y=x(_),g=i(20),m=x(g),b=i(0),I=x(b),v=i(5),N=x(v),C=i(10),E=x(C),w=i(9),A=x(w);function x(M){return M&&M.__esModule?M:{default:M}}function T(M,U,Y){return U in M?Object.defineProperty(M,U,{value:Y,enumerable:!0,configurable:!0,writable:!0}):M[U]=Y,M}function S(M,U){if(!(M instanceof U))throw new TypeError("Cannot call a class as a function")}function O(M,U){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U&&(typeof U=="object"||typeof U=="function")?U:M}function D(M,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof U);M.prototype=Object.create(U&&U.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),U&&(Object.setPrototypeOf?Object.setPrototypeOf(M,U):M.__proto__=U)}var q=(0,E.default)("quill:keyboard"),B=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",K=function(M){D(U,M),a(U,null,[{key:"match",value:function(Q,se){return se=H(se),["altKey","ctrlKey","metaKey","shiftKey"].some(function(X){return!!se[X]!==Q[X]&&se[X]!==null})?!1:se.key===(Q.which||Q.keyCode)}}]);function U(Y,Q){S(this,U);var se=O(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,Y,Q));return se.bindings={},Object.keys(se.options.bindings).forEach(function(X){X==="list autofill"&&Y.scroll.whitelist!=null&&!Y.scroll.whitelist.list||se.options.bindings[X]&&se.addBinding(se.options.bindings[X])}),se.addBinding({key:U.keys.ENTER,shiftKey:null},V),se.addBinding({key:U.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(se.addBinding({key:U.keys.BACKSPACE},{collapsed:!0},z),se.addBinding({key:U.keys.DELETE},{collapsed:!0},F)):(se.addBinding({key:U.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},z),se.addBinding({key:U.keys.DELETE},{collapsed:!0,suffix:/^.?$/},F)),se.addBinding({key:U.keys.BACKSPACE},{collapsed:!1},j),se.addBinding({key:U.keys.DELETE},{collapsed:!1},j),se.addBinding({key:U.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},z),se.listen(),se}return a(U,[{key:"addBinding",value:function(Q){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ue=H(Q);if(ue==null||ue.key==null)return q.warn("Attempted to add invalid keyboard binding",ue);typeof se=="function"&&(se={handler:se}),typeof X=="function"&&(X={handler:X}),ue=(0,p.default)(ue,se,X),this.bindings[ue.key]=this.bindings[ue.key]||[],this.bindings[ue.key].push(ue)}},{key:"listen",value:function(){var Q=this;this.quill.root.addEventListener("keydown",function(se){if(!se.defaultPrevented){var X=se.which||se.keyCode,ue=(Q.bindings[X]||[]).filter(function(Qe){return U.match(se,Qe)});if(ue.length!==0){var pe=Q.quill.getSelection();if(!(pe==null||!Q.quill.hasFocus())){var de=Q.quill.getLine(pe.index),Ae=o(de,2),We=Ae[0],qe=Ae[1],ne=Q.quill.getLeaf(pe.index),re=o(ne,2),fe=re[0],Z=re[1],J=pe.length===0?[fe,Z]:Q.quill.getLeaf(pe.index+pe.length),ce=o(J,2),me=ce[0],be=ce[1],xe=fe instanceof I.default.Text?fe.value().slice(0,Z):"",De=me instanceof I.default.Text?me.value().slice(be):"",Ce={collapsed:pe.length===0,empty:pe.length===0&&We.length()<=1,format:Q.quill.getFormat(pe),offset:qe,prefix:xe,suffix:De},ft=ue.some(function(Qe){if(Qe.collapsed!=null&&Qe.collapsed!==Ce.collapsed||Qe.empty!=null&&Qe.empty!==Ce.empty||Qe.offset!=null&&Qe.offset!==Ce.offset)return!1;if(Array.isArray(Qe.format)){if(Qe.format.every(function(Ut){return Ce.format[Ut]==null}))return!1}else if(s(Qe.format)==="object"&&!Object.keys(Qe.format).every(function(Ut){return Qe.format[Ut]===!0?Ce.format[Ut]!=null:Qe.format[Ut]===!1?Ce.format[Ut]==null:(0,d.default)(Qe.format[Ut],Ce.format[Ut])}))return!1;return Qe.prefix!=null&&!Qe.prefix.test(Ce.prefix)||Qe.suffix!=null&&!Qe.suffix.test(Ce.suffix)?!1:Qe.handler.call(Q,pe,Ce)!==!0});ft&&se.preventDefault()}}}})}}]),U}(A.default);K.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},K.DEFAULTS={bindings:{bold:G("bold"),italic:G("italic"),underline:G("underline"),indent:{key:K.keys.TAB,format:["blockquote","indent","list"],handler:function(U,Y){if(Y.collapsed&&Y.offset!==0)return!0;this.quill.format("indent","+1",N.default.sources.USER)}},outdent:{key:K.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(U,Y){if(Y.collapsed&&Y.offset!==0)return!0;this.quill.format("indent","-1",N.default.sources.USER)}},"outdent backspace":{key:K.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(U,Y){Y.format.indent!=null?this.quill.format("indent","-1",N.default.sources.USER):Y.format.list!=null&&this.quill.format("list",!1,N.default.sources.USER)}},"indent code-block":$(!0),"outdent code-block":$(!1),"remove tab":{key:K.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(U){this.quill.deleteText(U.index-1,1,N.default.sources.USER)}},tab:{key:K.keys.TAB,handler:function(U){this.quill.history.cutoff();var Y=new y.default().retain(U.index).delete(U.length).insert("	");this.quill.updateContents(Y,N.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(U.index+1,N.default.sources.SILENT)}},"list empty enter":{key:K.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(U,Y){this.quill.format("list",!1,N.default.sources.USER),Y.format.indent&&this.quill.format("indent",!1,N.default.sources.USER)}},"checklist enter":{key:K.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(U){var Y=this.quill.getLine(U.index),Q=o(Y,2),se=Q[0],X=Q[1],ue=(0,p.default)({},se.formats(),{list:"checked"}),pe=new y.default().retain(U.index).insert(`
`,ue).retain(se.length()-X-1).retain(1,{list:"unchecked"});this.quill.updateContents(pe,N.default.sources.USER),this.quill.setSelection(U.index+1,N.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:K.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(U,Y){var Q=this.quill.getLine(U.index),se=o(Q,2),X=se[0],ue=se[1],pe=new y.default().retain(U.index).insert(`
`,Y.format).retain(X.length()-ue-1).retain(1,{header:null});this.quill.updateContents(pe,N.default.sources.USER),this.quill.setSelection(U.index+1,N.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(U,Y){var Q=Y.prefix.length,se=this.quill.getLine(U.index),X=o(se,2),ue=X[0],pe=X[1];if(pe>Q)return!0;var de=void 0;switch(Y.prefix.trim()){case"[]":case"[ ]":de="unchecked";break;case"[x]":de="checked";break;case"-":case"*":de="bullet";break;default:de="ordered"}this.quill.insertText(U.index," ",N.default.sources.USER),this.quill.history.cutoff();var Ae=new y.default().retain(U.index-pe).delete(Q+1).retain(ue.length()-2-pe).retain(1,{list:de});this.quill.updateContents(Ae,N.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(U.index-Q,N.default.sources.SILENT)}},"code exit":{key:K.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(U){var Y=this.quill.getLine(U.index),Q=o(Y,2),se=Q[0],X=Q[1],ue=new y.default().retain(U.index+se.length()-X-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ue,N.default.sources.USER)}},"embed left":oe(K.keys.LEFT,!1),"embed left shift":oe(K.keys.LEFT,!0),"embed right":oe(K.keys.RIGHT,!1),"embed right shift":oe(K.keys.RIGHT,!0)}};function oe(M,U){var Y,Q=M===K.keys.LEFT?"prefix":"suffix";return Y={key:M,shiftKey:U,altKey:null},T(Y,Q,/^$/),T(Y,"handler",function(X){var ue=X.index;M===K.keys.RIGHT&&(ue+=X.length+1);var pe=this.quill.getLeaf(ue),de=o(pe,1),Ae=de[0];return Ae instanceof I.default.Embed?(M===K.keys.LEFT?U?this.quill.setSelection(X.index-1,X.length+1,N.default.sources.USER):this.quill.setSelection(X.index-1,N.default.sources.USER):U?this.quill.setSelection(X.index,X.length+1,N.default.sources.USER):this.quill.setSelection(X.index+X.length+1,N.default.sources.USER),!1):!0}),Y}function z(M,U){if(!(M.index===0||this.quill.getLength()<=1)){var Y=this.quill.getLine(M.index),Q=o(Y,1),se=Q[0],X={};if(U.offset===0){var ue=this.quill.getLine(M.index-1),pe=o(ue,1),de=pe[0];if(de!=null&&de.length()>1){var Ae=se.formats(),We=this.quill.getFormat(M.index-1,1);X=m.default.attributes.diff(Ae,We)||{}}}var qe=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(U.prefix)?2:1;this.quill.deleteText(M.index-qe,qe,N.default.sources.USER),Object.keys(X).length>0&&this.quill.formatLine(M.index-qe,qe,X,N.default.sources.USER),this.quill.focus()}}function F(M,U){var Y=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(U.suffix)?2:1;if(!(M.index>=this.quill.getLength()-Y)){var Q={},se=0,X=this.quill.getLine(M.index),ue=o(X,1),pe=ue[0];if(U.offset>=pe.length()-1){var de=this.quill.getLine(M.index+1),Ae=o(de,1),We=Ae[0];if(We){var qe=pe.formats(),ne=this.quill.getFormat(M.index,1);Q=m.default.attributes.diff(qe,ne)||{},se=We.length()}}this.quill.deleteText(M.index,Y,N.default.sources.USER),Object.keys(Q).length>0&&this.quill.formatLine(M.index+se-1,Y,Q,N.default.sources.USER)}}function j(M){var U=this.quill.getLines(M),Y={};if(U.length>1){var Q=U[0].formats(),se=U[U.length-1].formats();Y=m.default.attributes.diff(se,Q)||{}}this.quill.deleteText(M,N.default.sources.USER),Object.keys(Y).length>0&&this.quill.formatLine(M.index,1,Y,N.default.sources.USER),this.quill.setSelection(M.index,N.default.sources.SILENT),this.quill.focus()}function V(M,U){var Y=this;M.length>0&&this.quill.scroll.deleteAt(M.index,M.length);var Q=Object.keys(U.format).reduce(function(se,X){return I.default.query(X,I.default.Scope.BLOCK)&&!Array.isArray(U.format[X])&&(se[X]=U.format[X]),se},{});this.quill.insertText(M.index,`
`,Q,N.default.sources.USER),this.quill.setSelection(M.index+1,N.default.sources.SILENT),this.quill.focus(),Object.keys(U.format).forEach(function(se){Q[se]==null&&(Array.isArray(U.format[se])||se!=="link"&&Y.quill.format(se,U.format[se],N.default.sources.USER))})}function $(M){return{key:K.keys.TAB,shiftKey:!M,format:{"code-block":!0},handler:function(Y){var Q=I.default.query("code-block"),se=Y.index,X=Y.length,ue=this.quill.scroll.descendant(Q,se),pe=o(ue,2),de=pe[0],Ae=pe[1];if(de!=null){var We=this.quill.getIndex(de),qe=de.newlineIndex(Ae,!0)+1,ne=de.newlineIndex(We+Ae+X),re=de.domNode.textContent.slice(qe,ne).split(`
`);Ae=0,re.forEach(function(fe,Z){M?(de.insertAt(qe+Ae,Q.TAB),Ae+=Q.TAB.length,Z===0?se+=Q.TAB.length:X+=Q.TAB.length):fe.startsWith(Q.TAB)&&(de.deleteAt(qe+Ae,Q.TAB.length),Ae-=Q.TAB.length,Z===0?se-=Q.TAB.length:X-=Q.TAB.length),Ae+=fe.length+1}),this.quill.update(N.default.sources.USER),this.quill.setSelection(se,X,N.default.sources.SILENT)}}}}function G(M){return{key:M[0].toUpperCase(),shortKey:!0,handler:function(Y,Q){this.quill.format(M,!Q.format[M],N.default.sources.USER)}}}function H(M){if(typeof M=="string"||typeof M=="number")return H({key:M});if((typeof M>"u"?"undefined":s(M))==="object"&&(M=(0,h.default)(M,!1)),typeof M.key=="string")if(K.keys[M.key.toUpperCase()]!=null)M.key=K.keys[M.key.toUpperCase()];else if(M.key.length===1)M.key=M.key.toUpperCase().charCodeAt(0);else return null;return M.shortKey&&(M[B]=M.shortKey,delete M.shortKey),M}n.default=K,n.SHORTKEY=B},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,I){var v=[],N=!0,C=!1,E=void 0;try{for(var w=b[Symbol.iterator](),A;!(N=(A=w.next()).done)&&(v.push(A.value),!(I&&v.length===I));N=!0);}catch(x){C=!0,E=x}finally{try{!N&&w.return&&w.return()}finally{if(C)throw E}}return v}return function(b,I){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return m(b,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function m(b,I,v){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,I);if(N===void 0){var C=Object.getPrototypeOf(b);return C===null?void 0:m(C,I,v)}else{if("value"in N)return N.value;var E=N.get;return E===void 0?void 0:E.call(v)}},a=function(){function m(b,I){for(var v=0;v<I.length;v++){var N=I[v];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,I,v){return I&&m(b.prototype,I),v&&m(b,v),b}}(),l=i(0),h=f(l),c=i(7),d=f(c);function f(m){return m&&m.__esModule?m:{default:m}}function p(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function _(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function y(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var g=function(m){y(b,m),a(b,null,[{key:"value",value:function(){}}]);function b(I,v){p(this,b);var N=_(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,I));return N.selection=v,N.textNode=document.createTextNode(b.CONTENTS),N.domNode.appendChild(N.textNode),N._length=0,N}return a(b,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(v,N){if(this._length!==0)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,v,N);for(var C=this,E=0;C!=null&&C.statics.scope!==h.default.Scope.BLOCK_BLOT;)E+=C.offset(C.parent),C=C.parent;C!=null&&(this._length=b.CONTENTS.length,C.optimize(),C.formatAt(E,b.CONTENTS.length,v,N),this._length=0)}},{key:"index",value:function(v,N){return v===this.textNode?0:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,N)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var v=this.textNode,N=this.selection.getNativeRange(),C=void 0,E=void 0,w=void 0;if(N!=null&&N.start.node===v&&N.end.node===v){var A=[v,N.start.offset,N.end.offset];C=A[0],E=A[1],w=A[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==b.CONTENTS){var x=this.textNode.data.split(b.CONTENTS).join("");this.next instanceof d.default?(C=this.next.domNode,this.next.insertAt(0,x),this.textNode.data=b.CONTENTS):(this.textNode.data=x,this.parent.insertBefore(h.default.create(this.textNode),this),this.textNode=document.createTextNode(b.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),E!=null){var T=[E,w].map(function(O){return Math.max(0,Math.min(C.data.length,O-1))}),S=s(T,2);return E=S[0],w=S[1],{startNode:C,startOffset:E,endNode:C,endOffset:w}}}}},{key:"update",value:function(v,N){var C=this;if(v.some(function(w){return w.type==="characterData"&&w.target===C.textNode})){var E=this.restore();E&&(N.range=E)}}},{key:"value",value:function(){return""}}]),b}(h.default.Embed);g.blotName="cursor",g.className="ql-cursor",g.tagName="span",g.CONTENTS="\uFEFF",n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=h(s),a=i(4),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(){return c(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return y}(o.default.Container);p.allowedChildren=[l.default,a.BlockEmbed,p],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function g(m,b){for(var I=0;I<b.length;I++){var v=b[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,I){return b&&g(m.prototype,b),I&&g(m,I),m}}(),o=function g(m,b,I){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var N=Object.getPrototypeOf(m);return N===null?void 0:g(N,b,I)}else{if("value"in v)return v.value;var C=v.get;return C===void 0?void 0:C.call(I)}},a=i(0),l=h(a);function h(g){return g&&g.__esModule?g:{default:g}}function c(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function d(g,m){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:g}function f(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(g,m):g.__proto__=m)}var p=function(g){f(m,g);function m(){return c(this,m),d(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"value",value:function(I){var v=o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,I);return v.startsWith("rgb(")?(v=v.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+v.split(",").map(function(N){return("00"+parseInt(N).toString(16)).slice(-2)}).join("")):v}}]),m}(l.default.Attributor.Style),_=new l.default.Attributor.Class("color","ql-color",{scope:l.default.Scope.INLINE}),y=new p("color","color",{scope:l.default.Scope.INLINE});n.ColorAttributor=p,n.ColorClass=_,n.ColorStyle=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function y(g,m){for(var b=0;b<m.length;b++){var I=m[b];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(g,I.key,I)}}return function(g,m,b){return m&&y(g.prototype,m),b&&y(g,b),g}}(),o=function y(g,m,b){g===null&&(g=Function.prototype);var I=Object.getOwnPropertyDescriptor(g,m);if(I===void 0){var v=Object.getPrototypeOf(g);return v===null?void 0:y(v,m,b)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(b)}},a=i(6),l=h(a);function h(y){return y&&y.__esModule?y:{default:y}}function c(y,g){if(!(y instanceof g))throw new TypeError("Cannot call a class as a function")}function d(y,g){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:y}function f(y,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);y.prototype=Object.create(g&&g.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(y,g):y.__proto__=g)}var p=function(y){f(g,y);function g(){return c(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"format",value:function(b,I){if(b!==this.statics.blotName||!I)return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"format",this).call(this,b,I);I=this.constructor.sanitize(I),this.domNode.setAttribute("href",I)}}],[{key:"create",value:function(b){var I=o(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,b);return b=this.sanitize(b),I.setAttribute("href",b),I.setAttribute("rel","noopener noreferrer"),I.setAttribute("target","_blank"),I}},{key:"formats",value:function(b){return b.getAttribute("href")}},{key:"sanitize",value:function(b){return _(b,this.PROTOCOL_WHITELIST)?b:this.SANITIZED_URL}}]),g}(l.default);p.blotName="link",p.tagName="A",p.SANITIZED_URL="about:blank",p.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function _(y,g){var m=document.createElement("a");m.href=y;var b=m.href.slice(0,m.href.indexOf(":"));return g.indexOf(b)>-1}n.default=p,n.sanitize=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},o=function(){function g(m,b){for(var I=0;I<b.length;I++){var v=b[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,I){return b&&g(m.prototype,b),I&&g(m,I),m}}(),a=i(23),l=d(a),h=i(107),c=d(h);function d(g){return g&&g.__esModule?g:{default:g}}function f(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}var p=0;function _(g,m){g.setAttribute(m,g.getAttribute(m)!=="true")}var y=function(){function g(m){var b=this;f(this,g),this.select=m,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){b.togglePicker()}),this.label.addEventListener("keydown",function(I){switch(I.keyCode){case l.default.keys.ENTER:b.togglePicker();break;case l.default.keys.ESCAPE:b.escape(),I.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(g,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),_(this.label,"aria-expanded"),_(this.options,"aria-hidden")}},{key:"buildItem",value:function(b){var I=this,v=document.createElement("span");return v.tabIndex="0",v.setAttribute("role","button"),v.classList.add("ql-picker-item"),b.hasAttribute("value")&&v.setAttribute("data-value",b.getAttribute("value")),b.textContent&&v.setAttribute("data-label",b.textContent),v.addEventListener("click",function(){I.selectItem(v,!0)}),v.addEventListener("keydown",function(N){switch(N.keyCode){case l.default.keys.ENTER:I.selectItem(v,!0),N.preventDefault();break;case l.default.keys.ESCAPE:I.escape(),N.preventDefault();break}}),v}},{key:"buildLabel",value:function(){var b=document.createElement("span");return b.classList.add("ql-picker-label"),b.innerHTML=c.default,b.tabIndex="0",b.setAttribute("role","button"),b.setAttribute("aria-expanded","false"),this.container.appendChild(b),b}},{key:"buildOptions",value:function(){var b=this,I=document.createElement("span");I.classList.add("ql-picker-options"),I.setAttribute("aria-hidden","true"),I.tabIndex="-1",I.id="ql-picker-options-"+p,p+=1,this.label.setAttribute("aria-controls",I.id),this.options=I,[].slice.call(this.select.options).forEach(function(v){var N=b.buildItem(v);I.appendChild(N),v.selected===!0&&b.selectItem(N)}),this.container.appendChild(I)}},{key:"buildPicker",value:function(){var b=this;[].slice.call(this.select.attributes).forEach(function(I){b.container.setAttribute(I.name,I.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var b=this;this.close(),setTimeout(function(){return b.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(b){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=this.container.querySelector(".ql-selected");if(b!==v&&(v!=null&&v.classList.remove("ql-selected"),b!=null&&(b.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(b.parentNode.children,b),b.hasAttribute("data-value")?this.label.setAttribute("data-value",b.getAttribute("data-value")):this.label.removeAttribute("data-value"),b.hasAttribute("data-label")?this.label.setAttribute("data-label",b.getAttribute("data-label")):this.label.removeAttribute("data-label"),I))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var N=document.createEvent("Event");N.initEvent("change",!0,!0),this.select.dispatchEvent(N)}this.close()}}},{key:"update",value:function(){var b=void 0;if(this.select.selectedIndex>-1){var I=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];b=this.select.options[this.select.selectedIndex],this.selectItem(I)}else this.selectItem(null);var v=b!=null&&b!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",v)}}]),g}();n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=q(s),a=i(5),l=q(a),h=i(4),c=q(h),d=i(16),f=q(d),p=i(25),_=q(p),y=i(24),g=q(y),m=i(35),b=q(m),I=i(6),v=q(I),N=i(22),C=q(N),E=i(7),w=q(E),A=i(55),x=q(A),T=i(42),S=q(T),O=i(23),D=q(O);function q(B){return B&&B.__esModule?B:{default:B}}l.default.register({"blots/block":c.default,"blots/block/embed":h.BlockEmbed,"blots/break":f.default,"blots/container":_.default,"blots/cursor":g.default,"blots/embed":b.default,"blots/inline":v.default,"blots/scroll":C.default,"blots/text":w.default,"modules/clipboard":x.default,"modules/history":S.default,"modules/keyboard":D.default}),o.default.register(c.default,f.default,g.default,v.default,C.default,w.default),n.default=l.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function a(l){this.domNode=l,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(a.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),a.create=function(l){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var h;return Array.isArray(this.tagName)?(typeof l=="string"&&(l=l.toUpperCase(),parseInt(l).toString()===l&&(l=parseInt(l))),typeof l=="number"?h=document.createElement(this.tagName[l-1]):this.tagName.indexOf(l)>-1?h=document.createElement(l):h=document.createElement(this.tagName[0])):h=document.createElement(this.tagName),this.className&&h.classList.add(this.className),h},a.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},a.prototype.clone=function(){var l=this.domNode.cloneNode(!1);return s.create(l)},a.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},a.prototype.deleteAt=function(l,h){var c=this.isolate(l,h);c.remove()},a.prototype.formatAt=function(l,h,c,d){var f=this.isolate(l,h);if(s.query(c,s.Scope.BLOT)!=null&&d)f.wrap(c,d);else if(s.query(c,s.Scope.ATTRIBUTE)!=null){var p=s.create(this.statics.scope);f.wrap(p),p.format(c,d)}},a.prototype.insertAt=function(l,h,c){var d=c==null?s.create("text",h):s.create(h,c),f=this.split(l);this.parent.insertBefore(d,f)},a.prototype.insertInto=function(l,h){h===void 0&&(h=null),this.parent!=null&&this.parent.children.remove(this);var c=null;l.children.insertBefore(this,h),h!=null&&(c=h.domNode),(this.domNode.parentNode!=l.domNode||this.domNode.nextSibling!=c)&&l.domNode.insertBefore(this.domNode,c),this.parent=l,this.attach()},a.prototype.isolate=function(l,h){var c=this.split(l);return c.split(h),c},a.prototype.length=function(){return 1},a.prototype.offset=function(l){return l===void 0&&(l=this.parent),this.parent==null||this==l?0:this.parent.children.offset(this)+this.parent.offset(l)},a.prototype.optimize=function(l){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},a.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},a.prototype.replace=function(l){l.parent!=null&&(l.parent.insertBefore(this,l.next),l.remove())},a.prototype.replaceWith=function(l,h){var c=typeof l=="string"?s.create(l,h):l;return c.replace(this),c},a.prototype.split=function(l,h){return l===0?this:this.next},a.prototype.update=function(l,h){},a.prototype.wrap=function(l,h){var c=typeof l=="string"?s.create(l,h):l;return this.parent!=null&&this.parent.insertBefore(c,this.next),c.appendChild(this),c},a.blotName="abstract",a}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),a=i(33),l=i(1),h=function(){function c(d){this.attributes={},this.domNode=d,this.build()}return c.prototype.attribute=function(d,f){f?d.add(this.domNode,f)&&(d.value(this.domNode)!=null?this.attributes[d.attrName]=d:delete this.attributes[d.attrName]):(d.remove(this.domNode),delete this.attributes[d.attrName])},c.prototype.build=function(){var d=this;this.attributes={};var f=s.default.keys(this.domNode),p=o.default.keys(this.domNode),_=a.default.keys(this.domNode);f.concat(p).concat(_).forEach(function(y){var g=l.query(y,l.Scope.ATTRIBUTE);g instanceof s.default&&(d.attributes[g.attrName]=g)})},c.prototype.copy=function(d){var f=this;Object.keys(this.attributes).forEach(function(p){var _=f.attributes[p].value(f.domNode);d.format(p,_)})},c.prototype.move=function(d){var f=this;this.copy(d),Object.keys(this.attributes).forEach(function(p){f.attributes[p].remove(f.domNode)}),this.attributes={}},c.prototype.values=function(){var d=this;return Object.keys(this.attributes).reduce(function(f,p){return f[p]=d.attributes[p].value(d.domNode),f},{})},c}();n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])};return function(c,d){h(c,d);function f(){this.constructor=c}c.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(h,c){var d=h.getAttribute("class")||"";return d.split(/\s+/).filter(function(f){return f.indexOf(c+"-")===0})}var l=function(h){s(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.keys=function(d){return(d.getAttribute("class")||"").split(/\s+/).map(function(f){return f.split("-").slice(0,-1).join("-")})},c.prototype.add=function(d,f){return this.canAdd(d,f)?(this.remove(d),d.classList.add(this.keyName+"-"+f),!0):!1},c.prototype.remove=function(d){var f=a(d,this.keyName);f.forEach(function(p){d.classList.remove(p)}),d.classList.length===0&&d.removeAttribute("class")},c.prototype.value=function(d){var f=a(d,this.keyName)[0]||"",p=f.slice(this.keyName.length+1);return this.canAdd(d,p)?p:""},c}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])};return function(c,d){h(c,d);function f(){this.constructor=c}c.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function a(h){var c=h.split("-"),d=c.slice(1).map(function(f){return f[0].toUpperCase()+f.slice(1)}).join("");return c[0]+d}var l=function(h){s(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.keys=function(d){return(d.getAttribute("style")||"").split(";").map(function(f){var p=f.split(":");return p[0].trim()})},c.prototype.add=function(d,f){return this.canAdd(d,f)?(d.style[a(this.keyName)]=f,!0):!1},c.prototype.remove=function(d){d.style[a(this.keyName)]="",d.getAttribute("style")||d.removeAttribute("style")},c.prototype.value=function(d){var f=d.style[a(this.keyName)];return this.canAdd(d,f)?f:""},c}(o.default);n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(h,c){for(var d=0;d<c.length;d++){var f=c[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(h,f.key,f)}}return function(h,c,d){return c&&l(h.prototype,c),d&&l(h,d),h}}();function o(l,h){if(!(l instanceof h))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(h,c){o(this,l),this.quill=h,this.options=c,this.modules={}}return s(l,[{key:"init",value:function(){var c=this;Object.keys(this.options.modules).forEach(function(d){c.modules[d]==null&&c.addModule(d)})}},{key:"addModule",value:function(c){var d=this.quill.constructor.import("modules/"+c);return this.modules[c]=new d(this.quill,this.options.modules[c]||{}),this.modules[c]}}]),l}();a.DEFAULTS={modules:{}},a.themes={default:a},n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function m(b,I){for(var v=0;v<I.length;v++){var N=I[v];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,I,v){return I&&m(b.prototype,I),v&&m(b,v),b}}(),o=function m(b,I,v){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,I);if(N===void 0){var C=Object.getPrototypeOf(b);return C===null?void 0:m(C,I,v)}else{if("value"in N)return N.value;var E=N.get;return E===void 0?void 0:E.call(v)}},a=i(0),l=d(a),h=i(7),c=d(h);function d(m){return m&&m.__esModule?m:{default:m}}function f(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function p(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function _(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var y="\uFEFF",g=function(m){_(b,m);function b(I){f(this,b);var v=p(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,I));return v.contentNode=document.createElement("span"),v.contentNode.setAttribute("contenteditable",!1),[].slice.call(v.domNode.childNodes).forEach(function(N){v.contentNode.appendChild(N)}),v.leftGuard=document.createTextNode(y),v.rightGuard=document.createTextNode(y),v.domNode.appendChild(v.leftGuard),v.domNode.appendChild(v.contentNode),v.domNode.appendChild(v.rightGuard),v}return s(b,[{key:"index",value:function(v,N){return v===this.leftGuard?0:v===this.rightGuard?1:o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"index",this).call(this,v,N)}},{key:"restore",value:function(v){var N=void 0,C=void 0,E=v.data.split(y).join("");if(v===this.leftGuard)if(this.prev instanceof c.default){var w=this.prev.length();this.prev.insertAt(w,E),N={startNode:this.prev.domNode,startOffset:w+E.length}}else C=document.createTextNode(E),this.parent.insertBefore(l.default.create(C),this),N={startNode:C,startOffset:E.length};else v===this.rightGuard&&(this.next instanceof c.default?(this.next.insertAt(0,E),N={startNode:this.next.domNode,startOffset:E.length}):(C=document.createTextNode(E),this.parent.insertBefore(l.default.create(C),this.next),N={startNode:C,startOffset:E.length}));return v.data=y,N}},{key:"update",value:function(v,N){var C=this;v.forEach(function(E){if(E.type==="characterData"&&(E.target===C.leftGuard||E.target===C.rightGuard)){var w=C.restore(E.target);w&&(N.range=w)}})}}]),b}(l.default.Embed);n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},h=new o.default.Attributor.Attribute("align","align",l),c=new o.default.Attributor.Class("align","ql-align",l),d=new o.default.Attributor.Style("align","text-align",l);n.AlignAttribute=h,n.AlignClass=c,n.AlignStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=l(s),a=i(26);function l(d){return d&&d.__esModule?d:{default:d}}var h=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),c=new a.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=h,n.BackgroundStyle=c},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}var l={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},h=new o.default.Attributor.Attribute("direction","dir",l),c=new o.default.Attributor.Class("direction","ql-direction",l),d=new o.default.Attributor.Style("direction","direction",l);n.DirectionAttribute=h,n.DirectionClass=c,n.DirectionStyle=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function m(b,I){for(var v=0;v<I.length;v++){var N=I[v];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(b,N.key,N)}}return function(b,I,v){return I&&m(b.prototype,I),v&&m(b,v),b}}(),o=function m(b,I,v){b===null&&(b=Function.prototype);var N=Object.getOwnPropertyDescriptor(b,I);if(N===void 0){var C=Object.getPrototypeOf(b);return C===null?void 0:m(C,I,v)}else{if("value"in N)return N.value;var E=N.get;return E===void 0?void 0:E.call(v)}},a=i(0),l=h(a);function h(m){return m&&m.__esModule?m:{default:m}}function c(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function d(m,b){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:m}function f(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(m,b):m.__proto__=b)}var p={scope:l.default.Scope.INLINE,whitelist:["serif","monospace"]},_=new l.default.Attributor.Class("font","ql-font",p),y=function(m){f(b,m);function b(){return c(this,b),d(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"value",value:function(v){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,v).replace(/["']/g,"")}}]),b}(l.default.Attributor.Style),g=new y("font","font-family",p);n.FontStyle=g,n.FontClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=a(s);function a(c){return c&&c.__esModule?c:{default:c}}var l=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),h=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=l,n.SizeStyle=h},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function I(v,N){for(var C=0;C<N.length;C++){var E=N[C];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(v,E.key,E)}}return function(v,N,C){return N&&I(v.prototype,N),C&&I(v,C),v}}(),o=i(0),a=f(o),l=i(5),h=f(l),c=i(9),d=f(c);function f(I){return I&&I.__esModule?I:{default:I}}function p(I,v){if(!(I instanceof v))throw new TypeError("Cannot call a class as a function")}function _(I,v){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:I}function y(I,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);I.prototype=Object.create(v&&v.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(I,v):I.__proto__=v)}var g=function(I){y(v,I);function v(N,C){p(this,v);var E=_(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,N,C));return E.lastRecorded=0,E.ignoreChange=!1,E.clear(),E.quill.on(h.default.events.EDITOR_CHANGE,function(w,A,x,T){w!==h.default.events.TEXT_CHANGE||E.ignoreChange||(!E.options.userOnly||T===h.default.sources.USER?E.record(A,x):E.transform(A))}),E.quill.keyboard.addBinding({key:"Z",shortKey:!0},E.undo.bind(E)),E.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},E.redo.bind(E)),/Win/i.test(navigator.platform)&&E.quill.keyboard.addBinding({key:"Y",shortKey:!0},E.redo.bind(E)),E}return s(v,[{key:"change",value:function(C,E){if(this.stack[C].length!==0){var w=this.stack[C].pop();this.stack[E].push(w),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(w[C],h.default.sources.USER),this.ignoreChange=!1;var A=b(w[C]);this.quill.setSelection(A)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(C,E){if(C.ops.length!==0){this.stack.redo=[];var w=this.quill.getContents().diff(E),A=Date.now();if(this.lastRecorded+this.options.delay>A&&this.stack.undo.length>0){var x=this.stack.undo.pop();w=w.compose(x.undo),C=x.redo.compose(C)}else this.lastRecorded=A;this.stack.undo.push({redo:C,undo:w}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(C){this.stack.undo.forEach(function(E){E.undo=C.transform(E.undo,!0),E.redo=C.transform(E.redo,!0)}),this.stack.redo.forEach(function(E){E.undo=C.transform(E.undo,!0),E.redo=C.transform(E.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),v}(d.default);g.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function m(I){var v=I.ops[I.ops.length-1];return v==null?!1:v.insert!=null?typeof v.insert=="string"&&v.insert.endsWith(`
`):v.attributes!=null?Object.keys(v.attributes).some(function(N){return a.default.query(N,a.default.Scope.BLOCK)!=null}):!1}function b(I){var v=I.reduce(function(C,E){return C+=E.delete||0,C},0),N=I.length()-v;return m(I)&&(N-=1),N}n.default=g,n.getLastChangeIndex=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function V($,G){for(var H=0;H<G.length;H++){var M=G[H];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty($,M.key,M)}}return function($,G,H){return G&&V($.prototype,G),H&&V($,H),$}}(),o=function V($,G,H){$===null&&($=Function.prototype);var M=Object.getOwnPropertyDescriptor($,G);if(M===void 0){var U=Object.getPrototypeOf($);return U===null?void 0:V(U,G,H)}else{if("value"in M)return M.value;var Y=M.get;return Y===void 0?void 0:Y.call(H)}},a=i(3),l=A(a),h=i(2),c=A(h),d=i(8),f=A(d),p=i(23),_=A(p),y=i(34),g=A(y),m=i(59),b=A(m),I=i(60),v=A(I),N=i(28),C=A(N),E=i(61),w=A(E);function A(V){return V&&V.__esModule?V:{default:V}}function x(V,$){if(!(V instanceof $))throw new TypeError("Cannot call a class as a function")}function T(V,$){if(!V)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $&&(typeof $=="object"||typeof $=="function")?$:V}function S(V,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof $);V.prototype=Object.create($&&$.prototype,{constructor:{value:V,enumerable:!1,writable:!0,configurable:!0}}),$&&(Object.setPrototypeOf?Object.setPrototypeOf(V,$):V.__proto__=$)}var O=[!1,"center","right","justify"],D=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],q=[!1,"serif","monospace"],B=["1","2","3",!1],K=["small",!1,"large","huge"],oe=function(V){S($,V);function $(G,H){x(this,$);var M=T(this,($.__proto__||Object.getPrototypeOf($)).call(this,G,H)),U=function Y(Q){if(!document.body.contains(G.root))return document.body.removeEventListener("click",Y);M.tooltip!=null&&!M.tooltip.root.contains(Q.target)&&document.activeElement!==M.tooltip.textbox&&!M.quill.hasFocus()&&M.tooltip.hide(),M.pickers!=null&&M.pickers.forEach(function(se){se.container.contains(Q.target)||se.close()})};return G.emitter.listenDOM("click",document.body,U),M}return s($,[{key:"addModule",value:function(H){var M=o($.prototype.__proto__||Object.getPrototypeOf($.prototype),"addModule",this).call(this,H);return H==="toolbar"&&this.extendToolbar(M),M}},{key:"buildButtons",value:function(H,M){H.forEach(function(U){var Y=U.getAttribute("class")||"";Y.split(/\s+/).forEach(function(Q){if(Q.startsWith("ql-")&&(Q=Q.slice(3),M[Q]!=null))if(Q==="direction")U.innerHTML=M[Q][""]+M[Q].rtl;else if(typeof M[Q]=="string")U.innerHTML=M[Q];else{var se=U.value||"";se!=null&&M[Q][se]&&(U.innerHTML=M[Q][se])}})})}},{key:"buildPickers",value:function(H,M){var U=this;this.pickers=H.map(function(Q){if(Q.classList.contains("ql-align"))return Q.querySelector("option")==null&&j(Q,O),new v.default(Q,M.align);if(Q.classList.contains("ql-background")||Q.classList.contains("ql-color")){var se=Q.classList.contains("ql-background")?"background":"color";return Q.querySelector("option")==null&&j(Q,D,se==="background"?"#ffffff":"#000000"),new b.default(Q,M[se])}else return Q.querySelector("option")==null&&(Q.classList.contains("ql-font")?j(Q,q):Q.classList.contains("ql-header")?j(Q,B):Q.classList.contains("ql-size")&&j(Q,K)),new C.default(Q)});var Y=function(){U.pickers.forEach(function(se){se.update()})};this.quill.on(f.default.events.EDITOR_CHANGE,Y)}}]),$}(g.default);oe.DEFAULTS=(0,l.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var $=this,G=this.container.querySelector("input.ql-image[type=file]");G==null&&(G=document.createElement("input"),G.setAttribute("type","file"),G.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),G.classList.add("ql-image"),G.addEventListener("change",function(){if(G.files!=null&&G.files[0]!=null){var H=new FileReader;H.onload=function(M){var U=$.quill.getSelection(!0);$.quill.updateContents(new c.default().retain(U.index).delete(U.length).insert({image:M.target.result}),f.default.sources.USER),$.quill.setSelection(U.index+1,f.default.sources.SILENT),G.value=""},H.readAsDataURL(G.files[0])}}),this.container.appendChild(G)),G.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var z=function(V){S($,V);function $(G,H){x(this,$);var M=T(this,($.__proto__||Object.getPrototypeOf($)).call(this,G,H));return M.textbox=M.root.querySelector('input[type="text"]'),M.listen(),M}return s($,[{key:"listen",value:function(){var H=this;this.textbox.addEventListener("keydown",function(M){_.default.match(M,"enter")?(H.save(),M.preventDefault()):_.default.match(M,"escape")&&(H.cancel(),M.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),M!=null?this.textbox.value=M:H!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+H)||""),this.root.setAttribute("data-mode",H)}},{key:"restoreFocus",value:function(){var H=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=H}},{key:"save",value:function(){var H=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var M=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",H,f.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",H,f.default.sources.USER)),this.quill.root.scrollTop=M;break}case"video":H=F(H);case"formula":{if(!H)break;var U=this.quill.getSelection(!0);if(U!=null){var Y=U.index+U.length;this.quill.insertEmbed(Y,this.root.getAttribute("data-mode"),H,f.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(Y+1," ",f.default.sources.USER),this.quill.setSelection(Y+2,f.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),$}(w.default);function F(V){var $=V.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||V.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return $?($[1]||"https")+"://www.youtube.com/embed/"+$[2]+"?showinfo=0":($=V.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?($[1]||"https")+"://player.vimeo.com/video/"+$[2]+"/":V}function j(V,$){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;$.forEach(function(H){var M=document.createElement("option");H===G?M.setAttribute("selected","selected"):M.setAttribute("value",H),V.appendChild(M)})}n.BaseTooltip=z,n.default=oe},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];this.insertBefore(a[0],null),a.length>1&&this.append.apply(this,a.slice(1))},o.prototype.contains=function(a){for(var l,h=this.iterator();l=h();)if(l===a)return!0;return!1},o.prototype.insertBefore=function(a,l){a&&(a.next=l,l!=null?(a.prev=l.prev,l.prev!=null&&(l.prev.next=a),l.prev=a,l===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)},o.prototype.offset=function(a){for(var l=0,h=this.head;h!=null;){if(h===a)return l;l+=h.length(),h=h.next}return-1},o.prototype.remove=function(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)},o.prototype.iterator=function(a){return a===void 0&&(a=this.head),function(){var l=a;return a!=null&&(a=a.next),l}},o.prototype.find=function(a,l){l===void 0&&(l=!1);for(var h,c=this.iterator();h=c();){var d=h.length();if(a<d||l&&a===d&&(h.next==null||h.next.length()!==0))return[h,a];a-=d}return[null,0]},o.prototype.forEach=function(a){for(var l,h=this.iterator();l=h();)a(l)},o.prototype.forEachAt=function(a,l,h){if(!(l<=0))for(var c=this.find(a),d=c[0],f=c[1],p,_=a-f,y=this.iterator(d);(p=y())&&_<a+l;){var g=p.length();a>_?h(p,a-_,Math.min(l,_+g-a)):h(p,0,Math.min(g,a+l-_)),_+=g}},o.prototype.map=function(a){return this.reduce(function(l,h){return l.push(a(h)),l},[])},o.prototype.reduce=function(a,l){for(var h,c=this.iterator();h=c();)l=a(l,h);return l},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var _ in p)p.hasOwnProperty(_)&&(f[_]=p[_])};return function(f,p){d(f,p);function _(){this.constructor=f}f.prototype=p===null?Object.create(p):(_.prototype=p.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),a=i(1),l={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},h=100,c=function(d){s(f,d);function f(p){var _=d.call(this,p)||this;return _.scroll=_,_.observer=new MutationObserver(function(y){_.update(y)}),_.observer.observe(_.domNode,l),_.attach(),_}return f.prototype.detach=function(){d.prototype.detach.call(this),this.observer.disconnect()},f.prototype.deleteAt=function(p,_){this.update(),p===0&&_===this.length()?this.children.forEach(function(y){y.remove()}):d.prototype.deleteAt.call(this,p,_)},f.prototype.formatAt=function(p,_,y,g){this.update(),d.prototype.formatAt.call(this,p,_,y,g)},f.prototype.insertAt=function(p,_,y){this.update(),d.prototype.insertAt.call(this,p,_,y)},f.prototype.optimize=function(p,_){var y=this;p===void 0&&(p=[]),_===void 0&&(_={}),d.prototype.optimize.call(this,_);for(var g=[].slice.call(this.observer.takeRecords());g.length>0;)p.push(g.pop());for(var m=function(N,C){C===void 0&&(C=!0),!(N==null||N===y)&&N.domNode.parentNode!=null&&(N.domNode[a.DATA_KEY].mutations==null&&(N.domNode[a.DATA_KEY].mutations=[]),C&&m(N.parent))},b=function(N){N.domNode[a.DATA_KEY]==null||N.domNode[a.DATA_KEY].mutations==null||(N instanceof o.default&&N.children.forEach(b),N.optimize(_))},I=p,v=0;I.length>0;v+=1){if(v>=h)throw new Error("[Parchment] Maximum optimize iterations reached");for(I.forEach(function(N){var C=a.find(N.target,!0);C!=null&&(C.domNode===N.target&&(N.type==="childList"?(m(a.find(N.previousSibling,!1)),[].forEach.call(N.addedNodes,function(E){var w=a.find(E,!1);m(w,!1),w instanceof o.default&&w.children.forEach(function(A){m(A,!1)})})):N.type==="attributes"&&m(C.prev)),m(C))}),this.children.forEach(b),I=[].slice.call(this.observer.takeRecords()),g=I.slice();g.length>0;)p.push(g.pop())}},f.prototype.update=function(p,_){var y=this;_===void 0&&(_={}),p=p||this.observer.takeRecords(),p.map(function(g){var m=a.find(g.target,!0);return m==null?null:m.domNode[a.DATA_KEY].mutations==null?(m.domNode[a.DATA_KEY].mutations=[g],m):(m.domNode[a.DATA_KEY].mutations.push(g),null)}).forEach(function(g){g==null||g===y||g.domNode[a.DATA_KEY]==null||g.update(g.domNode[a.DATA_KEY].mutations||[],_)}),this.domNode[a.DATA_KEY].mutations!=null&&d.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,_),this.optimize(p,_)},f.blotName="scroll",f.defaultChild="block",f.scope=a.Scope.BLOCK_BLOT,f.tagName="DIV",f}(o.default);n.default=c},function(t,n,i){var s=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,f){d.__proto__=f}||function(d,f){for(var p in f)f.hasOwnProperty(p)&&(d[p]=f[p])};return function(d,f){c(d,f);function p(){this.constructor=d}d.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1);function l(c,d){if(Object.keys(c).length!==Object.keys(d).length)return!1;for(var f in c)if(c[f]!==d[f])return!1;return!0}var h=function(c){s(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.formats=function(f){if(f.tagName!==d.tagName)return c.formats.call(this,f)},d.prototype.format=function(f,p){var _=this;f===this.statics.blotName&&!p?(this.children.forEach(function(y){y instanceof o.default||(y=y.wrap(d.blotName,!0)),_.attributes.copy(y)}),this.unwrap()):c.prototype.format.call(this,f,p)},d.prototype.formatAt=function(f,p,_,y){if(this.formats()[_]!=null||a.query(_,a.Scope.ATTRIBUTE)){var g=this.isolate(f,p);g.format(_,y)}else c.prototype.formatAt.call(this,f,p,_,y)},d.prototype.optimize=function(f){c.prototype.optimize.call(this,f);var p=this.formats();if(Object.keys(p).length===0)return this.unwrap();var _=this.next;_ instanceof d&&_.prev===this&&l(p,_.formats())&&(_.moveChildren(this),_.remove())},d.blotName="inline",d.scope=a.Scope.INLINE_BLOT,d.tagName="SPAN",d}(o.default);n.default=h},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])};return function(c,d){h(c,d);function f(){this.constructor=c}c.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),a=i(1),l=function(h){s(c,h);function c(){return h!==null&&h.apply(this,arguments)||this}return c.formats=function(d){var f=a.query(c.blotName).tagName;if(d.tagName!==f)return h.formats.call(this,d)},c.prototype.format=function(d,f){a.query(d,a.Scope.BLOCK)!=null&&(d===this.statics.blotName&&!f?this.replaceWith(c.blotName):h.prototype.format.call(this,d,f))},c.prototype.formatAt=function(d,f,p,_){a.query(p,a.Scope.BLOCK)!=null?this.format(p,_):h.prototype.formatAt.call(this,d,f,p,_)},c.prototype.insertAt=function(d,f,p){if(p==null||a.query(f,a.Scope.INLINE)!=null)h.prototype.insertAt.call(this,d,f,p);else{var _=this.split(d),y=a.create(f,p);_.parent.insertBefore(y,_)}},c.prototype.update=function(d,f){navigator.userAgent.match(/Trident/)?this.build():h.prototype.update.call(this,d,f)},c.blotName="block",c.scope=a.Scope.BLOCK_BLOT,c.tagName="P",c}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,c){h.__proto__=c}||function(h,c){for(var d in c)c.hasOwnProperty(d)&&(h[d]=c[d])};return function(h,c){l(h,c);function d(){this.constructor=h}h.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=function(l){s(h,l);function h(){return l!==null&&l.apply(this,arguments)||this}return h.formats=function(c){},h.prototype.format=function(c,d){l.prototype.formatAt.call(this,0,this.length(),c,d)},h.prototype.formatAt=function(c,d,f,p){c===0&&d===this.length()?this.format(f,p):l.prototype.formatAt.call(this,c,d,f,p)},h.prototype.formats=function(){return this.statics.formats(this.domNode)},h}(o.default);n.default=a},function(t,n,i){var s=this&&this.__extends||function(){var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var f in d)d.hasOwnProperty(f)&&(c[f]=d[f])};return function(c,d){h(c,d);function f(){this.constructor=c}c.prototype=d===null?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),a=i(1),l=function(h){s(c,h);function c(d){var f=h.call(this,d)||this;return f.text=f.statics.value(f.domNode),f}return c.create=function(d){return document.createTextNode(d)},c.value=function(d){var f=d.data;return f.normalize&&(f=f.normalize()),f},c.prototype.deleteAt=function(d,f){this.domNode.data=this.text=this.text.slice(0,d)+this.text.slice(d+f)},c.prototype.index=function(d,f){return this.domNode===d?f:-1},c.prototype.insertAt=function(d,f,p){p==null?(this.text=this.text.slice(0,d)+f+this.text.slice(d),this.domNode.data=this.text):h.prototype.insertAt.call(this,d,f,p)},c.prototype.length=function(){return this.text.length},c.prototype.optimize=function(d){h.prototype.optimize.call(this,d),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof c&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},c.prototype.position=function(d,f){return[this.domNode,d]},c.prototype.split=function(d,f){if(f===void 0&&(f=!1),!f){if(d===0)return this;if(d===this.length())return this.next}var p=a.create(this.domNode.splitText(d));return this.parent.insertBefore(p,this.next),this.text=this.statics.value(this.domNode),p},c.prototype.update=function(d,f){var p=this;d.some(function(_){return _.type==="characterData"&&_.target===p.domNode})&&(this.text=this.statics.value(this.domNode))},c.prototype.value=function(){return this.text},c.blotName="text",c.scope=a.Scope.INLINE_BLOT,c}(o.default);n.default=l},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,l){return arguments.length>1&&!this.contains(a)==!l?l:o.call(this,a)}}String.prototype.startsWith||(String.prototype.startsWith=function(a,l){return l=l||0,this.substr(l,a.length)===a}),String.prototype.endsWith||(String.prototype.endsWith=function(a,l){var h=this.toString();(typeof l!="number"||!isFinite(l)||Math.floor(l)!==l||l>h.length)&&(l=h.length),l-=a.length;var c=h.indexOf(a,l);return c!==-1&&c===l}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("predicate must be a function");for(var h=Object(this),c=h.length>>>0,d=arguments[1],f,p=0;p<c;p++)if(f=h[p],l.call(d,f,p,h))return f}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function a(v,N,C){if(v==N)return v?[[o,v]]:[];(C<0||v.length<C)&&(C=null);var E=d(v,N),w=v.substring(0,E);v=v.substring(E),N=N.substring(E),E=f(v,N);var A=v.substring(v.length-E);v=v.substring(0,v.length-E),N=N.substring(0,N.length-E);var x=l(v,N);return w&&x.unshift([o,w]),A&&x.push([o,A]),_(x),C!=null&&(x=m(x,C)),x=b(x),x}function l(v,N){var C;if(!v)return[[s,N]];if(!N)return[[i,v]];var E=v.length>N.length?v:N,w=v.length>N.length?N:v,A=E.indexOf(w);if(A!=-1)return C=[[s,E.substring(0,A)],[o,w],[s,E.substring(A+w.length)]],v.length>N.length&&(C[0][0]=C[2][0]=i),C;if(w.length==1)return[[i,v],[s,N]];var x=p(v,N);if(x){var T=x[0],S=x[1],O=x[2],D=x[3],q=x[4],B=a(T,O),K=a(S,D);return B.concat([[o,q]],K)}return h(v,N)}function h(v,N){for(var C=v.length,E=N.length,w=Math.ceil((C+E)/2),A=w,x=2*w,T=new Array(x),S=new Array(x),O=0;O<x;O++)T[O]=-1,S[O]=-1;T[A+1]=0,S[A+1]=0;for(var D=C-E,q=D%2!=0,B=0,K=0,oe=0,z=0,F=0;F<w;F++){for(var j=-F+B;j<=F-K;j+=2){var V=A+j,$;j==-F||j!=F&&T[V-1]<T[V+1]?$=T[V+1]:$=T[V-1]+1;for(var G=$-j;$<C&&G<E&&v.charAt($)==N.charAt(G);)$++,G++;if(T[V]=$,$>C)K+=2;else if(G>E)B+=2;else if(q){var H=A+D-j;if(H>=0&&H<x&&S[H]!=-1){var M=C-S[H];if($>=M)return c(v,N,$,G)}}}for(var U=-F+oe;U<=F-z;U+=2){var H=A+U,M;U==-F||U!=F&&S[H-1]<S[H+1]?M=S[H+1]:M=S[H-1]+1;for(var Y=M-U;M<C&&Y<E&&v.charAt(C-M-1)==N.charAt(E-Y-1);)M++,Y++;if(S[H]=M,M>C)z+=2;else if(Y>E)oe+=2;else if(!q){var V=A+D-U;if(V>=0&&V<x&&T[V]!=-1){var $=T[V],G=A+$-V;if(M=C-M,$>=M)return c(v,N,$,G)}}}}return[[i,v],[s,N]]}function c(v,N,C,E){var w=v.substring(0,C),A=N.substring(0,E),x=v.substring(C),T=N.substring(E),S=a(w,A),O=a(x,T);return S.concat(O)}function d(v,N){if(!v||!N||v.charAt(0)!=N.charAt(0))return 0;for(var C=0,E=Math.min(v.length,N.length),w=E,A=0;C<w;)v.substring(A,w)==N.substring(A,w)?(C=w,A=C):E=w,w=Math.floor((E-C)/2+C);return w}function f(v,N){if(!v||!N||v.charAt(v.length-1)!=N.charAt(N.length-1))return 0;for(var C=0,E=Math.min(v.length,N.length),w=E,A=0;C<w;)v.substring(v.length-w,v.length-A)==N.substring(N.length-w,N.length-A)?(C=w,A=C):E=w,w=Math.floor((E-C)/2+C);return w}function p(v,N){var C=v.length>N.length?v:N,E=v.length>N.length?N:v;if(C.length<4||E.length*2<C.length)return null;function w(K,oe,z){for(var F=K.substring(z,z+Math.floor(K.length/4)),j=-1,V="",$,G,H,M;(j=oe.indexOf(F,j+1))!=-1;){var U=d(K.substring(z),oe.substring(j)),Y=f(K.substring(0,z),oe.substring(0,j));V.length<Y+U&&(V=oe.substring(j-Y,j)+oe.substring(j,j+U),$=K.substring(0,z-Y),G=K.substring(z+U),H=oe.substring(0,j-Y),M=oe.substring(j+U))}return V.length*2>=K.length?[$,G,H,M,V]:null}var A=w(C,E,Math.ceil(C.length/4)),x=w(C,E,Math.ceil(C.length/2)),T;if(!A&&!x)return null;x?A?T=A[4].length>x[4].length?A:x:T=x:T=A;var S,O,D,q;v.length>N.length?(S=T[0],O=T[1],D=T[2],q=T[3]):(D=T[0],q=T[1],S=T[2],O=T[3]);var B=T[4];return[S,O,D,q,B]}function _(v){v.push([o,""]);for(var N=0,C=0,E=0,w="",A="",x;N<v.length;)switch(v[N][0]){case s:E++,A+=v[N][1],N++;break;case i:C++,w+=v[N][1],N++;break;case o:C+E>1?(C!==0&&E!==0&&(x=d(A,w),x!==0&&(N-C-E>0&&v[N-C-E-1][0]==o?v[N-C-E-1][1]+=A.substring(0,x):(v.splice(0,0,[o,A.substring(0,x)]),N++),A=A.substring(x),w=w.substring(x)),x=f(A,w),x!==0&&(v[N][1]=A.substring(A.length-x)+v[N][1],A=A.substring(0,A.length-x),w=w.substring(0,w.length-x))),C===0?v.splice(N-E,C+E,[s,A]):E===0?v.splice(N-C,C+E,[i,w]):v.splice(N-C-E,C+E,[i,w],[s,A]),N=N-C-E+(C?1:0)+(E?1:0)+1):N!==0&&v[N-1][0]==o?(v[N-1][1]+=v[N][1],v.splice(N,1)):N++,E=0,C=0,w="",A="";break}v[v.length-1][1]===""&&v.pop();var T=!1;for(N=1;N<v.length-1;)v[N-1][0]==o&&v[N+1][0]==o&&(v[N][1].substring(v[N][1].length-v[N-1][1].length)==v[N-1][1]?(v[N][1]=v[N-1][1]+v[N][1].substring(0,v[N][1].length-v[N-1][1].length),v[N+1][1]=v[N-1][1]+v[N+1][1],v.splice(N-1,1),T=!0):v[N][1].substring(0,v[N+1][1].length)==v[N+1][1]&&(v[N-1][1]+=v[N+1][1],v[N][1]=v[N][1].substring(v[N+1][1].length)+v[N+1][1],v.splice(N+1,1),T=!0)),N++;T&&_(v)}var y=a;y.INSERT=s,y.DELETE=i,y.EQUAL=o,t.exports=y;function g(v,N){if(N===0)return[o,v];for(var C=0,E=0;E<v.length;E++){var w=v[E];if(w[0]===i||w[0]===o){var A=C+w[1].length;if(N===A)return[E+1,v];if(N<A){v=v.slice();var x=N-C,T=[w[0],w[1].slice(0,x)],S=[w[0],w[1].slice(x)];return v.splice(E,1,T,S),[E+1,v]}else C=A}}throw new Error("cursor_pos is out of bounds!")}function m(v,N){var C=g(v,N),E=C[1],w=C[0],A=E[w],x=E[w+1];if(A==null)return v;if(A[0]!==o)return v;if(x!=null&&A[1]+x[1]===x[1]+A[1])return E.splice(w,2,x,A),I(E,w,2);if(x!=null&&x[1].indexOf(A[1])===0){E.splice(w,2,[x[0],A[1]],[0,A[1]]);var T=x[1].slice(A[1].length);return T.length>0&&E.splice(w+2,0,[x[0],T]),I(E,w,3)}else return v}function b(v){for(var N=!1,C=function(x){return x.charCodeAt(0)>=56320&&x.charCodeAt(0)<=57343},E=function(x){return x.charCodeAt(x.length-1)>=55296&&x.charCodeAt(x.length-1)<=56319},w=2;w<v.length;w+=1)v[w-2][0]===o&&E(v[w-2][1])&&v[w-1][0]===i&&C(v[w-1][1])&&v[w][0]===s&&C(v[w][1])&&(N=!0,v[w-1][1]=v[w-2][1].slice(-1)+v[w-1][1],v[w][1]=v[w-2][1].slice(-1)+v[w][1],v[w-2][1]=v[w-2][1].slice(0,-1));if(!N)return v;for(var A=[],w=0;w<v.length;w+=1)v[w][1].length>0&&A.push(v[w]);return A}function I(v,N,C){for(var E=N+C-1;E>=0&&E>=N-1;E--)if(E+1<v.length){var w=v[E],A=v[E+1];w[0]===A[1]&&v.splice(E,2,[w[0],w[1]+A[1]])}return v}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var a in s)o.push(a);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(a){return Object.prototype.toString.call(a)=="[object Arguments]"}n.unsupported=o;function o(a){return a&&typeof a=="object"&&typeof a.length=="number"&&Object.prototype.hasOwnProperty.call(a,"callee")&&!Object.prototype.propertyIsEnumerable.call(a,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function a(h,c,d){this.fn=h,this.context=c,this.once=d||!1}function l(){this._events=new o,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],d,f;if(this._eventsCount===0)return c;for(f in d=this._events)i.call(d,f)&&c.push(s?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},l.prototype.listeners=function(c,d){var f=s?s+c:c,p=this._events[f];if(d)return!!p;if(!p)return[];if(p.fn)return[p.fn];for(var _=0,y=p.length,g=new Array(y);_<y;_++)g[_]=p[_].fn;return g},l.prototype.emit=function(c,d,f,p,_,y){var g=s?s+c:c;if(!this._events[g])return!1;var m=this._events[g],b=arguments.length,I,v;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),b){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,f),!0;case 4:return m.fn.call(m.context,d,f,p),!0;case 5:return m.fn.call(m.context,d,f,p,_),!0;case 6:return m.fn.call(m.context,d,f,p,_,y),!0}for(v=1,I=new Array(b-1);v<b;v++)I[v-1]=arguments[v];m.fn.apply(m.context,I)}else{var N=m.length,C;for(v=0;v<N;v++)switch(m[v].once&&this.removeListener(c,m[v].fn,void 0,!0),b){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,d);break;case 3:m[v].fn.call(m[v].context,d,f);break;case 4:m[v].fn.call(m[v].context,d,f,p);break;default:if(!I)for(C=1,I=new Array(b-1);C<b;C++)I[C-1]=arguments[C];m[v].fn.apply(m[v].context,I)}}return!0},l.prototype.on=function(c,d,f){var p=new a(d,f||this),_=s?s+c:c;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.once=function(c,d,f){var p=new a(d,f||this,!0),_=s?s+c:c;return this._events[_]?this._events[_].fn?this._events[_]=[this._events[_],p]:this._events[_].push(p):(this._events[_]=p,this._eventsCount++),this},l.prototype.removeListener=function(c,d,f,p){var _=s?s+c:c;if(!this._events[_])return this;if(!d)return--this._eventsCount===0?this._events=new o:delete this._events[_],this;var y=this._events[_];if(y.fn)y.fn===d&&(!p||y.once)&&(!f||y.context===f)&&(--this._eventsCount===0?this._events=new o:delete this._events[_]);else{for(var g=0,m=[],b=y.length;g<b;g++)(y[g].fn!==d||p&&!y[g].once||f&&y[g].context!==f)&&m.push(y[g]);m.length?this._events[_]=m.length===1?m[0]:m:--this._eventsCount===0?this._events=new o:delete this._events[_]}return this},l.prototype.removeAllListeners=function(c){var d;return c?(d=s?s+c:c,this._events[d]&&(--this._eventsCount===0?this._events=new o:delete this._events[d])):(this._events=new o,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prototype.setMaxListeners=function(){return this},l.prefixed=s,l.EventEmitter=l,typeof t<"u"&&(t.exports=l)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},o=function(){function ne(re,fe){var Z=[],J=!0,ce=!1,me=void 0;try{for(var be=re[Symbol.iterator](),xe;!(J=(xe=be.next()).done)&&(Z.push(xe.value),!(fe&&Z.length===fe));J=!0);}catch(De){ce=!0,me=De}finally{try{!J&&be.return&&be.return()}finally{if(ce)throw me}}return Z}return function(re,fe){if(Array.isArray(re))return re;if(Symbol.iterator in Object(re))return ne(re,fe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function ne(re,fe){for(var Z=0;Z<fe.length;Z++){var J=fe[Z];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(re,J.key,J)}}return function(re,fe,Z){return fe&&ne(re.prototype,fe),Z&&ne(re,Z),re}}(),l=i(3),h=S(l),c=i(2),d=S(c),f=i(0),p=S(f),_=i(5),y=S(_),g=i(10),m=S(g),b=i(9),I=S(b),v=i(36),N=i(37),C=i(13),E=S(C),w=i(26),A=i(38),x=i(39),T=i(40);function S(ne){return ne&&ne.__esModule?ne:{default:ne}}function O(ne,re,fe){return re in ne?Object.defineProperty(ne,re,{value:fe,enumerable:!0,configurable:!0,writable:!0}):ne[re]=fe,ne}function D(ne,re){if(!(ne instanceof re))throw new TypeError("Cannot call a class as a function")}function q(ne,re){if(!ne)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return re&&(typeof re=="object"||typeof re=="function")?re:ne}function B(ne,re){if(typeof re!="function"&&re!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof re);ne.prototype=Object.create(re&&re.prototype,{constructor:{value:ne,enumerable:!1,writable:!0,configurable:!0}}),re&&(Object.setPrototypeOf?Object.setPrototypeOf(ne,re):ne.__proto__=re)}var K=(0,m.default)("quill:clipboard"),oe="__ql-matcher",z=[[Node.TEXT_NODE,qe],[Node.TEXT_NODE,de],["br",X],[Node.ELEMENT_NODE,de],[Node.ELEMENT_NODE,se],[Node.ELEMENT_NODE,Ae],[Node.ELEMENT_NODE,Q],[Node.ELEMENT_NODE,We],["li",pe],["b",Y.bind(Y,"bold")],["i",Y.bind(Y,"italic")],["style",ue]],F=[v.AlignAttribute,A.DirectionAttribute].reduce(function(ne,re){return ne[re.keyName]=re,ne},{}),j=[v.AlignStyle,N.BackgroundStyle,w.ColorStyle,A.DirectionStyle,x.FontStyle,T.SizeStyle].reduce(function(ne,re){return ne[re.keyName]=re,ne},{}),V=function(ne){B(re,ne);function re(fe,Z){D(this,re);var J=q(this,(re.__proto__||Object.getPrototypeOf(re)).call(this,fe,Z));return J.quill.root.addEventListener("paste",J.onPaste.bind(J)),J.container=J.quill.addContainer("ql-clipboard"),J.container.setAttribute("contenteditable",!0),J.container.setAttribute("tabindex",-1),J.matchers=[],z.concat(J.options.matchers).forEach(function(ce){var me=o(ce,2),be=me[0],xe=me[1];!Z.matchVisual&&xe===Ae||J.addMatcher(be,xe)}),J}return a(re,[{key:"addMatcher",value:function(Z,J){this.matchers.push([Z,J])}},{key:"convert",value:function(Z){if(typeof Z=="string")return this.container.innerHTML=Z.replace(/\>\r?\n +\</g,"><"),this.convert();var J=this.quill.getFormat(this.quill.selection.savedRange.index);if(J[E.default.blotName]){var ce=this.container.innerText;return this.container.innerHTML="",new d.default().insert(ce,O({},E.default.blotName,J[E.default.blotName]))}var me=this.prepareMatching(),be=o(me,2),xe=be[0],De=be[1],Ce=U(this.container,xe,De);return H(Ce,`
`)&&Ce.ops[Ce.ops.length-1].attributes==null&&(Ce=Ce.compose(new d.default().retain(Ce.length()-1).delete(1))),K.log("convert",this.container.innerHTML,Ce),this.container.innerHTML="",Ce}},{key:"dangerouslyPasteHTML",value:function(Z,J){var ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y.default.sources.API;if(typeof Z=="string")this.quill.setContents(this.convert(Z),J),this.quill.setSelection(0,y.default.sources.SILENT);else{var me=this.convert(J);this.quill.updateContents(new d.default().retain(Z).concat(me),ce),this.quill.setSelection(Z+me.length(),y.default.sources.SILENT)}}},{key:"onPaste",value:function(Z){var J=this;if(!(Z.defaultPrevented||!this.quill.isEnabled())){var ce=this.quill.getSelection(),me=new d.default().retain(ce.index),be=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(y.default.sources.SILENT),setTimeout(function(){me=me.concat(J.convert()).delete(ce.length),J.quill.updateContents(me,y.default.sources.USER),J.quill.setSelection(me.length()-ce.length,y.default.sources.SILENT),J.quill.scrollingContainer.scrollTop=be,J.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Z=this,J=[],ce=[];return this.matchers.forEach(function(me){var be=o(me,2),xe=be[0],De=be[1];switch(xe){case Node.TEXT_NODE:ce.push(De);break;case Node.ELEMENT_NODE:J.push(De);break;default:[].forEach.call(Z.container.querySelectorAll(xe),function(Ce){Ce[oe]=Ce[oe]||[],Ce[oe].push(De)});break}}),[J,ce]}}]),re}(I.default);V.DEFAULTS={matchers:[],matchVisual:!0};function $(ne,re,fe){return(typeof re>"u"?"undefined":s(re))==="object"?Object.keys(re).reduce(function(Z,J){return $(Z,J,re[J])},ne):ne.reduce(function(Z,J){return J.attributes&&J.attributes[re]?Z.push(J):Z.insert(J.insert,(0,h.default)({},O({},re,fe),J.attributes))},new d.default)}function G(ne){if(ne.nodeType!==Node.ELEMENT_NODE)return{};var re="__ql-computed-style";return ne[re]||(ne[re]=window.getComputedStyle(ne))}function H(ne,re){for(var fe="",Z=ne.ops.length-1;Z>=0&&fe.length<re.length;--Z){var J=ne.ops[Z];if(typeof J.insert!="string")break;fe=J.insert+fe}return fe.slice(-1*re.length)===re}function M(ne){if(ne.childNodes.length===0)return!1;var re=G(ne);return["block","list-item"].indexOf(re.display)>-1}function U(ne,re,fe){return ne.nodeType===ne.TEXT_NODE?fe.reduce(function(Z,J){return J(ne,Z)},new d.default):ne.nodeType===ne.ELEMENT_NODE?[].reduce.call(ne.childNodes||[],function(Z,J){var ce=U(J,re,fe);return J.nodeType===ne.ELEMENT_NODE&&(ce=re.reduce(function(me,be){return be(J,me)},ce),ce=(J[oe]||[]).reduce(function(me,be){return be(J,me)},ce)),Z.concat(ce)},new d.default):new d.default}function Y(ne,re,fe){return $(fe,ne,!0)}function Q(ne,re){var fe=p.default.Attributor.Attribute.keys(ne),Z=p.default.Attributor.Class.keys(ne),J=p.default.Attributor.Style.keys(ne),ce={};return fe.concat(Z).concat(J).forEach(function(me){var be=p.default.query(me,p.default.Scope.ATTRIBUTE);be!=null&&(ce[be.attrName]=be.value(ne),ce[be.attrName])||(be=F[me],be!=null&&(be.attrName===me||be.keyName===me)&&(ce[be.attrName]=be.value(ne)||void 0),be=j[me],be!=null&&(be.attrName===me||be.keyName===me)&&(be=j[me],ce[be.attrName]=be.value(ne)||void 0))}),Object.keys(ce).length>0&&(re=$(re,ce)),re}function se(ne,re){var fe=p.default.query(ne);if(fe==null)return re;if(fe.prototype instanceof p.default.Embed){var Z={},J=fe.value(ne);J!=null&&(Z[fe.blotName]=J,re=new d.default().insert(Z,fe.formats(ne)))}else typeof fe.formats=="function"&&(re=$(re,fe.blotName,fe.formats(ne)));return re}function X(ne,re){return H(re,`
`)||re.insert(`
`),re}function ue(){return new d.default}function pe(ne,re){var fe=p.default.query(ne);if(fe==null||fe.blotName!=="list-item"||!H(re,`
`))return re;for(var Z=-1,J=ne.parentNode;!J.classList.contains("ql-clipboard");)(p.default.query(J)||{}).blotName==="list"&&(Z+=1),J=J.parentNode;return Z<=0?re:re.compose(new d.default().retain(re.length()-1).retain(1,{indent:Z}))}function de(ne,re){return H(re,`
`)||(M(ne)||re.length()>0&&ne.nextSibling&&M(ne.nextSibling))&&re.insert(`
`),re}function Ae(ne,re){if(M(ne)&&ne.nextElementSibling!=null&&!H(re,`

`)){var fe=ne.offsetHeight+parseFloat(G(ne).marginTop)+parseFloat(G(ne).marginBottom);ne.nextElementSibling.offsetTop>ne.offsetTop+fe*1.5&&re.insert(`
`)}return re}function We(ne,re){var fe={},Z=ne.style||{};return Z.fontStyle&&G(ne).fontStyle==="italic"&&(fe.italic=!0),Z.fontWeight&&(G(ne).fontWeight.startsWith("bold")||parseInt(G(ne).fontWeight)>=700)&&(fe.bold=!0),Object.keys(fe).length>0&&(re=$(re,fe)),parseFloat(Z.textIndent||0)>0&&(re=new d.default().insert("	").concat(re)),re}function qe(ne,re){var fe=ne.data;if(ne.parentNode.tagName==="O:P")return re.insert(fe.trim());if(fe.trim().length===0&&ne.parentNode.classList.contains("ql-clipboard"))return re;if(!G(ne.parentNode).whiteSpace.startsWith("pre")){var Z=function(ce,me){return me=me.replace(/[^\u00a0]/g,""),me.length<1&&ce?" ":me};fe=fe.replace(/\r\n/g," ").replace(/\n/g," "),fe=fe.replace(/\s\s+/g,Z.bind(Z,!0)),(ne.previousSibling==null&&M(ne.parentNode)||ne.previousSibling!=null&&M(ne.previousSibling))&&(fe=fe.replace(/^\s+/,Z.bind(Z,!1))),(ne.nextSibling==null&&M(ne.parentNode)||ne.nextSibling!=null&&M(ne.nextSibling))&&(fe=fe.replace(/\s+$/,Z.bind(Z,!1)))}return re.insert(fe)}n.default=V,n.matchAttributor=Q,n.matchBlot=se,n.matchNewline=de,n.matchSpacing=Ae,n.matchText=qe},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(y,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}return function(y,g,m){return g&&_(y.prototype,g),m&&_(y,m),y}}(),o=function _(y,g,m){y===null&&(y=Function.prototype);var b=Object.getOwnPropertyDescriptor(y,g);if(b===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:_(I,g,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(){return c(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,[{key:"optimize",value:function(m){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"optimize",this).call(this,m),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),y}(l.default);p.blotName="bold",p.tagName=["STRONG","B"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function T(S,O){var D=[],q=!0,B=!1,K=void 0;try{for(var oe=S[Symbol.iterator](),z;!(q=(z=oe.next()).done)&&(D.push(z.value),!(O&&D.length===O));q=!0);}catch(F){B=!0,K=F}finally{try{!q&&oe.return&&oe.return()}finally{if(B)throw K}}return D}return function(S,O){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return T(S,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function T(S,O){for(var D=0;D<O.length;D++){var q=O[D];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(S,q.key,q)}}return function(S,O,D){return O&&T(S.prototype,O),D&&T(S,D),S}}(),a=i(2),l=m(a),h=i(0),c=m(h),d=i(5),f=m(d),p=i(10),_=m(p),y=i(9),g=m(y);function m(T){return T&&T.__esModule?T:{default:T}}function b(T,S,O){return S in T?Object.defineProperty(T,S,{value:O,enumerable:!0,configurable:!0,writable:!0}):T[S]=O,T}function I(T,S){if(!(T instanceof S))throw new TypeError("Cannot call a class as a function")}function v(T,S){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:T}function N(T,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);T.prototype=Object.create(S&&S.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(T,S):T.__proto__=S)}var C=(0,_.default)("quill:toolbar"),E=function(T){N(S,T);function S(O,D){I(this,S);var q=v(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,O,D));if(Array.isArray(q.options.container)){var B=document.createElement("div");A(B,q.options.container),O.container.parentNode.insertBefore(B,O.container),q.container=B}else typeof q.options.container=="string"?q.container=document.querySelector(q.options.container):q.container=q.options.container;if(!(q.container instanceof HTMLElement)){var K;return K=C.error("Container required for toolbar",q.options),v(q,K)}return q.container.classList.add("ql-toolbar"),q.controls=[],q.handlers={},Object.keys(q.options.handlers).forEach(function(oe){q.addHandler(oe,q.options.handlers[oe])}),[].forEach.call(q.container.querySelectorAll("button, select"),function(oe){q.attach(oe)}),q.quill.on(f.default.events.EDITOR_CHANGE,function(oe,z){oe===f.default.events.SELECTION_CHANGE&&q.update(z)}),q.quill.on(f.default.events.SCROLL_OPTIMIZE,function(){var oe=q.quill.selection.getRange(),z=s(oe,1),F=z[0];q.update(F)}),q}return o(S,[{key:"addHandler",value:function(D,q){this.handlers[D]=q}},{key:"attach",value:function(D){var q=this,B=[].find.call(D.classList,function(oe){return oe.indexOf("ql-")===0});if(B){if(B=B.slice(3),D.tagName==="BUTTON"&&D.setAttribute("type","button"),this.handlers[B]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[B]==null){C.warn("ignoring attaching to disabled format",B,D);return}if(c.default.query(B)==null){C.warn("ignoring attaching to nonexistent format",B,D);return}}var K=D.tagName==="SELECT"?"change":"click";D.addEventListener(K,function(oe){var z=void 0;if(D.tagName==="SELECT"){if(D.selectedIndex<0)return;var F=D.options[D.selectedIndex];F.hasAttribute("selected")?z=!1:z=F.value||!1}else D.classList.contains("ql-active")?z=!1:z=D.value||!D.hasAttribute("value"),oe.preventDefault();q.quill.focus();var j=q.quill.selection.getRange(),V=s(j,1),$=V[0];if(q.handlers[B]!=null)q.handlers[B].call(q,z);else if(c.default.query(B).prototype instanceof c.default.Embed){if(z=prompt("Enter "+B),!z)return;q.quill.updateContents(new l.default().retain($.index).delete($.length).insert(b({},B,z)),f.default.sources.USER)}else q.quill.format(B,z,f.default.sources.USER);q.update($)}),this.controls.push([B,D])}}},{key:"update",value:function(D){var q=D==null?{}:this.quill.getFormat(D);this.controls.forEach(function(B){var K=s(B,2),oe=K[0],z=K[1];if(z.tagName==="SELECT"){var F=void 0;if(D==null)F=null;else if(q[oe]==null)F=z.querySelector("option[selected]");else if(!Array.isArray(q[oe])){var j=q[oe];typeof j=="string"&&(j=j.replace(/\"/g,'\\"')),F=z.querySelector('option[value="'+j+'"]')}F==null?(z.value="",z.selectedIndex=-1):F.selected=!0}else if(D==null)z.classList.remove("ql-active");else if(z.hasAttribute("value")){var V=q[oe]===z.getAttribute("value")||q[oe]!=null&&q[oe].toString()===z.getAttribute("value")||q[oe]==null&&!z.getAttribute("value");z.classList.toggle("ql-active",V)}else z.classList.toggle("ql-active",q[oe]!=null)})}}]),S}(g.default);E.DEFAULTS={};function w(T,S,O){var D=document.createElement("button");D.setAttribute("type","button"),D.classList.add("ql-"+S),O!=null&&(D.value=O),T.appendChild(D)}function A(T,S){Array.isArray(S[0])||(S=[S]),S.forEach(function(O){var D=document.createElement("span");D.classList.add("ql-formats"),O.forEach(function(q){if(typeof q=="string")w(D,q);else{var B=Object.keys(q)[0],K=q[B];Array.isArray(K)?x(D,B,K):w(D,B,K)}}),T.appendChild(D)})}function x(T,S,O){var D=document.createElement("select");D.classList.add("ql-"+S),O.forEach(function(q){var B=document.createElement("option");q!==!1?B.setAttribute("value",q):B.setAttribute("selected","selected"),D.appendChild(B)}),T.appendChild(D)}E.DEFAULTS={container:null,handlers:{clean:function(){var S=this,O=this.quill.getSelection();if(O!=null)if(O.length==0){var D=this.quill.getFormat();Object.keys(D).forEach(function(q){c.default.query(q,c.default.Scope.INLINE)!=null&&S.quill.format(q,!1)})}else this.quill.removeFormat(O,f.default.sources.USER)},direction:function(S){var O=this.quill.getFormat().align;S==="rtl"&&O==null?this.quill.format("align","right",f.default.sources.USER):!S&&O==="right"&&this.quill.format("align",!1,f.default.sources.USER),this.quill.format("direction",S,f.default.sources.USER)},indent:function(S){var O=this.quill.getSelection(),D=this.quill.getFormat(O),q=parseInt(D.indent||0);if(S==="+1"||S==="-1"){var B=S==="+1"?1:-1;D.direction==="rtl"&&(B*=-1),this.quill.format("indent",q+B,f.default.sources.USER)}},link:function(S){S===!0&&(S=prompt("Enter link URL:")),this.quill.format("link",S,f.default.sources.USER)},list:function(S){var O=this.quill.getSelection(),D=this.quill.getFormat(O);S==="check"?D.list==="checked"||D.list==="unchecked"?this.quill.format("list",!1,f.default.sources.USER):this.quill.format("list","unchecked",f.default.sources.USER):this.quill.format("list",S,f.default.sources.USER)}}},n.default=E,n.addControls=A},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(y,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}return function(y,g,m){return g&&_(y.prototype,g),m&&_(y,m),y}}(),o=function _(y,g,m){y===null&&(y=Function.prototype);var b=Object.getOwnPropertyDescriptor(y,g);if(b===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:_(I,g,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(g,m){c(this,y);var b=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,g));return b.label.innerHTML=m,b.container.classList.add("ql-color-picker"),[].slice.call(b.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(I){I.classList.add("ql-primary")}),b}return s(y,[{key:"buildItem",value:function(m){var b=o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"buildItem",this).call(this,m);return b.style.backgroundColor=m.getAttribute("value")||"",b}},{key:"selectItem",value:function(m,b){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,m,b);var I=this.label.querySelector(".ql-color-label"),v=m&&m.getAttribute("data-value")||"";I&&(I.tagName==="line"?I.style.stroke=v:I.style.fill=v)}}]),y}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(y,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}return function(y,g,m){return g&&_(y.prototype,g),m&&_(y,m),y}}(),o=function _(y,g,m){y===null&&(y=Function.prototype);var b=Object.getOwnPropertyDescriptor(y,g);if(b===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:_(I,g,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(28),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(g,m){c(this,y);var b=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,g));return b.container.classList.add("ql-icon-picker"),[].forEach.call(b.container.querySelectorAll(".ql-picker-item"),function(I){I.innerHTML=m[I.getAttribute("data-value")||""]}),b.defaultItem=b.container.querySelector(".ql-selected"),b.selectItem(b.defaultItem),b}return s(y,[{key:"selectItem",value:function(m,b){o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"selectItem",this).call(this,m,b),m=m||this.defaultItem,this.label.innerHTML=m.innerHTML}}]),y}(l.default);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function l(h,c){for(var d=0;d<c.length;d++){var f=c[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(h,f.key,f)}}return function(h,c,d){return c&&l(h.prototype,c),d&&l(h,d),h}}();function o(l,h){if(!(l instanceof h))throw new TypeError("Cannot call a class as a function")}var a=function(){function l(h,c){var d=this;o(this,l),this.quill=h,this.boundsContainer=c||document.body,this.root=h.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){d.root.style.marginTop=-1*d.quill.root.scrollTop+"px"}),this.hide()}return s(l,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(c){var d=c.left+c.width/2-this.root.offsetWidth/2,f=c.bottom+this.quill.root.scrollTop;this.root.style.left=d+"px",this.root.style.top=f+"px",this.root.classList.remove("ql-flip");var p=this.boundsContainer.getBoundingClientRect(),_=this.root.getBoundingClientRect(),y=0;if(_.right>p.right&&(y=p.right-_.right,this.root.style.left=d+y+"px"),_.left<p.left&&(y=p.left-_.left,this.root.style.left=d+y+"px"),_.bottom>p.bottom){var g=_.bottom-_.top,m=c.bottom-c.top+g;this.root.style.top=f-m+"px",this.root.classList.add("ql-flip")}return y}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),l}();n.default=a},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function x(T,S){var O=[],D=!0,q=!1,B=void 0;try{for(var K=T[Symbol.iterator](),oe;!(D=(oe=K.next()).done)&&(O.push(oe.value),!(S&&O.length===S));D=!0);}catch(z){q=!0,B=z}finally{try{!D&&K.return&&K.return()}finally{if(q)throw B}}return O}return function(T,S){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return x(T,S);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function x(T,S,O){T===null&&(T=Function.prototype);var D=Object.getOwnPropertyDescriptor(T,S);if(D===void 0){var q=Object.getPrototypeOf(T);return q===null?void 0:x(q,S,O)}else{if("value"in D)return D.value;var B=D.get;return B===void 0?void 0:B.call(O)}},a=function(){function x(T,S){for(var O=0;O<S.length;O++){var D=S[O];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(T,D.key,D)}}return function(T,S,O){return S&&x(T.prototype,S),O&&x(T,O),T}}(),l=i(3),h=I(l),c=i(8),d=I(c),f=i(43),p=I(f),_=i(27),y=I(_),g=i(15),m=i(41),b=I(m);function I(x){return x&&x.__esModule?x:{default:x}}function v(x,T){if(!(x instanceof T))throw new TypeError("Cannot call a class as a function")}function N(x,T){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:x}function C(x,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);x.prototype=Object.create(T&&T.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(x,T):x.__proto__=T)}var E=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],w=function(x){C(T,x);function T(S,O){v(this,T),O.modules.toolbar!=null&&O.modules.toolbar.container==null&&(O.modules.toolbar.container=E);var D=N(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,S,O));return D.quill.container.classList.add("ql-snow"),D}return a(T,[{key:"extendToolbar",value:function(O){O.container.classList.add("ql-snow"),this.buildButtons([].slice.call(O.container.querySelectorAll("button")),b.default),this.buildPickers([].slice.call(O.container.querySelectorAll("select")),b.default),this.tooltip=new A(this.quill,this.options.bounds),O.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(D,q){O.handlers.link.call(O,!q.format.link)})}}]),T}(p.default);w.DEFAULTS=(0,h.default)(!0,{},p.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(T){if(T){var S=this.quill.getSelection();if(S==null||S.length==0)return;var O=this.quill.getText(S);/^\S+@\S+\.\S+$/.test(O)&&O.indexOf("mailto:")!==0&&(O="mailto:"+O);var D=this.quill.theme.tooltip;D.edit("link",O)}else this.quill.format("link",!1)}}}}});var A=function(x){C(T,x);function T(S,O){v(this,T);var D=N(this,(T.__proto__||Object.getPrototypeOf(T)).call(this,S,O));return D.preview=D.root.querySelector("a.ql-preview"),D}return a(T,[{key:"listen",value:function(){var O=this;o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(D){O.root.classList.contains("ql-editing")?O.save():O.edit("link",O.preview.textContent),D.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(D){if(O.linkRange!=null){var q=O.linkRange;O.restoreFocus(),O.quill.formatText(q,"link",!1,d.default.sources.USER),delete O.linkRange}D.preventDefault(),O.hide()}),this.quill.on(d.default.events.SELECTION_CHANGE,function(D,q,B){if(D!=null){if(D.length===0&&B===d.default.sources.USER){var K=O.quill.scroll.descendant(y.default,D.index),oe=s(K,2),z=oe[0],F=oe[1];if(z!=null){O.linkRange=new g.Range(D.index-F,z.length());var j=y.default.formats(z.domNode);O.preview.textContent=j,O.preview.setAttribute("href",j),O.show(),O.position(O.quill.getBounds(O.linkRange));return}}else delete O.linkRange;O.hide()}})}},{key:"show",value:function(){o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),T}(f.BaseTooltip);A.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=w},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=J(s),a=i(36),l=i(38),h=i(64),c=i(65),d=J(c),f=i(66),p=J(f),_=i(67),y=J(_),g=i(37),m=i(26),b=i(39),I=i(40),v=i(56),N=J(v),C=i(68),E=J(C),w=i(27),A=J(w),x=i(69),T=J(x),S=i(70),O=J(S),D=i(71),q=J(D),B=i(72),K=J(B),oe=i(73),z=J(oe),F=i(13),j=J(F),V=i(74),$=J(V),G=i(75),H=J(G),M=i(57),U=J(M),Y=i(41),Q=J(Y),se=i(28),X=J(se),ue=i(59),pe=J(ue),de=i(60),Ae=J(de),We=i(61),qe=J(We),ne=i(108),re=J(ne),fe=i(62),Z=J(fe);function J(ce){return ce&&ce.__esModule?ce:{default:ce}}o.default.register({"attributors/attribute/direction":l.DirectionAttribute,"attributors/class/align":a.AlignClass,"attributors/class/background":g.BackgroundClass,"attributors/class/color":m.ColorClass,"attributors/class/direction":l.DirectionClass,"attributors/class/font":b.FontClass,"attributors/class/size":I.SizeClass,"attributors/style/align":a.AlignStyle,"attributors/style/background":g.BackgroundStyle,"attributors/style/color":m.ColorStyle,"attributors/style/direction":l.DirectionStyle,"attributors/style/font":b.FontStyle,"attributors/style/size":I.SizeStyle},!0),o.default.register({"formats/align":a.AlignClass,"formats/direction":l.DirectionClass,"formats/indent":h.IndentClass,"formats/background":g.BackgroundStyle,"formats/color":m.ColorStyle,"formats/font":b.FontClass,"formats/size":I.SizeClass,"formats/blockquote":d.default,"formats/code-block":j.default,"formats/header":p.default,"formats/list":y.default,"formats/bold":N.default,"formats/code":F.Code,"formats/italic":E.default,"formats/link":A.default,"formats/script":T.default,"formats/strike":O.default,"formats/underline":q.default,"formats/image":K.default,"formats/video":z.default,"formats/list/item":_.ListItem,"modules/formula":$.default,"modules/syntax":H.default,"modules/toolbar":U.default,"themes/bubble":re.default,"themes/snow":Z.default,"ui/icons":Q.default,"ui/picker":X.default,"ui/icon-picker":Ae.default,"ui/color-picker":pe.default,"ui/tooltip":qe.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function y(g,m){for(var b=0;b<m.length;b++){var I=m[b];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(g,I.key,I)}}return function(g,m,b){return m&&y(g.prototype,m),b&&y(g,b),g}}(),o=function y(g,m,b){g===null&&(g=Function.prototype);var I=Object.getOwnPropertyDescriptor(g,m);if(I===void 0){var v=Object.getPrototypeOf(g);return v===null?void 0:y(v,m,b)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(b)}},a=i(0),l=h(a);function h(y){return y&&y.__esModule?y:{default:y}}function c(y,g){if(!(y instanceof g))throw new TypeError("Cannot call a class as a function")}function d(y,g){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:y}function f(y,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);y.prototype=Object.create(g&&g.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(y,g):y.__proto__=g)}var p=function(y){f(g,y);function g(){return c(this,g),d(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return s(g,[{key:"add",value:function(b,I){if(I==="+1"||I==="-1"){var v=this.value(b)||0;I=I==="+1"?v+1:v-1}return I===0?(this.remove(b),!0):o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"add",this).call(this,b,I)}},{key:"canAdd",value:function(b,I){return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"canAdd",this).call(this,b,I)||o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"canAdd",this).call(this,b,parseInt(I))}},{key:"value",value:function(b){return parseInt(o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"value",this).call(this,b))||void 0}}]),g}(l.default.Attributor.Class),_=new p("indent","ql-indent",{scope:l.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function h(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){c(p,f);function p(){return l(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="blockquote",d.tagName="blockquote",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function p(_,y){for(var g=0;g<y.length;g++){var m=y[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(_,m.key,m)}}return function(_,y,g){return y&&p(_.prototype,y),g&&p(_,g),_}}(),o=i(4),a=l(o);function l(p){return p&&p.__esModule?p:{default:p}}function h(p,_){if(!(p instanceof _))throw new TypeError("Cannot call a class as a function")}function c(p,_){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:p}function d(p,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);p.prototype=Object.create(_&&_.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(p,_):p.__proto__=_)}var f=function(p){d(_,p);function _(){return h(this,_),c(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return s(_,null,[{key:"formats",value:function(g){return this.tagName.indexOf(g.tagName)+1}}]),_}(a.default);f.blotName="header",f.tagName=["H1","H2","H3","H4","H5","H6"],n.default=f},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function v(N,C){for(var E=0;E<C.length;E++){var w=C[E];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(N,w.key,w)}}return function(N,C,E){return C&&v(N.prototype,C),E&&v(N,E),N}}(),o=function v(N,C,E){N===null&&(N=Function.prototype);var w=Object.getOwnPropertyDescriptor(N,C);if(w===void 0){var A=Object.getPrototypeOf(N);return A===null?void 0:v(A,C,E)}else{if("value"in w)return w.value;var x=w.get;return x===void 0?void 0:x.call(E)}},a=i(0),l=p(a),h=i(4),c=p(h),d=i(25),f=p(d);function p(v){return v&&v.__esModule?v:{default:v}}function _(v,N,C){return N in v?Object.defineProperty(v,N,{value:C,enumerable:!0,configurable:!0,writable:!0}):v[N]=C,v}function y(v,N){if(!(v instanceof N))throw new TypeError("Cannot call a class as a function")}function g(v,N){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:v}function m(v,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);v.prototype=Object.create(N&&N.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(v,N):v.__proto__=N)}var b=function(v){m(N,v);function N(){return y(this,N),g(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return s(N,[{key:"format",value:function(E,w){E===I.blotName&&!w?this.replaceWith(l.default.create(this.statics.scope)):o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"format",this).call(this,E,w)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(E,w){return this.parent.isolate(this.offset(this.parent),this.length()),E===this.parent.statics.blotName?(this.parent.replaceWith(E,w),this):(this.parent.unwrap(),o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"replaceWith",this).call(this,E,w))}}],[{key:"formats",value:function(E){return E.tagName===this.tagName?void 0:o(N.__proto__||Object.getPrototypeOf(N),"formats",this).call(this,E)}}]),N}(c.default);b.blotName="list-item",b.tagName="LI";var I=function(v){m(N,v),s(N,null,[{key:"create",value:function(E){var w=E==="ordered"?"OL":"UL",A=o(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this,w);return(E==="checked"||E==="unchecked")&&A.setAttribute("data-checked",E==="checked"),A}},{key:"formats",value:function(E){if(E.tagName==="OL")return"ordered";if(E.tagName==="UL")return E.hasAttribute("data-checked")?E.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function N(C){y(this,N);var E=g(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,C)),w=function(x){if(x.target.parentNode===C){var T=E.statics.formats(C),S=l.default.find(x.target);T==="checked"?S.format("list","unchecked"):T==="unchecked"&&S.format("list","checked")}};return C.addEventListener("touchstart",w),C.addEventListener("mousedown",w),E}return s(N,[{key:"format",value:function(E,w){this.children.length>0&&this.children.tail.format(E,w)}},{key:"formats",value:function(){return _({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(E,w){if(E instanceof b)o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"insertBefore",this).call(this,E,w);else{var A=w==null?this.length():w.offset(this),x=this.split(A);x.parent.insertBefore(E,x)}}},{key:"optimize",value:function(E){o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"optimize",this).call(this,E);var w=this.next;w!=null&&w.prev===this&&w.statics.blotName===this.statics.blotName&&w.domNode.tagName===this.domNode.tagName&&w.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(w.moveChildren(this),w.remove())}},{key:"replace",value:function(E){if(E.statics.blotName!==this.statics.blotName){var w=l.default.create(this.statics.defaultChild);E.moveChildren(w),this.appendChild(w)}o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"replace",this).call(this,E)}}]),N}(f.default);I.blotName="list",I.scope=l.default.Scope.BLOCK_BLOT,I.tagName=["OL","UL"],I.defaultChild="list-item",I.allowedChildren=[b],n.ListItem=b,n.default=I},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function h(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){c(p,f);function p(){return l(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="italic",d.tagName=["EM","I"],n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(y,g){for(var m=0;m<g.length;m++){var b=g[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}return function(y,g,m){return g&&_(y.prototype,g),m&&_(y,m),y}}(),o=function _(y,g,m){y===null&&(y=Function.prototype);var b=Object.getOwnPropertyDescriptor(y,g);if(b===void 0){var I=Object.getPrototypeOf(y);return I===null?void 0:_(I,g,m)}else{if("value"in b)return b.value;var v=b.get;return v===void 0?void 0:v.call(m)}},a=i(6),l=h(a);function h(_){return _&&_.__esModule?_:{default:_}}function c(_,y){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}function d(_,y){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:_}function f(_,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);_.prototype=Object.create(y&&y.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(_,y):_.__proto__=y)}var p=function(_){f(y,_);function y(){return c(this,y),d(this,(y.__proto__||Object.getPrototypeOf(y)).apply(this,arguments))}return s(y,null,[{key:"create",value:function(m){return m==="super"?document.createElement("sup"):m==="sub"?document.createElement("sub"):o(y.__proto__||Object.getPrototypeOf(y),"create",this).call(this,m)}},{key:"formats",value:function(m){if(m.tagName==="SUB")return"sub";if(m.tagName==="SUP")return"super"}}]),y}(l.default);p.blotName="script",p.tagName=["SUB","SUP"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function h(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){c(p,f);function p(){return l(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="strike",d.tagName="S",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=a(s);function a(f){return f&&f.__esModule?f:{default:f}}function l(f,p){if(!(f instanceof p))throw new TypeError("Cannot call a class as a function")}function h(f,p){if(!f)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:f}function c(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);f.prototype=Object.create(p&&p.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(f,p):f.__proto__=p)}var d=function(f){c(p,f);function p(){return l(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default);d.blotName="underline",d.tagName="U",n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function g(m,b){for(var I=0;I<b.length;I++){var v=b[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,I){return b&&g(m.prototype,b),I&&g(m,I),m}}(),o=function g(m,b,I){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var N=Object.getPrototypeOf(m);return N===null?void 0:g(N,b,I)}else{if("value"in v)return v.value;var C=v.get;return C===void 0?void 0:C.call(I)}},a=i(0),l=c(a),h=i(27);function c(g){return g&&g.__esModule?g:{default:g}}function d(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function f(g,m){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:g}function p(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(g,m):g.__proto__=m)}var _=["alt","height","width"],y=function(g){p(m,g);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(I,v){_.indexOf(I)>-1?v?this.domNode.setAttribute(I,v):this.domNode.removeAttribute(I):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,I,v)}}],[{key:"create",value:function(I){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,I);return typeof I=="string"&&v.setAttribute("src",this.sanitize(I)),v}},{key:"formats",value:function(I){return _.reduce(function(v,N){return I.hasAttribute(N)&&(v[N]=I.getAttribute(N)),v},{})}},{key:"match",value:function(I){return/\.(jpe?g|gif|png)$/.test(I)||/^data:image\/.+;base64/.test(I)}},{key:"sanitize",value:function(I){return(0,h.sanitize)(I,["http","https","data"])?I:"//:0"}},{key:"value",value:function(I){return I.getAttribute("src")}}]),m}(l.default.Embed);y.blotName="image",y.tagName="IMG",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function g(m,b){for(var I=0;I<b.length;I++){var v=b[I];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,b,I){return b&&g(m.prototype,b),I&&g(m,I),m}}(),o=function g(m,b,I){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,b);if(v===void 0){var N=Object.getPrototypeOf(m);return N===null?void 0:g(N,b,I)}else{if("value"in v)return v.value;var C=v.get;return C===void 0?void 0:C.call(I)}},a=i(4),l=i(27),h=c(l);function c(g){return g&&g.__esModule?g:{default:g}}function d(g,m){if(!(g instanceof m))throw new TypeError("Cannot call a class as a function")}function f(g,m){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:g}function p(g,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);g.prototype=Object.create(m&&m.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(g,m):g.__proto__=m)}var _=["height","width"],y=function(g){p(m,g);function m(){return d(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return s(m,[{key:"format",value:function(I,v){_.indexOf(I)>-1?v?this.domNode.setAttribute(I,v):this.domNode.removeAttribute(I):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,I,v)}}],[{key:"create",value:function(I){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,I);return v.setAttribute("frameborder","0"),v.setAttribute("allowfullscreen",!0),v.setAttribute("src",this.sanitize(I)),v}},{key:"formats",value:function(I){return _.reduce(function(v,N){return I.hasAttribute(N)&&(v[N]=I.getAttribute(N)),v},{})}},{key:"sanitize",value:function(I){return h.default.sanitize(I)}},{key:"value",value:function(I){return I.getAttribute("src")}}]),m}(a.BlockEmbed);y.blotName="video",y.className="ql-video",y.tagName="IFRAME",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function I(v,N){for(var C=0;C<N.length;C++){var E=N[C];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(v,E.key,E)}}return function(v,N,C){return N&&I(v.prototype,N),C&&I(v,C),v}}(),o=function I(v,N,C){v===null&&(v=Function.prototype);var E=Object.getOwnPropertyDescriptor(v,N);if(E===void 0){var w=Object.getPrototypeOf(v);return w===null?void 0:I(w,N,C)}else{if("value"in E)return E.value;var A=E.get;return A===void 0?void 0:A.call(C)}},a=i(35),l=p(a),h=i(5),c=p(h),d=i(9),f=p(d);function p(I){return I&&I.__esModule?I:{default:I}}function _(I,v){if(!(I instanceof v))throw new TypeError("Cannot call a class as a function")}function y(I,v){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:I}function g(I,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);I.prototype=Object.create(v&&v.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(I,v):I.__proto__=v)}var m=function(I){g(v,I);function v(){return _(this,v),y(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return s(v,null,[{key:"create",value:function(C){var E=o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,C);return typeof C=="string"&&(window.katex.render(C,E,{throwOnError:!1,errorColor:"#f00"}),E.setAttribute("data-value",C)),E}},{key:"value",value:function(C){return C.getAttribute("data-value")}}]),v}(l.default);m.blotName="formula",m.className="ql-formula",m.tagName="SPAN";var b=function(I){g(v,I),s(v,null,[{key:"register",value:function(){c.default.register(m,!0)}}]);function v(){_(this,v);var N=y(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return N}return v}(f.default);n.FormulaBlot=m,n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function C(E,w){for(var A=0;A<w.length;A++){var x=w[A];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,x.key,x)}}return function(E,w,A){return w&&C(E.prototype,w),A&&C(E,A),E}}(),o=function C(E,w,A){E===null&&(E=Function.prototype);var x=Object.getOwnPropertyDescriptor(E,w);if(x===void 0){var T=Object.getPrototypeOf(E);return T===null?void 0:C(T,w,A)}else{if("value"in x)return x.value;var S=x.get;return S===void 0?void 0:S.call(A)}},a=i(0),l=y(a),h=i(5),c=y(h),d=i(9),f=y(d),p=i(13),_=y(p);function y(C){return C&&C.__esModule?C:{default:C}}function g(C,E){if(!(C instanceof E))throw new TypeError("Cannot call a class as a function")}function m(C,E){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:C}function b(C,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);C.prototype=Object.create(E&&E.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(C,E):C.__proto__=E)}var I=function(C){b(E,C);function E(){return g(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,[{key:"replaceWith",value:function(A){this.domNode.textContent=this.domNode.textContent,this.attach(),o(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replaceWith",this).call(this,A)}},{key:"highlight",value:function(A){var x=this.domNode.textContent;this.cachedText!==x&&((x.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=A(x),this.domNode.normalize(),this.attach()),this.cachedText=x)}}]),E}(_.default);I.className="ql-syntax";var v=new l.default.Attributor.Class("token","hljs",{scope:l.default.Scope.INLINE}),N=function(C){b(E,C),s(E,null,[{key:"register",value:function(){c.default.register(v,!0),c.default.register(I,!0)}}]);function E(w,A){g(this,E);var x=m(this,(E.__proto__||Object.getPrototypeOf(E)).call(this,w,A));if(typeof x.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var T=null;return x.quill.on(c.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(T),T=setTimeout(function(){x.highlight(),T=null},x.options.interval)}),x.highlight(),x}return s(E,[{key:"highlight",value:function(){var A=this;if(!this.quill.selection.composing){this.quill.update(c.default.sources.USER);var x=this.quill.getSelection();this.quill.scroll.descendants(I).forEach(function(T){T.highlight(A.options.highlight)}),this.quill.update(c.default.sources.SILENT),x!=null&&this.quill.setSelection(x,c.default.sources.SILENT)}}}]),E}(f.default);N.DEFAULTS={highlight:function(){return window.hljs==null?null:function(C){var E=window.hljs.highlightAuto(C);return E.value}}(),interval:1e3},n.CodeBlock=I,n.CodeToken=v,n.default=N},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function E(w,A,x){w===null&&(w=Function.prototype);var T=Object.getOwnPropertyDescriptor(w,A);if(T===void 0){var S=Object.getPrototypeOf(w);return S===null?void 0:E(S,A,x)}else{if("value"in T)return T.value;var O=T.get;return O===void 0?void 0:O.call(x)}},o=function(){function E(w,A){for(var x=0;x<A.length;x++){var T=A[x];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(w,T.key,T)}}return function(w,A,x){return A&&E(w.prototype,A),x&&E(w,x),w}}(),a=i(3),l=g(a),h=i(8),c=g(h),d=i(43),f=g(d),p=i(15),_=i(41),y=g(_);function g(E){return E&&E.__esModule?E:{default:E}}function m(E,w){if(!(E instanceof w))throw new TypeError("Cannot call a class as a function")}function b(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:E}function I(E,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);E.prototype=Object.create(w&&w.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(E,w):E.__proto__=w)}var v=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],N=function(E){I(w,E);function w(A,x){m(this,w),x.modules.toolbar!=null&&x.modules.toolbar.container==null&&(x.modules.toolbar.container=v);var T=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,A,x));return T.quill.container.classList.add("ql-bubble"),T}return o(w,[{key:"extendToolbar",value:function(x){this.tooltip=new C(this.quill,this.options.bounds),this.tooltip.root.appendChild(x.container),this.buildButtons([].slice.call(x.container.querySelectorAll("button")),y.default),this.buildPickers([].slice.call(x.container.querySelectorAll("select")),y.default)}}]),w}(f.default);N.DEFAULTS=(0,l.default)(!0,{},f.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(w){w?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var C=function(E){I(w,E);function w(A,x){m(this,w);var T=b(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,A,x));return T.quill.on(c.default.events.EDITOR_CHANGE,function(S,O,D,q){if(S===c.default.events.SELECTION_CHANGE)if(O!=null&&O.length>0&&q===c.default.sources.USER){T.show(),T.root.style.left="0px",T.root.style.width="",T.root.style.width=T.root.offsetWidth+"px";var B=T.quill.getLines(O.index,O.length);if(B.length===1)T.position(T.quill.getBounds(O));else{var K=B[B.length-1],oe=T.quill.getIndex(K),z=Math.min(K.length()-1,O.index+O.length-oe),F=T.quill.getBounds(new p.Range(oe,z));T.position(F)}}else document.activeElement!==T.textbox&&T.quill.hasFocus()&&T.hide()}),T}return o(w,[{key:"listen",value:function(){var x=this;s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){x.root.classList.remove("ql-editing")}),this.quill.on(c.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!x.root.classList.contains("ql-hidden")){var T=x.quill.getSelection();T!=null&&x.position(x.quill.getBounds(T))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(x){var T=s(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"position",this).call(this,x),S=this.root.querySelector(".ql-tooltip-arrow");if(S.style.marginLeft="",T===0)return T;S.style.marginLeft=-1*T-S.offsetWidth/2+"px"}}]),w}(d.BaseTooltip);C.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=C,n.default=N},function(t,n,i){t.exports=i(63)}]).default})})(im);var zk=im.exports,Hk=Ge&&Ge.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hs=Ge&&Ge.__assign||function(){return Hs=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Hs.apply(this,arguments)},Kk=Ge&&Ge.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},bo=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},Bt=bo(te),Gk=bo(mf),ii=bo(Bk),Jh=bo(zk),Wk=function(r){Hk(e,r);function e(t){var n=r.call(this,t)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(s,o,a,l){var h,c,d,f;s==="text-change"?(c=(h=n).onEditorChangeText)===null||c===void 0||c.call(h,n.editor.root.innerHTML,o,l,n.unprivilegedEditor):s==="selection-change"&&((f=(d=n).onEditorChangeSelection)===null||f===void 0||f.call(d,o,l,n.unprivilegedEditor))};var i=n.isControlled()?t.value:t.defaultValue;return n.value=i??"",n}return e.prototype.validateProps=function(t){var n;if(Bt.default.Children.count(t.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Bt.default.Children.count(t.children)){var i=Bt.default.Children.only(t.children);if(((n=i)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&t.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},e.prototype.shouldComponentUpdate=function(t,n){var i=this,s;if(this.validateProps(t),!this.editor||this.state.generation!==n.generation)return!0;if("value"in t){var o=this.getEditorContents(),a=(s=t.value,s??"");this.isEqualValue(a,o)||this.setEditorContents(this.editor,a)}return t.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,t.readOnly),Kk(this.cleanProps,this.dirtyProps).some(function(l){return!ii.default(t[l],i.props[l])})},e.prototype.shouldComponentRegenerate=function(t){var n=this;return this.dirtyProps.some(function(i){return!ii.default(t[i],n.props[i])})},e.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},e.prototype.componentWillUnmount=function(){this.destroyEditor()},e.prototype.componentDidUpdate=function(t,n){var i=this;if(this.editor&&this.shouldComponentRegenerate(t)){var s=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:s,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var a=this.regenerationSnapshot,s=a.delta,l=a.selection;delete this.regenerationSnapshot,this.instantiateEditor();var h=this.editor;h.setContents(s),Xh(function(){return i.setEditorSelection(h,l)})}},e.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},e.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},e.prototype.isControlled=function(){return"value"in this.props},e.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},e.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},e.prototype.createEditor=function(t,n){var i=new Jh.default(t,n);return n.tabIndex!=null&&this.setEditorTabIndex(i,n.tabIndex),this.hookEditor(i),i},e.prototype.hookEditor=function(t){this.unprivilegedEditor=this.makeUnprivilegedEditor(t),t.on("editor-change",this.onEditorChange)},e.prototype.unhookEditor=function(t){t.off("editor-change",this.onEditorChange)},e.prototype.getEditorContents=function(){return this.value},e.prototype.getEditorSelection=function(){return this.selection},e.prototype.isDelta=function(t){return t&&t.ops},e.prototype.isEqualValue=function(t,n){return this.isDelta(t)&&this.isDelta(n)?ii.default(t.ops,n.ops):ii.default(t,n)},e.prototype.setEditorContents=function(t,n){var i=this;this.value=n;var s=this.getEditorSelection();typeof n=="string"?t.setContents(t.clipboard.convert(n)):t.setContents(n),Xh(function(){return i.setEditorSelection(t,s)})},e.prototype.setEditorSelection=function(t,n){if(this.selection=n,n){var i=t.getLength();n.index=Math.max(0,Math.min(n.index,i-1)),n.length=Math.max(0,Math.min(n.length,i-1-n.index)),t.setSelection(n)}},e.prototype.setEditorTabIndex=function(t,n){var i,s;!((s=(i=t)===null||i===void 0?void 0:i.scroll)===null||s===void 0)&&s.domNode&&(t.scroll.domNode.tabIndex=n)},e.prototype.setEditorReadOnly=function(t,n){n?t.disable():t.enable()},e.prototype.makeUnprivilegedEditor=function(t){var n=t;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},e.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var t=Gk.default.findDOMNode(this.editingArea);if(!t)throw new Error("Cannot find element for editing area");if(t.nodeType===3)throw new Error("Editing area cannot be a text node");return t},e.prototype.renderEditingArea=function(){var t=this,n=this.props,i=n.children,s=n.preserveWhitespace,o=this.state.generation,a={key:o,ref:function(l){t.editingArea=l}};return Bt.default.Children.count(i)?Bt.default.cloneElement(Bt.default.Children.only(i),a):s?Bt.default.createElement("pre",Hs({},a)):Bt.default.createElement("div",Hs({},a))},e.prototype.render=function(){var t;return Bt.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(t=this.props.className,t??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},e.prototype.onEditorChangeText=function(t,n,i,s){var o,a;if(this.editor){var l=this.isDelta(this.value)?s.getContents():s.getHTML();l!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=l,(a=(o=this.props).onChange)===null||a===void 0||a.call(o,t,n,i,s))}},e.prototype.onEditorChangeSelection=function(t,n,i){var s,o,a,l,h,c;if(this.editor){var d=this.getEditorSelection(),f=!d&&t,p=d&&!t;ii.default(t,d)||(this.selection=t,(o=(s=this.props).onChangeSelection)===null||o===void 0||o.call(s,t,n,i),f?(l=(a=this.props).onFocus)===null||l===void 0||l.call(a,t,n,i):p&&((c=(h=this.props).onBlur)===null||c===void 0||c.call(h,d,n,i)))}},e.prototype.focus=function(){this.editor&&this.editor.focus()},e.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},e.displayName="React Quill",e.Quill=Jh.default,e.defaultProps={theme:"snow",modules:{},readOnly:!1},e}(Bt.default.Component);function Xh(r){Promise.resolve().then(r)}var Qk=Wk;const Yk=tg(Qk),Jk=100,Xk=800,Zk=200,eS=({value:r,onChange:e,placeholder:t="Enter content here...",style:n={},className:i="mt-1"})=>{const s=te.useRef(null),[o,a]=te.useState(Zk);te.useEffect(()=>{var y,g;const c=(y=s.current)==null?void 0:y.getEditor(),d=(g=c==null?void 0:c.getModule("toolbar"))==null?void 0:g.container;if(!d)return;let f=0;const p=m=>{m.target.closest(".ql-picker")&&(f=window.scrollY)},_=m=>{m.target.closest(".ql-picker")&&setTimeout(()=>{window.scrollY!==f&&window.scrollTo(window.scrollX,f)},0)};return d.addEventListener("mousedown",p),d.addEventListener("mouseup",_),()=>{d.removeEventListener("mousedown",p),d.removeEventListener("mouseup",_)}},[]);const l=te.useMemo(()=>({toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{align:[]}],[{color:[]},{background:[]}],["link","image","video"],["clean"]],handlers:{image:function(){var I;const c=(I=s.current)==null?void 0:I.getEditor();if(!c){console.error("Quill editor instance not found.");return}const d=c.getSelection(!0);if(!d)return;const f=c.theme.tooltip,p=f.save,_=f.action;f.edit();const y=f.textbox;if(!y){console.error("Tooltip input element not found."),f.hide();return}y.value="",y.setAttribute("placeholder","Enter image URL"),y.setAttribute("data-mode","image");const g=()=>{var N;const v=y.value;v&&c.insertEmbed(d.index,"image",v,"user"),f.hide(),f.save=p,f.action=_,y.removeEventListener("keydown",m),(N=f.root.querySelector("a.ql-action"))==null||N.removeEventListener("click",g)},m=v=>{var N;v.key==="Enter"?(v.preventDefault(),g()):v.key==="Escape"&&(v.preventDefault(),f.hide(),f.save=p,f.action=_,y.removeEventListener("keydown",m),(N=f.root.querySelector("a.ql-action"))==null||N.removeEventListener("click",g))};f.save=g,y.removeEventListener("keydown",m),y.addEventListener("keydown",m);const b=f.root.querySelector("a.ql-action");b?(b.removeEventListener("click",g),b.addEventListener("click",g)):console.warn("Tooltip save button (a.ql-action) not found."),y.focus()}}}}),[]),h=te.useMemo(()=>["header","font","size","bold","italic","underline","strike","blockquote","code-block","list","bullet","script","indent","direction","align","color","background","link","image","video"],[]);return P.jsxs("div",{className:`quill-editor-container ${i}`,children:[P.jsx("div",{className:"quill-editor-wrapper border border-gray-300 rounded-md overflow-hidden",style:{...n,height:`${o}px`,display:"flex",flexDirection:"column"},children:P.jsx(Yk,{theme:"snow",value:r,onChange:e,ref:s,modules:l,formats:h,className:"bg-white flex-grow",placeholder:t,style:{height:"calc(100% - 42px)"}})}),P.jsxs("div",{className:"flex items-center space-x-2 mt-2 text-gray-600",children:[P.jsx(vy,{size:16}),P.jsx("input",{type:"range",min:Jk,max:Xk,value:o,onChange:c=>a(Number(c.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700","aria-label":"Adjust editor height"}),P.jsx(dy,{size:16}),P.jsxs("span",{className:"text-xs w-12 text-right",children:[o,"px"]})]})]})},tS=()=>{const{showToast:r,requestConfirmation:e}=Or(),[t,n]=te.useState([]),[i,s]=te.useState(!1),[o,a]=te.useState(null),[l,h]=te.useState(""),[c,d]=te.useState(""),[f,p]=te.useState(""),[_,y]=te.useState(0),g=te.useMemo(()=>ve?_r(ve,"pages"):null,[]),m=te.useCallback(async()=>{if(!ve||!g){r("Error: Firestore database is not initialized.","error"),s(!1);return}s(!0);try{console.log("Fetching pages from Firestore...");const A=uo(g,co("order","asc")),T=(await Mi(A)).docs.map(S=>({id:S.id,...S.data()}));n(T)}catch(A){console.error("Error fetching pages:",A),r("Failed to load pages. Check console for details.","error")}finally{s(!1)}},[g,r]);te.useEffect(()=>{m()},[m]);const b=async A=>{if(A.preventDefault(),!l||!c||!f){r("Title, Slug, and Content are required.","error");return}if(s(!0),!ve){r("Error: Firestore database is not initialized.","error"),s(!1);return}const x=t.length>0?Math.max(...t.map(O=>O.order))+1:0,S={title:l,slug:c,content:f,order:o?_:x};try{if(o){console.log("Updating page in Firestore:",o,S);const O=Ze(ve,"pages",o);await Vs(O,S),console.log("Page updated successfully.")}else{if(console.log("Adding new page to Firestore:",S),!g)throw new Error("Collection reference not available");await Bl(g,S),console.log("Page added successfully."),r("Page added successfully!","success")}N(),m()}catch(O){console.error("Error saving page:",O),r("Failed to save page. Check console for details.","error")}finally{s(!1)}},I=async A=>{var x;if(!A){console.error("Cannot delete page without ID."),r("Cannot delete page: Invalid ID.","error");return}e({message:`Are you sure you want to delete the page "${((x=t.find(T=>T.id===A))==null?void 0:x.title)||A}"?
This action cannot be undone.`,onConfirm:async()=>{if(s(!0),!ve){r("Error: Firestore database is not initialized.","error"),s(!1);return}try{console.log("Deleting page from Firestore:",A);const T=Ze(ve,"pages",A);await Ul(T),console.log("Page deleted successfully."),r("Page deleted successfully!","success"),o===A&&N(),m()}catch(T){console.error("Error deleting page:",T),r("Failed to delete page. Check console for details.","error")}finally{s(!1)}},confirmText:"Delete Page",title:"Confirm Deletion"})},v=A=>{if(!A.id){console.error("Cannot edit page without ID."),r("Cannot edit page: Invalid ID.","error");return}a(A.id),h(A.title),d(A.slug),p(A.content),y(A.order)},N=()=>{a(null),h(""),d(""),p(""),y(0)},C=async(A,x)=>{const T=x==="up"?A-1:A+1;if(T<0||T>=t.length||!ve||!g)return;s(!0);const S=t[A],O=t[T],D=Va(ve),q=Ze(g,S.id),B=Ze(g,O.id);D.update(q,{order:O.order}),D.update(B,{order:S.order});try{await D.commit(),r(`Page moved ${x} successfully.`,"success"),m()}catch(K){console.error(`Error moving page ${x}:`,K),r("Failed to reorder page. Please try again.","error"),s(!1)}},E=A=>C(A,"up"),w=A=>C(A,"down");return P.jsxs("div",{className:"space-y-6",children:[P.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Manage Pages"}),P.jsxs("form",{onSubmit:b,className:"p-4 border rounded shadow-sm bg-white space-y-4",children:[P.jsx("h3",{className:"text-lg font-medium",children:o?"Edit Page":"Add New Page"}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"pageTitle",className:"block text-sm font-medium text-gray-700",children:"Title"}),P.jsx("input",{type:"text",id:"pageTitle",value:l,onChange:A=>h(A.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"pageSlug",className:"block text-sm font-medium text-gray-700",children:"Slug (URL Path, e.g., 'about-us')"}),P.jsx("input",{type:"text",id:"pageSlug",value:c,onChange:A=>d(A.target.value.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",pattern:"^[a-z0-9-]+$",title:"Slug can only contain lowercase letters, numbers, and hyphens."})]}),P.jsxs("div",{className:"relative quill-editor-wrapper",children:[P.jsx("label",{htmlFor:"pageContent",className:"block text-sm font-medium text-gray-700",children:"Content"}),P.jsx(eS,{value:f,onChange:p,placeholder:"Enter page content here..."})]}),P.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[o&&P.jsx("button",{type:"button",onClick:N,disabled:i,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Cancel Edit"}),P.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:i?"Saving...":o?"Update Page":"Add Page"})]})]}),P.jsxs("div",{className:"mt-6 border rounded shadow-sm bg-white",children:[P.jsx("h3",{className:"text-lg font-medium p-4 border-b",children:"Existing Pages"}),i&&!t.length?P.jsx("p",{className:"p-4 text-gray-500",children:"Loading pages..."}):t.length===0?P.jsx("p",{className:"p-4 text-gray-500",children:"No pages found."}):P.jsx("ul",{className:"divide-y divide-gray-200",children:t.map((A,x)=>P.jsxs("li",{className:"p-4 flex justify-between items-center hover:bg-gray-50",children:[P.jsxs("div",{className:"flex items-center space-x-3",children:[P.jsx("span",{className:"text-xs font-mono text-gray-400 w-6 text-right",children:A.order}),P.jsxs("div",{children:[P.jsx("p",{className:"font-medium text-gray-900",children:A.title}),P.jsxs("p",{className:"text-sm text-gray-500",children:["/",A.slug]})]})]}),P.jsxs("div",{className:"flex items-center space-x-1",children:[P.jsx("button",{onClick:()=>E(x),disabled:i||x===0,className:`p-1 rounded ${i||x===0?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Up",children:P.jsx(ya,{size:18})}),P.jsx("button",{onClick:()=>w(x),disabled:i||x===t.length-1,className:`p-1 rounded ${i||x===t.length-1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-blue-600 hover:bg-blue-100"}`,title:"Move Down",children:P.jsx(ga,{size:18})}),P.jsx("button",{onClick:()=>v(A),disabled:i,className:"p-1 rounded text-gray-500 hover:text-indigo-600 hover:bg-indigo-100 disabled:opacity-50",title:"Edit",children:P.jsx(va,{size:18})}),A.id&&P.jsx("button",{onClick:()=>I(A.id),disabled:i,className:"p-1 rounded text-gray-500 hover:text-red-600 hover:bg-red-100 disabled:opacity-50",title:"Delete",children:P.jsx(As,{size:18})})]})]},A.id))})]})]})},nS=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>an(async()=>{const{default:n}=await Promise.resolve().then(()=>qr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class ru extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class rS extends ru{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class iS extends ru{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sS extends ru{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ga;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Ga||(Ga={}));var oS=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};class aS{constructor(e,{headers:t={},customFetch:n,region:i=Ga.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=nS(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return oS(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let h;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(a["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(a["Content-Type"]="application/json",h=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:h}).catch(_=>{throw new rS(_)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new iS(c);if(!c.ok)throw new sS(c);let f=((n=c.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield c.json():f==="application/octet-stream"?p=yield c.blob():f==="text/event-stream"?p=c:f==="multipart/form-data"?p=yield c.formData():p=yield c.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var St={},iu={},wo={},$i={},Eo={},xo={},lS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},xr=lS();const uS=xr.fetch,sm=xr.fetch.bind(xr),om=xr.Headers,cS=xr.Request,hS=xr.Response,qr=Object.freeze(Object.defineProperty({__proto__:null,Headers:om,Request:cS,Response:hS,default:sm,fetch:uS},Symbol.toStringTag,{value:"Module"})),fS=ng(qr);var To={};Object.defineProperty(To,"__esModule",{value:!0});let dS=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};To.default=dS;var am=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xo,"__esModule",{value:!0});const pS=am(fS),mS=am(To);let gS=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=pS.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let h=null,c=null,d=null,f=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=m:c=JSON.parse(m))}const y=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");y&&g&&g.length>1&&(d=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(h={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,f=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const y=await s.text();try{h=JSON.parse(y),Array.isArray(h)&&s.status===404&&(c=[],h=null,f=200,p="OK")}catch{s.status===404&&y===""?(f=204,p="No Content"):h={message:y}}if(h&&this.isMaybeSingle&&(!((l=h==null?void 0:h.details)===null||l===void 0)&&l.includes("0 rows"))&&(h=null,f=200,p="OK"),h&&this.shouldThrowOnError)throw new mS.default(h)}return{error:h,data:c,count:d,status:f,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};xo.default=gS;var yS=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Eo,"__esModule",{value:!0});const vS=yS(xo);let _S=class extends vS.default{select(e){let t=!1;const n=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${h}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Eo.default=_S;var bS=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($i,"__esModule",{value:!0});const wS=bS(Eo);let ES=class extends wS.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};$i.default=ES;var xS=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wo,"__esModule",{value:!0});const si=xS($i);let TS=class{constructor(e,{headers:t={},schema:n,fetch:i}){this.url=e,this.headers=t,this.schema=n,this.fetch=i}select(e,{head:t=!1,count:n}={}){const i=t?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new si.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new si.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((h,c)=>h.concat(Object.keys(c)),[]);if(l.length>0){const h=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",h.join(","))}}return new si.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new si.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new si.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};wo.default=TS;var Ao={},ko={};Object.defineProperty(ko,"__esModule",{value:!0});ko.version=void 0;ko.version="0.0.0-automated";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.DEFAULT_HEADERS=void 0;const AS=ko;Ao.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${AS.version}`};var lm=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(iu,"__esModule",{value:!0});const kS=lm(wo),SS=lm($i),IS=Ao;let OS=class um{constructor(e,{headers:t={},schema:n,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},IS.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new kS.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new um(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:i=!1,count:s}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;n||i?(o=n?"HEAD":"GET",Object.entries(t).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{a.searchParams.append(c,d)})):(o="POST",l=t);const h=Object.assign({},this.headers);return s&&(h.Prefer=`count=${s}`),new SS.default({method:o,url:a,headers:h,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};iu.default=OS;var Fr=Ge&&Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(St,"__esModule",{value:!0});St.PostgrestError=St.PostgrestBuilder=St.PostgrestTransformBuilder=St.PostgrestFilterBuilder=St.PostgrestQueryBuilder=St.PostgrestClient=void 0;const cm=Fr(iu);St.PostgrestClient=cm.default;const hm=Fr(wo);St.PostgrestQueryBuilder=hm.default;const fm=Fr($i);St.PostgrestFilterBuilder=fm.default;const dm=Fr(Eo);St.PostgrestTransformBuilder=dm.default;const pm=Fr(xo);St.PostgrestBuilder=pm.default;const mm=Fr(To);St.PostgrestError=mm.default;var NS=St.default={PostgrestClient:cm.default,PostgrestQueryBuilder:hm.default,PostgrestFilterBuilder:fm.default,PostgrestTransformBuilder:dm.default,PostgrestBuilder:pm.default,PostgrestError:mm.default};const{PostgrestClient:PS,PostgrestQueryBuilder:FO,PostgrestFilterBuilder:UO,PostgrestTransformBuilder:BO,PostgrestBuilder:zO,PostgrestError:HO}=NS,RS="2.11.2",CS={"X-Client-Info":`realtime-js/${RS}`},jS="1.0.0",gm=1e4,LS=1e3;var fr;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(fr||(fr={}));var Nt;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Nt||(Nt={}));var Dt;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Dt||(Dt={}));var Wa;(function(r){r.websocket="websocket"})(Wa||(Wa={}));var Fn;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Fn||(Fn={}));class DS{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const i=t.getUint8(1),s=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+i));o=o+i;const l=n.decode(e.slice(o,o+s));o=o+s;const h=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:h}}}class ym{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Be;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Be||(Be={}));const Zh=(r,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((s,o)=>(s[o]=MS(o,r,e,i),s),{})},MS=(r,e,t,n)=>{const i=e.find(a=>a.name===r),s=i==null?void 0:i.type,o=t[r];return s&&!n.includes(s)?vm(s,o):Qa(o)},vm=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return FS(e,t)}switch(r){case Be.bool:return VS(e);case Be.float4:case Be.float8:case Be.int2:case Be.int4:case Be.int8:case Be.numeric:case Be.oid:return $S(e);case Be.json:case Be.jsonb:return qS(e);case Be.timestamp:return US(e);case Be.abstime:case Be.date:case Be.daterange:case Be.int4range:case Be.int8range:case Be.money:case Be.reltime:case Be.text:case Be.time:case Be.timestamptz:case Be.timetz:case Be.tsrange:case Be.tstzrange:return Qa(e);default:return Qa(e)}},Qa=r=>r,VS=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},$S=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},qS=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},FS=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let s;const o=r.slice(1,t);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>vm(e,a))}return r},US=r=>typeof r=="string"?r.replace(" ","T"):r,_m=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ca{constructor(e,t,n={},i=gm){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ef;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(ef||(ef={}));class mi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mi.syncState(this.state,i,s,o),this.pendingDiffs.forEach(l=>{this.state=mi.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=mi.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const s=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(s,(h,c)=>{o[h]||(l[h]=c)}),this.map(o,(h,c)=>{const d=s[h];if(d){const f=c.map(g=>g.presence_ref),p=d.map(g=>g.presence_ref),_=c.filter(g=>p.indexOf(g.presence_ref)<0),y=d.filter(g=>f.indexOf(g.presence_ref)<0);_.length>0&&(a[h]=_),y.length>0&&(l[h]=y)}else a[h]=c}),this.syncDiff(s,{joins:a,leaves:l},n,i)}static syncDiff(e,t,n,i){const{joins:s,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(a,l)=>{var h;const c=(h=e[a])!==null&&h!==void 0?h:[];if(e[a]=this.cloneDeep(l),c.length>0){const d=e[a].map(p=>p.presence_ref),f=c.filter(p=>d.indexOf(p.presence_ref)<0);e[a].unshift(...f)}n(a,c,l)}),this.map(o,(a,l)=>{let h=e[a];if(!h)return;const c=l.map(d=>d.presence_ref);h=h.filter(d=>c.indexOf(d.presence_ref)<0),e[a]=h,i(a,h,l),h.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tf;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(tf||(tf={}));var nf;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(nf||(nf={}));var en;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(en||(en={}));class su{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ca(this,Dt.join,this.params,this.timeout),this.rejoinTimer=new ym(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Dt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new mi(this),this.broadcastEndpointURL=_m(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:a}}=this.params;this._onError(c=>e==null?void 0:e(en.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(en.CLOSED));const l={},h={broadcast:s,presence:o,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(c=>c.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(en.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,p=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,_=[];for(let y=0;y<p;y++){const g=f[y],{filter:{event:m,schema:b,table:I,filter:v}}=g,N=c&&c[y];if(N&&N.event===m&&N.schema===b&&N.table===I&&N.filter===v)_.push(Object.assign(Object.assign({},g),{id:N.id}));else{this.unsubscribe(),e==null||e(en.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(en.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(en.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(en.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const h=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),h.receive("ok",()=>s("ok")),h.receive("error",()=>s("error")),h.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Nt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Dt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new ca(this,Dt.leave,{},e);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(s),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ca(this,e,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:h,join:c}=Dt;if(n&&[a,l,h,c].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var _,y,g;return((_=p.filter)===null||_===void 0?void 0:_.event)==="*"||((g=(y=p.filter)===null||y===void 0?void 0:y.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(p=>p.callback(f,n)):(s=this.bindings[o])===null||s===void 0||s.filter(p=>{var _,y,g,m,b,I;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const v=p.id,N=(_=p.filter)===null||_===void 0?void 0:_.event;return v&&((y=t.ids)===null||y===void 0?void 0:y.includes(v))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const v=(b=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return v==="*"||v===((I=t==null?void 0:t.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const _=f.data,{schema:y,table:g,commit_timestamp:m,type:b,errors:I}=_;f=Object.assign(Object.assign({},{schema:y,table:g,commit_timestamp:m,eventType:b,new:{},old:{},errors:I}),this._getPayloadRecords(_))}p.callback(f,n)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),s={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&su.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Dt.close,{},e)}_onError(e){this._on(Dt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Zh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Zh(e.columns,e.old_record)),t}}const BS=()=>{},zS=typeof WebSocket<"u",HS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class KS{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=CS,this.params={},this.timeout=gm,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=BS,this.conn=null,this.sendBuffer=[],this.serializer=new DS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>an(async()=>{const{default:l}=await Promise.resolve().then(()=>qr);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Wa.websocket}`,this.httpEndpoint=_m(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,o)=>o(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ym(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(zS){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new GS(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),an(async()=>{const{default:e}=await import("./browser-CKC9vik6.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1]),import.meta.url).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:jS}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case fr.connecting:return Fn.Connecting;case fr.open:return Fn.Open;case fr.closing:return Fn.Closing;default:return Fn.Closed}}isConnected(){return this.connectionState()===Fn.Open}channel(e,t={config:{}}){const n=new su(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:i,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(Dt.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(LS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:i,payload:s,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${o&&"("+o+")"||""}`,s),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(i,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Dt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([HS],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class GS{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=fr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class ou extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ot(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class WS extends ou{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ya extends ou{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var QS=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};const bm=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>an(async()=>{const{default:n}=await Promise.resolve().then(()=>qr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},YS=()=>QS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield an(()=>Promise.resolve().then(()=>qr),void 0,import.meta.url)).Response:Response}),Ja=r=>{if(Array.isArray(r))return r.map(t=>Ja(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Ja(n)}),e};var Wn=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};const ha=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),JS=(r,e,t)=>Wn(void 0,void 0,void 0,function*(){const n=yield YS();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{e(new WS(ha(i),r.status||500))}).catch(i=>{e(new Ya(ha(i),i))}):e(new Ya(ha(r),r))}),XS=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function qi(r,e,t,n,i,s){return Wn(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,XS(e,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>JS(l,a,n))})})}function Ks(r,e,t,n){return Wn(this,void 0,void 0,function*(){return qi(r,"GET",e,t,n)})}function gn(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return qi(r,"POST",e,n,i,t)})}function ZS(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return qi(r,"PUT",e,n,i,t)})}function eI(r,e,t,n){return Wn(this,void 0,void 0,function*(){return qi(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function wm(r,e,t,n,i){return Wn(this,void 0,void 0,function*(){return qi(r,"DELETE",e,n,i,t)})}var At=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};const tI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nI{constructor(e,t={},n,i){this.url=e,this.headers=t,this.bucketId=n,this.fetch=bm(i)}uploadOrUpdate(e,t,n,i){return At(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},rf),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const h=this._removeEmptyFolders(t),c=this._getFinalPath(h),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:h,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(ot(s))return{data:null,error:s};throw s}})}upload(e,t,n){return At(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return At(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const h=Object.assign({upsert:rf.upsert},i),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",h.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",h.cacheControl)):(l=n,c["cache-control"]=`max-age=${h.cacheControl}`,c["content-type"]=h.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(ot(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return At(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const s=yield gn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+s.url),a=o.searchParams.get("token");if(!a)throw new ou("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}update(e,t,n){return At(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return At(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}copy(e,t,n){return At(this,void 0,void 0,function*(){try{return{data:{path:(yield gn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return At(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield gn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return At(this,void 0,void 0,function*(){try{const i=yield gn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}download(e,t){return At(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ks(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ot(a))return{data:null,error:a};throw a}})}info(e){return At(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield Ks(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ja(n),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}exists(e){return At(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield eI(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ot(n)&&n instanceof Ya){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&i.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&i.push(l);let h=i.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${h}`)}}}remove(e){return At(this,void 0,void 0,function*(){try{return{data:yield wm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}list(e,t,n){return At(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},tI),t),{prefix:e||""});return{data:yield gn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ot(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const rI="2.7.1",iI={"X-Client-Info":`storage-js/${rI}`};var nr=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};class sI{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},iI),t),this.fetch=bm(n)}listBuckets(){return nr(this,void 0,void 0,function*(){try{return{data:yield Ks(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}})}getBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield Ks(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return nr(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return nr(this,void 0,void 0,function*(){try{return{data:yield ZS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ot(n))return{data:null,error:n};throw n}})}emptyBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}deleteBucket(e){return nr(this,void 0,void 0,function*(){try{return{data:yield wm(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ot(t))return{data:null,error:t};throw t}})}}class oI extends sI{constructor(e,t={},n){super(e,t,n)}from(e){return new nI(this.url,this.headers,e,this.fetch)}}const aI="2.49.4";let ci="";typeof Deno<"u"?ci="deno":typeof document<"u"?ci="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ci="react-native":ci="node";const lI={"X-Client-Info":`supabase-js-${ci}/${aI}`},uI={headers:lI},cI={schema:"public"},hI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},fI={};var dI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};const pI=r=>{let e;return r?e=r:typeof fetch>"u"?e=sm:e=fetch,(...t)=>e(...t)},mI=()=>typeof Headers>"u"?om:Headers,gI=(r,e,t)=>{const n=pI(t),i=mI();return(s,o)=>dI(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let h=new i(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",r),h.has("Authorization")||h.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},o),{headers:h}))})};var yI=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};function vI(r){return r.replace(/\/$/,"")}function _I(r,e){const{db:t,auth:n,realtime:i,global:s}=r,{db:o,auth:a,realtime:l,global:h}=e,c={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},h),s),accessToken:()=>yI(this,void 0,void 0,function*(){return""})};return r.accessToken?c.accessToken=r.accessToken:delete c.accessToken,c}const Em="2.69.1",ur=30*1e3,Xa=3,fa=Xa*ur,bI="http://localhost:9999",wI="supabase.auth.token",EI={"X-Client-Info":`gotrue-js/${Em}`},Za="X-Supabase-Api-Version",xm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xI=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,TI=6e5;class au extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ie(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class AI extends au{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function kI(r){return Ie(r)&&r.name==="AuthApiError"}class Tm extends au{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Rn extends au{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class pn extends Rn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function SI(r){return Ie(r)&&r.name==="AuthSessionMissingError"}class da extends Rn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ps extends Rn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ms extends Rn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function II(r){return Ie(r)&&r.name==="AuthImplicitGrantRedirectError"}class sf extends Rn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class el extends Rn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function pa(r){return Ie(r)&&r.name==="AuthRetryableFetchError"}class of extends Rn{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class gi extends Rn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const af="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lf=` 	
\r=`.split(""),OI=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<lf.length;e+=1)r[lf[e].charCodeAt(0)]=-2;for(let e=0;e<af.length;e+=1)r[af[e].charCodeAt(0)]=e;return r})();function Am(r,e,t){const n=OI[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function uf(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{RI(o,n,t)};for(let o=0;o<r.length;o+=1)Am(r.charCodeAt(o),i,s);return e.join("")}function NI(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function PI(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}NI(n,e)}}function RI(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if(!(r>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function CI(r){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)Am(r.charCodeAt(i),t,n);return new Uint8Array(e)}function jI(r){const e=[];return PI(r,t=>e.push(t)),new Uint8Array(e)}function LI(r){return Math.round(Date.now()/1e3)+r}function DI(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const zt=()=>typeof window<"u"&&typeof document<"u",Mn={tested:!1,writable:!1},yi=()=>{if(!zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mn.tested)return Mn.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Mn.tested=!0,Mn.writable=!0}catch{Mn.tested=!0,Mn.writable=!1}return Mn.writable};function MI(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const km=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>an(async()=>{const{default:n}=await Promise.resolve().then(()=>qr);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},VI=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Sm=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},gs=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ys=async(r,e)=>{await r.removeItem(e)};class So{constructor(){this.promise=new So.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}So.promiseConstructor=Promise;function ma(r){const e=r.split(".");if(e.length!==3)throw new gi("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!xI.test(e[n]))throw new gi("JWT not in base64url format");return{header:JSON.parse(uf(e[0])),payload:JSON.parse(uf(e[1])),signature:CI(e[2]),raw:{header:e[0],payload:e[1]}}}async function $I(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function qI(r,e){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await r(s);if(!e(s,null,o)){n(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function FI(r){return("0"+r.toString(16)).substr(-2)}function UI(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let s=0;s<56;s++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,FI).join("")}async function BI(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function zI(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await BI(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function rr(r,e,t=!1){const n=UI();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await Sm(r,`${e}-code-verifier`,i);const s=await zI(n);return[s,n===s?"plain":"s256"]}const HI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function KI(r){const e=r.headers.get(Za);if(!e||!e.match(HI))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function GI(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function WI(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var QI=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const qn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),YI=[502,503,504];async function cf(r){var e;if(!VI(r))throw new el(qn(r),0);if(YI.includes(r.status))throw new el(qn(r),r.status);let t;try{t=await r.json()}catch(s){throw new Tm(qn(s),s)}let n;const i=KI(r);if(i&&i.getTime()>=xm["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new of(qn(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new pn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new of(qn(t),r.status,t.weak_password.reasons);throw new AI(qn(t),r.status||500,n)}const JI=(r,e,t,n)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function je(r,e,t,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[Za]||(s[Za]=xm["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await XI(r,e,t+a,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function XI(r,e,t,n,i,s){const o=JI(e,n,i,s);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new el(qn(l),0)}if(a.ok||await cf(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await cf(l)}}function mn(r){var e;let t=null;nO(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=LI(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function hf(r){const e=mn(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function yn(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ZI(r){return{data:r,error:null}}function eO(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s}=r,o=QI(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function tO(r){return r}function nO(r){return r.access_token&&r.refresh_token&&r.expires_in}var rO=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class iO{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=km(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await je(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await je(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:yn})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=rO(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:eO,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ie(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await je(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yn})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,s,o,a,l;try{const h={nextPage:null,lastPage:0,total:0},c=await je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:tO});if(c.error)throw c.error;const d=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(_=>{const y=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(_.split(";")[1].split("=")[1]);h[`${g}Page`]=y}),h.total=parseInt(f)),{data:Object.assign(Object.assign({},d),h),error:null}}catch(h){if(Ie(h))return{data:{users:[]},error:h};throw h}}async getUserById(e){try{return await je(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yn})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await je(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:yn})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await je(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:yn})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await je(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await je(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}}const sO={getItem:r=>yi()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{yi()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{yi()&&globalThis.localStorage.removeItem(r)}};function ff(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function oO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ir={debug:!!(globalThis&&yi()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Im extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class aO extends Im{}async function lO(r,e,t){ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),ir.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw ir.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new aO(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(ir.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}oO();const uO={url:bI,storageKey:wI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:EI,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function df(r,e,t){return await t()}class Si{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Si.nextInstanceID,Si.nextInstanceID+=1,this.instanceID>0&&zt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},uO),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new iO({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=km(i.fetch),this.lock=i.lock||df,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:zt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=lO:this.lock=df,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:yi()?this.storage=sO:(this.memoryStorage={},this.storage=ff(this.memoryStorage)):(this.memoryStorage={},this.storage=ff(this.memoryStorage)),zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Em}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=MI(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),zt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),II(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ie(t)?{error:t}:{error:new Tm("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:mn}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(s){if(Ie(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,n,i;try{let s;if("email"in e){const{email:c,password:d,options:f}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await rr(this.storage,this.storageKey)),s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:_},xform:mn})}else if("phone"in e){const{phone:c,password:d,options:f}=e;s=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(i=f==null?void 0:f.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:mn})}else throw new ps("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(s){if(Ie(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:o,options:a}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hf})}else if("phone"in e){const{phone:s,password:o,options:a}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hf})}else throw new ps("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new da}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await gs(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:s,error:o}=await je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:mn});if(await ys(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new da}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Ie(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:s,nonce:o}=e,a=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:mn}),{data:l,error:h}=a;return h?{data:{user:null,session:null},error:h}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new da}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:h})}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,s,o;try{if("email"in e){const{email:a,options:l}=e;let h=null,c=null;this.flowType==="pkce"&&([h,c]=await rr(this.storage,this.storageKey));const{error:d}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:h,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:h,error:c}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:c}}throw new ps("You must provide either an email or phone number.")}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let i,s;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:mn});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,h=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:h,session:l},error:null}}catch(i){if(Ie(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await rr(this.storage,this.storageKey)),await je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:ZI})}catch(s){if(Ie(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new pn;const{error:i}=await je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:s}=e,{error:o}=await je(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:i,options:s}=e,{data:o,error:a}=await je(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new ps("You must provide either an email or phone number and a type")}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await gs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<fa:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,h,c)=>(!o&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,h,c))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yn}):await this._useSession(async t=>{var n,i,s;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pn}:await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:yn})})}catch(t){if(Ie(t))return SI(t)&&(await this._removeSession(),await ys(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new pn;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await rr(this.storage,this.storageKey));const{data:h,error:c}=await je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:yn});if(c)throw c;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pn;const t=Date.now()/1e3;let n=t,i=!0,s=null;const{payload:o}=ma(e.access_token);if(o.exp&&(n=o.exp,i=n<=t),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Ie(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new pn;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!zt())throw new ms("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ms(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new sf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ms("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sf("No code detected.");const{data:b,error:I}=await this._exchangeCodeForSession(e.code);if(I)throw I;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:h}=e;if(!s||!a||!o||!h)throw new ms("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let f=c+d;l&&(f=parseInt(l));const p=f-c;p*1e3<=ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const _=f-d;c-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,c):c-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,c);const{data:y,error:g}=await this._getUser(s);if(g)throw g;const m={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:h,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(Ie(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await gs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{error:s};const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(kI(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ys(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=DI(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:s},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await rr(this.storage,this.storageKey,!0));try{return await je(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Ie(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:i}=await this._useSession(async s=>{var o,a,l,h,c;const{data:d,error:f}=s;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await je(this.fetch,"GET",p,{headers:this.headers,jwt:(c=(h=d.session)===null||h===void 0?void 0:h.access_token)!==null&&c!==void 0?c:void 0})});if(i)throw i;return zt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ie(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)throw o;return await je(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await qI(async i=>(i>0&&await $I(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:mn})),(i,s)=>{const o=200*Math.pow(2,i);return s&&pa(s)&&Date.now()+o-n<ur})}catch(n){if(this._debug(t,"error",n),Ie(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),zt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await gs(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const i=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<fa;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${fa}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),pa(s)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new pn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new So;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new pn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Ie(s)){const o={session:null,error:s};return pa(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Sm(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ys(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&zt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ur}ms, refresh threshold is ${Xa} ticks`),i<=Xa&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Im)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await rr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await je(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:s,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:h}=await je(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;if(s)return{data:null,error:s};const{data:o,error:a}=await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:s}=t;return s?{data:null,error:s}:await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],i=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=ma(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+TI>Date.now()))return n;const{data:i,error:s}=await je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new gi("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(o=>o.kid===e),!n)throw new gi("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:p,error:_}=await this.getSession();if(_||!p.session)return{data:null,error:_};n=p.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=ma(n);if(GI(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:o},error:null}}const h=WI(i.alg),c=await this.fetchJwk(i.kid,t),d=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,o,jI(`${a}.${l}`)))throw new gi("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}}Si.nextInstanceID=0;const cO=Si;class hO extends cO{constructor(e){super(e)}}var fO=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(c){try{h(n.next(c))}catch(d){o(d)}}function l(c){try{h(n.throw(c))}catch(d){o(d)}}function h(c){c.done?s(c.value):i(c.value).then(a,l)}h((n=n.apply(r,e||[])).next())})};class dO{constructor(e,t,n){var i,s,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=vI(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:cI,realtime:fI,auth:Object.assign(Object.assign({},hI),{storageKey:l}),global:uI},c=_I(n??{},h);this.storageKey=(i=c.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=gI(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new PS(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new aS(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new oI(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return fO(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:s,flowType:o,lock:a,debug:l},h,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hO({url:this.authUrl,headers:Object.assign(Object.assign({},d),h),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,flowType:o,lock:a,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new KS(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const pO=(r,e,t)=>new dO(r,e,t),mO="https://dzmecnikrhsdedcagvzs.supabase.co",gO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR6bWVjbmlrcmhzZGVkY2FndnpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTQ2NzcsImV4cCI6MjA1OTEzMDY3N30.JMMQMbVTS7QHDPkFInynQ-MszbrH_mEFl4uEDP9E5pk";let Om=null;try{Om=pO(mO,gO),console.log("Supabase client initialized.")}catch(r){console.error("Error initializing Supabase client:",r)}const Et=Om,Vn="img",yO=({onUploadSuccess:r})=>{const[e,t]=te.useState("idle"),[n,i]=te.useState(null),[s,o]=te.useState(null),[a,l]=te.useState(null),[h,c]=te.useState(null),[d,f]=te.useState(!1),[p,_]=te.useState("Copy Link"),[y,g]=te.useState([]),[m,b]=te.useState(!0),[I,v]=te.useState(null),[N,C]=te.useState(null),[E,w]=te.useState(null),[A,x]=te.useState(""),[T,S]=te.useState(null),[O,D]=te.useState([]),q=te.useRef(null),{showToast:B,requestConfirmation:K}=Or(),oe=Z=>{if(!Et)return null;const{data:J}=Et.storage.from(Vn).getPublicUrl(Z);return(J==null?void 0:J.publicUrl)??null},z=async()=>{if(b(!0),v(null),!Et){v("Supabase client not initialized."),b(!1);return}try{const{data:Z,error:J}=await Et.storage.from(Vn).list("public",{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(J)throw J;Z&&g(Z)}catch(Z){console.error("Error fetching file history:",Z),v(`Failed to load history: ${Z instanceof Error?Z.message:"Unknown error"}`)}finally{b(!1)}},F=(Z,J)=>{D(ce=>J?ce.includes(Z)?ce:[...ce,Z]:ce.filter(me=>me!==Z))},j=()=>{if(!r||O.length===0)return;let Z=[],J=[];O.forEach(ce=>{const me=oe(ce);me?(r(me),Z.push(me)):(J.push(ce),console.error("Could not get public URL for selected file:",ce))}),J.length>0&&B(`Failed to get URLs for: ${J.map(ce=>ce.split("/").pop()).join(", ")}`,"error"),Z.length>0&&(B(`${Z.length} URL(s) used successfully.`,"success"),console.log("Used URLs:",Z),D([]))},V=async()=>{if(!Et||O.length===0)return;const Z=O.map(ce=>ce.split("/").pop()||"unknown file"),J=`Are you sure you want to delete ${O.length} selected file(s)?

- ${Z.join(`
- `)}

This cannot be undone.`;K({message:J,confirmText:"Confirm Delete",onConfirm:async()=>{if(!Et){B("Supabase client not initialized.","error");return}try{const{data:ce,error:me}=await Et.storage.from(Vn).remove(O);if(me)throw me;console.log("Successfully deleted files:",ce),B(`${O.length} file(s) deleted successfully.`,"success"),D([]),z()}catch(ce){console.error("Error deleting selected files:",ce),B(`Failed to delete selected files: ${ce instanceof Error?ce.message:"Unknown error"}`,"error")}}})},$=async(Z,J)=>{if(!Z){C({fileId:J,message:"Error!"}),setTimeout(()=>C(null),2e3);return}try{await navigator.clipboard.writeText(Z),C({fileId:J,message:"Copied!"}),setTimeout(()=>C(null),2e3)}catch(ce){console.error("Failed to copy history link:",ce),C({fileId:J,message:"Failed!"}),setTimeout(()=>C(null),2e3)}},G=(Z,J)=>{w(Z),x(J),S(null)},H=()=>{w(null),x(""),S(null)},M=async(Z,J)=>{if(!Et){S("Supabase client not initialized.");return}if(!A||A.trim()===""||A===J){S("Please enter a valid new name.");return}if(A.includes("/")){S("Filename cannot contain slashes.");return}const ce=J.includes(".")?J.substring(J.lastIndexOf(".")):"";let me=A.trim();ce&&!me.endsWith(ce)&&(me+=ce);const be=J.substring(J.lastIndexOf("."));let xe=A.trim();xe.endsWith(be)||(xe+=be);const De=`public/${J}`,Ce=`public/${xe}`;S(null);try{const{error:ft}=await Et.storage.from(Vn).move(De,Ce);if(ft)throw ft.message.includes("already exists")?new Error(`A file named '${xe}' already exists.`):ft;H(),z(),B("File renamed successfully!","success")}catch(ft){console.error("Error renaming file:",ft),S(`Rename failed: ${ft instanceof Error?ft.message:"Unknown error"}`)}},U=async Z=>{if(!Et){B("Supabase client not initialized.","error");return}const ce=`Are you sure you want to delete ${Z.split("/").pop()||"this file"}? This cannot be undone.`;K({message:ce,confirmText:"Confirm Delete",onConfirm:async()=>{if(!Et){B("Supabase client not initialized.","error");return}try{const{error:me}=await Et.storage.from(Vn).remove([Z]);if(me)throw me;z(),B("File deleted successfully.","success")}catch(me){console.error("Error deleting file:",me),B(`Failed to delete file: ${me instanceof Error?me.message:"Unknown error"}`,"error")}}})};te.useEffect(()=>{z()},[]);const Y=Z=>{Z&&Z.type.startsWith("image/")?(i(Z),c(null),t("idle"),l(null),o(URL.createObjectURL(Z)),de(Z)):(i(null),o(null),Z&&c("Please select an image file."))},Q=Z=>{var J;Y(((J=Z.target.files)==null?void 0:J[0])??null),Z.target&&(Z.target.value="")},se=Z=>{var J;Z.preventDefault(),Z.stopPropagation(),f(!1),Y(((J=Z.dataTransfer.files)==null?void 0:J[0])??null)},X=Z=>{Z.preventDefault(),Z.stopPropagation(),f(!0)},ue=Z=>{Z.preventDefault(),Z.stopPropagation(),Z.currentTarget.contains(Z.relatedTarget)||f(!1)},pe=()=>{var Z;(Z=q.current)==null||Z.click()},de=async Z=>{if(!Et){c("Supabase client is not initialized. Check configuration."),t("error");return}if(!Z){c("No file selected for upload."),t("error");return}t("uploading"),c(null),_("Copy Link");const ce=`public/${Date.now()}_${Z.name}`;try{const{data:me,error:be}=await Et.storage.from(Vn).upload(ce,Z,{cacheControl:"3600",upsert:!1});if(be)throw console.error("Supabase upload error:",be),be;console.log("Supabase upload successful:",me);const{data:xe}=Et.storage.from(Vn).getPublicUrl(ce);if(!xe||!xe.publicUrl)throw console.error("Could not get public URL for:",ce),new Error("Failed to retrieve public URL after upload.");const De=xe.publicUrl;console.log("File available at:",De),l(De),t("success"),r&&r(De),z()}catch(me){console.error("Upload process failed:",me),c(`Upload failed: ${me instanceof Error?me.message:"Unknown error"}`),t("error")}},Ae=async()=>{if(a)try{await navigator.clipboard.writeText(a),_("Copied!"),setTimeout(()=>_("Copy Link"),2e3)}catch(Z){console.error("Failed to copy:",Z),c("Failed to copy link to clipboard.")}},We=()=>P.jsxs("div",{className:`w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center transition-all duration-300 ${d?"border-blue-500 border-2":"border-gray-200 border"}`,onDrop:se,onDragOver:X,onDragLeave:ue,children:[P.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-2",children:"Upload your image"}),P.jsx("p",{className:"text-xs text-gray-500 mb-6",children:"File should be Jpeg, Png,..."}),P.jsxs("div",{className:`bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl p-10 mb-6 transition-colors duration-300 ${d?"border-blue-400 bg-blue-50":""}`,children:[P.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:P.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),P.jsx("p",{className:"text-sm text-gray-500",children:"Drag & Drop your image here"})]}),P.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Or"}),P.jsx("button",{onClick:pe,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300",children:"Choose a file"}),P.jsx("input",{ref:q,type:"file",accept:"image/jpeg",onChange:Q,className:"hidden"}),h&&P.jsx("p",{className:"text-red-500 text-sm mt-4",children:h})]}),qe=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsxs("svg",{className:"animate-spin mx-auto h-10 w-10 text-blue-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[P.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),P.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),P.jsx("h2",{className:"text-lg font-medium text-gray-700",children:"Uploading..."})]}),ne=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsx("svg",{className:"mx-auto h-10 w-10 text-green-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),P.jsx("h2",{className:"text-lg font-medium text-gray-700 mb-4",children:"Uploaded Successfully!"}),s&&P.jsx("div",{className:"mb-6 rounded-xl overflow-hidden border border-gray-200",children:P.jsx("img",{src:s,alt:"Uploaded preview",className:"max-w-full max-h-64 object-contain mx-auto"})}),P.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg p-2 bg-gray-50",children:[P.jsx("input",{type:"text",value:a??"",readOnly:!0,className:"flex-grow text-xs text-gray-700 bg-transparent border-none focus:ring-0 p-1 truncate","aria-label":"Uploaded image link"}),P.jsx("button",{onClick:Ae,className:"ml-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors duration-300 flex-shrink-0",children:p})]}),h&&P.jsx("p",{className:"text-red-500 text-sm mt-4",children:h})]}),re=()=>P.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-6 text-center",children:[P.jsx("svg",{className:"mx-auto h-10 w-10 text-red-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),P.jsx("h2",{className:"text-lg font-medium text-red-700 mb-4",children:"Upload Failed"}),P.jsx("p",{className:"text-sm text-gray-600 mb-6",children:h||"An unknown error occurred."}),P.jsx("button",{onClick:()=>{t("idle"),c(null),i(null),o(null)},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-300",children:"Try Again"})]}),fe=()=>P.jsxs("div",{className:"w-full max-w-2xl mt-8 bg-white rounded-xl shadow-lg p-6",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Uploaded Files History"}),O.length>0&&P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsxs("span",{className:"text-sm text-gray-600",children:[O.length," selected"]}),P.jsx("button",{onClick:j,className:"px-3 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors disabled:opacity-50",title:"Use selected image URLs",disabled:!r,children:"Use Selected"}),P.jsx("button",{onClick:V,className:"px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",title:"Delete selected files permanently",children:"Delete Selected"})]})]}),m&&P.jsx("p",{className:"text-gray-500",children:"Loading history..."}),I&&P.jsx("p",{className:"text-red-500",children:I}),!m&&!I&&P.jsx("ul",{className:"max-h-60 overflow-y-auto divide-y divide-gray-200 border rounded-md",children:y.length===0?P.jsx("li",{className:"p-3 text-center text-gray-500",children:"No files found in history."}):y.map(Z=>{const J=Z.id||Z.name,ce=Z.name,me=`public/${ce}`,be=oe(me),xe=(N==null?void 0:N.fileId)===J?N.message:null,De=E===J,Ce=O.includes(me);return P.jsxs("li",{className:`p-3 flex justify-between items-center text-sm ${Ce?"bg-blue-50":""}`,children:[" ",P.jsxs("div",{className:"flex items-center space-x-3 flex-grow min-w-0 mr-2",children:[" ",P.jsx("input",{type:"checkbox",checked:Ce,onChange:ft=>F(me,ft.target.checked),className:"form-checkbox h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 flex-shrink-0","aria-label":`Select file ${ce}`,disabled:De}),be?P.jsx("img",{src:be,alt:`Preview of ${ce}`,className:"h-10 w-10 object-cover rounded flex-shrink-0",loading:"lazy"}):P.jsx("div",{className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center text-gray-400 flex-shrink-0",children:"?"}),De?P.jsxs("div",{className:"flex-grow",children:[P.jsx("input",{type:"text",value:A,onChange:ft=>x(ft.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 w-full focus:outline-none focus:ring-1 focus:ring-blue-500","aria-label":"New filename"}),T&&P.jsx("p",{className:"text-red-500 text-xs mt-1",children:T})]}):P.jsx("span",{className:"text-gray-800 truncate",title:ce,children:ce})]}),P.jsxs("div",{className:"flex space-x-1 flex-shrink-0",children:[" ",De?P.jsxs(P.Fragment,{children:[P.jsx("button",{onClick:()=>M(J,ce),className:"px-2 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors",title:"Save new name",children:"Save"}),P.jsx("button",{onClick:H,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors",title:"Cancel editing",children:"Cancel"})]}):P.jsxs(P.Fragment,{children:[P.jsxs("button",{onClick:()=>$(be,J),className:`px-2 py-1 text-white text-xs rounded transition-colors ${xe==="Copied!"?"bg-green-600":xe==="Failed!"||xe==="Error!"?"bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,title:"Copy image link",disabled:!be||!!xe||Ce,children:[" ",xe||"Copy"]}),P.jsxs("button",{onClick:()=>G(J,ce),className:"px-2 py-1 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors",title:"Rename file",disabled:Ce,children:[" ","Edit"]}),P.jsxs("button",{onClick:()=>U(me),className:"px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",title:"Delete this file permanently",disabled:Ce,children:[" ","Delete"]})]})]})]},J)})})]});return P.jsxs("div",{className:"flex flex-col items-center justify-start min-h-[400px] bg-gray-100 p-4",children:[P.jsxs("div",{className:"w-full flex justify-center mb-4",children:[e==="idle"&&We(),e==="uploading"&&qe(),e==="success"&&ne(),e==="error"&&re()]}),fe()]})},vO=()=>{const r=gf(),[e,t]=te.useState(!1),[n,i]=te.useState(()=>{const x=localStorage.getItem("desktopSidebarCollapsed");return x?JSON.parse(x):!1}),[s,o]=te.useState(!1),[a,l]=te.useState(window.innerWidth<768);te.useEffect(()=>{const x=()=>{const T=window.innerWidth<768;l(T),T||t(!1)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),te.useEffect(()=>{a||localStorage.setItem("desktopSidebarCollapsed",JSON.stringify(n))},[n,a]);const{translations:h,isLoading:c,saveStatus:d,handleInputChange:f,handleAddNewProject:p,handleAddNewService:_,saveChanges:y,handleDeleteItem:g}=a1(),[m,b]=te.useState(null),[I,v]=te.useState(null),N={pageViews:"1,234",totalPages:"12",comments:"45",averageRating:"4.8"},C=async()=>{if(!Mt){console.error("Firebase auth instance is not available."),alert("Logout service unavailable. Please try again later.");return}try{await Eg(Mt),r("/admin/login")}catch(x){console.error("Logout failed:",x),alert("Failed to log out. Please try again.")}},E=[{icon:P.jsx(sy,{size:20}),label:"Dashboard",tab:"dashboard"},{icon:P.jsx(oc,{size:20}),label:"Pages",tab:"pages"},{icon:P.jsx(Xg,{size:20}),label:"Projects",tab:"projects"},{icon:P.jsx(ny,{size:20}),label:"Media",tab:"media"},{icon:P.jsx(If,{size:20}),label:"Appearance",tab:"styleEditor"},{icon:P.jsx(ay,{size:20}),label:"Social Links",tab:"socialLinks"},{icon:P.jsx(ky,{size:20}),label:"Settings",tab:"generalInfo"}],w=()=>P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Page Views"}),P.jsx(Qg,{className:"text-blue-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.pageViews}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Last 30 days"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Total Pages"}),P.jsx(oc,{className:"text-green-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.totalPages}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Published content"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Comments"}),P.jsx(gy,{className:"text-purple-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.comments}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Awaiting response"})]}),P.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[P.jsxs("div",{className:"flex items-center justify-between mb-4",children:[P.jsx("h3",{className:"text-gray-700 font-semibold",children:"Average Rating"}),P.jsx(Py,{className:"text-yellow-500",size:20})]}),P.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.averageRating}),P.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Based on feedback"})]})]}),A=()=>{if(c)return P.jsx("div",{className:"flex items-center justify-center py-10",children:P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});if(!m||m==="dashboard")return w();if(m==="styleEditor")return P.jsx(pw,{});if(m==="socialLinks")return P.jsx(mw,{});if(m==="pages")return P.jsx(tS,{});if(m==="media")return P.jsx(yO,{});if(s1(m)){const x=as(m);return P.jsxs(P.Fragment,{children:[P.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-700 capitalize",children:x}),m==="projects"?P.jsx(l1,{data:h.en.projects,path:[m],handleChange:f,editingPath:I,setEditingPath:v,handleAddProject:p,handleDelete:g,renderFields:hr}):m==="services"?P.jsx(u1,{data:h.en.services,path:[m],handleChange:f,editingPath:I,setEditingPath:v,handleAddService:_,handleDelete:g,renderFields:hr}):m==="generalInfo"?P.jsx(gw,{translations:h,handleInputChange:f,editingPath:I,setEditingPath:v,getStaticSectionName:as}):hr(h.en[m],[m],f,I,v,void 0,g)]})}return P.jsxs("p",{className:"text-red-500",children:["Error: Invalid tab '",m,"' selected."]})};return P.jsxs(dp,{children:[" ",P.jsxs("div",{className:"min-h-screen bg-gray-100",children:[P.jsx("nav",{className:"bg-white shadow-md fixed w-full z-10",children:P.jsxs("div",{className:"px-4 h-16 flex items-center justify-between",children:[P.jsxs("div",{className:"flex items-center space-x-4",children:[P.jsx("button",{onClick:()=>{a?t(!e):i(!n)},className:"text-gray-500 hover:text-gray-700 md:hidden",children:P.jsx(ac,{size:24})}),P.jsx("button",{onClick:()=>i(!n),className:"text-gray-500 hover:text-gray-700 hidden md:block",children:P.jsx(ac,{size:24})})]}),P.jsx("div",{className:"flex items-center space-x-4",children:P.jsxs("div",{className:"relative",children:[P.jsxs("button",{onClick:()=>o(!s),className:"flex items-center space-x-2 text-gray-700 hover:text-gray-900",children:[P.jsx($y,{size:20}),P.jsx("span",{children:"Admin"}),P.jsx(Vg,{size:16})]}),s&&P.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 border border-gray-200",children:P.jsxs("button",{onClick:C,className:"w-full px-4 py-2 text-left text-red-600 hover:bg-gray-50 flex items-center space-x-2",children:[P.jsx(cy,{size:16}),P.jsx("span",{children:"Logout"})]})})]})})]})}),P.jsxs("div",{className:"flex pt-16",children:[a&&e&&P.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20",onClick:()=>t(!1)}),P.jsx("aside",{className:`fixed top-16 h-[calc(100vh-4rem)] bg-gray-800 text-white transition-transform duration-300 ease-in-out z-30 md:translate-x-0 md:transition-all md:duration-300
            ${a?e?"translate-x-0 w-64":"-translate-x-full w-64":n?"w-20":"w-64"}
          `,children:P.jsx("nav",{className:"p-4 overflow-y-auto h-full",children:E.map(x=>P.jsxs("button",{onClick:()=>{b(x.tab),a&&t(!1)},className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${m===x.tab?"bg-blue-600 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white"}`,children:[x.icon,P.jsx("span",{className:`${a&&e||!a&&!n?"inline":"hidden"}`,children:x.label})]},x.tab))})}),P.jsx("main",{className:`flex-1 transition-all duration-300 ${a?"ml-0":n?"md:ml-20":"md:ml-64"}`,children:P.jsxs("div",{className:"p-4 md:p-8",children:[P.jsxs("div",{className:"mb-4 md:mb-6",children:[P.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:m?as(m):"Dashboard"}),P.jsxs("p",{className:"text-sm text-gray-500",children:["Home / ",m?as(m):"Dashboard"]})]}),P.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:A()}),m&&m!=="styleEditor"&&m!=="socialLinks"&&m!=="pages"&&P.jsxs("div",{className:"mt-6 flex justify-end items-center gap-4",children:[d&&P.jsx("span",{className:"text-green-600 text-sm",children:d}),P.jsx("button",{onClick:()=>y(),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition-colors",disabled:c,children:"Save Changes"})]})]})})]})]})]})},_O=(r=Vt)=>{const e=r.en,t=e==null?void 0:e.projects,n=t?Object.entries(t).filter(([i,s])=>i!=="title"&&typeof s=="object"&&s!==null).map(([i,s])=>({title:(s==null?void 0:s.title)??`Project ${i}`,description:(s==null?void 0:s.description)??"Description missing.",tags:(s==null?void 0:s.tags)??[],link:(s==null?void 0:s.link)??""})):[];return{title:(t==null?void 0:t.title)??"Featured Projects",projects:n}},bO=({logoUrl:r})=>P.jsx("img",{src:r||"https://raw.githubusercontent.com/tiger3homs/home/refs/heads/main/public/logo.png",alt:"Logo",className:"mx-auto mb-6 w-24 h-24",style:{pointerEvents:"none",userSelect:"none"}}),wO=({page:r})=>{const e=rg();return r?P.jsx("div",{className:"min-h-screen text-white",style:{background:"linear-gradient(to bottom right, var(--background-from-color, #111827), var(--background-to-color, #1F2937))"},children:P.jsxs("div",{className:"container mx-auto px-4 py-16",children:[P.jsx("h1",{className:"text-4xl font-bold mb-6",style:{color:"var(--title-color)"},children:r.title}),P.jsxs("div",{className:"prose prose-invert max-w-none text-text",children:[" ",P.jsx("div",{className:"ql-snow",children:P.jsx("div",{className:"ql-editor",dangerouslySetInnerHTML:{__html:r.content}})})]}),P.jsx("div",{className:"mt-12 text-center",children:P.jsx(Ts,{to:"/",className:"text-blue-400 hover:text-blue-300 underline",children:"← Back to Home"})})]})}):P.jsxs("div",{className:"container mx-auto px-4 py-16 text-center text-white min-h-screen flex flex-col items-center justify-center",children:[P.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Page Not Found"}),P.jsxs("p",{className:"text-xl",children:["The page you requested (",e.pathname,") could not be found."]}),P.jsx(Ts,{to:"/",className:"mt-6 inline-block bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded",children:"Go Home"})]})},EO=()=>{const[r,e]=te.useState(!1),t=()=>{window.pageYOffset>300?e(!0):e(!1)};te.useEffect(()=>(window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}),[]);const n=()=>{window.scrollTo({top:0,behavior:"smooth"})};return P.jsx("button",{type:"button",onClick:n,className:`fixed bottom-5 right-5 p-3 rounded-full bg-blue-500 text-white shadow-lg transition-opacity duration-300 hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,"aria-label":"Scroll to top",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:P.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})})})},xO=te.lazy(()=>an(()=>import("./ServicesSection-Csd0n1L0.js"),__vite__mapDeps([2,1,3]),import.meta.url)),TO=te.lazy(()=>an(()=>import("./ProjectsSection-CPRpL5UG.js"),__vite__mapDeps([4,1,3]),import.meta.url)),AO=te.lazy(()=>an(()=>import("./ContactSection-CZbPmDpJ.js"),__vite__mapDeps([5,1,3]),import.meta.url)),kO=6e4;let pf=0;const SO=r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r),IO=r=>r.length>=10&&r.length<=1e3,OO={Github:Tf,Facebook:xf,Mail:Sf,Instagram:Af,Linkedin:kf,Twitter:Nf},NO=({children:r})=>{const[e,t]=te.useState(null),[n,i]=te.useState(!0);return te.useEffect(()=>{if(!Mt){i(!1);return}const s=vf(Mt,o=>{t(o),i(!1)});return()=>s()},[]),n?P.jsx("div",{className:"flex items-center justify-center min-h-screen",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):e?r:P.jsx(yf,{to:"/admin/login",replace:!0})},PO=({dynamicPages:r})=>{const[e,t]=te.useState(Vt),[n,i]=te.useState(!0),[s,o]=te.useState(!1);te.useEffect(()=>{if(!ve){console.error("MainSite: Firestore instance is not available."),i(!1);return}const b=Ze(ve,"translations/en");i(!0);const I=zl(b,v=>{if(v.exists()){const N=v.data();t(C=>({...C,en:{...Vt.en,...N}}))}else t(Vt),console.log("MainSite: No translations document found in Firestore, using defaults.");i(!1)},v=>{console.error("MainSite: Firestore snapshot error:",v),t(Vt),i(!1)});return()=>I()},[]),te.useEffect(()=>{const b=I=>{I.ctrlKey&&I.altKey&&I.key==="a"&&(I.preventDefault(),o(v=>!v))};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[]);const a=te.useMemo(()=>e.en,[e]),[l,h]=te.useState([]),[c,d]=te.useState({name:"",email:"",message:""}),f=te.useCallback(b=>{const{name:I,value:v}=b.target;d(N=>({...N,[I]:v}))},[]),p=te.useCallback(async b=>{b.preventDefault();const I=Date.now();if(I-pf<kO){alert("Please wait a minute before sending another message.");return}if(!SO(c.email)){alert("Please enter a valid email address.");return}if(!IO(c.message)){alert("Message must be between 10 and 1000 characters.");return}pf=I;try{uc.init("skwn_-DYfDakGK644"),await uc.send("service_bdj14o3","template_2e2nikq",{name:c.name,email:c.email,message:c.message,to_email:"tiger3homs@gmail.com"}),alert("Message sent successfully!"),d({name:"",email:"",message:""})}catch(v){console.error("Failed to send message:",v),alert("Failed to send message. Please try again.")}},[c]);te.useEffect(()=>{(async()=>{if(ve)try{const I=_r(ve,"socialLinks"),v=uo(I,co("order","asc")),C=(await Mi(v)).docs.map(E=>({id:E.id,...E.data()}));h(C)}catch(I){console.error("Error fetching social links:",I)}})()},[]);const _=te.useMemo(()=>_O(e),[e]),y=P.jsx("div",{className:"flex items-center justify-center p-8",children:P.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})});return n?P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):P.jsxs("div",{className:"min-h-screen text-white ltr",style:{background:"linear-gradient(to bottom right, var(--background-from-color, #111827), var(--background-to-color, #1F2937))"},children:[P.jsx("header",{className:"container mx-auto px-4 py-16 md:py-32",children:P.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[P.jsx(bO,{logoUrl:a.generalInfo.logoUrl}),P.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6 text-primary",style:{pointerEvents:"none",userSelect:"none"},children:a.generalInfo.siteTitle}),P.jsx("p",{className:"text-xl md:text-2xl text-secondary mb-8",style:{pointerEvents:"none",userSelect:"none"},children:a.generalInfo.siteRole}),P.jsx("div",{className:"flex justify-center space-x-6",children:l.map(b=>{const I=OO[b.icon];return I?P.jsx("a",{href:b.url,target:"_blank",rel:"noopener noreferrer","aria-label":b.name,className:"text-primary hover:text-text transition-colors transform hover:scale-110",children:P.jsx(I,{size:24})},b.id):null})}),r&&r.length>0&&P.jsx("nav",{className:"mb-4 flex justify-center flex-wrap gap-x-4 gap-y-2 mt-8",children:r.map(b=>P.jsx(Ts,{to:`/${b.slug}`,className:"text-secondary hover:text-primary transition-colors text-sm",children:b.title},b.id))})]})}),P.jsx(te.Suspense,{fallback:y,children:P.jsx(TO,{title:_.title,projects:_.projects})}),P.jsx("section",{className:"container mx-auto px-4 py-16 bg-gray-800/50 backdrop-blur-sm",children:P.jsxs("div",{className:"max-w-3xl mx-auto",children:[P.jsx("h2",{className:"text-3xl font-bold text-center mb-8",style:{color:"var(--title-color)"},children:a.about.title}),P.jsx("p",{className:"text-lg leading-relaxed text-text",children:a.about.description})]})}),P.jsx(te.Suspense,{fallback:y,children:P.jsx(xO,{title:a.services.title,services:a.services.list})}),P.jsx(te.Suspense,{fallback:y,children:P.jsx(AO,{t:a.contact,handleSubmit:p,formData:c,handleInputChange:f})}),P.jsxs("footer",{className:"container mx-auto px-4 py-8 text-center relative",children:[P.jsx("p",{className:"text-secondary mb-4",children:a.generalInfo.footerText}),P.jsx(Ts,{to:"/admin/dashboard",className:`absolute bottom-2 left-1/2 -translate-x-1/2 text-sm text-primary hover:text-text underline transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"}`,children:"Admin Dashboard"})]})]})};function RO(){const[r,e]=te.useState([]),[t,n]=te.useState(!0);return te.useEffect(()=>{if(!ve){console.error("App.tsx: Firestore not initialized correctly for loading styles.");return}const i=Ze(ve,"settings","styles");console.log("App.tsx: Setting up real-time listener for global styles...");const s=zl(i,o=>{if(o.exists()){const a=o.data();console.log("App.tsx: Received style update from Firestore:",a),document.documentElement.style.setProperty("--primary-color",a.primaryColor),document.documentElement.style.setProperty("--secondary-color",a.secondaryColor),document.documentElement.style.setProperty("--font-family",a.fontFamily),document.documentElement.style.setProperty("--title-color",a.titleColor||"#d7e3ee"),document.documentElement.style.setProperty("--h3title-color",a.h3TitleColor||"#d7e3ee"),document.documentElement.style.setProperty("--text-color",a.textColor||"#c6d3e2"),document.documentElement.style.setProperty("--background-from-color",a.backgroundFromColor||"#111827"),document.documentElement.style.setProperty("--background-to-color",a.backgroundToColor||"#1F2937"),document.documentElement.style.setProperty("--section-bg-color",a.sectionBgColor||"#374151")}else console.log("App.tsx: No global styles document found in Firestore, applying CSS defaults.")},o=>{console.error("App.tsx: Error listening to global styles:",o)});return()=>{console.log("App.tsx: Unsubscribing from global styles listener."),s()}},[]),te.useEffect(()=>{if(n(!0),!ve){console.error("App.tsx: Firestore not initialized correctly for loading pages."),n(!1);return}(async()=>{if(!ve){console.error("App.tsx: Firestore not initialized correctly for loading pages."),n(!1);return}try{const s=_r(ve,"pages"),o=uo(s,co("order","asc")),l=(await Mi(o)).docs.map(h=>({id:h.id,...h.data()}));e(l),console.log("App.tsx: Fetched dynamic pages:",l)}catch(s){console.error("App.tsx: Error fetching dynamic pages:",s)}finally{n(!1)}})()},[]),t?P.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-900",children:P.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):P.jsxs(dp,{children:[" ",P.jsxs(ig,{children:[P.jsxs(sg,{children:[P.jsx(ti,{path:"/",element:P.jsx(PO,{dynamicPages:r})}),r.map(i=>P.jsx(ti,{path:`/${i.slug}`,element:P.jsx(wO,{page:i})},i.id)),P.jsx(ti,{path:"/admin/login",element:P.jsx(e1,{})}),P.jsx(ti,{path:"/admin/dashboard",element:P.jsx(NO,{children:P.jsx(vO,{})})}),P.jsx(ti,{path:"/admin",element:P.jsx(yf,{to:"/admin/login",replace:!0})})]}),P.jsx(EO,{})," "]})]})}wf(document.getElementById("root")).render(P.jsx(RO,{}));export{Re as c,P as j};
//# sourceMappingURL=index-BOZ-Sprd.js.map
